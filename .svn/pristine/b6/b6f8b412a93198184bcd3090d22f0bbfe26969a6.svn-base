!(function(){function t(t){try{if(""+t=="[object CallbackConstructor]")return"function"}catch(t){}return"object"}!(function(i,n,o){function r(o,c){var a=n[o];if(!a){var h=i[o];if(!h){var l="function"==("object"==(e=typeof require)?t(require):e)&&require;if(!c&&l)return l(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var d={};a=n[o]={exports:d},h[0]((function(t){return r(h[1][t]||t)}),a,d)}return a.exports}for(var s="function"==("object"==(e=typeof require)?t(require):e)&&require,c=0;c<o.length;c++)r(o[c])})({1:[(function(t,e,i){function n(t,e){return function(i){"use strict";if(1!==arguments.length){var n="";2===arguments.length?n="Arguments: "+arguments[1]:arguments.length>2&&(n="Arguments: "+cc.js.shiftArguments.apply(null,arguments).join(", ")),t(e+" "+i+", please go to "+s+"#"+i+" to see details. "+n)}else t(e+" "+i+", please go to "+s+"#"+i+" to see details.")}}cc._logToWebPage=function(t){if(cc._canvas){var e=cc._logList,i=document;if(!e){var n=i.createElement("Div"),o=n.style;n.setAttribute("id","logInfoDiv"),cc._canvas.parentNode.appendChild(n),n.setAttribute("width","200"),n.setAttribute("height",cc._canvas.height),o.zIndex="99999",o.position="absolute",o.top="0",o.left="0";var r=(e=cc._logList=i.createElement("textarea")).style;e.setAttribute("rows","20"),e.setAttribute("cols","30"),e.setAttribute("disabled",!0),n.appendChild(e),r.backgroundColor="transparent",r.borderBottom="1px solid #cccccc",r.borderRightWidth="0px",r.borderLeftWidth="0px",r.borderTopWidth="0px",r.borderTopStyle="none",r.borderRightStyle="none",r.borderLeftStyle="none",r.padding="0px",r.margin=0}e.value=e.value+t+"\r\n",e.scrollTop=e.scrollHeight}};var o=t("./cocos2d/core/platform/CCEnum");cc.DebugMode=o({NONE:0,INFO:1,WARN:2,ERROR:3,INFO_FOR_WEB_PAGE:4,WARN_FOR_WEB_PAGE:5,ERROR_FOR_WEB_PAGE:6});var r=cc.log||console.log;cc._initDebugSetting=function(t){if(cc.log=cc.logID=cc.warn=cc.warnID=cc.error=cc.errorID=cc._throw=cc.assert=cc.assertID=function(){},t!==cc.DebugMode.NONE){console&&console.log.apply&&(console.error||(console.error=console.log),console.warn||(console.warn=console.log),console.error.bind?cc.error=console.error.bind(console):cc.error=console.error,cc.assert=function(t,e){if(!t)throw e&&(e=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments))),new Error(e)}),t!==cc.DebugMode.ERROR&&(console.warn.bind?cc.warn=console.warn.bind(console):cc.warn=console.warn),t===cc.DebugMode.INFO&&(cc.log=r,cc.info=r),cc.warnID=n(cc.warn,"Warning"),cc.errorID=n(cc.error,"Error"),cc.logID=n(cc.log,"Log");var e=n((function(){for(var t=[!1],e=0;e<arguments.length;++e)t.push(arguments[e]);cc.assert.apply(null,t)}),"Assert");cc.assertID=function(t){"use strict";t||e.apply(null,cc.js.shiftArguments.apply(null,arguments))}}},cc._throw=function(t){var e=t.stack;e?cc.error(t+"\n"+e):cc.error(t)};var s="https://github.com/cocos-creator/engine/blob/master/EngineErrorMap.md"}),{"./cocos2d/core/platform/CCEnum":138}],2:[(function(t,e,i){}),{}],3:[(function(t,e,i){cc.Action=cc._Class.extend({ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.Action.TAG_INVALID},clone:function(){var t=new cc.Action;return t.originalTarget=null,t.target=null,t.tag=this.tag,t},isDone:function(){return!0},startWithTarget:function(t){this.originalTarget=t,this.target=t},stop:function(){this.target=null},step:function(t){cc.logID(1006)},update:function(t){cc.logID(1007)},getTarget:function(){return this.target},setTarget:function(t){this.target=t},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(t){this.originalTarget=t},getTag:function(){return this.tag},setTag:function(t){this.tag=t},retain:function(){},release:function(){}}),cc.Action.TAG_INVALID=-1,cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(t){this._duration=t},reverse:function(){return cc.logID(1008),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,t&&this.initWithAction(t,e)},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},initWithAction:function(t,e){if(!t)throw new Error("cc.Speed.initWithAction(): action must be non nil");return this._innerAction=t,this._speed=e,!0},clone:function(){var t=new cc.Speed;return t.initWithAction(this._innerAction.clone(),this._speed),t},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(t){this._innerAction.step(t*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.speed=function(t,e){return new cc.Speed(t,e)},cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))},clone:function(){var t=new cc.Follow,e=this._worldRect,i=new cc.Rect(e.x,e.y,e.width,e.height);return t.initWithTarget(this._followedNode,i),t},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(t){this._boundarySet=t},initWithTarget:function(t,e){if(!t)throw new Error("cc.Follow.initWithAction(): followedNode must be non nil");var i=this;e=e||cc.rect(0,0,0,0),i._followedNode=t,i._worldRect=e,i._boundarySet=!cc._rectEqualToZero(e),i._boundaryFullyCovered=!1;var n=cc.director.getWinSize();return i._fullScreenSize=cc.p(n.width,n.height),i._halfScreenSize=cc.pMult(i._fullScreenSize,.5),i._boundarySet&&(i.leftBoundary=-(e.x+e.width-i._fullScreenSize.x),i.rightBoundary=-e.x,i.topBoundary=-e.y,i.bottomBoundary=-(e.y+e.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary&&(i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2),i.topBoundary<i.bottomBoundary&&(i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2),i.topBoundary===i.bottomBoundary&&i.leftBoundary===i.rightBoundary&&(i._boundaryFullyCovered=!0)),!0},step:function(t){var e=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO),i=this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO),n=cc.pSub(e,i),o=this.target.parent.convertToNodeSpaceAR(cc.pAdd(n,this._halfScreenSize));if(this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(cc.clampf(o.x,this.leftBoundary,this.rightBoundary),cc.clampf(o.y,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(o.x,o.y)},isDone:function(){return!this._followedNode.isRunning()},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(t,e){return new cc.Follow(t,e)}}),{}],4:[(function(t,e,i){function n(t){for(var e=[],i=t.length-1;i>=0;i--)e.push(cc.p(t[i].x,t[i].y));return e}function o(t){for(var e=[],i=0;i<t.length;i++)e.push(cc.p(t[i].x,t[i].y));return e}cc.cardinalSplineAt=function(t,e,i,n,o,r){var s=r*r,c=s*r,a=(1-o)/2,h=a*(2*s-c-r),l=a*(-c+s)+(2*c-3*s+1),u=a*(c-2*s+r)+(-2*c+3*s),d=a*(c-s),p=t.x*h+e.x*l+i.x*u+n.x*d,_=t.y*h+e.y*l+i.y*u+n.y*d;return cc.p(p,_)},cc.getControlPointAt=function(t,e){return t[Math.min(t.length-1,Math.max(e,0))]},cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._points=[],void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(!e||0===e.length)throw new Error("Invalid configuration. It must at least have one control point");return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this.setPoints(e),this._tension=i,!0)},clone:function(){var t=new cc.CardinalSplineTo;return t.initWithDuration(this._duration,o(this._points),this._tension),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._deltaT=1/(this._points.length-1),this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY()),this._accumulatedDiff=cc.p(0,0)},update:function(t){t=this._computeEaseTime(t);var e,i,n=this._points;if(1===t)e=n.length-1,i=1;else{var o=this._deltaT;i=(t-o*(e=0|t/o))/o}var r=cc.cardinalSplineAt(cc.getControlPointAt(n,e-1),cc.getControlPointAt(n,e-0),cc.getControlPointAt(n,e+1),cc.getControlPointAt(n,e+2),this._tension,i);if(cc.macro.ENABLE_STACKABLE_ACTIONS){var s,c;if(s=this.target.getPositionX()-this._previousPosition.x,c=this.target.getPositionY()-this._previousPosition.y,0!==s||0!==c){var a=this._accumulatedDiff;s=a.x+s,c=a.y+c,a.x=s,a.y=c,r.x+=s,r.y+=c}}this.updatePosition(r)},reverse:function(){var t=n(this._points);return cc.cardinalSplineTo(this._duration,t,this._tension)},updatePosition:function(t){this.target.setPosition(t),this._previousPosition=t},getPoints:function(){return this._points},setPoints:function(t){this._points=t}}),cc.cardinalSplineTo=function(t,e,i){return new cc.CardinalSplineTo(t,e,i)},cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(t,e,i){cc.CardinalSplineTo.prototype.ctor.call(this),this._startPosition=cc.p(0,0),void 0!==i&&this.initWithDuration(t,e,i)},startWithTarget:function(t){cc.CardinalSplineTo.prototype.startWithTarget.call(this,t),this._startPosition.x=t.getPositionX(),this._startPosition.y=t.getPositionY()},reverse:function(){for(var t,e=this._points.slice(),i=e[0],o=1;o<e.length;++o)t=e[o],e[o]=cc.pSub(t,i),i=t;var r=n(e);i=r[r.length-1],r.pop(),i.x=-i.x,i.y=-i.y,r.unshift(i);for(o=1;o<r.length;++o)(t=r[o]).x=-t.x,t.y=-t.y,t.x+=i.x,t.y+=i.y,r[o]=t,i=t;return cc.cardinalSplineBy(this._duration,r,this._tension)},updatePosition:function(t){var e=this._startPosition,i=t.x+e.x,n=t.y+e.y;this._previousPosition.x=i,this._previousPosition.y=n,this.target.setPosition(i,n)},clone:function(){var t=new cc.CardinalSplineBy;return t.initWithDuration(this._duration,o(this._points),this._tension),t}}),cc.cardinalSplineBy=function(t,e,i){return new cc.CardinalSplineBy(t,e,i)},cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(t,e){e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomTo;return t.initWithDuration(this._duration,o(this._points)),t}}),cc.catmullRomTo=function(t,e){return new cc.CatmullRomTo(t,e)},cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(t,e){cc.CardinalSplineBy.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomBy;return t.initWithDuration(this._duration,o(this._points)),t}}),cc.catmullRomBy=function(t,e){return new cc.CatmullRomBy(t,e)}}),{}],5:[(function(t,e,i){cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ActionEase.initWithAction(): action must be non nil");return!!this.initWithDuration(t.getDuration())&&(this._inner=t,!0)},clone:function(){var t=new cc.ActionEase;return t.initWithAction(this._inner.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop(),cc.ActionInterval.prototype.stop.call(this)},update:function(t){this._inner.update(t)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}}),cc.actionEase=function(t){return new cc.ActionEase(t)},cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},setRate:function(t){this._rate=t},getRate:function(){return this._rate},initWithAction:function(t,e){return!!cc.ActionEase.prototype.initWithAction.call(this,t)&&(this._rate=e,!0)},clone:function(){var t=new cc.EaseRateAction;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate)}}),cc.easeRateAction=function(t,e){return new cc.EaseRateAction(t,e)},cc.EaseIn=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseIn;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.easeIn=function(t){return{_rate:t,easing:function(t){return Math.pow(t,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.EaseOut=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseOut;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.easeOut=function(t){return{_rate:t,easing:function(t){return Math.pow(t,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.EaseInOut=cc.EaseRateAction.extend({update:function(t){(t*=2)<1?this._inner.update(.5*Math.pow(t,this._rate)):this._inner.update(1-.5*Math.pow(2-t,this._rate))},clone:function(){var t=new cc.EaseInOut;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}}),cc.easeInOut=function(t){return{_rate:t,easing:function(t){return(t*=2)<1?.5*Math.pow(t,this._rate):1-.5*Math.pow(2-t,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}},cc.EaseExponentialIn=cc.ActionEase.extend({update:function(t){this._inner.update(0===t?0:Math.pow(2,10*(t-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialInObj={easing:function(t){return 0===t?0:Math.pow(2,10*(t-1))},reverse:function(){return cc._easeExponentialOutObj}},cc.easeExponentialIn=function(){return cc._easeExponentialInObj},cc.EaseExponentialOut=cc.ActionEase.extend({update:function(t){this._inner.update(1===t?1:1-Math.pow(2,-10*t))},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialOutObj={easing:function(t){return 1===t?1:1-Math.pow(2,-10*t)},reverse:function(){return cc._easeExponentialInObj}},cc.easeExponentialOut=function(){return cc._easeExponentialOutObj},cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(t){1!==t&&0!==t&&(t=(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))),this._inner.update(t)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialInOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialInOutObj={easing:function(t){return 1!==t&&0!==t?(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1))):t},reverse:function(){return cc._easeExponentialInOutObj}},cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj},cc.EaseSineIn=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1,this._inner.update(t)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var t=new cc.EaseSineIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeSineInObj={easing:function(t){return 0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}},cc.easeSineIn=function(){return cc._easeSineInObj},cc.EaseSineOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:Math.sin(t*Math.PI/2),this._inner.update(t)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var t=new cc.EaseSineOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeSineOutObj={easing:function(t){return 0===t||1===t?t:Math.sin(t*Math.PI/2)},reverse:function(){return cc._easeSineInObj}},cc.easeSineOut=function(){return cc._easeSineOutObj},cc.EaseSineInOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1),this._inner.update(t)},clone:function(){var t=new cc.EaseSineInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}}),cc._easeSineInOutObj={easing:function(t){return 0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1)},reverse:function(){return cc._easeSineInOutObj}},cc.easeSineInOut=function(){return cc._easeSineInOutObj},cc.EaseElastic=cc.ActionEase.extend({_period:.3,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),t&&this.initWithAction(t,e)},getPeriod:function(){return this._period},setPeriod:function(t){this._period=t},initWithAction:function(t,e){return cc.ActionEase.prototype.initWithAction.call(this,t),this._period=null==e?.3:e,!0},reverse:function(){return cc.logID(1009),null},clone:function(){var t=new cc.EaseElastic;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticIn=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;t-=1,e=-Math.pow(2,10*t)*Math.sin((t-i)*Math.PI*2/this._period)}this._inner.update(e)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticIn;return t.initWithAction(this._inner.clone(),this._period),t}}),cc._easeElasticInObj={easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-.075)*Math.PI*2/.3))},reverse:function(){return cc._easeElasticOutObj}},cc.easeElasticIn=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:cc._easeElasticInObj},cc.EaseElasticOut=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;e=Math.pow(2,-10*t)*Math.sin((t-i)*Math.PI*2/this._period)+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc._easeElasticOutObj={easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*Math.PI*2/.3)+1},reverse:function(){return cc._easeElasticInObj}},cc.easeElasticOut=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:cc._easeElasticOutObj},cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t*=2,i||(i=this._period=.3*1.5);var n=i/4;e=(t-=1)<0?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticInOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.easeElasticInOut=function(t){return t=t||.3,{_period:t,easing:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t*=2,i||(i=this._period=.3*1.5);var n=i/4;e=(t-=1)<0?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}return e},reverse:function(){return cc.easeElasticInOut(this._period)}}},cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},clone:function(){var t=new cc.EaseBounce;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}}),cc.EaseBounceIn=cc.EaseBounce.extend({update:function(t){var e=1-this.bounceTime(1-t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceIn;return t.initWithAction(this._inner.clone()),t}}),cc._bounceTime=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},cc._easeBounceInObj={easing:function(t){return 1-cc._bounceTime(1-t)},reverse:function(){return cc._easeBounceOutObj}},cc.easeBounceIn=function(){return cc._easeBounceInObj},cc.EaseBounceOut=cc.EaseBounce.extend({update:function(t){var e=this.bounceTime(t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeBounceOutObj={easing:function(t){return cc._bounceTime(t)},reverse:function(){return cc._easeBounceInObj}},cc.easeBounceOut=function(){return cc._easeBounceOutObj},cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(t){var e=0;t<.5?(t*=2,e=.5*(1-this.bounceTime(1-t))):e=.5*this.bounceTime(2*t-1)+.5,this._inner.update(e)},clone:function(){var t=new cc.EaseBounceInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}}),cc._easeBounceInOutObj={easing:function(t){var e;return t<.5?(t*=2,e=.5*(1-cc._bounceTime(1-t))):e=.5*cc._bounceTime(2*t-1)+.5,e},reverse:function(){return cc._easeBounceInOutObj}},cc.easeBounceInOut=function(){return cc._easeBounceInOutObj},cc.EaseBackIn=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:t*t*(2.70158*t-1.70158),this._inner.update(t)},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBackIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeBackInObj={easing:function(t){return 0===t||1===t?t:t*t*(2.70158*t-1.70158)},reverse:function(){return cc._easeBackOutObj}},cc.easeBackIn=function(){return cc._easeBackInObj},cc.EaseBackOut=cc.ActionEase.extend({update:function(t){t-=1,this._inner.update(t*t*(2.70158*t+1.70158)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBackOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeBackOutObj={easing:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},reverse:function(){return cc._easeBackInObj}},cc.easeBackOut=function(){return cc._easeBackOutObj},cc.EaseBackInOut=cc.ActionEase.extend({update:function(t){(t*=2)<1?this._inner.update(t*t*(3.5949095*t-2.5949095)/2):(t-=2,this._inner.update(t*t*(3.5949095*t+2.5949095)/2+1))},clone:function(){var t=new cc.EaseBackInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}}),cc._easeBackInOutObj={easing:function(t){return(t*=2)<1?t*t*(3.5949095*t-2.5949095)/2:(t-=2)*t*(3.5949095*t+2.5949095)/2+1},reverse:function(){return cc._easeBackInOutObj}},cc.easeBackInOut=function(){return cc._easeBackInOutObj},cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(t){cc.ActionEase.prototype.ctor.call(this,t)},_updateTime:function(t,e,i,n,o){return Math.pow(1-o,3)*t+3*o*Math.pow(1-o,2)*e+3*Math.pow(o,2)*(1-o)*i+Math.pow(o,3)*n},update:function(t){var e=this._updateTime(this._p0,this._p1,this._p2,this._p3,t);this._inner.update(e)},clone:function(){var t=new cc.EaseBezierAction;return t.initWithAction(this._inner.clone()),t.setBezierParamer(this._p0,this._p1,this._p2,this._p3),t},reverse:function(){var t=new cc.EaseBezierAction(this._inner.reverse());return t.setBezierParamer(this._p3,this._p2,this._p1,this._p0),t},setBezierParamer:function(t,e,i,n){this._p0=t||0,this._p1=e||0,this._p2=i||0,this._p3=n||0}}),cc.easeBezierAction=function(t,e,i,n){return{easing:function(o){return cc.EaseBezierAction.prototype._updateTime(t,e,i,n,o)},reverse:function(){return cc.easeBezierAction(n,i,e,t)}}},cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(t){return Math.pow(t,2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}}),cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}},cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn},cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-t*(t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionOut;return t.initWithAction(),t},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}}),cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}},cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut},cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t*=2,t<1?t*t*.5:-.5*(--t*(t-2)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}}),cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}},cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut},cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}}),cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}},cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn},cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-((t-=1)*t*t*t-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}}),cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}},cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut},cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}}),cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}},cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut},cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}}),cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}},cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn},cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(t){return(t-=1)*t*t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}}),cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}},cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut},cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}}),cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}},cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut},cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(t){return-1*(Math.sqrt(1-t*t)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}}),cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}},cc.easeCircleActionIn=function(){return cc._easeCircleActionIn},cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,Math.sqrt(1-t*t)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}}),cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}},cc.easeCircleActionOut=function(){return cc._easeCircleActionOut},cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}}),cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}},cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut},cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}}),cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}},cc.easeCubicActionIn=function(){return cc._easeCubicActionIn},cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(t){return(t-=1)*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}}),cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}},cc.easeCubicActionOut=function(){return cc._easeCubicActionOut},cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}}),cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}},cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut}}),{}],6:[(function(t,e,i){cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(t){this.update(1)},update:function(t){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i)e[i].enabled=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Hide=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i)e[i].enabled=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.ToggleVisibility=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i){var n=e[i];n.enabled=!n.enabled}},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.init(t)},update:function(t){this.target.removeFromParent(this._isNeedCleanUp)},init:function(t){return this._isNeedCleanUp=t,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(t){return new cc.RemoveSelf(t)},cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void 0!==t&&this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=t,!0},update:function(t){this.target.scaleX=Math.abs(this.target.scaleX)*(this._flippedX?-1:1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var t=new cc.FlipX;return t.initWithFlipX(this._flippedX),t}}),cc.flipX=function(t){return new cc.FlipX(t)},cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void 0!==t&&this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=t,!0},update:function(t){this.target.scaleY=Math.abs(this.target.scaleY)*(this._flippedY?-1:1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var t=new cc.FlipY;return t.initWithFlipY(this._flippedY),t}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(t,e){cc.FiniteTimeAction.prototype.ctor.call(this),this._x=0,this._y=0,void 0!==t&&(void 0!==t.x&&(e=t.y,t=t.x),this.initWithPosition(t,e))},initWithPosition:function(t,e){return this._x=t,this._y=e,!0},update:function(t){this.target.setPosition(this._x,this._y)},clone:function(){var t=new cc.Place;return t.initWithPosition(this._x,this._y),t}}),cc.place=function(t,e){return new cc.Place(t,e)},cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_function:null,_data:null,ctor:function(t,e,i){cc.FiniteTimeAction.prototype.ctor.call(this),this.initWithFunction(t,e,i)},initWithFunction:function(t,e,i){return t&&(this._function=t),e&&(this._selectorTarget=e),void 0!==i&&(this._data=i),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(t){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(t){t!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=t)},clone:function(){var t=new cc.CallFunc;return t.initWithFunction(this._function,this._selectorTarget,this._data),t}}),cc.callFunc=function(t,e,i){return new cc.CallFunc(t,e,i)}}),{}],7:[(function(t,e,i){cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(t){this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this.MAX_VALUE=2,this._repeatMethod=!1,this._speedMethod=!1,cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(t)},getElapsed:function(){return this._elapsed},initWithDuration:function(t){return this._duration=0===t?cc.macro.FLT_EPSILON:t,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(t){t._repeatForever=this._repeatForever,t._speed=this._speed,t._timesForRepeat=this._timesForRepeat,t._easeList=this._easeList,t._speedMethod=this._speedMethod,t._repeatMethod=this._repeatMethod},_reverseEaseList:function(t){if(this._easeList){t._easeList=[];for(var e=0;e<this._easeList.length;e++)t._easeList.push(this._easeList[e].reverse())}},clone:function(){var t=new cc.ActionInterval(this._duration);return this._cloneDecoration(t),t},easing:function(t){this._easeList?this._easeList.length=0:this._easeList=[];for(var e=0;e<arguments.length;e++)this._easeList.push(arguments[e]);return this},_computeEaseTime:function(t){var e=this._easeList;if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++)t=e[i].easing(t);return t},step:function(t){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=t;var e=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);e=1>e?e:1,this.update(e>0?e:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.logID(1010),null},setAmplitudeRate:function(t){cc.logID(1011)},getAmplitudeRate:function(){return cc.logID(1012),0},speed:function(t){return t<=0?(cc.logID(1013),this):(this._speedMethod=!0,this._speed*=t,this)},getSpeed:function(){return this._speed},setSpeed:function(t){return this._speed=t,this},repeat:function(t){return t=Math.round(t),isNaN(t)||t<1?(cc.logID(1014),this):(this._repeatMethod=!0,this._timesForRepeat*=t,this)},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(t){return new cc.ActionInterval(t)},cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._actions=[];var e=t instanceof Array?t:arguments;if(1!==e.length){var i=e.length-1;if(i>=0&&null==e[i]&&cc.logID(1015),i>=0){for(var n,o=e[0],r=1;r<i;r++)e[r]&&(n=o,o=cc.Sequence._actionOneTwo(n,e[r]));this.initWithTwoActions(o,e[i])}}else cc.errorID(1019)},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Sequence.initWithTwoActions(): arguments must all be non nil");var i=t._duration+e._duration;return this.initWithDuration(i),this._actions[0]=t,this._actions[1]=e,!0},clone:function(){var t=new cc.Sequence;return this._cloneDecoration(t),t.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._split=this._actions[0]._duration/this._duration,this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(t){var e,i,n=0,o=this._split,r=this._actions,s=this._last;(t=this._computeEaseTime(t))<o?(e=0!==o?t/o:1,0===n&&1===s&&(r[1].update(0),r[1].stop())):(n=1,e=1===o?1:(t-o)/(1-o),-1===s&&(r[0].startWithTarget(this.target),r[0].update(1),r[0].stop()),s||(r[0].update(1),r[0].stop())),i=r[n],s===n&&i.isDone()||(s!==n&&i.startWithTarget(this.target),e*=i._timesForRepeat,i.update(e>1?e%1:e),this._last=n)},reverse:function(){var t=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.sequence=function(t){var e=t instanceof Array?t:arguments;if(1===e.length)return cc.errorID(1019),null;var i=e.length-1;i>=0&&null==e[i]&&cc.logID(1015);var n=null;if(i>=0){n=e[0];for(var o=1;o<=i;o++)e[o]&&(n=cc.Sequence._actionOneTwo(n,e[o]))}return n},cc.Sequence._actionOneTwo=function(t,e){var i=new cc.Sequence;return i.initWithTwoActions(t,e),i},cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},initWithAction:function(t,e){var i=t._duration*e;return!!this.initWithDuration(i)&&(this._times=e,this._innerAction=t,t instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0)},clone:function(){var t=new cc.Repeat;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone(),this._times),t},startWithTarget:function(t){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t);var e=this._innerAction,i=this._duration,n=this._times,o=this._nextDt;if(t>=o){for(;t>o&&this._total<n;)e.update(1),this._total++,e.stop(),e.startWithTarget(this.target),o+=e._duration/i,this._nextDt=o;t>=1&&this._total<n&&(e.update(1),this._total++),this._actionInstant||(this._total===n?e.stop():e.update(t-(o-e._duration/i)))}else e.update(t*n%1)},isDone:function(){return this._total===this._times},reverse:function(){var t=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(t,e){return new cc.Repeat(t,e)},cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._innerAction=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.RepeatForever.initWithAction(): action must be non null");return this._innerAction=t,!0},clone:function(){var t=new cc.RepeatForever;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},step:function(t){var e=this._innerAction;e.step(t),e.isDone()&&(e.startWithTarget(this.target),e.step(e.getElapsed()-e._duration))},isDone:function(){return!1},reverse:function(){var t=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(t){return new cc.RepeatForever(t)},cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._one=null,this._two=null;var e=t instanceof Array?t:arguments;if(1!==e.length){var i=e.length-1;if(i>=0&&null==e[i]&&cc.logID(1015),i>=0){for(var n,o=e[0],r=1;r<i;r++)e[r]&&(n=o,o=cc.Spawn._actionOneTwo(n,e[r]));this.initWithTwoActions(o,e[i])}}else cc.errorID(1020)},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Spawn.initWithTwoActions(): arguments must all be non null");var i=!1,n=t._duration,o=e._duration;return this.initWithDuration(Math.max(n,o))&&(this._one=t,this._two=e,n>o?this._two=cc.Sequence._actionOneTwo(e,cc.delayTime(n-o)):n<o&&(this._one=cc.Sequence._actionOneTwo(t,cc.delayTime(o-n))),i=!0),i},clone:function(){var t=new cc.Spawn;return this._cloneDecoration(t),t.initWithTwoActions(this._one.clone(),this._two.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._one.startWithTarget(t),this._two.startWithTarget(t)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t),this._one&&this._one.update(t),this._two&&this._two.update(t)},reverse:function(){var t=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.spawn=function(t){var e=t instanceof Array?t:arguments;if(1===e.length)return cc.errorID(1020),null;e.length>0&&null==e[e.length-1]&&cc.logID(1015);for(var i=e[0],n=1;n<e.length;n++)null!=e[n]&&(i=cc.Spawn._actionOneTwo(i,e[n]));return i},cc.Spawn._actionOneTwo=function(t,e){var i=new cc.Spawn;return i.initWithTwoActions(t,e),i},cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._dstAngleX=e||0,this._dstAngleY=void 0!==i?i:this._dstAngleX,!0)},clone:function(){var t=new cc.RotateTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.rotationX%360,i=this._dstAngleX-e;i>180&&(i-=360),i<-180&&(i+=360),this._startAngleX=e,this._diffAngleX=i,this._startAngleY=t.rotationY%360;var n=this._dstAngleY-this._startAngleY;n>180&&(n-=360),n<-180&&(n+=360),this._diffAngleY=n},reverse:function(){cc.logID(1016)},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._diffAngleX*t,this.target.rotationY=this._startAngleY+this._diffAngleY*t)}}),cc.rotateTo=function(t,e,i){return new cc.RotateTo(t,e,i)},cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._angleX=e||0,this._angleY=void 0!==i?i:this._angleX,!0)},clone:function(){var t=new cc.RotateBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._angleX,this._angleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startAngleX=t.rotationX,this._startAngleY=t.rotationY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._angleX*t,this.target.rotationY=this._startAngleY+this._angleY*t)},reverse:function(){var t=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.rotateBy=function(t,e,i){return new cc.RotateBy(t,e,i)},cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._positionDelta=cc.p(0,0),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0!==e.x&&(i=e.y,e=e.x),this._positionDelta.x=e,this._positionDelta.y=i,!0)},clone:function(){var t=new cc.MoveBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._positionDelta),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._positionDelta.x*t,i=this._positionDelta.y*t,n=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var o=this.target.getPositionX(),r=this.target.getPositionY(),s=this._previousPosition;n.x=n.x+o-s.x,n.y=n.y+r-s.y,e+=n.x,i+=n.y,s.x=e,s.y=i,this.target.setPosition(e,i)}else this.target.setPosition(n.x+e,n.y+i)}},reverse:function(){var t=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.moveBy=function(t,e,i){return new cc.MoveBy(t,e,i)},cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(t,e,i){cc.MoveBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.MoveBy.prototype.initWithDuration.call(this,t,e,i)&&(void 0!==e.x&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},clone:function(){var t=new cc.MoveTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition),t},startWithTarget:function(t){cc.MoveBy.prototype.startWithTarget.call(this,t),this._positionDelta.x=this._endPosition.x-t.getPositionX(),this._positionDelta.y=this._endPosition.y-t.getPositionY()}}),cc.moveTo=function(t,e,i){return new cc.MoveTo(t,e,i)},cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endSkewX=e,this._endSkewY=i,n=!0),n},clone:function(){var t=new cc.SkewTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endSkewX,this._endSkewY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startSkewX=t.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=t.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(t){t=this._computeEaseTime(t),this.target.skewX=this._startSkewX+this._deltaX*t,this.target.skewY=this._startSkewY+this._deltaY*t}}),cc.skewTo=function(t,e,i){return new cc.SkewTo(t,e,i)},cc.SkewBy=cc.SkewTo.extend({ctor:function(t,e,i){cc.SkewTo.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.SkewTo.prototype.initWithDuration.call(this,t,e,i)&&(this._skewX=e,this._skewY=i,n=!0),n},clone:function(){var t=new cc.SkewBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._skewX,this._skewY),t},startWithTarget:function(t){cc.SkewTo.prototype.startWithTarget.call(this,t),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var t=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.skewBy=function(t,e,i){return new cc.SkewBy(t,e,i)},cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(t,e,i,n,o){cc.ActionInterval.prototype.ctor.call(this),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),this._delta=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,o)},initWithDuration:function(t,e,i,n,o){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0===o&&(o=n,n=i,i=e.y,e=e.x),this._delta.x=e,this._delta.y=i,this._height=n,this._jumps=o,!0)},clone:function(){var t=new cc.JumpBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._delta,this._height,this._jumps),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=t*this._jumps%1,i=4*this._height*e*(1-e);i+=this._delta.y*t;var n=this._delta.x*t,o=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var r=this.target.getPositionX(),s=this.target.getPositionY(),c=this._previousPosition;o.x=o.x+r-c.x,o.y=o.y+s-c.y,n+=o.x,i+=o.y,c.x=n,c.y=i,this.target.setPosition(n,i)}else this.target.setPosition(o.x+n,o.y+i)}},reverse:function(){var t=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.jumpBy=function(t,e,i,n,o){return new cc.JumpBy(t,e,i,n,o)},cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(t,e,i,n,o){cc.JumpBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,o)},initWithDuration:function(t,e,i,n,o){return!!cc.JumpBy.prototype.initWithDuration.call(this,t,e,i,n,o)&&(void 0===o&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},startWithTarget:function(t){cc.JumpBy.prototype.startWithTarget.call(this,t),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var t=new cc.JumpTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),t}}),cc.jumpTo=function(t,e,i,n,o){return new cc.JumpTo(t,e,i,n,o)},cc.bezierAt=function(t,e,i,n,o){return Math.pow(1-o,3)*t+3*o*Math.pow(1-o,2)*e+3*Math.pow(o,2)*(1-o)*i+Math.pow(o,3)*n},cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._config=e,!0)},clone:function(){var t=new cc.BezierBy;this._cloneDecoration(t);for(var e=[],i=0;i<this._config.length;i++){var n=this._config[i];e.push(cc.p(n.x,n.y))}return t.initWithDuration(this._duration,e),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._config,i=e[0].x,n=e[1].x,o=e[2].x,r=e[0].y,s=e[1].y,c=e[2].y,a=cc.bezierAt(0,i,n,o,t),h=cc.bezierAt(0,r,s,c,t),l=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var u=this.target.getPositionX(),d=this.target.getPositionY(),p=this._previousPosition;l.x=l.x+u-p.x,l.y=l.y+d-p.y,a+=l.x,h+=l.y,p.x=a,p.y=h,this.target.setPosition(a,h)}else this.target.setPosition(l.x+a,l.y+h)}},reverse:function(){var t=this._config,e=[cc.pAdd(t[1],cc.pNeg(t[2])),cc.pAdd(t[0],cc.pNeg(t[2])),cc.pNeg(t[2])],i=new cc.BezierBy(this._duration,e);return this._cloneDecoration(i),this._reverseEaseList(i),i}}),cc.bezierBy=function(t,e){return new cc.BezierBy(t,e)},cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(t,e){cc.BezierBy.prototype.ctor.call(this),this._toConfig=[],e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toConfig=e,!0)},clone:function(){var t=new cc.BezierTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toConfig),t},startWithTarget:function(t){cc.BezierBy.prototype.startWithTarget.call(this,t);var e=this._startPosition,i=this._toConfig,n=this._config;n[0]=cc.pSub(i[0],e),n[1]=cc.pSub(i[1],e),n[2]=cc.pSub(i[2],e)}}),cc.bezierTo=function(t,e){return new cc.BezierTo(t,e)},cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endScaleX=e,this._endScaleY=null!=i?i:e,!0)},clone:function(){var t=new cc.ScaleTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startScaleX=t.scaleX,this._startScaleY=t.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*t,this.target.scaleY=this._startScaleY+this._deltaY*t)}}),cc.scaleTo=function(t,e,i){return new cc.ScaleTo(t,e,i)},cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(t){cc.ScaleTo.prototype.startWithTarget.call(this,t),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var t=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.ScaleBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t}}),cc.scaleBy=function(t,e,i){return new cc.ScaleBy(t,e,i)},cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._times=e,!0)},clone:function(){var t=new cc.Blink;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._times),t},update:function(t){if(t=this._computeEaseTime(t),this.target&&!this.isDone()){var e=1/this._times,i=t%e;this.target.opacity=i>e/2?255:0}},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._originalState=t.opacity},stop:function(){this.target.opacity=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var t=new cc.Blink(this._duration,this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.blink=function(t,e){return new cc.Blink(t,e)},cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toOpacity=e,!0)},clone:function(){var t=new cc.FadeTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},update:function(t){t=this._computeEaseTime(t);var e=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=e+(this._toOpacity-e)*t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._fromOpacity=t.opacity}}),cc.fadeTo=function(t,e){return new cc.FadeTo(t,e)},cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,255)},reverse:function(){var t=new cc.FadeOut;return t.initWithDuration(this._duration,0),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeIn;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},startWithTarget:function(t){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,t)}}),cc.fadeIn=function(t){return new cc.FadeIn(t)},cc.FadeOut=cc.FadeTo.extend({ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,0)},reverse:function(){var t=new cc.FadeIn;return t._reverseAction=this,t.initWithDuration(this._duration,255),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeOut;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t}}),cc.fadeOut=function(t){return new cc.FadeOut(t)},cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),e instanceof cc.Color&&(n=e.b,i=e.g,e=e.r),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=cc.color(e,i,n),!0)},clone:function(){var t=new cc.TintTo;this._cloneDecoration(t);var e=this._to;return t.initWithDuration(this._duration,e.r,e.g,e.b),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=this.target.color},update:function(t){t=this._computeEaseTime(t);var e=this._from,i=this._to;e&&this.target.setColor(cc.color(e.r+(i.r-e.r)*t,e.g+(i.g-e.g)*t,e.b+(i.b-e.b)*t))}}),cc.tintTo=function(t,e,i,n){return new cc.TintTo(t,e,i,n)},cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._deltaR=e,this._deltaG=i,this._deltaB=n,!0)},clone:function(){var t=new cc.TintBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.color;this._fromR=e.r,this._fromG=e.g,this._fromB=e.b},update:function(t){t=this._computeEaseTime(t),this.target.color=cc.color(this._fromR+this._deltaR*t,this._fromG+this._deltaG*t,this._fromB+this._deltaB*t)},reverse:function(){var t=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.tintBy=function(t,e,i,n){return new cc.TintBy(t,e,i,n)},cc.DelayTime=cc.ActionInterval.extend({update:function(t){},reverse:function(){var t=new cc.DelayTime(this._duration);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.DelayTime;return this._cloneDecoration(t),t.initWithDuration(this._duration),t}}),cc.delayTime=function(t){return new cc.DelayTime(t)},cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._other=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ReverseTime.initWithAction(): action must be non null");if(t===this._other)throw new Error("cc.ReverseTime.initWithAction(): the action was already passed in.");return!!cc.ActionInterval.prototype.initWithDuration.call(this,t._duration)&&(this._other=t,!0)},clone:function(){var t=new cc.ReverseTime;return this._cloneDecoration(t),t.initWithAction(this._other.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._other.startWithTarget(t)},update:function(t){t=this._computeEaseTime(t),this._other&&this._other.update(1-t)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(t){return new cc.ReverseTime(t)},cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,_currFrameIndex:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],t&&this.initWithAnimation(t)},getAnimation:function(){return this._animation},setAnimation:function(t){this._animation=t},getCurrentFrameIndex:function(){return this._currFrameIndex},initWithAnimation:function(t){if(!t)throw new Error("cc.Animate.initWithAnimation(): animation must be non-NULL");var e=t.getDuration();if(this.initWithDuration(e*t.getLoops())){this._nextFrame=0,this.setAnimation(t),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes;i.length=0;var n=0,o=e/t.getTotalDelayUnits(),r=t.getFrames();cc.js.array.verifyType(r,cc.AnimationFrame);for(var s=0;s<r.length;s++){var c=n*o/e;n+=r[s].getDelayUnits(),i.push(c)}return!0}return!1},clone:function(){var t=new cc.Animate;return this._cloneDecoration(t),t.initWithAnimation(this._animation.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._animation.getRestoreOriginalFrame()&&(this._origFrame=t.getSpriteFrame()),this._nextFrame=0,this._executedLoops=0},update:function(t){(t=this._computeEaseTime(t))<1&&((0|(t*=this._animation.getLoops()))>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),t%=1);for(var e=this._animation.getFrames(),i=e.length,n=this._splitTimes,o=this._nextFrame;o<i&&n[o]<=t;o++)_currFrameIndex=o,this.target.setSpriteFrame(e[_currFrameIndex].getSpriteFrame()),this._nextFrame=o+1},reverse:function(){var t=this._animation,e=t.getFrames(),i=[];if(cc.js.array.verifyType(e,cc.AnimationFrame),e.length>0)for(var n=e.length-1;n>=0;n--){var o=e[n];if(!o)break;i.push(o.clone())}var r=new cc.SpriteFrameAnimation(i,t.getDelayPerUnit(),t.getLoops());r.setRestoreOriginalFrame(t.getRestoreOriginalFrame());var s=new cc.Animate(r);return this._cloneDecoration(s),this._reverseEaseList(s),s},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame),cc.Action.prototype.stop.call(this)}}),cc.animate=function(t){return new cc.Animate(t)},cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),e&&this.initWithTarget(t,e)},initWithTarget:function(t,e){return!!this.initWithDuration(e._duration)&&(this._forcedTarget=t,this._action=e,!0)},clone:function(){var t=new cc.TargetedAction;return this._cloneDecoration(t),t.initWithTarget(this._forcedTarget,this._action.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(t){t=this._computeEaseTime(t),this._action.update(t)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(t){this._forcedTarget!==t&&(this._forcedTarget=t)}}),cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)}}),{}],8:[(function(t,e,i){var n=function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.paused=!1,this.lock=!1};cc.ActionManager=cc._Class.extend({_elementPool:[],_searchElementByTarget:function(t,e){for(var i=0;i<t.length;i++)if(e===t[i].target)return t[i];return null},ctor:function(){this._hashTargets={},this._arrayTargets=[],this._currentTarget=null},_getElement:function(t,e){var i=this._elementPool.pop();return i||(i=new n),i.target=t,i.paused=!!e,i},_putElement:function(t){t.actions.length=0,t.actionIndex=0,t.currentAction=null,t.paused=!1,t.target=null,t.lock=!1,this._elementPool.push(t)},addAction:function(t,e,i){if(!t)throw new Error("cc.ActionManager.addAction(): action must be non-null");if(!e)throw new Error("cc.ActionManager.addAction(): action must be non-null");var n=this._hashTargets[e.__instanceId];n?n.actions||(n.actions=[]):(n=this._getElement(e,i),this._hashTargets[e.__instanceId]=n,this._arrayTargets.push(n)),n.actions.push(t),t.startWithTarget(e)},removeAllActions:function(){for(var t=this._arrayTargets,e=0;e<t.length;e++){var i=t[e];i&&this.removeAllActionsFromTarget(i.target,!0)}},removeAllActionsFromTarget:function(t,e){if(null!=t){var i=this._hashTargets[t.__instanceId];i&&(i.actions.length=0,this._deleteHashElement(i))}},removeAction:function(t){if(null!=t){var e=t.getOriginalTarget(),i=this._hashTargets[e.__instanceId];if(i){for(var n=0;n<i.actions.length;n++)if(i.actions[n]===t){i.actions.splice(n,1),i.actionIndex>=n&&i.actionIndex--;break}}else cc.logID(1001)}},removeActionByTag:function(t,e){t===cc.Action.TAG_INVALID&&cc.logID(1002),cc.assertID(e,1003);var i=this._hashTargets[e.__instanceId];if(i)for(var n=i.actions.length,o=0;o<n;++o){var r=i.actions[o];if(r&&r.getTag()===t&&r.getOriginalTarget()===e){this._removeActionAtIndex(o,i);break}}},getActionByTag:function(t,e){t===cc.Action.TAG_INVALID&&cc.logID(1004);var i=this._hashTargets[e.__instanceId];if(i){if(null!=i.actions)for(var n=0;n<i.actions.length;++n){var o=i.actions[n];if(o&&o.getTag()===t)return o}cc.logID(1005,t)}return null},getNumberOfRunningActionsInTarget:function(t){var e=this._hashTargets[t.__instanceId];return e&&e.actions?e.actions.length:0},pauseTarget:function(t){var e=this._hashTargets[t.__instanceId];e&&(e.paused=!0)},resumeTarget:function(t){var e=this._hashTargets[t.__instanceId];e&&(e.paused=!1)},pauseAllRunningActions:function(){for(var t=[],e=this._arrayTargets,i=0;i<e.length;i++){var n=e[i];n&&!n.paused&&(n.paused=!0,t.push(n.target))}return t},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.resumeTarget(t[e])},pauseTargets:function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.pauseTarget(t[e])},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdate(this)},_removeActionAtIndex:function(t,e){e.actions[t];e.actions.splice(t,1),e.actionIndex>=t&&e.actionIndex--,0===e.actions.length&&this._deleteHashElement(e)},_deleteHashElement:function(t){var e=!1;if(t&&!t.lock&&this._hashTargets[t.target.__instanceId]){delete this._hashTargets[t.target.__instanceId];for(var i=this._arrayTargets,n=0,o=i.length;n<o;n++)if(i[n]===t){i.splice(n,1);break}this._putElement(t),e=!0}return e},update:function(t){for(var e,i=this._arrayTargets,n=0;n<i.length;n++){if(this._currentTarget=i[n],!(e=this._currentTarget).paused&&e.actions){for(e.lock=!0,e.actionIndex=0;e.actionIndex<e.actions.length;e.actionIndex++)if(e.currentAction=e.actions[e.actionIndex],e.currentAction){if(e.currentAction.step(t*(e.currentAction._speedMethod?e.currentAction._speed:1)),e.currentAction&&e.currentAction.isDone()){e.currentAction.stop();var o=e.currentAction;e.currentAction=null,this.removeAction(o)}e.currentAction=null}e.lock=!1}0===e.actions.length&&this._deleteHashElement(e)&&n--}}})}),{}],9:[(function(t,e,i){t("./CCActionManager"),t("./CCAction"),t("./CCActionInterval"),t("./CCActionInstant"),t("./CCActionEase"),t("./CCActionCatmullRom")}),{"./CCAction":3,"./CCActionCatmullRom":4,"./CCActionEase":5,"./CCActionInstant":6,"./CCActionInterval":7,"./CCActionManager":8}],10:[(function(i,n,o){function r(t,e){h.call(this,t),this.animation=e}function s(t){var e=t.split(".");return e.shift(),e.length>0?e:null}function c(i,n){function o(t){if(!Array.isArray(t))return!1;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(!Array.isArray(n)||6!==n.length)return!1}return!0}function r(i,r,c){var h,p=i instanceof cc.Node&&"position"===r,_=[];(h=p?new u:new l).target=i;var f,g=r.indexOf(".");-1!==g?i[f=r.slice(0,g)]:f=r,h.prop=f,h.subProps=s(r);for(var v=0,y=c.length;v<y;v++){var m=c[v],b=m.frame/n.duration;if(h.ratios.push(b),p){var C=m.motionPath;C&&!o(C)&&(cc.errorID(3904,i.name,r,v),C=null),_.push(C)}var T=m.value;h.values.push(T);var S=m.curve;if(S){if("string"===("object"==(e=typeof S)?t(S):e)){h.types.push(S);continue}if(Array.isArray(S)){S[0]===S[1]&&S[2]===S[3]?h.types.push(l.Linear):h.types.push(l.Bezier(S));continue}}h.types.push(l.Linear)}return p&&d(_,h,a.duration,a.sample),h}function c(t,e){var i=e.props,n=e.comps;if(i)for(var o in i){u=r(t,o,l=i[o]);h.push(u)}if(n)for(var s in n){var c=t.getComponent(s);if(c){var a=n[s];for(var o in a){var l=a[o],u=r(c,o,l);h.push(u)}}}}var a=n.clip,h=n.curves;h.length=0,n.duration=a.duration,n.speed=a.speed,n.wrapMode=a.wrapMode,n.frameRate=a.sample,(n.wrapMode&f.Loop)===f.Loop?n.repeatCount=1/0:n.repeatCount=1;var v=a.curveData,y=v.paths;c(i,v);for(var m in y){var b=cc.find(m,i);b&&c(b,y[m])}var C=a.events;if(C)for(var T,S=0,E=C.length;S<E;S++){T||((T=new p).target=i,h.push(T));var x,A=C[S],w=A.frame/n.duration,O=g(T.ratios,w);O>=0?x=T.events[O]:(x=new _,T.ratios.push(w),T.events.push(x)),x.add(A.func,A.params)}}var a=cc.js,h=i("./animators").Animator,l=i("./animation-curves").DynamicAnimCurve,u=i("./animation-curves").SampledAnimCurve,d=i("./motion-path-helper").sampleMotionPaths,p=i("./animation-curves").EventAnimCurve,_=i("./animation-curves").EventInfo,f=i("./types").WrapModeMask,g=i("../core/utils/binary-search").binarySearchEpsilon;a.extend(r,h);var v=r.prototype;v.playState=function(i,n){i.clip&&(i.curveLoaded||c(this.target,i),this.addAnimation(i),i.animator=this,i.play(),"number"===("object"==(e=typeof n)?t(n):e)&&i.setTime(n),this.play())},v.addAnimation=function(t){h.prototype.addAnimation.call(this,t);for(var e=this.animation._listeners,i=0,n=e.length;i<n;i++){var o=e[i];t.on(o[0],o[1],o[2],o[3])}},v.removeAnimation=function(t){h.prototype.removeAnimation.call(this,t),t.animator=null},v.sample=function(){var t=this._anims,e=t.array;for(t.i=0;t.i<e.length;++t.i)e[t.i].sample()},v.stopState=function(t){t&&t.stop()},v.pauseState=function(t){t&&t.pause()},v.resumeState=function(t){t&&t.resume(),this.isPaused&&this.resume()},v.setStateTime=function(t,e){if(void 0!==e)t&&(t.setTime(e),t.sample());else{e=t;var i=this._anims,n=i.array;for(i.i=0;i.i<n.length;++i.i){var o=n[i.i];o.setTime(e),o.sample()}}},v.onStop=function(){var t=this._anims,e=t.array;for(t.i=0;t.i<e.length;++t.i)e[t.i].stop();h.prototype.onStop.call(this)},v.onPause=function(){for(var t=this._anims.array,e=0;e<t.length;++e){var i=t[e];i.pause(),i.animator=null}h.prototype.onPause.call(this)},v.onResume=function(){for(var t=this._anims.array,e=0;e<t.length;++e){var i=t[e];i.animator=this,i.resume()}h.prototype.onResume.call(this)},v._reloadClip=function(t){c(this.target,t)},n.exports=r}),{"../core/utils/binary-search":159,"./animation-curves":12,"./animators":15,"./motion-path-helper":19,"./types":21}],11:[(function(t,e,i){var n=cc.Class({name:"cc.AnimationClip",extends:cc.Asset,properties:{_duration:{default:0,type:"Float"},duration:{get:function(){return this._duration}},sample:{default:60},speed:{default:1},wrapMode:{default:cc.WrapMode.Normal},curveData:{default:{},visible:!1},events:{default:[],visible:!1}},statics:{createWithSpriteFrames:function(t,e){if(!Array.isArray(t))return cc.errorID(3905),null;var i=new n;i.sample=e||i.sample,i._duration=t.length/i.sample;for(var o=[],r=1/i.sample,s=0,c=t.length;s<c;s++)o[s]={frame:s*r,value:t[s]};return i.curveData={comps:{"cc.Sprite":{spriteFrame:o}}},i}}});cc.AnimationClip=e.exports=n}),{}],12:[(function(i,n,o){function r(i,n){if("string"===("object"==(e=typeof n)?t(n):e)){var o=cc.Easing[n];o?i=o(i):cc.errorID(3906,n)}else Array.isArray(n)&&(i=s(n,i));return i}var s=i("./bezier").bezierByTime,c=i("../core/utils/binary-search").binarySearchEpsilon,a=i("./types").WrapModeMask,h=i("./types").WrappedInfo,l=cc.Class({name:"cc.AnimCurve",sample:function(t,e,i){},onTimeChangedManually:function(){}}),u=cc.Class({name:"cc.DynamicAnimCurve",extends:l,properties:{target:null,prop:"",values:[],ratios:[],types:[],subProps:null},_calcValue:function(i,n){var o=this.values,r=o[i-1],s=o[i];return"number"===("object"==(e=typeof r)?t(r):e)?r+(s-r)*n:r&&r.lerp?r.lerp(s,n):r},_applyValue:function(t,e,i){t[e]=i},_findFrameIndex:c,sample:function(t,e,i){var n=this.values,o=this.ratios,s=o.length;if(0!==s){var c,a=this._findFrameIndex(o,e);if(a<0)if((a=~a)<=0)c=n[0];else if(a>=s)c=n[s-1];else{var h=o[a-1],l=(e-h)/(o[a]-h);l=r(l,this.types[a-1]),c=this._calcValue(a,l)}else c=n[a];var u=this.subProps;if(u){for(var d=this.target[this.prop],p=d,_=0;_<u.length-1;_++){var f=u[_];if(!p)return;p=p[f]}var g=u[u.length-1];if(!p)return;this._applyValue(p,g,c),c=d}this._applyValue(this.target,this.prop,c)}}});u.Linear=null,u.Bezier=function(t){return t};var d=cc.Class({name:"cc.SampledAnimCurve",extends:u,_findFrameIndex:function(t,e){var i=t.length-1;if(0===i)return 0;var n=t[0];if(e<n)return 0;var o=t[i];if(e>o)return i;var r=(e=(e-n)/(o-n))/(1/i),s=0|r;return r-s<1e-6?s:~(s+1)}}),p=function(){this.events=[]};p.prototype.add=function(t,e){this.events.push({func:t||"",params:e||[]})};var _=cc.Class({name:"cc.EventAnimCurve",extends:l,properties:{target:null,ratios:[],events:[],_wrappedInfo:{default:function(){return new h}},_lastWrappedInfo:null,_ignoreIndex:NaN},_wrapIterations:function(t){return t-(0|t)==0&&(t-=1),0|t},sample:function(t,e,i){var n=this.ratios.length,o=i.getWrappedInfo(i.time,this._wrappedInfo),r=o.direction,s=c(this.ratios,o.ratio);if(s<0&&(s=~s-1,r<0&&(s+=1)),this._ignoreIndex!==s&&(this._ignoreIndex=NaN),o.frameIndex=s,!this._lastWrappedInfo)return this._fireEvent(s),void(this._lastWrappedInfo=new h(o));var l=i.wrapMode,u=this._wrapIterations(o.iterations),d=this._lastWrappedInfo,p=this._wrapIterations(d.iterations),_=d.frameIndex,f=d.direction,g=-1!==p&&u!==p;if(_===s&&g&&1===n)this._fireEvent(0);else if(_!==s||g){r=f;do{if(_!==s){if(-1===r&&0===_&&s>0?((l&a.PingPong)===a.PingPong?r*=-1:_=n,p++):1===r&&_===n-1&&s<n-1&&((l&a.PingPong)===a.PingPong?r*=-1:_=-1,p++),_===s)break;if(p>u)break}_+=r,cc.director.getAnimationManager().pushDelayEvent(this,"_fireEvent",[_])}while(_!==s&&_>-1&&_<n)}this._lastWrappedInfo.set(o)},_fireEvent:function(t){if(!(t<0||t>=this.events.length||this._ignoreIndex===t)){var e=this.events[t].events;if(this.target.isValid)for(var i=this.target._components,n=0;n<e.length;n++)for(var o=e[n],r=o.func,s=0;s<i.length;s++){var c=i[s],a=c[r];a&&a.apply(c,o.params)}}},onTimeChangedManually:function(t,e){this._lastWrappedInfo=null,this._ignoreIndex=NaN;var i=e.getWrappedInfo(t,this._wrappedInfo),n=i.direction,o=c(this.ratios,i.ratio);o<0&&(o=~o-1,n<0&&(o+=1),this._ignoreIndex=o)}});n.exports={AnimCurve:l,DynamicAnimCurve:u,SampledAnimCurve:d,EventAnimCurve:_,EventInfo:p,computeRatioByType:r}}),{"../core/utils/binary-search":159,"./bezier":16,"./types":21}],13:[(function(t,e,n){var o=cc.js,r=cc.Class({ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._animators=new o.array.MutableForwardIterator([]),this._delayEvents=[]},update:function(t){var e=this._animators,n=e.array;for(e.i=0;e.i<n.length;++e.i){var o=n[e.i];o._isPlaying&&!o._isPaused&&o.update(t)}var r=this._delayEvents;for(i=0,l=r.length;i<l;i++){var s=r[i];s.target[s.func].apply(s.target,s.args)}r.length=0},destruct:function(){},addAnimator:function(t){-1===this._animators.array.indexOf(t)&&this._animators.push(t)},removeAnimator:function(t){var e=this._animators.array.indexOf(t);e>=0?this._animators.fastRemoveAt(e):cc.errorID(3907)},pushDelayEvent:function(t,e,i){this._delayEvents.push({target:t,func:e,args:i})}});cc.AnimationManager=e.exports=r}),{}],14:[(function(t,e,i){function n(t,e){r.call(this,null,null,{duration:t.length}),this._emit=this.emit,this.emit=function(){for(var t=new Array(arguments.length),e=0,i=t.length;e<i;e++)t[e]=arguments[e];cc.director.getAnimationManager().pushDelayEvent(this,"_emit",t)},this._clip=t,this._name=e||t.name}var o=cc.js,r=t("./types").AnimationNode;o.extend(n,r);var s=n.prototype;o.get(s,"clip",(function(){return this._clip})),o.get(s,"name",(function(){return this._name})),o.obsolete(s,"AnimationState.length","duration"),o.getset(s,"curveLoaded",(function(){return this.curves.length>0}),(function(){this.curves.length=0})),s.onPlay=function(){this.setTime(0),r.prototype.onPlay.call(this)},s.onStop=function(){r.prototype.onStop.call(this),this.animator&&this.animator.removeAnimation(this)},s.setTime=function(t){this.time=t||0;var e=this;this.curves.forEach((function(i){i.onTimeChangedManually(t,e)}))},cc.AnimationState=e.exports=n}),{"./types":21}],15:[(function(i,n,o){function r(t){this.target=t,this._anims=new l.array.MutableForwardIterator([])}function s(t){r.call(this,t)}function c(i){for(var n=0,o=0,r=i.length,s=0;s<r;s++){var c=i[s],a=c.ratio;if(0===s&&"number"!==("object"==(e=typeof a)?t(a):e)?c.computedRatio=a=0:s===r-1&&"number"!==("object"==(e=typeof a)?t(a):e)&&(c.computedRatio=a=1),"number"===("object"==(e=typeof a)?t(a):e)){if(n+1<s)for(var h=(a-o)/(s-n),l=n+1;l<s;l++)o+=h,i[l].computedRatio=o;n=s,o=a}}}function a(t,e,i){for(var n,o=0;o<t.length;o++)if((n=t[o]).target===e&&n.prop===i)return n;return null}function h(t,e,i,n,o){var r=a(t,e,i);r||(r=new p,t.push(r),r.target=e,r.prop=i),r.values.push(n),r.ratios.push(o)}var l=cc.js,u=i("./playable"),d=i("./types").AnimationNode,p=i("./animation-curves").DynamicAnimCurve;l.extend(r,u);var _=r.prototype;_.update=function(t){var e=this._anims,i=e.array,n=0,o=i.length;for(e.i=0;e.i<i.length;++e.i){var r=i[e.i];r._isPlaying&&!r._isPaused&&(r.update(t),r._isPlaying||n++)}var s=n>=o;(0===i.length||s)&&this.stop()},_.stopStatesExcept=function(t){var e=this._anims,i=e.array;for(e.i=0;e.i<i.length;++e.i){var n=i[e.i];n!==t&&this.stopState(n)}},_.on=function(t,e,i,n){for(var o=this._anims.array,r=0;r<o.length;++r)o[r].on(t,e,i,n)},_.onPlay=function(){cc.director.getAnimationManager().addAnimator(this)},_.onStop=function(){this._isPaused||cc.director.getAnimationManager().removeAnimator(this)},_.onResume=function(){cc.director.getAnimationManager().addAnimator(this)},_.onPause=function(){cc.director.getAnimationManager().removeAnimator(this)},_.addAnimation=function(t){-1===this._anims.array.indexOf(t)&&this._anims.push(t)},_.removeAnimation=function(t){var e=this._anims.array.indexOf(t);e>=0?this._anims.fastRemoveAt(e):cc.errorID(3908)},l.extend(s,r);var f=s.prototype;f.animate=function(t,e){if(!t)return cc.errorID(3909),null;c(t);var i=this._doAnimate(t,e);return this.play(),i},f._doAnimate=function(i,n){var o=new d(this,null,n);o.play();for(var r=o.curves,s=-1,c=0;c<i.length;c++){var a=i[c],l=a.ratio;if("number"!==("object"==(e=typeof l)?t(l):e)&&(l=a.computedRatio),l<0)cc.errorID(3910);else if(l<s)cc.errorID(3911);else{s=l;for(var u in a){var p=a[u];if("props"===u)for(var _ in p)h(r,this.target,_,p[_],l);else if("comps"===u)for(var f in p){var g=this.target.getComponent(f),v=p[f];for(var _ in v)h(r,g,_,v[_],l)}}}}return this._anims.push(o),o},n.exports={Animator:r,EntityAnimator:s}}),{"./animation-curves":12,"./playable":20,"./types":21}],16:[(function(t,e,i){function n(t,e,i,n,o){var r=1-o;return t*r*r*r+3*e*r*r*o+3*i*r*o*o+n*o*o*o}function o(t){return t<0?-Math.pow(-t,1/3):Math.pow(t,1/3)}function r(t,e){var i,n,r,s,d,p=e-0,_=e-t[0],f=3*p,g=3*_,v=3*(e-t[2]),y=1/(-p+g-v+(e-1)),m=(f-6*_+v)*y,b=m*(1/3),C=(-f+g)*y,T=1/3*(3*C-m*m),S=T*(1/3),E=(2*m*m*m-9*m*C+27*(p*y))/27,x=E/2,A=x*x+S*S*S;if(A<0){var w=1/3*-T,O=u(w*w*w),I=-E/(2*O),N=a(I<-1?-1:I>1?1:I),L=2*o(O);return r=L*c(N*(1/3))-b,s=L*c((N+l)*(1/3))-b,d=L*c((N+2*l)*(1/3))-b,0<=r&&r<=1?0<=s&&s<=1?0<=d&&d<=1?h(r,s,d):h(r,s):0<=d&&d<=1?h(r,d):r:0<=s&&s<=1?0<=d&&d<=1?h(s,d):s:d}if(0===A)return i=x<0?o(-x):-o(x),r=2*i-b,s=-i-b,0<=r&&r<=1?0<=s&&s<=1?h(r,s):r:s;var R=u(A);return i=o(-x+R),n=o(x+R),r=i-n-b}function s(t,e){var i=r(t,e),n=1-i;return 0*n*n*n+3*t[1]*i*n*n+3*t[3]*i*i*n+1*i*i*i}var c=Math.cos,a=Math.acos,h=Math.max,l=2*Math.PI,u=Math.sqrt;e.exports={bezier:n,bezierByTime:s}}),{}],17:[(function(t,e,i){function n(t,e){return function(i){return i<.5?e(2*i)/2:t(2*i-1)/2+.5}}var o={constant:function(){return 0},linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1- --t*t*t*t},quartInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sineIn:function(t){return 1-Math.cos(t*Math.PI/2)},sineOut:function(t){return Math.sin(t*Math.PI/2)},sineInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},expoIn:function(t){return 0===t?0:Math.pow(1024,t-1)},expoOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},expoInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},smooth:function(t){return t<=0?0:t>=1?1:t*t*(3-2*t)},fade:function(t){return t<=0?0:t>=1?1:t*t*t*(t*(6*t-15)+10)}};o.quadOutIn=n(o.quadIn,o.quadOut),o.cubicOutIn=n(o.cubicIn,o.cubicOut),o.quartOutIn=n(o.quartIn,o.quartOut),o.quintOutIn=n(o.quintIn,o.quintOut),o.sineOutIn=n(o.sineIn,o.sineOut),o.expoOutIn=n(o.expoIn,o.expoOut),o.circOutIn=n(o.circIn,o.circOut),o.backOutIn=n(o.backIn,o.backOut),o.backOutIn=n(o.backIn,o.backOut),o.bounceIn=function(t){return 1-o.bounceOut(1-t)},o.bounceInOut=function(t){return t<.5?.5*o.bounceIn(2*t):.5*o.bounceOut(2*t-1)+.5},o.bounceOutIn=n(o.bounceIn,o.bounceOut),cc.Easing=e.exports=o}),{}],18:[(function(t,e,i){t("./bezier"),t("./easing"),t("./types"),t("./motion-path-helper"),t("./animation-curves"),t("./animation-clip"),t("./animators"),t("./animation-manager"),t("./animation-state"),t("./animation-animator")}),{"./animation-animator":10,"./animation-clip":11,"./animation-curves":12,"./animation-manager":13,"./animation-state":14,"./animators":15,"./bezier":16,"./easing":17,"./motion-path-helper":19,"./types":21}],19:[(function(t,e,i){function n(t){this.points=t||[],this.beziers=[],this.ratios=[],this.progresses=[],this.length=0,this.computeBeziers()}function o(){this.start=l(),this.end=l(),this.startCtrlPoint=l(),this.endCtrlPoint=l()}function r(t,e,i,o){function r(t){return t instanceof cc.Vec2?{in:t,pos:t,out:t}:Array.isArray(t)&&6===t.length?{in:l(t[2],t[3]),pos:l(t[0],t[1]),out:l(t[4],t[5])}:{in:cc.Vec2.ZERO,pos:cc.Vec2.ZERO,out:cc.Vec2.ZERO}}function a(t,e,i){_.push(t),f.push(e),g.push(i)}var u=e.values;if(0!==t.length&&0!==u.length)if(1!==(u=u.map((function(t){return l(t[0],t[1])}))).length){for(var d=e.types,p=e.ratios,_=e.values=[],f=e.types=[],g=e.ratios=[],v=0,y=s.Linear,m=0,b=t.length;m<b-1;m++){var C,T=t[m],S=p[m],E=p[m+1]-S,x=u[m],A=u[m+1],w=d[m],O=[],I=v/E,N=1/(E*i*o);if(T&&T.length>0){var L=[];L.push(r(x));for(var R=0,P=T.length;R<P;R++){var B=r(T[R]);L.push(B)}L.push(r(A));var D=new n(L);D.computeBeziers();for(var M=D.progresses;1-I>1e-6;){var F,j,k,z;if((C=c(C=I,w))<0)z=(0-C)*(j=D.beziers[0]).getLength(),k=j.start.sub(j.endCtrlPoint).normalize(),F=j.start.add(k.mul(z));else if(C>1)z=(C-1)*(j=D.beziers[D.beziers.length-1]).getLength(),k=j.end.sub(j.startCtrlPoint).normalize(),F=j.end.add(k.mul(z));else{var W=h(M,C);W<0&&(W=~W),C-=W>0?M[W-1]:0,C/=D.ratios[W],F=D.beziers[W].getPointAt(C)}O.push(F),I+=N}}else for(;1-I>1e-6;)C=c(C=I,w),O.push(x.lerp(A,C)),I+=N;y="constant"===w?w:s.Linear;for(var R=0,P=O.length;R<P;R++){var V=S+v+N*R*E;a(O[R],y,V)}v=Math.abs(I-1)>1e-6?(I-1)*E:0}p[p.length-1]!==g[g.length-1]&&a(u[u.length-1],y,p[p.length-1])}else e.values=u}var s=t("./animation-curves").DynamicAnimCurve,c=t("./animation-curves").computeRatioByType,a=t("./bezier").bezier,h=t("../core/utils/binary-search").binarySearchEpsilon,l=cc.v2;n.prototype.computeBeziers=function(){this.beziers.length=0,this.ratios.length=0,this.progresses.length=0,this.length=0;for(var t,e=1;e<this.points.length;e++){var i=this.points[e-1],n=this.points[e];(t=new o).start=i.pos,t.startCtrlPoint=i.out,t.end=n.pos,t.endCtrlPoint=n.in,this.beziers.push(t),this.length+=t.getLength()}for(var r=0,e=0;e<this.beziers.length;e++)t=this.beziers[e],this.ratios[e]=t.getLength()/this.length,this.progresses[e]=r+=this.ratios[e];return this.beziers},o.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},o.prototype.getPoint=function(t){var e=a(this.start.x,this.startCtrlPoint.x,this.endCtrlPoint.x,this.end.x,t),i=a(this.start.y,this.startCtrlPoint.y,this.endCtrlPoint.y,this.end.y,t);return new l(e,i)},o.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},o.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1)return this.cacheArcLengths;var e,i,n=[],o=this.getPoint(0),r=0;for(n.push(0),i=1;i<=t;i++)e=this.getPoint(i/t),r+=cc.pDistance(e,o),n.push(r),o=e;return this.cacheArcLengths=n,n},o.prototype.getUtoTmapping=function(t,e){var i,n=this.getLengths(),o=0,r=n.length;i=e||t*n[r-1];for(var s,c=0,a=r-1;c<=a;)if(o=Math.floor(c+(a-c)/2),(s=n[o]-i)<0)c=o+1;else{if(!(s>0)){a=o;break}a=o-1}if(o=a,n[o]===i)return l=o/(r-1);var h=n[o],l=(o+(i-h)/(n[o+1]-h))/(r-1);return l},e.exports={sampleMotionPaths:r,Curve:n,Bezier:o}}),{"../core/utils/binary-search":159,"./animation-curves":12,"./bezier":16}],20:[(function(t,e,i){function n(){this._isPlaying=!1,this._isPaused=!1,this._stepOnce=!1}var o=cc.js,r=n.prototype;o.get(r,"isPlaying",(function(){return this._isPlaying}),!0),o.get(r,"isPaused",(function(){return this._isPaused}),!0);var s=function(){};r.onPlay=s,r.onPause=s,r.onResume=s,r.onStop=s,r.onError=s,r.play=function(){this._isPlaying?this._isPaused?(this._isPaused=!1,this.onResume()):this.onError("already-playing"):(this._isPlaying=!0,this.onPlay())},r.stop=function(){this._isPlaying&&(this._isPlaying=!1,this.onStop(),this._isPaused=!1)},r.pause=function(){this._isPlaying&&(this._isPaused=!0,this.onPause())},r.resume=function(){this._isPlaying&&this._isPaused&&(this._isPaused=!1,this.onResume())},r.step=function(){this.pause(),this._stepOnce=!0,this._isPlaying||this.play()},e.exports=n}),{}],21:[(function(i,n,o){function r(t){t?this.set(t):(this.ratio=0,this.time=0,this.direction=1,this.stopped=!0,this.iterations=0,this.frameIndex=void 0)}function s(){h.call(this)}function c(i,n,o){if(s.call(this),this._firstFramePlayed=!1,this._delay=0,this._delayTime=0,this._wrappedInfo=new r,this._lastWrappedInfo=null,this.animator=i,this.curves=n||[],this.delay=0,this.repeatCount=1,this.duration=1,this.speed=1,this.wrapMode=u.Normal,o){this.delay=o.delay||this.delay;var c=o.duration;"undefined"!==("object"==(e=typeof c)?t(c):e)&&(this.duration=c);var a=o.speed;"undefined"!==("object"==(e=typeof a)?t(a):e)&&(this.speed=a);var h=o.wrapMode;if("undefined"!==("object"==(e=typeof h)?t(h):e)){var d="number"===("object"==(e=typeof h)?t(h):e);this.wrapMode=d?h:u[h]}var p=o.repeatCount;"undefined"!==("object"==(e=typeof p)?t(p):e)?this.repeatCount=p:this.wrapMode&l.Loop&&(this.repeatCount=1/0)}this.time=0}var a=cc.js,h=i("./playable"),l={Loop:2,ShouldWrap:4,PingPong:22,Reverse:36},u=cc.Enum({Default:0,Normal:1,Reverse:l.Reverse,Loop:l.Loop,LoopReverse:l.Loop|l.Reverse,PingPong:l.PingPong,PingPongReverse:l.PingPong|l.Reverse});cc.WrapMode=u,r.prototype.set=function(t){this.ratio=t.ratio,this.time=t.time,this.direction=t.direction,this.stopped=t.stopped,this.iterations=t.iterations,this.frameIndex=t.frameIndex},a.extend(s,h),s.prototype.update=function(t){},a.extend(c,s);var d=c.prototype;d.update=function(t){if(!(this._delayTime>0&&(this._delayTime-=t,this._delayTime>0))){this._firstFramePlayed?this.time+=t*this.speed:this._firstFramePlayed=!0;var e=this.sample();this._lastWrappedInfo||(this._lastWrappedInfo=new r(e));var i=(0|e.iterations)>(0|this._lastWrappedInfo.iterations);this.repeatCount>1&&i&&((this.wrapMode&l.Reverse)===l.Reverse?this._lastWrappedInfo.direction<0&&this.emit("lastframe",this):this._lastWrappedInfo.direction>0&&this.emit("lastframe",this)),e.stopped&&(this.stop(),this.emit("finished",this)),this._lastWrappedInfo.set(e)}},d._needRevers=function(t){var e=this.wrapMode,i=!1;return(e&l.PingPong)===l.PingPong&&(t-(0|t)==0&&t>0&&(t-=1),1&t&&(i=!i)),(e&l.Reverse)===l.Reverse&&(i=!i),i},d.getWrappedInfo=function(t,e){e=e||new r;var i=!1,n=this.duration,o=0,s=this.wrapMode,c=Math.abs(t/n);c>this.repeatCount&&(c=this.repeatCount);var a=!1;s&l.ShouldWrap&&(a=this._needRevers(c));var h=a?-1:1;if(this.speed<0&&(h*=-1),c>=this.repeatCount){i=!0;var u=this.repeatCount-(0|this.repeatCount);0===u&&(u=1),t=u*n*(t>0?1:-1)}if(t>n){var d=t%n;t=0===d?n:d}else t<0&&0!==(t%=n)&&(t+=n);return s&l.ShouldWrap&&a&&(t=n-t),o=t/n,e.ratio=o,e.time=t,e.direction=h,e.stopped=i,e.iterations=c,e},d.sample=function(){for(var t=this.getWrappedInfo(this.time,this._wrappedInfo),e=this.curves,i=0,n=e.length;i<n;i++)e[i].sample(t.time,t.ratio,this);return t},d.onStop=function(){this.emit("stop",this)},d.onPlay=function(){this._delayTime=this._delay,this.emit("play",this)},d.onPause=function(){this.emit("pause",this)},d.onResume=function(){this.emit("resume",this)},a.getset(d,"wrapMode",(function(){return this._wrapMode}),(function(t){this._wrapMode=t,this.time=0,t&l.Loop?this.repeatCount=1/0:this.repeatCount=1})),a.getset(d,"delay",(function(){return this._delay}),(function(t){this._delayTime=this._delay=t})),cc.js.mixin(d,cc.EventTarget.prototype),cc.AnimationNode=c,n.exports={WrapModeMask:l,WrapMode:u,AnimationNode:c,WrappedInfo:r}}),{"./playable":20}],22:[(function(t,e,i){var n=cc.js;i.removed=function(t){function e(){cc.errorID(1403)}n.getset(t,"willPlayMusic",e,e)},i.deprecated=function(t){var e=-1,i=1,o=1,r=1,s=1;n.get(t,"playMusic",(function(){return function(n,s){return t.stop(e),e=t.play(n,s,r),i=n,o=s,e}})),n.get(t,"stopMusic",(function(){return function(){return t.stop(e),e}})),n.get(t,"pauseMusic",(function(){return function(){return t.pause(e),e}})),n.get(t,"resumeMusic",(function(){return function(){return t.resume(e),e}})),n.get(t,"rewindMusic",(function(){return function(){return t.setCurrentTime(e,0),e}})),n.get(t,"getMusicVolume",(function(){return function(){return r}})),n.get(t,"setMusicVolume",(function(){return function(i){return r=i,t.setVolume(e,r),r}})),n.get(t,"isMusicPlaying",(function(){return function(){return t.getState(e)===t.AudioState.PLAYING}})),n.get(t,"playEffect",(function(){return function(e,i,n){return t.play(e,i||!1,void 0===n?s:n)}})),n.get(t,"setEffectsVolume",(function(i){return function(i){s=i;var n=t._id2audio;for(var o in n)o!==e&&t.setVolume(o,i)}})),n.get(t,"getEffectsVolume",(function(){return function(){return s}})),n.get(t,"pauseEffect",(function(){return function(e){return t.pause(e)}})),n.get(t,"pauseAllEffects",(function(){return function(){var i=t.getState(e)===t.AudioState.PLAYING;t.pauseAll(),i&&t.resume(e)}})),n.get(t,"resumeEffect",(function(){return function(e){t.resume(e)}})),n.get(t,"resumeAllEffects",(function(){return function(){var i=t.getState(e)===t.AudioState.PAUSED;t.resumeAll(),i&&t.getState(e)===t.AudioState.PLAYING&&t.pause(e)}})),n.get(t,"stopEffect",(function(){return function(e){return t.stop(e)}})),n.get(t,"stopAllEffects",(function(){return function(){var n=t.getState(e)===t.AudioState.PLAYING,r=t.getCurrentTime(e);t.stopAll(),n&&(e=t.play(i,o),t.setCurrentTime(e,r))}})),n.get(t,"unloadEffect",(function(){return function(e){return t.stop(e)}}))}}),{}],23:[(function(i,n,o){"use strict";function r(t){var e=cc.Mask;if(e)for(var i=0,n=t;n&&cc.Node.isNode(n);n=n._parent,++i)if(n.getComponent(e))return{index:i,node:n};return null}function s(t){t._parent._delaySort()}var c=i("./utils/prefab-helper"),a=i("./utils/scene-graph-helper"),h=cc.Object.Flags.Destroying,l=i("./utils/misc"),u=i("./event/event"),d=!!cc.ActionManager,p=function(){},_=cc.Enum({TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_WHEEL:"mousewheel"}),f=[_.TOUCH_START,_.TOUCH_MOVE,_.TOUCH_END,_.TOUCH_CANCEL],g=[_.MOUSE_DOWN,_.MOUSE_ENTER,_.MOUSE_MOVE,_.MOUSE_LEAVE,_.MOUSE_UP,_.MOUSE_WHEEL],v=null,y=function(t,e){e=u.EventTouch.pool.get(e);var i=t.getLocation(),n=this.owner;return!!n._hitTest(i,this)&&(e.type=_.TOUCH_START,e.touch=t,e.bubbles=!0,n.dispatchEvent(e),!0)},m=function(t,e){e=u.EventTouch.pool.get(e);var i=this.owner;e.type=_.TOUCH_MOVE,e.touch=t,e.bubbles=!0,i.dispatchEvent(e)},b=function(t,e){e=u.EventTouch.pool.get(e);var i=t.getLocation(),n=this.owner;n._hitTest(i,this)?e.type=_.TOUCH_END:e.type=_.TOUCH_CANCEL,e.touch=t,e.bubbles=!0,n.dispatchEvent(e)},C=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.stopPropagation(),(t=u.EventMouse.pool.get(t)).type=_.MOUSE_DOWN,i.dispatchEvent(t))},T=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)?(t.stopPropagation(),t=u.EventMouse.pool.get(t),this._previousIn||(v&&(t.type=_.MOUSE_LEAVE,v.dispatchEvent(t),v._mouseListener._previousIn=!1),v=this.owner,t.type=_.MOUSE_ENTER,i.dispatchEvent(t),this._previousIn=!0),t.type=_.MOUSE_MOVE,i.dispatchEvent(t)):this._previousIn&&((t=u.EventMouse.pool.get(t)).type=_.MOUSE_LEAVE,i.dispatchEvent(t),this._previousIn=!1,v=null)},S=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.stopPropagation(),(t=u.EventMouse.pool.get(t)).type=_.MOUSE_UP,i.dispatchEvent(t))},E=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&((t=u.EventMouse.pool.get(t)).type=_.MOUSE_WHEEL,i.dispatchEvent(t))},x=cc.Class({name:"cc.Node",extends:i("./utils/base-node"),properties:{_opacity:255,_color:cc.Color.WHITE,_cascadeOpacityEnabled:!0,_anchorPoint:cc.p(.5,.5),_contentSize:cc.size(0,0),_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:cc.p(0,0),_skewX:0,_skewY:0,_localZOrder:0,_globalZOrder:0,_opacityModifyRGB:!1,groupIndex:{default:0,type:cc.Integer},group:{get:function(){return cc.game.groupList[this.groupIndex]||""},set:function(t){this.groupIndex=cc.game.groupList.indexOf(t),this.emit("group-changed")}},x:{get:function(){return this._position.x},set:function(t){var e=this._position;if(t!==e.x){e.x=t,this._sgNode.setPositionX(t);var i=this._capturingListeners&&this._capturingListeners._callbackTable["position-changed"],n=this._bubblingListeners&&this._bubblingListeners._callbackTable["position-changed"];(i&&i.length>0||n&&n.length>0)&&this.emit("position-changed")}}},y:{get:function(){return this._position.y},set:function(t){var e=this._position;if(t!==e.y){e.y=t,this._sgNode.setPositionY(t);var i=this._capturingListeners&&this._capturingListeners._callbackTable["position-changed"],n=this._bubblingListeners&&this._bubblingListeners._callbackTable["position-changed"];(i&&i.length>0||n&&n.length>0)&&this.emit("position-changed")}}},rotation:{get:function(){return this._rotationX!==this._rotationY&&cc.logID(1602),this._rotationX},set:function(t){this._rotationX===t&&this._rotationY===t||(this._rotationX=this._rotationY=t,this._sgNode.rotation=t,this.emit("rotation-changed"))}},rotationX:{get:function(){return this._rotationX},set:function(t){this._rotationX!==t&&(this._rotationX=t,this._sgNode.rotationX=t,this.emit("rotation-changed"))}},rotationY:{get:function(){return this._rotationY},set:function(t){this._rotationY!==t&&(this._rotationY=t,this._sgNode.rotationY=t,this.emit("rotation-changed"))}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX!==t&&(this._scaleX=t,this._sgNode.scaleX=t,this.emit("scale-changed"))}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY!==t&&(this._scaleY=t,this._sgNode.scaleY=t,this.emit("scale-changed"))}},skewX:{get:function(){return this._skewX},set:function(t){this._skewX=t,this._sgNode.skewX=t}},skewY:{get:function(){return this._skewY},set:function(t){this._skewY=t,this._sgNode.skewY=t}},opacity:{get:function(){return this._opacity},set:function(t){if(this._opacity!==t&&(this._opacity=t,this._sgNode.setOpacity(t),!this._cascadeOpacityEnabled)){var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&e.setOpacity(t)}},range:[0,255]},cascadeOpacity:{get:function(){return this._cascadeOpacityEnabled},set:function(t){if(this._cascadeOpacityEnabled!==t){this._cascadeOpacityEnabled=t,this._sgNode.cascadeOpacity=t;var e=t?255:this._opacity,i=this._sizeProvider;i instanceof _ccsg.Node&&i.setOpacity(e)}}},color:{get:function(){return this._color.clone()},set:function(t){this._color.equals(t)||(this._color.fromColor(t),this._sizeProvider instanceof _ccsg.Node&&this._sizeProvider.setColor(t))}},anchorX:{get:function(){return this._anchorPoint.x},set:function(t){var e=this._anchorPoint;if(e.x!==t){e.x=t;var i=this._sizeProvider;i instanceof _ccsg.Node&&i.setAnchorPoint(e),this.emit("anchor-changed")}}},anchorY:{get:function(){return this._anchorPoint.y},set:function(t){var e=this._anchorPoint;if(e.y!==t){e.y=t;var i=this._sizeProvider;i instanceof _ccsg.Node&&i.setAnchorPoint(e),this.emit("anchor-changed")}}},width:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getWidth();return this._contentSize.width=t,t}return this._contentSize.width},set:function(t){if(t!==this._contentSize.width){var e=this._sizeProvider;e&&e.setContentSize(t,e._getHeight());this._contentSize.width=t,this.emit("size-changed")}}},height:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getHeight();return this._contentSize.height=t,t}return this._contentSize.height},set:function(t){if(t!==this._contentSize.height){var e=this._sizeProvider;e&&e.setContentSize(e._getWidth(),t);this._contentSize.height=t,this.emit("size-changed")}}},zIndex:{get:function(){return this._localZOrder},set:function(t){this._localZOrder!==t&&(this._localZOrder=t,this._sgNode.zIndex=t,this._parent&&s(this))}}},ctor:function(t){var e=this._sgNode=new _ccsg.Node;e.retain(),e._entity=this,e.onEnter=function(){_ccsg.Node.prototype.onEnter.call(this),this._entity&&!this._entity._active&&(d&&cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this))},cc.game._isCloning||(e.cascadeOpacity=!0),this._sizeProvider=null,this._reorderChildDirty=!1,this._widget=null,this._touchListener=null,this._mouseListener=null,this._retainedActions=[]},statics:{isNode:function(t){return t instanceof x&&(t.constructor===x||!(t instanceof cc.Scene))}},_onSetParent:function(t){var e=this._sgNode;e.parent&&e.parent.removeChild(e,!1),t&&(t._sgNode.addChild(e),t._delaySort())},_onSiblingIndexChanged:function(t){var e,i=this._parent,n=i._children,o=0,r=n.length;if(cc.runtime)for(;o<r;o++){var s=(e=n[o]._sgNode).getLocalZOrder();e.setLocalZOrder(s+1),e.setLocalZOrder(s)}else if(i._sgNode.removeChild(this._sgNode,!1),t+1<n.length){var c=n[t+1];i._sgNode.insertChildBefore(this._sgNode,c._sgNode)}else i._sgNode.addChild(this._sgNode)},_onPreDestroy:function(){var t=this._onPreDestroyBase();d&&cc.director.getActionManager().removeAllActionsFromTarget(this),v===this&&(v=null),cc.macro.ENABLE_GC_FOR_NATIVE_OBJECTS||this._releaseAllActions(),this._touchListener&&(this._touchListener.release(),this._touchListener.owner=null,this._touchListener.mask=null,this._touchListener=null),this._mouseListener&&(this._mouseListener.release(),this._mouseListener.owner=null,this._mouseListener.mask=null,this._mouseListener=null),this._reorderChildDirty&&cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this),cc.eventManager.removeListeners(this),t?(this._sgNode.release(),this._sgNode._entity=null,this._sgNode=null):this._removeSgNode()},_onPostActivated:function(t){var e=d?cc.director.getActionManager():null;if(t)if(e&&e.resumeTarget(this),cc.eventManager.resumeTarget(this),this._touchListener){var i=this._touchListener.mask=r(this);this._mouseListener&&(this._mouseListener.mask=i)}else this._mouseListener&&(this._mouseListener.mask=r(this));else e&&e.pauseTarget(this),cc.eventManager.pauseTarget(this)},_onHierarchyChanged:function(t){this._onHierarchyChangedBase(t),cc._widgetManager._nodesOrderDirty=!0},_onBatchCreated:function(){var t=this._prefab;t&&t.sync&&!t._synced&&t.root===this&&c.syncWithPrefab(this),this._updateDummySgNode(),this._parent&&this._parent._sgNode.addChild(this._sgNode),this._activeInHierarchy||(d&&cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this));for(var e=this._children,i=0,n=e.length;i<n;i++)e[i]._onBatchCreated()},on:function(t,e,i,n){var o=!1;return-1!==f.indexOf(t)?this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this,mask:r(this),onTouchBegan:y,onTouchMoved:m,onTouchEnded:b}),this._touchListener.retain(),cc.eventManager.addListener(this._touchListener,this),o=!0):-1!==g.indexOf(t)&&(this._mouseListener||(this._mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE,_previousIn:!1,owner:this,mask:r(this),onMouseDown:C,onMouseMove:T,onMouseUp:S,onMouseScroll:E}),this._mouseListener.retain(),cc.eventManager.addListener(this._mouseListener,this),o=!0)),o&&!this._activeInHierarchy&&cc.director.getScheduler().schedule((function(){this._activeInHierarchy||cc.eventManager.pauseTarget(this)}),this,0,0,0,!1),this._EventTargetOn(t,e,i,n)},off:function(t,e,i,n){this._EventTargetOff(t,e,i,n),-1!==f.indexOf(t)?this._checkTouchListeners():-1!==g.indexOf(t)&&this._checkMouseListeners()},targetOff:function(t){this._EventTargetTargetOff(t),this._checkTouchListeners(),this._checkMouseListeners()},pauseSystemEvents:function(t){cc.eventManager.pauseTarget(this,t)},resumeSystemEvents:function(t){cc.eventManager.resumeTarget(this,t)},_checkTouchListeners:function(){if(!(this._objFlags&h)&&this._touchListener){var t=0;if(this._bubblingListeners)for(;t<f.length;++t)if(this._bubblingListeners.has(f[t]))return;if(this._capturingListeners)for(;t<f.length;++t)if(this._capturingListeners.has(f[t]))return;cc.eventManager.removeListener(this._touchListener),this._touchListener=null}},_checkMouseListeners:function(){if(!(this._objFlags&h)&&this._mouseListener){var t=0;if(this._bubblingListeners)for(;t<g.length;++t)if(this._bubblingListeners.has(g[t]))return;if(this._capturingListeners)for(;t<g.length;++t)if(this._capturingListeners.has(g[t]))return;v===this&&(v=null),cc.eventManager.removeListener(this._mouseListener),this._mouseListener=null}},_hitTest:function(t,e){var i,n=this.width,o=this.height,r=cc.rect(0,0,n,o);i=cc.Camera&&cc.Camera.main?cc.Camera.main.getNodeToCameraTransform(this):this.getNodeToWorldTransform(),cc._rectApplyAffineTransformIn(r,i);var s=t.x-r.x,c=r.x+r.width-t.x,a=t.y-r.y,h=r.y+r.height-t.y;if(s>=0&&c>=0&&h>=0&&a>=0){if(e&&e.mask){for(var l=e.mask,u=this,d=0;u&&d<l.index;++d,u=u.parent);if(u===l.node){var p=u.getComponent(cc.Mask);return!p||!p.enabledInHierarchy||p._hitTest(t)}return e.mask=null,!0}return!0}return!1},_getCapturingTargets:function(t,e){for(var i=this.parent;i;)i.hasEventListener(t,!0)&&e.push(i),i=i.parent},_getBubblingTargets:function(t,e){for(var i=this.parent;i;)i.hasEventListener(t)&&e.push(i),i=i.parent},isRunning:function(){return this._activeInHierarchy},runAction:d?function(t){if(this.active)return cc.assertID(t,1618),cc.macro.ENABLE_GC_FOR_NATIVE_OBJECTS||this._retainAction(t),this._sgNode._owner=this,cc.director.getActionManager().addAction(t,this,!1),t}:p,pauseAllActions:d?function(){cc.director.getActionManager().pauseTarget(this)}:p,resumeAllActions:d?function(){cc.director.getActionManager().resumeTarget(this)}:p,stopAllActions:d?function(){cc.director.getActionManager().removeAllActionsFromTarget(this)}:p,stopAction:d?function(t){cc.director.getActionManager().removeAction(t)}:p,stopActionByTag:d?function(t){t!==cc.Action.TAG_INVALID?cc.director.getActionManager().removeActionByTag(t,this):cc.logID(1612)}:p,getActionByTag:d?function(t){return t===cc.Action.TAG_INVALID?(cc.logID(1613),null):cc.director.getActionManager().getActionByTag(t,this)}:function(){return null},getNumberOfRunningActions:d?function(){return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this)}:function(){return 0},_retainAction:function(t){t instanceof cc.Action&&-1===this._retainedActions.indexOf(t)&&(this._retainedActions.push(t),t.retain())},_releaseAllActions:function(){for(var t=0;t<this._retainedActions.length;++t)this._retainedActions[t].release();this._retainedActions.length=0},setTag:function(t){this._tag=t,this._sgNode.tag=t},getPosition:function(){return new cc.Vec2(this._position)},setPosition:function(i,n){var o;"undefined"===("object"==(e=typeof n)?t(n):e)?(o=i.x,n=i.y):o=i;var r=this._position;if(r.x!==o||r.y!==n){r.x=o,r.y=n,this._sgNode.setPosition(o,n);var s=this._capturingListeners&&this._capturingListeners._callbackTable["position-changed"],c=this._bubblingListeners&&this._bubblingListeners._callbackTable["position-changed"];(s&&s.length>0||c&&c.length>0)&&this.emit("position-changed")}},getScale:function(){return this._scaleX!==this._scaleY&&cc.logID(1603),this._scaleX},setScale:function(i,n){"object"===("object"==(e=typeof i)?t(i):e)?(n=i.y,i=i.x):n=n||0===n?n:i,this._scaleX===i&&this._scaleY===n||(this._scaleX=i,this._scaleY=n,this._sgNode.setScale(i,n),this.emit("scale-changed"))},getContentSize:function(t){if(this._sizeProvider&&!t){var e=this._sizeProvider.getContentSize();return this._contentSize=e,cc.size(e)}return cc.size(this._contentSize)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}this._sizeProvider&&this._sizeProvider.setContentSize(i),this.emit("size-changed")},setOpacityModifyRGB:function(t){if(this._opacityModifyRGB!==t){this._opacityModifyRGB=t,this._sgNode.setOpacityModifyRGB(t);var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&e.setOpacityModifyRGB(t)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setGlobalZOrder:function(t){this._globalZOrder=t,this._sgNode.setGlobalZOrder(t)},getGlobalZOrder:function(){return this._globalZOrder=this._sgNode.getGlobalZOrder(),this._globalZOrder},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}var n=this._sizeProvider;n instanceof _ccsg.Node&&n.setAnchorPoint(i),this.emit("anchor-changed")},getAnchorPointInPoints:function(){return this._sgNode.getAnchorPointInPoints()},getDisplayedOpacity:function(){return this._sgNode.getDisplayedOpacity()},_updateDisplayedOpacity:function(t){this._sgNode.updateDisplayedOpacity(t)},getDisplayedColor:function(){return this._sgNode.getDisplayedColor()},getNodeToParentTransformAR:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,o=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(o,e)}return e},getBoundingBox:function(){var t=this.getContentSize(),e=cc.rect(0,0,t.width,t.height);return cc._rectApplyAffineTransformIn(e,this.getNodeToParentTransform())},getBoundingBoxToWorld:function(){var t;return this.parent&&(t=this.parent.getNodeToWorldTransformAR()),this._getBoundingBoxTo(t)},_getBoundingBoxTo:function(t){var e=this.getContentSize(),i=e.width,n=e.height,o=cc.rect(-this._anchorPoint.x*i,-this._anchorPoint.y*n,i,n),r=cc.affineTransformConcat(this.getNodeToParentTransformAR(),t);if(cc._rectApplyAffineTransformIn(o,r),!this._children)return o;for(var s=this._children,c=0;c<s.length;c++){var a=s[c];if(a&&a.active){var h=a._getBoundingBoxTo(r);h&&(o=cc.rectUnion(o,h))}}return o},getNodeToParentTransform:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(this._isSgTransformArToMe(t)){var i=-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,o=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(o,e)}return e},getNodeToWorldTransform:function(){var t=this.getContentSize();cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.getNodeToWorldTransform();if(this._isSgTransformArToMe(t)){var i=-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,o=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(o,e)}return e},getNodeToWorldTransformAR:function(){var t=this.getContentSize();cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.getNodeToWorldTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,o=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(o,e)}return e},getParentToNodeTransform:function(){return this._sgNode.getParentToNodeTransform()},getWorldToNodeTransform:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.getWorldToNodeTransform()},_isSgTransformArToMe:function(t){var e=this._sgNode.getContentSize();return 0===e.width&&0===e.height&&(0!==t.width||0!==t.height)||!!this._sgNode.isIgnoreAnchorPointForPosition()},convertToNodeSpace:function(t){cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.convertToNodeSpace(t);return cc.pAdd(e,cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},convertToWorldSpace:function(t){cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=t.x-this._anchorPoint.x*this._contentSize.width,i=t.y-this._anchorPoint.y*this._contentSize.height;return cc.v2(this._sgNode.convertToWorldSpace(cc.v2(e,i)))},convertToNodeSpaceAR:function(t){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.isIgnoreAnchorPointForPosition()?cc.v2(this._sgNode.convertToNodeSpace(t)):this._sgNode.convertToNodeSpaceAR(t)},convertToWorldSpaceAR:function(t){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.isIgnoreAnchorPointForPosition()?cc.v2(this._sgNode.convertToWorldSpace(t)):cc.v2(this._sgNode.convertToWorldSpaceAR(t))},convertTouchToNodeSpace:function(t){return this.convertToNodeSpace(t.getLocation())},convertTouchToNodeSpaceAR:function(t){return this.convertToNodeSpaceAR(t.getLocation())},setNodeDirty:function(){this._sgNode.setNodeDirty()},addChild:function(i,n,o){n=void 0===n?i._localZOrder:n;var r,s=!1;"undefined"===("object"==(e=typeof o)?t(o):e)?(o=void 0,r=i._name):cc.js.isString(o)?(r=o,o=void 0):cc.js.isNumber(o)&&(s=!0,r=""),cc.assertID(i,1606),cc.assertID(null===i._parent,1605),i.parent=this,i.zIndex=n,s?i.setTag(o):i.setName(r)},cleanup:function(){d&&cc.director.getActionManager().removeAllActionsFromTarget(this),cc.eventManager.removeListeners(this);var t,e,i=this._children.length;for(t=0;t<i;++t)(e=this._children[t])&&e.cleanup()},sortAllChildren:function(){if(this._reorderChildDirty){this._reorderChildDirty=!1;var t=this._children;if(t.length>1){var e,i,n,o=t.length;for(e=1;e<o;e++){for(n=t[e],i=e-1;i>=0;){if(n._localZOrder<t[i]._localZOrder)t[i+1]=t[i];else{if(!(n._localZOrder===t[i]._localZOrder&&n._sgNode._arrivalOrder<t[i]._sgNode._arrivalOrder))break;t[i+1]=t[i]}i--}t[i+1]=n}this.emit("child-reorder")}cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)}},_delaySort:function(){this._reorderChildDirty||(this._reorderChildDirty=!0,cc.director.__fastOn(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this))},_updateDummySgNode:function(){var t=this,e=t._sgNode;e.setPosition(t._position),e.setRotationX(t._rotationX),e.setRotationY(t._rotationY),e.setScale(t._scaleX,t._scaleY),e.setSkewX(t._skewX),e.setSkewY(t._skewY);var i=e._arrivalOrder;e.setLocalZOrder(t._localZOrder),e._arrivalOrder=i,e.setGlobalZOrder(t._globalZOrder),e.setColor(this._color),e.setOpacity(t._opacity),e.setOpacityModifyRGB(t._opacityModifyRGB),e.setCascadeOpacityEnabled(t._cascadeOpacityEnabled),e.setTag(t._tag)},_updateSgNode:function(){this._updateDummySgNode();var t=this._sgNode;t.setAnchorPoint(this._anchorPoint),t.setVisible(this._active),t.setColor(this._color);var e=d?cc.director.getActionManager():null;this._activeInHierarchy?(e&&e.resumeTarget(this),cc.eventManager.resumeTarget(this)):(e&&e.pauseTarget(this),cc.eventManager.pauseTarget(this))},_removeSgNode:a.removeSgNode,onRestore:!1}),A=function(){this._activeInHierarchy||cc.eventManager.pauseTarget(this)};cc.js.getset(x.prototype,"_sgNode",(function(){return this.__sgNode}),(function(t){this.__sgNode=t,(this._touchListener||this._mouseListener)&&(this._touchListener&&(this._touchListener.retain(),cc.eventManager.removeListener(this._touchListener),cc.eventManager.addListener(this._touchListener,this),this._touchListener.release()),this._mouseListener&&(this._mouseListener.retain(),cc.eventManager.removeListener(this._mouseListener),cc.eventManager.addListener(this._mouseListener,this),this._mouseListener.release()),cc.director.once(cc.Director.EVENT_BEFORE_UPDATE,A,this))}),!0);var w=["parent","tag","skewX","skewY","position","rotation","rotationX","rotationY","scale","scaleX","scaleY","opacity","color"],O={x:["getPositionX","setPositionX"],y:["getPositionY","setPositionY"],zIndex:["getLocalZOrder","setLocalZOrder"],opacityModifyRGB:["isOpacityModifyRGB","setOpacityModifyRGB"],cascadeOpacity:["isCascadeOpacityEnabled","setCascadeOpacityEnabled"]};l.propertyDefine(x,w,O),x.EventType=_,cc.Node=n.exports=x}),{"./event/event":85,"./utils/base-node":158,"./utils/misc":162,"./utils/prefab-helper":164,"./utils/scene-graph-helper":165}],24:[(function(t,e,i){cc.Scene=cc.Class({name:"cc.Scene",extends:t("./CCNode"),properties:{autoReleaseAssets:void 0},ctor:function(){var t=this._sgNode=new _ccsg.Scene;t.retain(),t.setAnchorPoint(0,0),this._anchorPoint.x=0,this._anchorPoint.y=0,this._activeInHierarchy=!1,this._inited=!cc.game._isCloning,this.dependAssets=null},destroy:function(){this._super(),this._activeInHierarchy=!1},_onHierarchyChanged:function(){},_instantiate:null,_load:function(){this._inited||(this._onBatchCreated(),this._inited=!0)},_activate:function(t){t=!1!==t,cc.director._nodeActivator.activateNode(this,t)}}),e.exports=cc.Scene}),{"./CCNode":23}],25:[(function(t,e,i){var n=t("./CCRawAsset");cc.Asset=cc.Class({name:"cc.Asset",extends:n,properties:{rawUrl:{get:function(){if(this._rawFiles){if(cc.AssetLibrary)return cc.AssetLibrary.getLibUrlNoExt(this._uuid)+"/"+this._rawFiles[0];cc.errorID(6400)}return""},visible:!1},rawUrls:{get:function(){if(this._rawFiles){if(cc.AssetLibrary){var t=cc.AssetLibrary.getLibUrlNoExt(this._uuid)+"/";return this._rawFiles.map((function(e){return t+e}))}cc.errorID(6401)}return[]},visible:!1},_rawFiles:null},statics:{deserialize:function(t){return cc.deserialize(t)},preventDeferredLoadDependents:!1},serialize:function(){return Editor.serialize(this)},createNode:null,_setRawFiles:function(t){this._rawFiles=t.length>0?t:null},_preloadRawFiles:null}),e.exports=cc.Asset}),{"./CCRawAsset":31}],26:[(function(t,e,i){var n=cc.Class({name:"cc.AudioClip",extends:cc.RawAsset});cc.AudioClip=n,e.exports=n}),{}],27:[(function(t,e,i){var n=cc.Class({name:"cc.BitmapFont",extends:cc.Font,properties:{fntDataStr:{default:""},spriteFrame:{default:null,type:cc.SpriteFrame},fontSize:{default:-1},_fntConfig:null}});cc.BitmapFont=n,e.exports=n}),{}],28:[(function(t,e,i){var n=cc.Class({name:"cc.Font",extends:cc.Asset});cc.Font=n,e.exports=n}),{}],29:[(function(t,e,i){var n=cc.Class({name:"cc.LabelAtlas",extends:cc.BitmapFont});cc.LabelAtlas=n,e.exports=n}),{}],30:[(function(t,e,i){var n=cc.Class({name:"cc.Prefab",extends:cc.Asset,properties:{data:null,asyncLoadAssets:void 0,_createFunction:{default:null,serializable:!1}},createNode:!1,compileCreateFunction:function(){var e=t("../platform/instantiate-jit");this._createFunction=e.compile(this.data)},_doInstantiate:function(t){return this.data._prefab?this.data._prefab._synced=!0:cc.warnID(3700),this._createFunction||this.compileCreateFunction(),this._createFunction(t)},_instantiate:function(){var t=this._doInstantiate();return this.data._instantiate(t),t}});cc.Prefab=e.exports=n,cc.js.obsolete(cc,"cc._Prefab","Prefab")}),{"../platform/instantiate-jit":149}],31:[(function(t,e,i){var n=t("../platform/CCObject");cc.RawAsset=cc.Class({name:"cc.RawAsset",extends:n,ctor:function(){Object.defineProperty(this,"_uuid",{value:"",writable:!0})},statics:{createNodeByInfo:null}}),Object.defineProperty(cc.RawAsset,"isRawAssetType",{value:function(t){return cc.isChildClassOf(t,cc.RawAsset)&&!cc.isChildClassOf(t,cc.Asset)}}),e.exports=cc.RawAsset}),{"../platform/CCObject":140}],32:[(function(t,e,i){var n=cc.Class({name:"cc.SceneAsset",extends:cc.Asset,properties:{scene:null,asyncLoadAssets:void 0}});cc.SceneAsset=n,e.exports=n}),{}],33:[(function(t,e,i){var n=cc.Class({name:"cc.Script",extends:cc.Asset});cc._Script=n;var o=cc.Class({name:"cc.JavaScript",extends:n});cc._JavaScript=o;var r=cc.Class({name:"cc.CoffeeScript",extends:n});cc._CoffeeScript=r;var s=cc.Class({name:"cc.TypeScript",extends:n});cc._TypeScript=s}),{}],34:[(function(t,e,i){var n=cc.Class({name:"cc.SpriteAtlas",extends:cc.Asset,properties:{_spriteFrames:{default:{}}},getTexture:function(){var t=Object.keys(this._spriteFrames);if(t.length>0){var e=this._spriteFrames[t[0]];return e?e.getTexture():null}return null},getSpriteFrame:function(t){return this._spriteFrames[t]},getSpriteFrames:function(){var t=[],e=this._spriteFrames;for(var i in e)t.push(e[i]);return t}});cc.SpriteAtlas=n,e.exports=n}),{}],35:[(function(t,e,i){var n=cc.Class({name:"cc.TTFFont",extends:cc.Font});cc.TTFFont=n,e.exports=n}),{}],36:[(function(t,e,i){t("./CCRawAsset"),t("./CCAsset"),t("./CCFont"),t("./CCPrefab"),t("./CCAudioClip"),t("./CCScripts"),t("./CCSceneAsset"),t("../sprites/CCSpriteFrame"),t("../textures/CCTexture2D"),t("./CCTTFFont"),t("./CCSpriteAtlas"),t("./CCBitmapFont"),t("./CCLabelAtlas")}),{"../sprites/CCSpriteFrame":218,"../textures/CCTexture2D":218,"./CCAsset":25,"./CCAudioClip":26,"./CCBitmapFont":27,"./CCFont":28,"./CCLabelAtlas":29,"./CCPrefab":30,"./CCRawAsset":31,"./CCSceneAsset":32,"./CCScripts":33,"./CCSpriteAtlas":34,"./CCTTFFont":35}],37:[(function(t,e,i){function n(t){return t instanceof cc.Scene?cc.visibleRect:!t._sizeProvider||t._sizeProvider instanceof _ccsg.Node?t._contentSize:t.getContentSize()}function o(t,e,i,n){for(var o=t._parent._scaleX,r=t._parent._scaleY,s=0,c=0,a=t._parent;;){var h=a._position;if(s+=h.x,c+=h.y,!(a=a._parent))return i.x=i.y=0,void(n.x=n.y=1);if(a===e)break;var l=a._scaleX,u=a._scaleY;s*=l,c*=u,o*=l,r*=u}n.x=0!==o?1/o:1,n.y=0!==r?1/r:1,i.x=-s,i.y=-c}function r(t,e){var i,r,s,c=e._target;c?o(t,i=c,r=u,s=d):i=t._parent;var a=n(i),p=i._anchorPoint,_=i instanceof cc.Scene,f=t._position.x,g=t._position.y,v=t._anchorPoint;if(e._alignFlags&h){var y,m,b=a.width;_?(y=cc.visibleRect.left.x,m=cc.visibleRect.right.x):m=(y=-p.x*b)+b,y+=e._isAbsLeft?e._left:e._left*b,m-=e._isAbsRight?e._right:e._right*b,c&&(y+=r.x,y*=s.x,m+=r.x,m*=s.x);var C,T=v.x,S=t._scaleX;if(S<0&&(T=1-T,S=-S),e.isStretchWidth)C=m-y,0!==S&&(t.width=C/S),f=y+T*C;else if(C=t.width*S,e.isAlignHorizontalCenter){var E=e._isAbsHorizontalCenter?e._horizontalCenter:e._horizontalCenter*b,x=(.5-p.x)*a.width;c&&(E*=s.x,x+=r.x,x*=s.x),f=x+(T-.5)*C+E}else f=e.isAlignLeft?y+T*C:m+(T-1)*C}if(e._alignFlags&l){var A,w,O=a.height;_?(w=cc.visibleRect.bottom.y,A=cc.visibleRect.top.y):A=(w=-p.y*O)+O,w+=e._isAbsBottom?e._bottom:e._bottom*O,A-=e._isAbsTop?e._top:e._top*O,c&&(w+=r.y,w*=s.y,A+=r.y,A*=s.y);var I,N=v.y,L=t._scaleY;if(L<0&&(N=1-N,L=-L),e.isStretchHeight)I=A-w,0!==L&&(t.height=I/L),g=w+N*I;else if(I=t.height*L,e.isAlignVerticalCenter){var R=e._isAbsVerticalCenter?e._verticalCenter:e._verticalCenter*O,P=(.5-p.y)*a.height;c&&(R*=s.y,P+=r.y,P*=s.y),g=P+(N-.5)*I+R}else g=e.isAlignBottom?w+N*I:A+(N-1)*I}t.setPosition(f,g)}function s(t){var e=t._widget;if(e){r(t,e),e.isAlignOnce?e.enabled=!1:p.push(e)}for(var i=t._children,n=0;n<i.length;n++){var o=i[n];o._active&&s(o)}}function c(){var t=cc.director.getScene();if(t){if(_.isAligning=!0,_._nodesOrderDirty)p.length=0,s(t),_._nodesOrderDirty=!1;else{var e,i=_._activeWidgetsIterator;for(i.i=0;i.i<p.length;++i.i)r((e=p[i.i]).node,e)}_.isAligning=!1}}function a(t){var e=t._parent;cc.Node.isNode(e)&&a(e);var i=t._widget||t.getComponent(cc.Widget);i&&r(t,i)}var h=56,l=7,u=cc.Vec2.ZERO,d=cc.Vec2.ONE,p=[],_=cc._widgetManager=e.exports={_AlignFlags:{TOP:1,MID:2,BOT:4,LEFT:8,CENTER:16,RIGHT:32},isAligning:!1,_nodesOrderDirty:!1,_activeWidgetsIterator:new cc.js.array.MutableForwardIterator(p),init:function(t){t.on(cc.Director.EVENT_BEFORE_VISIT,c)},add:function(t){t.node._widget=t,this._nodesOrderDirty=!0},remove:function(t){t.node._widget=null,this._activeWidgetsIterator.remove(t)},updateAlignment:a}}),{}],38:[(function(t,e,i){var n=cc.Class({name:"cc.Camera",extends:cc._RendererUnderSG,ctor:function(){this.viewMatrix=cc.affineTransformMake(),this.invertViewMatrix=cc.affineTransformMake(),this._lastViewMatrix=cc.affineTransformMake(),this._sgTarges=[],this._checkedTimes=0,this.visibleRect={left:cc.v2(),right:cc.v2(),top:cc.v2(),bottom:cc.v2()},this.viewPort=cc.rect()},editor:!1,properties:{_targets:{default:[],type:cc.Node,visible:!0},zoomRatio:1},statics:{main:null},_createSgNode:function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){cc.errorID(8301);var t=new _ccsg.Node;return t.setTransform=t.addTarget=t.removeTarget=function(){},t}return new _ccsg.CameraNode},_initSgNode:function(){},_addSgTargetInSg:function(t){var e;if(t instanceof cc.Node?e=t._sgNode:t instanceof _ccsg.Node&&(e=t),e&&!e._cameraInfo){e._cameraInfo={touched:this._checkedTimes},this._sgNode.addTarget(e),this._sgTarges.push(e)}},_removeTargetInSg:function(t){var e;if(t instanceof cc.Node?e=t._sgNode:t instanceof _ccsg.Node&&(e=t),e&&e._cameraInfo){this._sgNode.removeTarget(e),delete e._cameraInfo,cc.js.array.remove(this._sgTarges,e)}},onEnable:function(){if(n.main)cc.errorID(8300);else{n.main=this;for(var t=this._targets,e=0,i=t.length;e<i;e++)this._addSgTargetInSg(t[e])}},onDisable:function(){if(n.main===this){n.main=null;for(var t=this._sgTarges,e=t.length-1;e>=0;e--)this._removeTargetInSg(t[e])}},addTarget:function(t){-1===this._targets.indexOf(t)&&(this._addSgTargetInSg(t),this._targets.push(t))},removeTarget:function(t){-1!==this._targets.indexOf(t)&&(this._removeTargetInSg(t),cc.js.array.remove(this._targets,t))},getTargets:function(){return this._targets},getNodeToCameraTransform:function(t){var e=t.getNodeToWorldTransform();return this.containsNode(t)&&(e=cc.affineTransformConcatIn(e,cc.Camera.main.viewMatrix)),e},getCameraToWorldPoint:function(t){return cc.Camera.main&&(t=cc.pointApplyAffineTransform(t,cc.Camera.main.invertViewMatrix)),t},containsNode:function(t){t instanceof cc.Node&&(t=t._sgNode);for(var e=this._sgTarges;t;){if(-1!==e.indexOf(t))return!0;t=t.parent}return!1},_setSgNodesTransformDirty:function(){for(var t=this._sgTarges,e=0;e<t.length;e++)t[e].markTransformUpdated()},_checkSgTargets:function(){for(var t=this._targets,e=this._sgTarges,i=++this._checkedTimes,n=0,o=t.length;n<o;n++){var r=t[n],s=r;r instanceof cc.Node&&(s=r._sgNode)&&!s._cameraInfo&&this._addSgTargetInSg(s),s&&(s._cameraInfo.touched=i)}for(var c=e.length-1;c>=0;c--){var a=e[c];a._cameraInfo.touched!==i&&this._removeTargetInSg(a)}},lateUpdate:function(){this._checkSgTargets();var t=this.viewMatrix,e=this.invertViewMatrix,i=this.viewPort,n=cc.visibleRect,o=this.visibleRect,r=this.node.getNodeToWorldTransformAR(),s=.5*-(Math.atan2(r.b,r.a)+Math.atan2(-r.c,r.d)),c=1,a=0,h=0,l=1;s&&(h=Math.sin(s),c=l=Math.cos(s),a=-h);var u=this.zoomRatio;c*=u,a*=u,h*=u,l*=u,t.a=c,t.b=a,t.c=h,t.d=l;var d=n.center;t.tx=d.x-(c*r.tx+h*r.ty),t.ty=d.y-(a*r.tx+l*r.ty),cc.affineTransformInvertOut(t,e),i.x=n.bottomLeft.x,i.y=n.bottomLeft.y,i.width=n.width,i.height=n.height,cc._rectApplyAffineTransformIn(i,e),o.left.x=i.xMin,o.right.x=i.xMax,o.bottom.y=i.yMin,o.top.y=i.yMax,this._sgNode.setTransform(c,a,h,l,t.tx,t.ty);var p=this._lastViewMatrix;p.a===t.a&&p.b===t.b&&p.c===t.c&&p.d===t.d&&p.tx===t.tx&&p.ty===t.ty||(this._setSgNodesTransformDirty(),p.a=t.a,p.b=t.b,p.c=t.c,p.d=t.d,p.tx=t.tx,p.ty=t.ty)}});n.flags=cc.Enum({InCamera:1,ParentInCamera:2}),e.exports=cc.Camera=n}),{"./CCSGCameraNode":218}],39:[(function(t,e,i){cc.Collider.Box=cc.Class({properties:{_offset:cc.v2(0,0),_size:cc.size(100,100),offset:{tooltip:!1,get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},size:{tooltip:!1,get:function(){return this._size},set:function(t){this._size.width=t.width<0?0:t.width,this._size.height=t.height<0?0:t.height},type:cc.Size}},resetInEditor:!1});var n=cc.Class({name:"cc.BoxCollider",extends:cc.Collider,mixins:[cc.Collider.Box],editor:!1});cc.BoxCollider=e.exports=n}),{}],40:[(function(t,e,i){cc.Collider.Circle=cc.Class({properties:{_offset:cc.v2(0,0),_radius:50,offset:{get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},radius:{tooltip:!1,get:function(){return this._radius},set:function(t){this._radius=t<0?0:t}}},resetInEditor:!1});var n=cc.Class({name:"cc.CircleCollider",extends:cc.Collider,mixins:[cc.Collider.Circle],editor:!1});cc.CircleCollider=e.exports=n}),{}],41:[(function(t,e,i){var n=cc.Class({name:"cc.Collider",extends:cc.Component,properties:{editing:{default:!1,serializable:!1,tooltip:!1},tag:{tooltip:!1,default:0,range:[0,1e7],type:cc.Integer}},onDisable:function(){cc.director.getCollisionManager().removeCollider(this)},onEnable:function(){cc.director.getCollisionManager().addCollider(this)}});cc.Collider=e.exports=n}),{}],42:[(function(t,e,i){var n=t("./CCContact"),o=n.CollisionType,r=cc.rect(),s=cc.v2(),c=cc.Class({mixins:[cc.EventTarget],properties:{enabled:!1,enabledDrawBoundingBox:!1},ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._contacts=[],this._colliders=[],this._debugDrawer=null,this._enabledDebugDraw=!1},update:function(t){if(this.enabled){var e,i,n=this._colliders;for(e=0,i=n.length;e<i;e++)this.updateCollider(n[e]);var r=this._contacts,s=[];for(e=0,i=r.length;e<i;e++){var c=r[e].updateState();c!==o.None&&s.push([c,r[e]])}for(e=0,i=s.length;e<i;e++){var a=s[e];this._doCollide(a[0],a[1])}this.drawColliders()}},_doCollide:function(t,e){var i;switch(t){case o.CollisionEnter:i="onCollisionEnter";break;case o.CollisionStay:i="onCollisionStay";break;case o.CollisionExit:i="onCollisionExit"}var n,r,s,c=e.collider1,a=e.collider2,h=c.node._components,l=a.node._components;for(n=0,r=h.length;n<r;n++)(s=h[n])[i]&&s[i](a,c);for(n=0,r=l.length;n<r;n++)(s=l[n])[i]&&s[i](c,a)},shouldCollide:function(t,e){var i=t.node,n=e.node,o=cc.game.collisionMatrix;return i!==n&&o[i.groupIndex][n.groupIndex]},initCollider:function(t){if(!t.world){var e=t.world={};e.aabb=cc.rect(),e.preAabb=cc.rect(),e.radius=0,t instanceof cc.BoxCollider?(e.position=null,e.points=[cc.v2(),cc.v2(),cc.v2(),cc.v2()]):t instanceof cc.PolygonCollider?(e.position=null,e.points=t.points.map((function(t){return cc.v2(t.x,t.y)}))):t instanceof cc.CircleCollider&&(e.position=cc.v2(),e.points=null)}},updateCollider:function(t){var e=t.offset,i=t.world,n=i.aabb,o=i.transform=t.node.getNodeToWorldTransformAR(),c=i.preAabb;if(c.x=n.x,c.y=n.y,c.width=n.width,c.height=n.height,t instanceof cc.BoxCollider){var a=t.size;r.x=e.x-a.width/2,r.y=e.y-a.height/2,r.width=a.width,r.height=a.height;var h=i.points,l=h[0],u=h[1],d=h[2],p=h[3];cc.obbApplyAffineTransform(r,o,l,u,d,p);var _=Math.min(l.x,u.x,d.x,p.x),f=Math.min(l.y,u.y,d.y,p.y),g=Math.max(l.x,u.x,d.x,p.x),v=Math.max(l.y,u.y,d.y,p.y);n.x=_,n.y=f,n.width=g-_,n.height=v-f}else if(t instanceof cc.CircleCollider){E=cc.pointApplyAffineTransform(t.offset,o);i.position.x=E.x,i.position.y=E.y,o.tx=o.ty=0,s.x=t.radius,s.y=0;var y=cc.pointApplyAffineTransform(s,o),m=Math.sqrt(y.x*y.x+y.y*y.y);i.radius=m,n.x=E.x-m,n.y=E.y-m,n.width=2*m,n.height=2*m}else if(t instanceof cc.PolygonCollider){var b=t.points,C=i.points;C.length=b.length;for(var _=1e6,f=1e6,g=-1e6,v=-1e6,T=0,S=b.length;T<S;T++){C[T]||(C[T]=cc.v2()),s.x=b[T].x+e.x,s.y=b[T].y+e.y;var E=cc.pointApplyAffineTransform(s,o);C[T].x=E.x,C[T].y=E.y,E.x>g&&(g=E.x),E.x<_&&(_=E.x),E.y>v&&(v=E.y),E.y<f&&(f=E.y)}n.x=_,n.y=f,n.width=g-_,n.height=v-f}},addCollider:function(t){var e=this._colliders;if(-1===e.indexOf(t)){for(var i=0,o=e.length;i<o;i++){var r=e[i];if(this.shouldCollide(t,r)){var s=new n(t,r);this._contacts.push(s)}}e.push(t),this.initCollider(t)}t.node.on("group-changed",this.onNodeGroupChanged,this)},removeCollider:function(t){var e=this._colliders,i=e.indexOf(t);if(i>=0){e.splice(i,1);for(var n=this._contacts,r=n.length-1;r>=0;r--){var s=n[r];s.collider1!==t&&s.collider2!==t||(s.touching&&this._doCollide(o.CollisionExit,s),n.splice(r,1))}t.node.off("group-changed",this.onNodeGroupChanged,this)}else cc.errorID(6600)},attachDebugDrawToCamera:function(t){this._debugDrawer&&t.addTarget(this._debugDrawer)},detachDebugDrawFromCamera:function(t){this._debugDrawer&&t.removeTarget(this._debugDrawer)},onNodeGroupChanged:function(t){for(var e=t.currentTarget.getComponents(cc.Collider),i=0,n=e.length;i<n;i++)this.removeCollider(e[i]),this.addCollider(e[i])},drawColliders:function(){var t=this._debugDrawer;if(this._enabledDebugDraw&&t){t.clear();for(var e=this._colliders,i=0,n=e.length;i<n;i++){var o=e[i];if(o instanceof cc.BoxCollider||o instanceof cc.PolygonCollider){var r=o.world.points;if(r.length>0){t.strokeColor=cc.Color.WHITE,t.moveTo(r[0].x,r[0].y);for(var s=1;s<r.length;s++)t.lineTo(r[s].x,r[s].y);t.close(),t.stroke()}}else o instanceof cc.CircleCollider&&(t.circle(o.world.position.x,o.world.position.y,o.world.radius),t.stroke());if(this.enabledDrawBoundingBox){var c=o.world.aabb;t.strokeColor=cc.Color.BLUE,t.moveTo(c.xMin,c.yMin),t.lineTo(c.xMin,c.yMax),t.lineTo(c.xMax,c.yMax),t.lineTo(c.xMax,c.yMin),t.close(),t.stroke()}}}},onSceneLaunched:function(){this._enabledDebugDraw&&this._debugDrawer&&(this._debugDrawer.removeFromParent(),cc.director.getScene()._sgNode.addChild(this._debugDrawer))}});cc.js.getset(c.prototype,"enabledDebugDraw",(function(){return this._enabledDebugDraw}),(function(t){t&&!this._enabledDebugDraw?(this._debugDrawer||(this._debugDrawer=new _ccsg.GraphicsNode,this._debugDrawer.retain()),cc.director.getScene()._sgNode.addChild(this._debugDrawer),cc.director.on(cc.Director.EVENT_AFTER_SCENE_LAUNCH,this.onSceneLaunched,this)):!t&&this._enabledDebugDraw&&(this._debugDrawer.clear(),this._debugDrawer.removeFromParent(!1),cc.director.off(cc.Director.EVENT_AFTER_SCENE_LAUNCH,this.onSceneLaunched,this)),this._enabledDebugDraw=t})),cc.CollisionManager=e.exports=c}),{"./CCContact":43}],43:[(function(t,e,i){function n(t,e){this.collider1=t,this.collider2=e,this.touching=!1;var i=t instanceof cc.BoxCollider||t instanceof cc.PolygonCollider,n=e instanceof cc.BoxCollider||e instanceof cc.PolygonCollider,r=t instanceof cc.CircleCollider,s=e instanceof cc.CircleCollider;i&&n?this.testFunc=o.polygonPolygon:r&&s?this.testFunc=o.circleCircle:i&&s?this.testFunc=o.polygonCircle:r&&n?(this.testFunc=o.polygonCircle,this.collider1=e,this.collider2=t):cc.errorID(6601,cc.js.getClassName(t),cc.js.getClassName(e))}var o=t("./CCIntersection"),r=cc.Enum({None:0,CollisionEnter:1,CollisionStay:2,CollisionExit:3});n.prototype.test=function(){var t=this.collider1.world,e=this.collider2.world;return!!t.aabb.intersects(e.aabb)&&(this.testFunc===o.polygonPolygon?this.testFunc(t.points,e.points):this.testFunc===o.circleCircle?this.testFunc(t,e):this.testFunc===o.polygonCircle&&this.testFunc(t.points,e))},n.prototype.updateState=function(){var t=this.test(),e=r.None;return t&&!this.touching?(this.touching=!0,e=r.CollisionEnter):t&&this.touching?e=r.CollisionStay:!t&&this.touching&&(this.touching=!1,e=r.CollisionExit),e},n.CollisionType=r,e.exports=n}),{"./CCIntersection":44}],44:[(function(t,e,i){function n(t,e,i,n){var o=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),r=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x),s=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(0!==s){var c=o/s,a=r/s;if(0<=c&&c<=1&&0<=a&&a<=1)return!0}return!1}function o(t,e,i){for(var o=i.length,r=0;r<o;++r)if(n(t,e,i[r],i[(r+1)%o]))return!0;return!1}function r(t,e){for(var i=!1,n=t.x,o=t.y,r=e.length,s=0,c=r-1;s<r;c=s++){var a=e[s].x,h=e[s].y,l=e[c].x,u=e[c].y;h>o!=u>o&&n<(l-a)*(o-h)/(u-h)+a&&(i=!i)}return i}function s(t,e,i,n){var o,r=i.x-e.x,s=i.y-e.y,c=r*r+s*s,a=((t.x-e.x)*r+(t.y-e.y)*s)/c;return o=n?c?a<0?e:a>1?i:cc.v2(e.x+a*r,e.y+a*s):e:cc.v2(e.x+a*r,e.y+a*s),r=t.x-o.x,s=t.y-o.y,Math.sqrt(r*r+s*s)}var c={};c.lineLine=n,c.lineRect=function(t,e,i){var o=new cc.Vec2(i.x,i.y),r=new cc.Vec2(i.x,i.yMax),s=new cc.Vec2(i.xMax,i.yMax),c=new cc.Vec2(i.xMax,i.y);return!!(n(t,e,o,r)||n(t,e,r,s)||n(t,e,s,c)||n(t,e,c,o))},c.linePolygon=o,c.rectRect=function(t,e){var i=t.x,n=t.y,o=t.x+t.width,r=t.y+t.height,s=e.x,c=e.y,a=e.x+e.width,h=e.y+e.height;return i<=a&&o>=s&&n<=h&&r>=c},c.rectPolygon=function(t,e){var i,n,s=new cc.Vec2(t.x,t.y),c=new cc.Vec2(t.x,t.yMax),a=new cc.Vec2(t.xMax,t.yMax),h=new cc.Vec2(t.xMax,t.y);if(o(s,c,e))return!0;if(o(c,a,e))return!0;if(o(a,h,e))return!0;if(o(h,s,e))return!0;for(i=0,n=e.length;i<n;++i)if(r(e[i],t))return!0;return!!(r(s,e)||r(c,e)||r(a,e)||r(h,e))},c.polygonPolygon=function(t,e){var i,n;for(i=0,n=t.length;i<n;++i)if(o(t[i],t[(i+1)%n],e))return!0;for(i=0,n=e.length;i<n;++i)if(r(e[i],t))return!0;for(i=0,n=t.length;i<n;++i)if(r(t[i],e))return!0;return!1},c.circleCircle=function(t,e){return t.position.sub(e.position).mag()<t.radius+e.radius},c.polygonCircle=function(t,e){var i=e.position;if(r(i,t))return!0;for(var n=0,o=t.length;n<o;n++)if(s(i,0===n?t[t.length-1]:t[n-1],t[n],!0)<e.radius)return!0;return!1},c.pointInPolygon=r,c.pointLineDistance=s,cc.Intersection=e.exports=c}),{}],45:[(function(t,e,i){cc.Collider.Polygon=cc.Class({properties:{threshold:{default:1,serializable:!1,visible:!1},_offset:cc.v2(0,0),offset:{get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},points:{tooltip:!1,default:function(){return[cc.v2(-50,-50),cc.v2(50,-50),cc.v2(50,50),cc.v2(-50,50)]},type:[cc.Vec2]}},resetPointsByContour:!1});var n=cc.Class({name:"cc.PolygonCollider",extends:cc.Collider,mixins:[cc.Collider.Polygon],editor:!1});cc.PolygonCollider=e.exports=n}),{}],46:[(function(t,e,i){t("./CCCollisionManager"),t("./CCCollider"),t("./CCBoxCollider"),t("./CCCircleCollider"),t("./CCPolygonCollider")}),{"./CCBoxCollider":39,"./CCCircleCollider":40,"./CCCollider":41,"./CCCollisionManager":42,"./CCPolygonCollider":45}],47:[(function(t,e,i){function n(t,e){for(var i=e.constructor._executionOrder,n=e.__instanceId,o=0,r=t.length-1,s=r>>>1;o<=r;s=o+r>>>1){var c=t[s],a=c.constructor._executionOrder;if(a>i)r=s-1;else if(a<i)o=s+1;else{var h=c.__instanceId;if(h>n)r=s-1;else{if(!(h<n))return s;o=s+1}}}return~o}function o(t,e){for(var i=t.array,n=t.i+1;n<i.length;){var o=i[n];o._enabled&&o.node._activeInHierarchy?++n:(t.removeAt(n),e&&(o._objFlags&=~e))}}function r(t,e){return t.constructor._executionOrder-e.constructor._executionOrder}function s(t,e){var i="var a=it.array;for(it.i=0;it.i<a.length;++it.i){var c=a[it.i];"+t+"}";return e?Function("it","dt",i):Function("it",i)}function c(){this.startInvoker=new p(s("c.start();c._objFlags|="+l)),this.updateInvoker=new _(s("c.update(dt)",!0)),this.lateUpdateInvoker=new _(s("c.lateUpdate(dt)",!0)),this.scheduleInNextFrame=[],this._updating=!1}t("./platform/CCClass");var a=t("./platform/CCObject").Flags,h=t("./platform/js").array,l=a.IsStartCalled,u=a.IsOnEnableCalled,d=(a.IsEditorOnEnableCalled,cc.Class({__ctor__:function(t){var e=h.MutableForwardIterator;this._zero=new e([]),this._neg=new e([]),this._pos=new e([]),this._invoke=t},statics:{stableRemoveInactive:o},add:null,remove:null,invoke:null})),p=cc.Class({extends:d,add:function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).array.push(t)},remove:function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).fastRemove(t)},cancelInactive:function(t){o(this._zero,t),o(this._neg,t),o(this._pos,t)},invoke:function(){var t=this._neg;t.array.length>0&&(t.array.sort(r),this._invoke(t),t.array.length=0),this._invoke(this._zero),this._zero.array.length=0;var e=this._pos;e.array.length>0&&(e.array.sort(r),this._invoke(e),e.array.length=0)}}),_=cc.Class({extends:d,add:function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.array.push(t);else{var i=e<0?this._neg.array:this._pos.array,o=n(i,t);o<0&&i.splice(~o,0,t)}},remove:function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.fastRemove(t);else{var i=e<0?this._neg:this._pos,o=n(i.array,t);o>=0&&i.removeAt(o)}},invoke:function(t){this._neg.array.length>0&&this._invoke(this._neg,t),this._invoke(this._zero,t),this._pos.array.length>0&&this._invoke(this._pos,t)}}),f=cc.Class({ctor:c,unscheduleAll:c,statics:{LifeCycleInvoker:d,OneOffInvoker:p,createInvokeImpl:s,invokeOnEnable:function(t){var e=cc.director._compScheduler,i=t.array;for(t.i=0;t.i<i.length;++t.i){var n=i[t.i];n._enabled&&(n.onEnable(),!n.node._activeInHierarchy||e._onEnabled(n))}}},_onEnabled:function(t){cc.director.getScheduler().resumeTarget(t),t._objFlags|=u,this._updating?this.scheduleInNextFrame.push(t):this._scheduleImmediate(t)},_onDisabled:function(t){cc.director.getScheduler().pauseTarget(t),t._objFlags&=~u;var e=this.scheduleInNextFrame.indexOf(t);e>=0?h.fastRemoveAt(this.scheduleInNextFrame,e):(!t.start||t._objFlags&l||this.startInvoker.remove(t),t.update&&this.updateInvoker.remove(t),t.lateUpdate&&this.lateUpdateInvoker.remove(t))},enableComp:function(t,e){if(!(t._objFlags&u)){if(t.onEnable){if(e)return void e.add(t);if(t.onEnable(),!t.node._activeInHierarchy)return}this._onEnabled(t)}},disableComp:function(t){t._objFlags&u&&(t.onDisable&&t.onDisable(),this._onDisabled(t))},_scheduleImmediate:function(t){!t.start||t._objFlags&l||this.startInvoker.add(t),t.update&&this.updateInvoker.add(t),t.lateUpdate&&this.lateUpdateInvoker.add(t)},_deferredSchedule:function(){for(var t=this.scheduleInNextFrame,e=0,i=t.length;e<i;e++){var n=t[e];this._scheduleImmediate(n)}t.length=0},startPhase:function(){this._updating=!0,this.scheduleInNextFrame.length>0&&this._deferredSchedule(),this.startInvoker.invoke()},updatePhase:function(t){this.updateInvoker.invoke(t)},lateUpdatePhase:function(t){this.lateUpdateInvoker.invoke(t),this._updating=!1}});e.exports=f}),{"./platform/CCClass":136,"./platform/CCObject":140,"./platform/js":151,"./utils/misc":162}],48:[(function(t,e,i){function n(t,e){return t===e||t&&e&&(t.name===e.name||t._uuid===e._uuid)}var o=t("../../animation/animation-animator"),r=t("../../animation/animation-clip"),s=cc.Class({name:"cc.Animation",extends:t("./CCComponent"),mixins:[cc.EventTarget],editor:!1,ctor:function(){this._animator=null,this._nameToState={},this._didInit=!1,this._currentClip=null,this._listeners=[]},properties:{_defaultClip:{default:null,type:r},defaultClip:{type:r,get:function(){return this._defaultClip},set:function(t){return},tooltip:!1},currentClip:{get:function(){return this._currentClip},set:function(t){this._currentClip=t},type:r,visible:!1},_clips:{default:[],type:[r],tooltip:!1,visible:!0},playOnLoad:{default:!1,tooltip:!1}},start:function(){if(this.playOnLoad&&this._defaultClip){var t=this.getAnimationState(this._defaultClip.name);this._animator.playState(t)}},onEnable:function(){this._animator&&this._animator.resume()},onDisable:function(){this._animator&&this._animator.pause()},onDestroy:function(){this.stop()},getClips:function(){return this._clips},play:function(t,e){var i=this.playAdditive(t,e);return this._animator.stopStatesExcept(i),i},playAdditive:function(t,e){this._init();var i=this.getAnimationState(t||this._defaultClip&&this._defaultClip.name);if(i){this.enabled=!0;var n=this._animator;n.isPlaying&&i.isPlaying?i.isPaused?n.resumeState(i):(n.stopState(i),n.playState(i,e)):n.playState(i,e),this.currentClip=i.clip}return i},stop:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.stopState(e)}else this._animator.stop()},pause:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.pauseState(e)}else this.enabled=!1},resume:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.resumeState(e)}else this.enabled=!0},setCurrentTime:function(t,e){if(this._init(),e){var i=this._nameToState[e];i&&this._animator.setStateTime(i,t)}else this._animator.setStateTime(t)},getAnimationState:function(t){this._init();var e=this._nameToState[t];return e&&!e.curveLoaded&&this._animator._reloadClip(e),e||null},addClip:function(t,e){if(t){this._init(),cc.js.array.contains(this._clips,t)||this._clips.push(t),e=e||t.name;var i=this._nameToState[e];if(i){if(i.clip===t)return i;var n=this._clips.indexOf(i.clip);-1!==n&&this._clips.splice(n,1)}var o=new cc.AnimationState(t,e);return this._nameToState[e]=o,o}cc.warnID(3900)},removeClip:function(t,e){if(t){this._init();var i;for(var n in this._nameToState)if((i=this._nameToState[n]).clip===t)break;if(t===this._defaultClip){if(!e)return void cc.warnID(3902);this._defaultClip=null}if(i&&i.isPlaying){if(!e)return void cc.warnID(3903);this.stop(i.name)}this._clips=this._clips.filter((function(e){return e!==t})),i&&delete this._nameToState[i.name]}else cc.warnID(3901)},sample:function(t){if(this._init(),t){var e=this._nameToState[t];e&&e.sample()}else this._animator.sample()},on:function(t,e,i,n){this._init();for(var o=this._listeners,r=0,s=o.length;r<s;r++){var c=o[r];if(c[0]===t&&c[1]===e&&c[2]===i&&c[3]===n)return}return this._animator.on(t,e,i,n),o.push([t,e,i,n]),e},off:function(t,e,i,n){this._init();for(var o=this._listeners,r=this._nameToState,s=o.length-1;s>=0;s--){var c=o[s];if(c[0]===t&&c[1]===e&&c[2]===i&&c[3]===n){for(var a in r)r[a].off(t,e,i,n);o.splice(s,1)}}},_init:function(){this._didInit||(this._didInit=!0,this._animator=new o(this.node,this),this._createStates())},_createStates:function(){this._nameToState={};for(var t=null,e=!1,i=0;i<this._clips.length;++i){var o=this._clips[i];o&&(t=new cc.AnimationState(o),this._nameToState[t.name]=t,n(this._defaultClip,o)&&(e=t))}this._defaultClip&&!e&&(t=new cc.AnimationState(this._defaultClip),this._nameToState[t.name]=t)}});cc.Animation=e.exports=s}),{"../../animation/animation-animator":10,"../../animation/animation-clip":11,"./CCComponent":53}],49:[(function(t,e,i){var n=cc.Class({name:"cc.AudioSource",extends:t("./CCComponent"),editor:!1,ctor:function(){this.audio=new cc.Audio},properties:{_clip:{default:"",url:cc.AudioClip},_volume:1,_mute:!1,_loop:!1,_pausedFlag:{default:!1,serializable:!1},isPlaying:{get:function(){return!!this.audio&&this.audio.getState()===cc.Audio.State.PLAYING},visible:!1},clip:{get:function(){return this._clip},set:function(t){t!==this._clip&&(this._clip=t,this.audio.stop(),this.audio.src=this._clip,this.audio.preload&&this.audio.preload())},url:cc.AudioClip,tooltip:!1,animatable:!1},volume:{get:function(){return this._volume},set:function(t){t=cc.clamp01(t),this._volume=t;var e=this.audio;return e&&!this._mute&&(e.setVolume(t),e._loaded||e.on("load",(function(){e.setVolume(t)}))),t},tooltip:!1},mute:{get:function(){return this._mute},set:function(t){return this._mute=t,this.audio&&this.audio.setVolume(t?0:this._volume),t},animatable:!1,tooltip:!1},loop:{get:function(){return this._loop},set:function(t){return this._loop=t,this.audio&&this.audio.setLoop(t),t},animatable:!1,tooltip:!1},playOnLoad:{default:!1,tooltip:!1,animatable:!1},preload:{default:!1,animatable:!1}},_pausedCallback:function(){var t=this.audio;t&&!t.paused&&(this.audio.pause(),this._pausedFlag=!0)},_restoreCallback:function(){this.audio&&(this._pausedFlag&&this.audio.resume(),this._pausedFlag=!1)},onEnable:function(){this.playOnLoad&&this.play(),this.preload&&(this.audio.src=this._clip,this.audio.preload()),cc.game.on(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.on(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDisable:function(){this.stop(),cc.game.off(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.off(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDestroy:function(){this.stop(),cc.audioEngine.uncache(this._clip)},play:function(){if(this._clip){var t=this._mute?0:this._volume,e=this.audio,i=this._loop;if(e._loaded)return e.stop(),e.setCurrentTime(0),void e.play();e.src=this._clip,e.once("load",(function(){e.setLoop(i),e.setVolume(t),e.play()})),e.preload()}},stop:function(){this.audio&&this.audio.stop()},pause:function(){this.audio&&this.audio.pause()},resume:function(){this.audio&&this.audio.resume()},rewind:function(){this.audio&&this.audio.setCurrentTime(0)},getCurrentTime:function(){var t=0;return this.audio&&(t=this.audio.getCurrentTime()),t},setCurrentTime:function(t){var e=this.audio;return e?e._loaded?(e.setCurrentTime(t),t):(e.once("load",(function(){e.setCurrentTime(t)})),t):t},getDuration:function(){var t=0;return this.audio&&(t=this.audio.getDuration()),t}});cc.AudioSource=e.exports=n}),{"./CCComponent":53}],50:[(function(t,e,i){function n(t){t.stopPropagation()}var o=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","mouseenter","mouseleave","mousewheel"],r=cc.Class({name:"cc.BlockInputEvents",extends:t("./CCComponent"),editor:{menu:"i18n:MAIN_MENU.component.ui/Block Input Events",inspector:"packages://inspector/inspectors/comps/block-input-events.js",help:"i18n:COMPONENT.help_url.block-input-events"},onEnable:function(){for(var t=0;t<o.length;t++)this.node.on(o[t],n,this)},onDisable:function(){for(var t=0;t<o.length;t++)this.node.off(o[t],n,this)}});cc.BlockInputEvents=e.exports=r}),{"./CCComponent":53}],51:[(function(t,e,i){var n=cc.Enum({NONE:0,COLOR:1,SPRITE:2,SCALE:3}),o=cc.Class({name:"cc.Button",extends:t("./CCComponent"),ctor:function(){this._resetState(),this._fromColor=null,this._toColor=null,this._time=0,this._transitionFinished=!0,this._fromScale=1,this._toScale=1,this._originalScale=1,this._sprite=null},_resetState:function(){this._pressed=!1,this._hovered=!1},editor:!1,properties:{interactable:{default:!0,tooltip:!1,notify:function(t){this._updateState(),this.interactable||this._resetState()},animatable:!1},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}},enableAutoGrayEffect:{default:!1,tooltip:!1,notify:function(){this._updateDisabledState()}},transition:{default:n.NONE,tooltip:!1,type:n,animatable:!1},normalColor:{default:cc.color(214,214,214),displayName:"Normal",tooltip:!1,notify:function(){this._updateState()}},pressedColor:{default:cc.color(211,211,211),displayName:"Pressed",tooltip:!1},hoverColor:{default:cc.Color.WHITE,displayName:"Hover",tooltip:!1},disabledColor:{default:cc.color(124,124,124),displayName:"Disabled",tooltip:!1,notify:function(){this._updateState()}},duration:{default:.1,range:[0,10],tooltip:!1},zoomScale:{default:1.2,tooltip:!1},normalSprite:{default:null,type:cc.SpriteFrame,displayName:"Normal",tooltip:!1,notify:function(){this._updateState()}},pressedSprite:{default:null,type:cc.SpriteFrame,displayName:"Pressed",tooltip:!1},hoverSprite:{default:null,type:cc.SpriteFrame,displayName:"Hover",tooltip:!1},disabledSprite:{default:null,type:cc.SpriteFrame,displayName:"Disabled",tooltip:!1,notify:function(){this._updateState()}},target:{default:null,type:cc.Node,tooltip:!1,notify:function(){this._applyTarget()}},clickEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Transition:n},__preload:function(){this.target||(this.target=this.node),this._applyTarget(),this._updateState()},onEnable:function(){this.normalSprite&&this.normalSprite.ensureLoadTexture(),this.hoverSprite&&this.hoverSprite.ensureLoadTexture(),this.pressedSprite&&this.pressedSprite.ensureLoadTexture(),this.disabledSprite&&this.disabledSprite.ensureLoadTexture(),this._registerEvent()},update:function(t){var e=this.target;if(!this._transitionFinished&&(this.transition===n.COLOR||this.transition===n.SCALE)){this.time+=t;var i=1;this.duration>0&&(i=this.time/this.duration),i>=1&&(i=1,this._transitionFinished=!0),this.transition===n.COLOR?e.color=this._fromColor.lerp(this._toColor,i):this.transition===n.SCALE&&(e.scale=cc.lerp(this._fromScale,this._toScale,i))}},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_getTargetSprite:function(t){var e=null;return t&&(e=t.getComponent(cc.Sprite)),e},_applyTarget:function(){this._sprite=this._getTargetSprite(this.target),this.target&&(this._originalScale=this.target.scale)},_onTouchBegan:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),t.stopPropagation())},_onTouchMove:function(t){if(this.interactable&&this.enabledInHierarchy&&this._pressed){var e=t.touch,i=this.node._hitTest(e.getLocation());if(this.transition===n.SCALE&&this.target)i?(this._fromScale=this._originalScale,this._toScale=this._originalScale*this.zoomScale,this._transitionFinished=!1):(this.time=0,this._transitionFinished=!0,this.target.scale=this._originalScale);else{var o;o=i?"pressed":"normal",this._applyTransition(o)}t.stopPropagation()}},_onTouchEnded:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,t),this.node.emit("click",this)),this._pressed=!1,this._updateState(),t.stopPropagation())},_zoomUp:function(){this._fromScale=this._originalScale,this._toScale=this._originalScale*this.zoomScale,this.time=0,this._transitionFinished=!1},_zoomBack:function(){this._fromScale=this.target.scale,this._toScale=this._originalScale,this.time=0,this._transitionFinished=!1},_onTouchCancel:function(){this.interactable&&this.enabledInHierarchy&&(this._pressed=!1,this._updateState())},_onMouseMoveIn:function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this.transition!==n.SPRITE||this.hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},_onMouseMoveOut:function(){this._hovered&&(this._hovered=!1,this._updateState())},_updateState:function(){var t=this._getButtonState();this._applyTransition(t),this._updateDisabledState()},onDisable:function(){this._hovered=!1,this._pressed=!1,this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_getButtonState:function(){return this.interactable?this._pressed?"pressed":this._hovered?"hover":"normal":"disabled"},_updateColorTransition:function(t){var e=this[t+"Color"],i=this.target;this._fromColor=i.color.clone(),this._toColor=e,this.time=0,this._transitionFinished=!1},_updateSpriteTransition:function(t){var e=this[t+"Sprite"];this._sprite&&e&&(this._sprite.spriteFrame=e)},_updateScaleTransition:function(t){"pressed"===t?this._zoomUp():this._zoomBack()},_applyTransition:function(t){var e=this.transition;e===n.COLOR?this._updateColorTransition(t):e===n.SPRITE?this._updateSpriteTransition(t):e===n.SCALE&&this._updateScaleTransition(t)},_resizeNodeToTargetNode:!1,_updateDisabledState:function(){this._sprite&&this._sprite._sgNode.setState(0),this.enableAutoGrayEffect&&this.transition!==n.COLOR&&(this.transition===n.SPRITE&&this.disabledSprite||this._sprite&&!this.interactable&&this._sprite._sgNode.setState(1))}});cc.Button=e.exports=o}),{"./CCComponent":53}],52:[(function(t,e,i){var n={getContentSize:function(){return cc.visibleRect},setContentSize:function(t){},_getWidth:function(){return this.getContentSize().width},_getHeight:function(){return this.getContentSize().height}},o=cc.Class({name:"cc.Canvas",extends:t("./CCComponent"),editor:!1,resetInEditor:!1,statics:{instance:null},properties:{_designResolution:cc.size(960,640),designResolution:{get:function(){return cc.size(this._designResolution)},set:function(t){this._designResolution.width=t.width,this._designResolution.height=t.height,this.applySettings()},tooltip:!1},_fitWidth:!1,_fitHeight:!0,fitHeight:{get:function(){return this._fitHeight},set:function(t){this._fitHeight!==t&&(this._fitHeight=t,this.applySettings())},tooltip:!1},fitWidth:{get:function(){return this._fitWidth},set:function(t){this._fitWidth!==t&&(this._fitWidth=t,this.applySettings())},tooltip:!1}},ctor:function(){this._thisOnResized=cc.EventListener.create({event:cc.EventListener.CUSTOM,eventName:"window-resize",callback:this.onResized.bind(this)}),this._thisOnResized.retain()},__preload:function(){if(o.instance)return cc.errorID(6700,this.node.name,o.instance.node.name);if(o.instance=this,this.node._sizeProvider);else this.node._sizeProvider=n;cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),cc.eventManager.addListener(this._thisOnResized,1),this.applySettings(),this.onResized()},onDestroy:function(){this.node._sizeProvider===n&&(this.node._sizeProvider=null),cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),cc.eventManager.removeListener(this._thisOnResized),this._thisOnResized.release(),o.instance===this&&(o.instance=null)},alignWithScreen:function(){var t,e=cc.visibleRect,i=0,n=0;!this.fitHeight&&!this.fitWidth&&(i=.5*((t=cc.view.getDesignResolutionSize()).width-e.width),n=.5*(t.height-e.height)),this.node.setPosition(.5*e.width+i,.5*e.height+n)},onResized:function(){this.alignWithScreen()},applySettings:function(){var t,e=cc.ResolutionPolicy;t=this.fitHeight&&this.fitWidth?e.SHOW_ALL:this.fitHeight||this.fitWidth?this.fitWidth?e.FIXED_WIDTH:e.FIXED_HEIGHT:e.NO_BORDER;var i=this._designResolution;cc.view.setDesignResolutionSize(i.width,i.height,t)}});cc.Canvas=e.exports=o}),{"./CCComponent":53}],53:[(function(i,n,o){var r=i("../platform/CCObject"),s=i("../platform/js"),c=new(i("../platform/id-generater"))("Comp"),a=r.Flags.IsOnEnableCalled,h=r.Flags.IsOnLoadCalled,l=cc.Class({name:"cc.Component",extends:r,ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this.__eventTargets=[]},properties:{node:{default:null,visible:!1},name:{get:function(){if(this._name)return this._name;var t=cc.js.getClassName(this),e=t.lastIndexOf(".");return e>=0&&(t=t.slice(e+1)),this.node.name+"<"+t+">"},set:function(t){this._name=t},visible:!1},_id:{default:"",serializable:!1},uuid:{get:function(){var t=this._id;return t||(t=this._id=c.getNewId()),t},visible:!1},__scriptAsset:!1,_enabled:!0,enabled:{get:function(){return this._enabled},set:function(t){if(this._enabled!==t&&(this._enabled=t,this.node._activeInHierarchy)){var e=cc.director._compScheduler;t?e.enableComp(this):e.disableComp(this)}},visible:!1},enabledInHierarchy:{get:function(){return(this._objFlags&a)>0},visible:!1},_isOnLoadCalled:{get:function(){return this._objFlags&h}}},update:null,lateUpdate:null,__preload:null,onLoad:null,start:null,onEnable:null,onDisable:null,onDestroy:null,onFocusInEditor:null,onLostFocusInEditor:null,resetInEditor:null,addComponent:function(t){return this.node.addComponent(t)},getComponent:function(t){return this.node.getComponent(t)},getComponents:function(t){return this.node.getComponents(t)},getComponentInChildren:function(t){return this.node.getComponentInChildren(t)},getComponentsInChildren:function(t){return this.node.getComponentsInChildren(t)},_getLocalBounds:null,onRestore:null,destroy:function(){this._super()&&this._enabled&&this.node._activeInHierarchy&&cc.director._compScheduler.disableComp(this)},_onPreDestroy:function(){this.unscheduleAllCallbacks();for(var t=this.__eventTargets,e=0,i=t.length;e<i;++e){var n=t[e];n&&n.targetOff(this)}t.length=0,cc.director._nodeActivator.destroyComp(this),this.node._removeComponent(this)},_instantiate:function(t){return t||(t=cc.instantiate._clone(this,this)),t.node=null,t},isRunning:function(){return this.enabledInHierarchy},schedule:function(t,e,i,n){cc.assertID(t,1619),cc.assertID(e>=0,1620),e=e||0,i=isNaN(i)?cc.macro.REPEAT_FOREVER:i,n=n||0,cc.director.getScheduler().schedule(t,this,e,i,n,!this.enabledInHierarchy)},scheduleOnce:function(t,e){this.schedule(t,0,0,e)},unschedule:function(t){t&&cc.director.getScheduler().unschedule(t,this)},unscheduleAllCallbacks:function(){cc.director.getScheduler().unscheduleAllForTarget(this)}});l._requireComponent=null,l._executionOrder=0,s.value(l,"_registerEditorProps",(function(i,n){var o=n.requireComponent;o&&(i._requireComponent=o);var r=n.executionOrder;r&&"number"===("object"==(e=typeof r)?t(r):e)&&(i._executionOrder=r)})),l.prototype.__scriptUuid="",cc.Component=n.exports=l}),{"../platform/CCObject":140,"../platform/id-generater":147,"../platform/js":151}],54:[(function(i,n,o){cc.Component.EventHandler=cc.Class({name:"cc.ClickEvent",properties:{target:{default:null,type:cc.Node},component:{default:""},handler:{default:""},customEventData:{default:""}},statics:{emitEvents:function(t){"use strict";var e,i,n;if(arguments.length>0)for(i=0,n=(e=new Array(arguments.length-1)).length;i<n;i++)e[i]=arguments[i+1];for(i=0,n=t.length;i<n;i++){var o=t[i];o instanceof cc.Component.EventHandler&&o.emit(e)}}},emit:function(i){var n=this.target;if(cc.isValid(n)){var o=n.getComponent(this.component);if(cc.isValid(o)){var r=o[this.handler];"function"===("object"==(e=typeof r)?t(r):e)&&(null!=this.customEventData&&""!==this.customEventData&&(i=i.slice()).push(this.customEventData),r.apply(o,i))}}}})}),{}],55:[(function(t,e,i){t("../editbox/CCSGEditBox");var n=_ccsg.EditBox.KeyboardReturnType,o=_ccsg.EditBox.InputMode,r=_ccsg.EditBox.InputFlag,s=cc.Class({name:"cc.EditBox",extends:cc._RendererUnderSG,editor:!1,properties:{_useOriginalSize:!0,_string:"",string:{tooltip:!1,get:function(){return this._sgNode.string},set:function(t){this._sgNode.string=this._string=t}},backgroundImage:{tooltip:!1,default:null,type:cc.SpriteFrame,notify:function(){var t=this._sgNode,e=t.getBackgroundSprite();this.backgroundImage?this._createBackgroundSprite().setContentSize(t.getContentSize()):e.removeFromParent()}},returnType:{default:n.DEFAULT,tooltip:!1,displayName:"KeyboardReturnType",type:n,notify:function(){this._sgNode.returnType=this.returnType}},inputFlag:{tooltip:!1,default:r.DEFAULT,type:r,notify:function(){this._sgNode.inputFlag=this.inputFlag}},inputMode:{tooltip:!1,default:o.ANY,type:o,notify:function(){this._sgNode.inputMode=this.inputMode}},fontSize:{tooltip:!1,default:20,notify:function(){this._sgNode.fontSize=this.fontSize}},lineHeight:{tooltip:!1,default:40,notify:function(){this._sgNode.setLineHeight(this.lineHeight)}},fontColor:{tooltip:!1,default:cc.Color.WHITE,notify:function(){this._sgNode.fontColor=this.fontColor}},placeholder:{tooltip:!1,default:"Enter text here...",notify:function(){this._sgNode.placeholder=this.placeholder}},placeholderFontSize:{tooltip:!1,default:20,notify:function(){this._sgNode.placeholderFontSize=this.placeholderFontSize}},placeholderFontColor:{tooltip:!1,default:cc.Color.GRAY,notify:function(){this._sgNode.placeholderFontColor=this.placeholderFontColor}},maxLength:{tooltip:!1,default:20,notify:function(){this._sgNode.maxLength=this.maxLength}},stayOnTop:{tooltip:!1,default:!1,notify:function(){}},_tabIndex:0,tabIndex:{tooltip:!1,get:function(){return this._tabIndex},set:function(t){this._tabIndex=t,this._sgNode.setTabIndex(t)}},editingDidBegan:{default:[],type:cc.Component.EventHandler},textChanged:{default:[],type:cc.Component.EventHandler},editingDidEnded:{default:[],type:cc.Component.EventHandler},editingReturn:{default:[],type:cc.Component.EventHandler}},statics:{KeyboardReturnType:n,InputFlag:r,InputMode:o},_applyCapInset:function(t){var e=this.backgroundImage;t.setInsetTop(e.insetTop),t.setInsetBottom(e.insetBottom),t.setInsetRight(e.insetRight),t.setInsetLeft(e.insetLeft)},_createSgNode:function(){return new _ccsg.EditBox(cc.size(160,40))},_createBackgroundSprite:function(){var t=this._sgNode,e=new cc.Scale9Sprite;return e.setRenderingType(cc.Scale9Sprite.RenderingType.SLICED),this.backgroundImage&&(this.backgroundImage.ensureLoadTexture(),e.setSpriteFrame(this.backgroundImage),this._applyCapInset(e)),t.initWithSizeAndBackgroundSprite(cc.size(160,40),e),e},_initSgNode:function(){var t=this._sgNode;this._createBackgroundSprite(),t.setContentSize(this.node.getContentSize()),t.inputMode=this.inputMode,t.maxLength=this.maxLength,t.string=this._string,t.fontSize=this.fontSize,t.fontColor=this.fontColor,t.placeholder=this.placeholder,t.placeholderFontSize=this.placeholderFontSize,t.placeholderFontColor=this.placeholderFontColor,t.inputFlag=this.inputFlag,t.returnType=this.returnType,t.setLineHeight(this.lineHeight),t.stayOnTop(this.stayOnTop),t.setTabIndex(this.tabIndex),t.setDelegate(this)},editBoxEditingDidBegan:function(){cc.Component.EventHandler.emitEvents(this.editingDidBegan,this),this.node.emit("editing-did-began",this)},editBoxEditingDidEnded:function(){cc.Component.EventHandler.emitEvents(this.editingDidEnded,this),this.node.emit("editing-did-ended",this)},editBoxTextChanged:function(t,e){cc.Component.EventHandler.emitEvents(this.textChanged,e,this),this.node.emit("text-changed",this)},editBoxEditingReturn:function(){cc.Component.EventHandler.emitEvents(this.editingReturn,this),this.node.emit("editing-return",this)},onDestroy:function(){this._sgNode.setDelegate(null),this._super()},__preload:function(){this._super(),this._registerEvent()},_registerEvent:function(){},_onTouchBegan:function(t){this._sgNode&&this._sgNode._onTouchBegan(t.touch),t.stopPropagation()},_onTouchEnded:function(t){this._sgNode&&this._sgNode._onTouchEnded(),t.stopPropagation()},setFocus:function(){this._sgNode&&this._sgNode.setFocus()},isFocused:function(){var t=!1;return this._sgNode&&(t=this._sgNode.isFocused()),t}});s.prototype.editBoxEditingDidBegin=function(t){this.editBoxEditingDidBegan(t)},s.prototype.editBoxEditingDidEnd=function(t){this.editBoxEditingDidEnded(t)},cc.EditBox=e.exports=s}),{"../editbox/CCSGEditBox":218}],56:[(function(i,n,o){i("../label/CCSGLabel"),i("../label/CCSGLabelCanvasRenderCmd"),i("../label/CCSGLabelWebGLRenderCmd");var r=cc.TextAlignment,s=cc.VerticalTextAlignment,c=_ccsg.Label.Overflow,a=cc.Class({name:"cc.Label",extends:cc._RendererUnderSG,ctor:function(){},editor:!1,_updateSgNodeString:function(){this._sgNode.setString(this.string),this._updateNodeSize()},_updateSgNodeFontSize:function(){this._sgNode&&(this._sgNode.setFontSize(this._fontSize),this._updateNodeSize())},properties:{_useOriginalSize:!0,string:{default:"Label",multiline:!0,tooltip:!1,notify:function(){this._sgNode&&this._updateSgNodeString()}},horizontalAlign:{default:r.LEFT,type:r,tooltip:!1,notify:function(){this._sgNode&&this._sgNode.setHorizontalAlign(this.horizontalAlign)},animatable:!1},verticalAlign:{default:s.TOP,type:s,tooltip:!1,notify:function(){this._sgNode&&this._sgNode.setVerticalAlign(this.verticalAlign)},animatable:!1},_actualFontSize:{default:40},actualFontSize:{displayName:"Actual Font Size",animatable:!1,readonly:!0,get:function(){return this._sgNode&&(this._actualFontSize=this._sgNode.getFontSize()),this._actualFontSize}},_fontSize:40,fontSize:{get:function(){return this._fontSize},set:function(t){this._fontSize=t,this._updateSgNodeFontSize()},tooltip:!1},fontFamily:{default:"Arial",tooltip:!1,notify:function(){this._sgNode&&this._sgNode.setFontFamily(this.fontFamily)},animatable:!1},_lineHeight:40,lineHeight:{get:function(){return this._sgNode&&(this._lineHeight=this._sgNode.getLineHeight()),this._lineHeight},set:function(t){this._lineHeight=t,this._sgNode&&(this._sgNode.setLineHeight(t),this._updateNodeSize())},tooltip:!1},overflow:{default:c.NONE,type:c,tooltip:!1,notify:function(){this._sgNode&&(this._sgNode.setOverflow(this.overflow),this._updateNodeSize())},animatable:!1},_enableWrapText:!0,enableWrapText:{get:function(){return this._sgNode&&(this._enableWrapText=this._sgNode.isWrapTextEnabled()),this._enableWrapText},set:function(t){this._enableWrapText=t,this._sgNode&&this._sgNode.enableWrapText(t)},animatable:!1,tooltip:!1},_N$file:null,font:{get:function(){return this._N$file},set:function(i){if(i||(this._isSystemFontUsed=!0),this._N$file=i,this._bmFontOriginalSize=-1,i&&this._isSystemFontUsed&&(this._isSystemFontUsed=!1),this._sgNode){"string"===("object"==(e=typeof i)?t(i):e)&&cc.warnID(4e3);var n=this.font;n instanceof cc.BitmapFont?n.spriteFrame?n.spriteFrame.textureLoaded()?this._sgNode.setFontAsset(n):(cc.warnID(4012,n.name),this._sgNode.setFontFamily("")):(cc.warnID(4011,n.name),this._sgNode.setFontFamily("")):this._sgNode.setFontAsset(n)}i instanceof cc.BitmapFont&&(this._bmFontOriginalSize=i.fontSize)},type:cc.Font,tooltip:!1,animatable:!1},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(t){this._isSystemFontUsed=!!t,t&&(this.font=null,this._sgNode&&this._sgNode.setFontFamily(this.fontFamily))},animatable:!1,tooltip:!1},_bmFontOriginalSize:{displayName:"BMFont Original Size",default:-1,serializable:!1,readonly:!0,visible:!0,animatable:!1},_spacingX:0,spacingX:{get:function(){return this._spacingX},set:function(t){this._spacingX=t,this._sgNode&&(this._sgNode.setSpacingX(this.spacingX),this._updateNodeSize())}}},statics:{HorizontalAlign:r,VerticalAlign:s,Overflow:c},__preload:function(){this._super(),this._updateNodeSize()},_createSgNode:function(){return null},_initSgNode:function(){var i=this.font;"string"===("object"==(e=typeof i)?t(i):e)&&cc.warnID(4e3);var n;i instanceof cc.BitmapFont?i.spriteFrame?i.spriteFrame.textureLoaded()?n=this._sgNode=new _ccsg.Label(this.string,JSON.stringify(i._fntConfig),i.spriteFrame):(cc.warnID(4012,i.name),n=this._sgNode=new _ccsg.Label(this.string,null,null,this._fontSize)):(cc.warnID(4011,i.name),n=this._sgNode=_ccsg.Label.pool.get(this.string)):n=this._sgNode=_ccsg.Label.pool.get(this.string,i,null,this._fontSize),n.retain(),i instanceof cc.BitmapFont&&(this._bmFontOriginalSize=i.fontSize),n.setVisible(!1),n.setHorizontalAlign(this.horizontalAlign),n.setVerticalAlign(this.verticalAlign),n.setFontSize(this._fontSize),this.useSystemFont&&n.setFontFamily(this.fontFamily),n.setOverflow(this.overflow),n.enableWrapText(this._enableWrapText),n.setLineHeight(this._lineHeight),n.setString(this.string),i instanceof cc.BitmapFont&&n.setSpacingX(this.spacingX),n.setContentSize(this.node.getContentSize()),n.setColor(this.node.color)},_updateNodeSize:function(){this._sgNode&&this._sgNode.parent&&(this.overflow!==c.NONE&&this.overflow!==c.RESIZE_HEIGHT||this.node.setContentSize(this._sgNode.getContentSize()))},onDestroy:function(){var t=this._sgNode;this._super(),t&&(t.removeFromParent(!0),_ccsg.Label.pool.put(t))}});cc.Label=n.exports=a}),{"../label/CCSGLabel":218,"../label/CCSGLabelCanvasRenderCmd":218,"../label/CCSGLabelWebGLRenderCmd":218}],57:[(function(t,e,i){var n=cc.Class({name:"cc.LabelOutline",extends:t("./CCComponent"),editor:!1,ctor:function(){this._labelSGNode=null},properties:{_color:cc.color(255,255,255,255),_width:1,color:{get:function(){return this._color},set:function(t){this._color=cc.color(t),this._labelSGNode&&this._labelSGNode.setOutlineColor(cc.color(this._color))}},width:{get:function(){return this._width},set:function(t){this._width=t,this._labelSGNode&&(this._labelSGNode.setOutlineWidth(t),this._labelSGNode.setMargin(t))}}},onEnable:function(){var t=this.node.getComponent("cc.Label"),e=this._labelSGNode=t&&t._sgNode;this._labelSGNode&&(e.setOutlined(!0),e.setOutlineColor(cc.color(this._color)),e.setOutlineWidth(this._width),e.setMargin(this._width))},onDisable:function(){this._labelSGNode&&(this._labelSGNode.setOutlined(!1),this._labelSGNode.setMargin(0)),this._labelSGNode=null}});cc.LabelOutline=e.exports=n}),{"./CCComponent":53}],58:[(function(t,e,i){var n=cc.Enum({NONE:0,HORIZONTAL:1,VERTICAL:2,GRID:3}),o=cc.Enum({NONE:0,CONTAINER:1,CHILDREN:2}),r=cc.Enum({HORIZONTAL:0,VERTICAL:1}),s=cc.Enum({BOTTOM_TO_TOP:0,TOP_TO_BOTTOM:1}),c=cc.Enum({LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1}),a=cc.Class({name:"cc.Layout",extends:t("./CCComponent"),editor:!1,properties:{_layoutSize:cc.size(300,200),_layoutDirty:{default:!0,serializable:!1},_resize:o.NONE,_N$layoutType:n.NONE,type:{type:n,get:function(){return this._N$layoutType},set:function(t){this._N$layoutType=t,this._doLayoutDirty()},tooltip:!1,animatable:!1},resizeMode:{type:o,tooltip:!1,animatable:!1,get:function(){return this._resize},set:function(t){this.type===n.NONE&&t===o.CHILDREN||(this._resize=t,this._doLayoutDirty())}},cellSize:{default:cc.size(40,40),tooltip:!1,type:cc.Size,notify:function(){this._doLayoutDirty()}},startAxis:{default:r.HORIZONTAL,tooltip:!1,type:r,notify:function(){this._doLayoutDirty()},animatable:!1},_N$padding:{default:0},paddingLeft:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingRight:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingTop:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingBottom:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},spacingX:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},spacingY:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},verticalDirection:{default:s.TOP_TO_BOTTOM,type:s,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1},horizontalDirection:{default:c.LEFT_TO_RIGHT,type:c,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1}},statics:{Type:n,VerticalDirection:s,HorizontalDirection:c,ResizeMode:o,AxisDirection:r},_migratePaddingData:function(){this.paddingLeft=this._N$padding,this.paddingRight=this._N$padding,this.paddingTop=this._N$padding,this.paddingBottom=this._N$padding,this._N$padding=0},onEnable:function(){this._addEventListeners(),cc.sizeEqualToSize(this.node.getContentSize(),cc.size(0,0))&&this.node.setContentSize(this._layoutSize),0!==this._N$padding&&this._migratePaddingData(),this._doLayoutDirty()},onDisable:function(){this._removeEventListeners()},_doLayoutDirty:function(){this._layoutDirty=!0},_addEventListeners:function(){cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this._updateLayout,this),this.node.on("size-changed",this._resized,this),this.node.on("anchor-changed",this._doLayoutDirty,this),this.node.on("child-added",this._childAdded,this),this.node.on("child-removed",this._childRemoved,this),this.node.on("child-reorder",this._doLayoutDirty,this),this._addChildrenEventListeners()},_removeEventListeners:function(){cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this._updateLayout,this),this.node.off("size-changed",this._resized,this),this.node.off("anchor-changed",this._doLayoutDirty,this),this.node.off("child-added",this._childAdded,this),this.node.off("child-removed",this._childRemoved,this),this.node.off("child-reorder",this._doLayoutDirty,this),this._removeChildrenEventListeners()},_addChildrenEventListeners:function(){this.node.children.forEach(function(t){t.on("size-changed",this._doLayoutDirty,this),t.on("position-changed",this._doLayoutDirty,this),t.on("anchor-changed",this._doLayoutDirty,this),t.on("active-in-hierarchy-changed",this._doLayoutDirty,this)}.bind(this))},_removeChildrenEventListeners:function(){this.node.children.forEach(function(t){t.off("size-changed",this._doLayoutDirty,this),t.off("position-changed",this._doLayoutDirty,this),t.off("anchor-changed",this._doLayoutDirty,this),t.off("active-in-hierarchy-changed",this._doLayoutDirty,this)}.bind(this))},_childAdded:function(t){var e=t.detail;e.on("size-changed",this._doLayoutDirty,this),e.on("position-changed",this._doLayoutDirty,this),e.on("anchor-changed",this._doLayoutDirty,this),e.on("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_childRemoved:function(t){var e=t.detail;e.off("size-changed",this._doLayoutDirty,this),e.off("position-changed",this._doLayoutDirty,this),e.off("anchor-changed",this._doLayoutDirty,this),e.off("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_resized:function(){this._layoutSize=this.node.getContentSize(),this._doLayoutDirty()},_doLayoutHorizontally:function(t,e,i,r){var a=this.node.getAnchorPoint(),h=this.node.children,l=1,u=this.paddingLeft,d=-a.x*t;this.horizontalDirection===c.RIGHT_TO_LEFT&&(l=-1,d=(1-a.x)*t,u=this.paddingRight);var p=d+l*u-l*this.spacingX,_=0,f=0,g=0,v=0,y=0,m=0,b=this.cellSize.width;return this.type!==n.GRID&&this.resizeMode===o.CHILDREN&&(b=(t-(this.paddingLeft+this.paddingRight)-(h.length-1)*this.spacingX)/h.length),h.forEach(function(h){if(h.activeInHierarchy){this._resize===o.CHILDREN&&(h.width=b,this.type===n.GRID&&(h.height=this.cellSize.height));var C=h.anchorX;g>f&&(f=g),h.height>=f&&(g=f,f=h.height,m=h.getAnchorPoint().y),this.horizontalDirection===c.RIGHT_TO_LEFT&&(C=1-h.anchorX),p=p+l*C*h.width+l*this.spacingX;var T=l*(1-C)*h.width;if(e){var S=p+T+l*(l>0?this.paddingRight:this.paddingLeft),E=this.horizontalDirection===c.LEFT_TO_RIGHT&&S>(1-a.x)*t,x=this.horizontalDirection===c.RIGHT_TO_LEFT&&S<-a.x*t;(E||x)&&(h.height>=f?(0===g&&(g=f),_+=g,g=f):(_+=f,g=h.height,f=0),p=d+l*(u+C*h.width),v++)}var A=i(h,_,v);t>=h.width+this.paddingLeft+this.paddingRight&&r&&h.setPosition(cc.p(p,A));var w,O=1,I=0===f?h.height:f;this.verticalDirection===s.TOP_TO_BOTTOM?(y=y||this.node._contentSize.height,(w=A+(O=-1)*(I*m+this.paddingBottom))<y&&(y=w)):(y=y||-this.node._contentSize.height,(w=A+O*(I*m+this.paddingTop))>y&&(y=w)),p+=T}}.bind(this)),y},_getVerticalBaseHeight:function(t){var e=0,i=0;return this.resizeMode===o.CONTAINER?(t.forEach((function(t){t.activeInHierarchy&&(i++,e+=t.height)})),e+=(i-1)*this.spacingY+this.paddingBottom+this.paddingTop):e=this.node.getContentSize().height,e},_doLayoutVertically:function(t,e,i,r){var a=this.node.getAnchorPoint(),h=this.node.children,l=1,u=this.paddingBottom,d=-a.y*t;this.verticalDirection===s.TOP_TO_BOTTOM&&(l=-1,d=(1-a.y)*t,u=this.paddingTop);var p=d+l*u-l*this.spacingY,_=0,f=0,g=0,v=0,y=0,m=0,b=this.cellSize.height;return this.type!==n.GRID&&this.resizeMode===o.CHILDREN&&(b=(t-(this.paddingTop+this.paddingBottom)-(h.length-1)*this.spacingY)/h.length),h.forEach(function(h){if(h.activeInHierarchy){this.resizeMode===o.CHILDREN&&(h.height=b,this.type===n.GRID&&(h.width=this.cellSize.width));var C=h.anchorY;g>f&&(f=g),h.width>=f&&(g=f,f=h.width,m=h.getAnchorPoint().x),this.verticalDirection===s.TOP_TO_BOTTOM&&(C=1-h.anchorY),p=p+l*C*h.height+l*this.spacingY;var T=l*(1-C)*h.height;if(e){var S=p+T+l*(l>0?this.paddingTop:this.paddingBottom),E=this.verticalDirection===s.BOTTOM_TO_TOP&&S>(1-a.y)*t,x=this.verticalDirection===s.TOP_TO_BOTTOM&&S<-a.y*t;(E||x)&&(h.width>=f?(0===g&&(g=f),_+=g,g=f):(_+=f,g=h.width,f=0),p=d+l*(u+C*h.height),v++)}var A=i(h,_,v);t>=h.height+(this.paddingTop+this.paddingBottom)&&r&&h.setPosition(cc.p(A,p));var w,O=1,I=0===f?h.width:f;this.horizontalDirection===c.RIGHT_TO_LEFT?(O=-1,y=y||this.node._contentSize.width,(w=A+O*(I*m+this.paddingLeft))<y&&(y=w)):(y=y||-this.node._contentSize.width,(w=A+O*(I*m+this.paddingRight))>y&&(y=w)),p+=T}}.bind(this)),y},_doLayoutBasic:function(){var t=null;if(this.node.children.forEach((function(e){e.activeInHierarchy&&(t=t?cc.rectUnion(t,e.getBoundingBoxToWorld()):e.getBoundingBoxToWorld())})),t){var e=this.node.parent.convertToNodeSpaceAR(cc.p(t.x,t.y));e=cc.pAdd(e,cc.p(-this.paddingLeft,-this.paddingBottom));var i=this.node.parent.convertToNodeSpaceAR(cc.p(t.x+t.width,t.y+t.height));i=cc.pAdd(i,cc.p(this.paddingRight,this.paddingTop));var n=cc.size(parseFloat((i.x-e.x).toFixed(2)),parseFloat((i.y-e.y).toFixed(2))),o=this.node.getPosition(),r=(o.x-e.x)/n.width,s=(o.y-e.y)/n.height,c=cc.p(parseFloat(r.toFixed(2)),parseFloat(s.toFixed(2)));this.node.setAnchorPoint(c),this.node.setContentSize(n)}},_doLayoutGridAxisHorizontal:function(t,e){var i=e.width,n=1,r=-t.y*e.height,c=this.paddingBottom;this.verticalDirection===s.TOP_TO_BOTTOM&&(n=-1,r=(1-t.y)*e.height,c=this.paddingTop);var a=function(t,e,i){return r+n*(e+t.anchorY*t.height+c+i*this.spacingY)}.bind(this),h=0;if(this.resizeMode===o.CONTAINER){var l=this._doLayoutHorizontally(i,!0,a,!1);(h=r-l)<0&&(h*=-1),r=-t.y*h,this.verticalDirection===s.TOP_TO_BOTTOM&&(n=-1,r=(1-t.y)*h)}this._doLayoutHorizontally(i,!0,a,!0),this.resizeMode===o.CONTAINER&&this.node.setContentSize(i,h)},_doLayoutGridAxisVertical:function(t,e){var i=e.height,n=1,r=-t.x*e.width,s=this.paddingLeft;this.horizontalDirection===c.RIGHT_TO_LEFT&&(n=-1,r=(1-t.x)*e.width,s=this.paddingRight);var a=function(t,e,i){return r+n*(e+t.anchorX*t.width+s+i*this.spacingX)}.bind(this),h=0;if(this.resizeMode===o.CONTAINER){var l=this._doLayoutVertically(i,!0,a,!1);(h=r-l)<0&&(h*=-1),r=-t.x*h,this.horizontalDirection===c.RIGHT_TO_LEFT&&(n=-1,r=(1-t.x)*h)}this._doLayoutVertically(i,!0,a,!0),this.resizeMode===o.CONTAINER&&this.node.setContentSize(h,i)},_doLayoutGrid:function(){var t=this.node.getAnchorPoint(),e=this.node.getContentSize();this.startAxis===r.HORIZONTAL?this._doLayoutGridAxisHorizontal(t,e):this.startAxis===r.VERTICAL&&this._doLayoutGridAxisVertical(t,e)},_getHorizontalBaseWidth:function(t){var e=0,i=0;return this.resizeMode===o.CONTAINER?(t.forEach((function(t){t.activeInHierarchy&&(i++,e+=t.width)})),e+=(i-1)*this.spacingX+this.paddingLeft+this.paddingRight):e=this.node.getContentSize().width,e},_doLayout:function(){if(this.type===n.HORIZONTAL){var t=this._getHorizontalBaseWidth(this.node.children),e=function(t){return t.y};this._doLayoutHorizontally(t,!1,e,!0),this.node.width=t}else if(this.type===n.VERTICAL){var i=this._getVerticalBaseHeight(this.node.children),r=function(t){return t.x};this._doLayoutVertically(i,!1,r,!0),this.node.height=i}else this.type===n.NONE?this.resizeMode===o.CONTAINER&&this._doLayoutBasic():this.type===n.GRID&&this._doLayoutGrid()},_updateLayout:function(){this._layoutDirty&&this.node.children.length>0&&(this._doLayout(),this._layoutDirty=!1)}});Object.defineProperty(a.prototype,"padding",{get:function(){return cc.warnID(4100),this.paddingLeft},set:function(t){this._N$padding=t,this._migratePaddingData(),this._doLayoutDirty()}}),cc.Layout=e.exports=a}),{"./CCComponent":53}],59:[(function(t,e,i){t("../../clipping-nodes/CCClippingNode"),t("../../clipping-nodes/CCClippingNodeCanvasRenderCmd"),t("../../clipping-nodes/CCClippingNodeWebGLRenderCmd");var n=cc._RendererInSG,o=cc.Enum({RECT:0,ELLIPSE:1,IMAGE_STENCIL:2}),r=cc.Class({name:"cc.Mask",extends:n,editor:!1,properties:{_clippingStencil:{default:null,serializable:!1},_type:o.RECT,type:{get:function(){return this._type},set:function(t){this._type=t,this._refreshStencil()},type:o,tooltip:!1},spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1,notify:function(){this._refreshStencil()}},alphaThreshold:{default:1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){cc._renderType!==cc.game.RENDER_TYPE_CANVAS?this._sgNode.setAlphaThreshold(this.alphaThreshold):cc.warnID(4201)}},inverted:{default:!1,type:cc.Boolean,tooltip:!1,notify:function(){cc._renderType!==cc.game.RENDER_TYPE_CANVAS?this._sgNode.setInverted(this.inverted):cc.warnID(4202)}},_segements:64,segements:{get:function(){return this._segements},set:function(t){this._segements=cc.clampf(t,3,1e4),this._refreshStencil()},tooltip:!1},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}}},statics:{Type:o},_resizeNodeToTargetNode:!1,_initSgNode:function(){},_createSgNode:function(){return new cc.ClippingNode},_hitTest:function(t){var e=this.node.getContentSize(),i=e.width,n=e.height,r=this.node.getNodeToWorldTransform();if(this.type===o.RECT||this.type===o.IMAGE_STENCIL){var s=cc.rect(0,0,i,n);cc._rectApplyAffineTransformIn(s,r);var c=t.x-s.x,a=s.x+s.width-t.x,h=t.y-s.y,l=s.y+s.height-t.y;return c>=0&&a>=0&&l>=0&&h>=0}if(this.type===o.ELLIPSE){var u=i/2,d=n/2,p=r.a*u+r.c*d+r.tx,_=r.b*u+r.d*d+r.ty,f=t.x-p,g=t.y-_;return f*f/(u*u)+g*g/(d*d)<1}},onEnable:function(){this._super(),this.spriteFrame&&this.spriteFrame.ensureLoadTexture(),this._refreshStencil(),this.node.on("size-changed",this._refreshStencil,this),this.node.on("anchor-changed",this._refreshStencil,this)},onDisable:function(){this._super(),this.node.off("size-changed",this._refreshStencil,this),this.node.off("anchor-changed",this._refreshStencil,this)},_calculateCircle:function(t,e,i){for(var n=[],o=2*Math.PI/i,r=0;r<i;++r)n.push(cc.v2(e.x*Math.cos(o*r)+t.x,e.y*Math.sin(o*r)+t.y));return n},_refreshStencil:function(){if(this.type===o.IMAGE_STENCIL&&(cc._renderType,cc.game.RENDER_TYPE_WEBGL),1){var t=this.node.getContentSize(),e=this.node.getAnchorPoint(),i=this._clippingStencil;if(this._type===o.IMAGE_STENCIL)i instanceof cc.Scale9Sprite&&i._spriteFrame===this.spriteFrame||((i=new cc.Scale9Sprite).setSpriteFrame(this.spriteFrame),this._sgNode.setStencil(i)),i.setContentSize(t),i.setAnchorPoint(e),this._sgNode.setAlphaThreshold(this.alphaThreshold);else{i instanceof cc.DrawNode||((i=new cc.DrawNode).retain(),this._sgNode.setStencil(i));var n=t.width,r=t.height,s=-n*e.x,c=-r*e.y,a=cc.color(255,255,255,0);if(i.clear(),this._type===o.RECT){var h=[cc.v2(s,c),cc.v2(s+n,c),cc.v2(s+n,c+r),cc.v2(s,c+r)];i.drawPoly(h,a,0,a)}else if(this._type===o.ELLIPSE){var l=cc.v2(s+n/2,c+r/2),u={x:n/2,y:r/2};i.drawPoly(this._calculateCircle(l,u,this._segements),a,0,a)}}this._sgNode.setInverted(this.inverted),this._clippingStencil=i}else cc.warnID(4200)}});r.prototype.__superOnDestroy=n.prototype.onDestroy,r.prototype.onDestroy=function(){this.__superOnDestroy(),this._clippingStencil&&(this._clippingStencil.release(),this._clippingStencil=null)},cc.Mask=e.exports=r}),{"../../clipping-nodes/CCClippingNode":218,"../../clipping-nodes/CCClippingNodeCanvasRenderCmd":218,"../../clipping-nodes/CCClippingNodeWebGLRenderCmd":218}],60:[(function(t,e,i){var n=cc.Enum({Unified:0,Free:1}),o=cc.Enum({Horizontal:0,Vertical:1}),r=cc.Enum({PAGE_TURNING:0}),s=cc.Class({name:"cc.PageView",extends:cc.ScrollView,editor:!1,ctor:function(){this._curPageIdx=0,this._lastPageIdx=0,this._pages=[],this._scrollCenterOffsetX=[],this._scrollCenterOffsetY=[]},properties:{sizeMode:{default:n.Unified,type:n,tooltip:!1,notify:function(){this._syncSizeMode()}},direction:{default:o.Horizontal,type:o,tooltip:!1,notify:function(){this._syncScrollDirection()}},scrollThreshold:{default:.5,type:cc.Float,slide:!0,range:[0,1,.01],tooltip:!1},autoPageTurningThreshold:{default:100,type:cc.Float,tooltip:!1},pageTurningEventTiming:{default:.1,type:cc.Float,range:[0,1,.01],tooltip:!1},indicator:{default:null,type:cc.PageViewIndicator,tooltip:!1,notify:function(){this.indicator&&this.indicator.setPageView(this)}},pageTurningSpeed:{default:.3,type:cc.Float,tooltip:!1},pageEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{SizeMode:n,Direction:o,EventType:r},__preload:function(){this.node.on("size-changed",this._updateAllPagesSize,this)},onEnable:function(){this._super(),this.node.on("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onDisable:function(){this._super(),this.node.off("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onLoad:function(){this._initPages(),this.indicator&&this.indicator.setPageView(this)},onDestroy:function(){this.node.off("size-changed",this._updateAllPagesSize,this)},getCurrentPageIndex:function(){return this._curPageIdx},setCurrentPageIndex:function(t){this.scrollToPage(t,!0)},getPages:function(){return this._pages},addPage:function(t){t&&-1===this._pages.indexOf(t)&&this.content&&(this.content.addChild(t),this._pages.push(t),this._updatePageView())},insertPage:function(t,e){e<0||!t||-1!==this._pages.indexOf(t)||!this.content||(e>=this._pages.length?this.addPage(t):(this._pages.splice(e,0,t),this.content.addChild(t),this._updatePageView()))},removePage:function(t){if(t&&this.content){var e=this._pages.indexOf(t);-1!==e?this.removePageAtIndex(e):cc.warnID(4300,t.name)}},removePageAtIndex:function(t){var e=this._pages;if(!(t<0||t>=e.length)){var i=e[t];i&&(this.content.removeChild(i),e.splice(t,1),this._updatePageView())}},removeAllPages:function(){if(this.content){for(var t=this._pages,e=0,i=t.length;e<i;e++)this.content.removeChild(t[e]);this._pages.length=0,this._updatePageView()}},scrollToPage:function(t,e){t<0||t>this._pages.length||(e=void 0!==e?e:.3,this._curPageIdx=t,this.scrollToOffset(this._moveOffsetValue(t),e,!0),this.indicator&&this.indicator._changedState())},getScrollEndedEventTiming:function(){return this.pageTurningEventTiming},_syncScrollDirection:function(){this.horizontal=this.direction===o.Horizontal,this.vertical=this.direction===o.Vertical},_syncSizeMode:function(){if(this.content){var t=this.content.getComponent(cc.Layout);if(t){if(0===this._pages.length)t.padding=0;else{var e=this._pages[this._pages.length-1];this.sizeMode===n.Free&&(this.direction===o.Horizontal?(t.paddingLeft=(this.node.width-this._pages[0].width)/2,t.paddingRight=(this.node.width-e.width)/2):this.direction===o.Vertical&&(t.paddingTop=(this.node.height-this._pages[0].height)/2,t.paddingBottom=(this.node.height-e.height)/2))}t._updateLayout()}}},_updatePageView:function(){var t=this._pages.length,e=this.content.getComponent(cc.Layout);e&&e.enabled&&e._updateLayout(),this._curPageIdx>=t&&(this._curPageIdx=0===t?0:t-1,this._lastPageIdx=this._curPageIdx);for(var i=0;i<t;++i)this._pages[i].setSiblingIndex(i),this.direction===o.Horizontal?this._scrollCenterOffsetX[i]=Math.abs(this.content.x+this._pages[i].x):this._scrollCenterOffsetY[i]=Math.abs(this.content.y+this._pages[i].y);this.indicator&&this.indicator._refresh()},_updateAllPagesSize:function(){if(this.sizeMode===n.Unified)for(var t=this._pages,e=this.node.getContentSize(),i=0,o=t.length;i<o;i++)t[i].setContentSize(e)},_initPages:function(){if(this.content){for(var t=this.content.children,e=0;e<t.length;++e){var i=t[e];this._pages.indexOf(i)>=0||this._pages.push(i)}this._syncScrollDirection(),this._syncSizeMode(),this._updatePageView()}},_dispatchPageTurningEvent:function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,cc.Component.EventHandler.emitEvents(this.pageEvents,this,r.PAGE_TURNING),this.node.emit("page-turning",this))},_isScrollable:function(t,e,i){if(this.sizeMode===n.Free){var r,s;if(this.direction===o.Horizontal)return r=this._scrollCenterOffsetX[e],s=this._scrollCenterOffsetX[i],Math.abs(t.x)>=Math.abs(r-s)*this.scrollThreshold;if(this.direction===o.Vertical)return r=this._scrollCenterOffsetY[e],s=this._scrollCenterOffsetY[i],Math.abs(t.y)>=Math.abs(r-s)*this.scrollThreshold}else{if(this.direction===o.Horizontal)return Math.abs(t.x)>=this.node.width*this.scrollThreshold;if(this.direction===o.Vertical)return Math.abs(t.y)>=this.node.height*this.scrollThreshold}},_isQuicklyScrollable:function(t){if(this.direction===o.Horizontal){if(Math.abs(t.x)>this.autoPageTurningThreshold)return!0}else if(this.direction===o.Vertical&&Math.abs(t.y)>this.autoPageTurningThreshold)return!0;return!1},_moveOffsetValue:function(t){var e=cc.p(0,0);return this.sizeMode===n.Free?this.direction===o.Horizontal?e.x=this._scrollCenterOffsetX[t]:this.direction===o.Vertical&&(e.y=this._scrollCenterOffsetY[t]):this.direction===o.Horizontal?e.x=t*this.node.width:this.direction===o.Vertical&&(e.y=t*this.node.height),e},_getDragDirection:function(t){return this.direction===o.Horizontal?0===t.x?0:t.x>0?1:-1:this.direction===o.Vertical?0===t.y?0:t.y<0?1:-1:void 0},_handleReleaseLogic:function(t){var e=this._startBounceBackIfNeeded(),i=cc.pSub(this._touchBeganPosition,this._touchEndPosition);if(e){var n=this._getDragDirection(i);if(0===n)return;this._curPageIdx=n>0?this._pages.length-1:0,this.indicator&&this.indicator._changedState()}else{var o=this._curPageIdx,r=o+this._getDragDirection(i),s=this.pageTurningSpeed*Math.abs(o-r);if(r<this._pages.length){if(this._isScrollable(i,o,r))return void this.scrollToPage(r,s);var c=this._calculateTouchMoveVelocity();if(this._isQuicklyScrollable(c))return void this.scrollToPage(r,s)}this.scrollToPage(o,s)}},_onTouchBegan:function(t,e){this._touchBeganPosition=t.touch.getLocation(),this._super(t,e)},_onTouchMoved:function(t,e){this._super(t,e)},_onTouchEnded:function(t,e){this._touchEndPosition=t.touch.getLocation(),this._super(t,e)},_onTouchCancelled:function(t,e){this._touchEndPosition=t.touch.getLocation(),this._super(t,e)},_onMouseWheel:function(){}});cc.PageView=e.exports=s}),{}],61:[(function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1}),o=cc.Class({name:"cc.PageViewIndicator",extends:t("./CCComponent"),editor:!1,properties:{_layout:null,_pageView:null,_indicators:[],spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1},direction:{default:n.HORIZONTAL,type:n,tooltip:!1},cellSize:{default:cc.size(20,20),tooltip:!1},spacing:{default:0,tooltip:!1}},statics:{Direction:n},onLoad:function(){this._updateLayout()},setPageView:function(t){this._pageView=t,this._refresh()},_updateLayout:function(){this._layout=this.getComponent(cc.Layout),this._layout||(this._layout=this.addComponent(cc.Layout)),this.direction===n.HORIZONTAL?(this._layout.type=cc.Layout.Type.HORIZONTAL,this._layout.spacingX=this.spacing):this.direction===n.VERTICAL&&(this._layout.type=cc.Layout.Type.VERTICAL,this._layout.spacingY=this.spacing),this._layout.resizeMode=cc.Layout.ResizeMode.CONTAINER},_createIndicator:function(){var t=new cc.Node;return t.addComponent(cc.Sprite).spriteFrame=this.spriteFrame,t.parent=this.node,t.width=this.cellSize.width,t.height=this.cellSize.height,t},_changedState:function(){var t=this._indicators;if(0!==t.length){var e=this._pageView._curPageIdx;if(!(e>=t.length)){for(var i=0;i<t.length;++i)t[i].opacity=127.5;t[e].opacity=255}}},_refresh:function(){if(this._pageView){var t=this._indicators,e=this._pageView.getPages();if(e.length!==t.length){var i=0;if(e.length>t.length)for(i=0;i<e.length;++i)t[i]||(t[i]=this._createIndicator());else for(i=t.length-e.length;i>0;--i){var n=t[i-1];this.node.removeChild(n),t.splice(i-1,1)}this._layout&&this._layout.enabledInHierarchy&&this._layout._updateLayout(),this._changedState()}}}});cc.PageViewIndicator=e.exports=o}),{"./CCComponent":53}],62:[(function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1,FILLED:2}),o=cc.Class({name:"cc.ProgressBar",extends:t("./CCComponent"),editor:!1,_initBarSprite:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=this.node.getContentSize(),i=this.node.getAnchorPoint(),o=t.getContentSize();t.parent===this.node&&this.node.setContentSize(o),this.barSprite.fillType===cc.Sprite.FillType.RADIAL&&(this.mode=n.FILLED);var r=t.getContentSize();if(this.mode===n.HORIZONTAL?this.totalLength=r.width:this.mode===n.VERTICAL?this.totalLength=r.height:this.totalLength=this.barSprite.fillRange,t.parent===this.node){var s=-e.width*i.x;t.setPosition(cc.p(s,0))}}},_updateBarStatus:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e,i,o,r=t.getAnchorPoint(),s=t.getContentSize(),c=t.getPosition(),a=cc.p(0,.5),h=cc.clamp01(this.progress),l=this.totalLength*h;switch(this.mode){case n.HORIZONTAL:this.reverse&&(a=cc.p(1,.5)),e=cc.size(l,s.height),i=this.totalLength,o=s.height;break;case n.VERTICAL:a=this.reverse?cc.p(.5,1):cc.p(.5,0),e=cc.size(s.width,l),i=s.width,o=this.totalLength}if(this.mode===n.FILLED)this.barSprite.type!==cc.Sprite.Type.FILLED?cc.warn("ProgressBar FILLED mode only works when barSprite's Type is FILLED!"):(this.reverse&&(l*=-1),this.barSprite.fillRange=l);else if(this.barSprite.type!==cc.Sprite.Type.FILLED){var u=a.x-r.x,d=a.y-r.y,p=cc.p(i*u,o*d);t.setPosition(cc.pAdd(c,p)),t.setAnchorPoint(a),t.setContentSize(e)}else cc.warn("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")}},properties:{barSprite:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._initBarSprite()},animatable:!1},mode:{default:n.HORIZONTAL,type:n,tooltip:!1,notify:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=t.getContentSize();this.mode===n.HORIZONTAL?this.totalLength=e.width:this.mode===n.VERTICAL?this.totalLength=e.height:this.mode===n.FILLED&&(this.totalLength=this.barSprite.fillRange)}},animatable:!1},_N$totalLength:1,totalLength:{range:[0,Number.MAX_VALUE],tooltip:!1,get:function(){return this._N$totalLength},set:function(t){this.mode===n.FILLED&&(t=cc.clamp01(t)),this._N$totalLength=t,this._updateBarStatus()}},progress:{default:1,type:"Float",range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateBarStatus()}},reverse:{default:!1,tooltip:!1,notify:function(){this.barSprite&&(this.barSprite.fillStart=1-this.barSprite.fillStart),this._updateBarStatus()},animatable:!1}},statics:{Mode:n}});cc.ProgressBar=e.exports=o}),{"./CCComponent":53}],63:[(function(t,e,i){var n=cc.Class({extends:t("./CCSGComponent"),name:"cc._RendererInSG",ctor:function(){var t=this._sgNode=this._createSgNode();t.setVisible(!1),t.retain(),this._plainNode=new _ccsg.Node,this._plainNode.retain()},__preload:function(){this._initSgNode()},onEnable:function(){cc.director._actionManager&&cc.director._actionManager.getNumberOfRunningActionsInTarget(this.node)>0&&(cc.errorID(1629,this.node.name),cc.errorID(1630),cc.errorID(1631)),this._replaceSgNode(this._sgNode)},onDisable:function(){this._replaceSgNode(this._plainNode)},onDestroy:function(){this._removeSgNode();var t=this.node._sgNode;this._plainNode!==t&&(this._plainNode.release(),this._plainNode=null)},_replaceSgNode:function(t){var e=this.node,i=e._sgNode;i._entity=null;var n=i.getChildren().slice();i.removeAllChildren(!1),t.getChildrenCount()>0&&t.removeAllChildren(!1);for(var o=0,r=n.length;o<r;++o)t.addChild(n[o]);var s=i.getParent();s&&(cc.runtime?(s.removeChild(i,!1),s.addChild(t),t.arrivalOrder=i.arrivalOrder):(s.insertChildBefore(t,i),s.removeChild(i,!1))),e._sgNode=t,e._sgNode._entity=e,e._updateSgNode()}});cc._RendererInSG=e.exports=n}),{"./CCSGComponent":66}],64:[(function(t,e,i){var n=cc.Class({extends:t("./CCSGComponent"),name:"cc._RendererUnderSG",ctor:function(){var t=this._sgNode=this._createSgNode();t&&(t.retain(),t.setVisible(!1))},__preload:function(){this._initSgNode(),this._registSizeProvider(),this._appendSgNode(this._sgNode)},onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),this._removeSgNode()},_appendSgNode:function(t){if(t){var e=this.node;t.setColor(e._color),e._cascadeOpacityEnabled||t.setOpacity(e._opacity),t.setAnchorPoint(e._anchorPoint),t.setOpacityModifyRGB(e._opacityModifyRGB),t.setLocalZOrder(-1),e._sgNode.addChild(t)}}});cc._RendererUnderSG=e.exports=n}),{"./CCSGComponent":66}],65:[(function(t,e,i){t("../label/CCHtmlTextParser"),t("../label/CCTextUtils");var n=cc.TextAlignment,o=cc.VerticalTextAlignment,r=cc.Class({name:"cc.RichText",extends:cc._RendererUnderSG,ctor:function(){this._textArray=null,this._labelSegments=[],this._labelSegmentsCache=[],this._linesWidth=[],this._resetState(),this._updateRichTextStatus=this._updateRichText},editor:!1,properties:{string:{default:"<color=#00ff00>Rich</c><color=#0fffff>Text</color>",multiline:!0,tooltip:!1,notify:function(){this._updateRichTextStatus()}},horizontalAlign:{default:n.LEFT,type:n,tooltip:!1,animatable:!1,notify:function(t){this.horizontalAlign!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},fontSize:{default:40,tooltip:!1,notify:function(t){this.fontSize!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},font:{default:null,type:cc.TTFFont,tooltip:!1,notify:function(t){this.font!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},maxWidth:{default:0,tooltip:!1,notify:function(t){this.maxWidth!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},lineHeight:{default:40,tooltip:!1,notify:function(t){this.lineHeight!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},imageAtlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,notify:function(t){this.imageAtlas!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}}},statics:{HorizontalAlign:n,VerticalAlign:o},onEnable:function(){this._super(),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_createSgNode:function(){var t=new _ccsg.Node;t.setCascadeOpacityEnabled(!0);var e=this;return t.setColor=function(){e._updateLabelSegmentTextAttributes()},t._setContentSize=t.setContentSize,t.setContentSize=function(){},t},_updateLabelSegmentTextAttributes:function(){this._labelSegments.forEach(function(t){this._applyTextAttribute(t)}.bind(this))},_initSgNode:function(){this._updateRichText()},_createFontLabel:function(t){return _ccsg.Label.pool.get(t,this.font,null,this.fontSize)},_getFontRawUrl:function(){return this.font instanceof cc.TTFFont?this.font.rawUrl:""},_onTTFLoaded:function(){var t=this._getFontRawUrl();if(t){var e=this;cc.CustomFontLoader.loadTTF(t,(function(){e._layoutDirty=!0,e._updateRichText()}))}},_measureText:function(t,e){var i=this,n=function(e){var n;return 0===i._labelSegmentsCache.length?(n=i._createFontLabel(e),i._labelSegmentsCache.push(n)):(n=i._labelSegmentsCache[0]).setString(e),n._styleIndex=t,i._applyTextAttribute(n),n.getContentSize().width};return e?n(e):n},_onTouchEnded:function(t){if(this.enabledInHierarchy)for(var e=this.node.getComponents(cc.Component),i=0;i<this._labelSegments.length;++i){var n=this._labelSegments[i],o=n._clickHandler;o&&this._containsTouchLocation(n,t.touch.getLocation())&&e.forEach((function(e){e.enabledInHierarchy&&e[o]&&e[o](t)}))}},_containsTouchLocation:function(t,e){var i=t.getBoundingBoxToWorld();return cc.rectContainsPoint(i,e)},_resetState:function(){var t=this._sgNode;t&&t.removeAllChildren(),this._labelSegments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},_addLabelSegment:function(t,e){var i;0===this._labelSegmentsCache.length?i=this._createFontLabel(t):(i=this._labelSegmentsCache.pop()).setString(t),i._styleIndex=e,i._lineCount=this._lineCount,this._applyTextAttribute(i),i.setAnchorPoint(0,0),this._sgNode.addChild(i),this._labelSegments.push(i),i.setOverflow(1);var n=i.getContentSize();return i.enableWrap(!1),i.setDimensions(n.width,this.lineHeight),i},_updateRichTextWithMaxWidth:function(t,e,i){var n,o=e;if(this._lineOffsetX>0&&o+this._lineOffsetX>this.maxWidth)for(var r=0;this._lineOffsetX<=this.maxWidth;){var s=this._getFirstWordLen(t,r,t.length),c=t.substr(r,s),a=this._measureText(i,c);if(!(this._lineOffsetX+a<=this.maxWidth)){if(r>0){var h=t.substr(0,r);this._addLabelSegment(h,i),t=t.substr(r,t.length),o=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=a,r+=s}if(o>this.maxWidth)for(var l=cc.TextUtils.fragmentText(t,o,this.maxWidth,this._measureText(i)),u=0;u<l.length;++u){var d=l[u],p=(n=this._addLabelSegment(d,i)).getContentSize();this._lineOffsetX+=p.width,l.length>1&&u<l.length-1&&this._updateLineInfo()}else this._lineOffsetX+=o,this._addLabelSegment(t,i)},_isLastComponentCR:function(t){return t.length-1===t.lastIndexOf("\n")},_updateLineInfo:function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},_needsUpdateTextLayout:function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;++e){var i=this._textArray[e],n=t[e];if(i.text!=n.text)return!0;if(i.style){if(n.style){if(i.style.size!==n.style.size||i.style.italic!==n.style.italic||i.style.isImage!==n.style.isImage)return!0;if(i.style.isImage===n.style.isImage&&i.style.src!==n.style.src)return!0}else if(i.style.size||i.style.italic||i.style.isImage)return!0}else if(n.style&&(n.style.size||n.style.italic||n.style.isImage))return!0}return!1},_onSpriteFrameLoaded:function(t,e){var i;(i=e||t.target).__sprite.setSpriteFrame(i)},_applySpriteFrame:function(t){t&&(t.textureLoaded()?this._onSpriteFrameLoaded(null,t):(t.once("load",this._onSpriteFrameLoaded,this),t.ensureLoadTexture()))},_addRichTextImageElement:function(t){var e=t.style.src,i=this.imageAtlas.getSpriteFrame(e);if(i){var n=new cc.Scale9Sprite;n.setAnchorPoint(0,0),i.__sprite=n,this._sgNode.addChild(n),this._labelSegments.push(n);var o=i.getRect(),r=1,s=o.width,c=o.height,a=t.style.imageWidth,h=t.style.imageHeight;h>0&&h<this.lineHeight?(s*=r=h/c,c*=r):(s*=r=this.lineHeight/c,c*=r),a>0&&(s=a),this.maxWidth>0?(this._lineOffsetX+s>this.maxWidth&&this._updateLineInfo(),this._lineOffsetX+=s):(this._lineOffsetX+=s,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),this._applySpriteFrame(i),n.setContentSize(s,c),n._lineCount=this._lineCount,t.style.event&&t.style.event.click&&(n._clickHandler=t.style.event.click)}else cc.warnID(4400)},_updateRichText:function(){if(this.enabled){var t=cc.htmlTextParser.parse(this.string);if(!this._needsUpdateTextLayout(t))return this._textArray=t,void this._updateLabelSegmentTextAttributes();this._textArray=t;var e=this._sgNode;this._resetState();for(var i,n=!1,o=0;o<this._textArray.length;++o){var r=this._textArray[o],s=r.text;if(""===s){if(r.style&&r.style.newline){this._updateLineInfo();continue}if(r.style&&r.style.isImage&&this.imageAtlas){this._addRichTextImageElement(r);continue}}for(var c=s.split("\n"),a=0;a<c.length;++a){var h=c[a];if(""!==h)if(n=!1,this.maxWidth>0){var l=this._measureText(o,h);this._updateRichTextWithMaxWidth(h,l,o),c.length>1&&a<c.length-1&&this._updateLineInfo()}else i=this._addLabelSegment(h,o).getContentSize(),this._lineOffsetX+=i.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),c.length>1&&a<c.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(s)&&a==c.length-1)continue;this._updateLineInfo(),n=!0}}}n||this._linesWidth.push(this._lineOffsetX),this.maxWidth>0&&(this._labelWidth=this.maxWidth),this._labelHeight=this._lineCount*this.lineHeight,e._setContentSize(this._labelWidth,this._labelHeight),this.node.emit("size-changed"),this._updateRichTextPosition(),this._layoutDirty=!1}},_getFirstWordLen:function(t,e,i){var n=t.charAt(e);if(cc.TextUtils.isUnicodeCJK(n)||cc.TextUtils.isUnicodeSpace(n))return 1;for(var o=1,r=e+1;r<i&&(n=t.charAt(r),!cc.TextUtils.isUnicodeSpace(n)&&!cc.TextUtils.isUnicodeCJK(n));++r)o++;return o},_updateRichTextPosition:function(){for(var t=0,e=1,i=this._lineCount,n=0;n<this._labelSegments.length;++n){var o=this._labelSegments[n],r=o._lineCount;r>e&&(t=0,e=r);var s=0;switch(this.horizontalAlign){case cc.TextAlignment.LEFT:s=0;break;case cc.TextAlignment.CENTER:s=(this._labelWidth-this._linesWidth[r-1])/2;break;case cc.TextAlignment.RIGHT:s=this._labelWidth-this._linesWidth[r-1]}o.setPositionX(t+s);var c=o.getContentSize(),a=(i-r)*this.lineHeight;o instanceof cc.Scale9Sprite&&(a+=(this.lineHeight-o.getContentSize().height)/2),o.setPositionY(a),r===e&&(t+=c.width)}},_convertLiteralColorValue:function(t){var e=t.toUpperCase();return cc.Color[e]?cc.Color[e]:cc.hexToColor(t)},_applyTextAttribute:function(t){if(!(t instanceof cc.Scale9Sprite)){var e=t._styleIndex;t.setLineHeight(this.lineHeight),t.setVerticalAlign(o.CENTER);var i=null;this._textArray[e]&&(i=this._textArray[e].style),i&&i.color?t.setColor(this._convertLiteralColorValue(i.color)):t.setColor(this.node.color),i&&i.bold?t.enableBold(!0):t.enableBold(!1),i&&i.italic?t.enableItalics(!0):t.enableItalics(!1),i&&i.underline?t.enableUnderline(!0):t.enableUnderline(!1),i&&i.outline?(t.setOutlined(!0),t.setOutlineColor(this._convertLiteralColorValue(i.outline.color)),t.setOutlineWidth(i.outline.width),t.setMargin(i.outline.width)):(t.setOutlined(!1),t.setMargin(0)),i&&i.size?t.setFontSize(i.size):t.setFontSize(this.fontSize),i&&i.event&&i.event.click&&(t._clickHandler=i.event.click)}},onDestroy:function(){this._super();for(var t=0;t<this._labelSegments.length;++t)this._labelSegments[t].removeFromParent(!0),_ccsg.Label.pool.put(this._labelSegments[t]);this._resetState()}});cc.RichText=e.exports=r}),{"../label/CCHtmlTextParser":96,"../label/CCTextUtils":97}],66:[(function(t,e,i){var n=t("../utils/scene-graph-helper"),o=cc.Class({extends:t("./CCComponent"),name:"cc._SGComponent",editor:!1,properties:{_sgNode:{default:null,serializable:!1}},_createSgNode:null,_initSgNode:null,_removeSgNode:n.removeSgNode,_registSizeProvider:function(){if(this.node._sizeProvider);else this.node._sizeProvider=this._sgNode}});cc._SGComponent=e.exports=o}),{"../utils/scene-graph-helper":165,"./CCComponent":53}],67:[(function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1}),o=cc.Class({name:"cc.Scrollbar",extends:t("./CCComponent"),editor:!1,properties:{_scrollView:null,_touching:!1,_autoHideRemainingTime:{default:0,serializable:!1},_opacity:255,handle:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},direction:{default:n.HORIZONTAL,type:n,tooltip:!1,notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},enableAutoHide:{default:!0,animatable:!1,tooltip:!1},autoHideTime:{default:1,animatable:!1,tooltip:!1}},statics:{Direction:n},setTargetScrollView:function(t){this._scrollView=t},_convertToScrollViewSpace:function(t){var e=t.convertToWorldSpace(cc.p(0,0));return this._scrollView.node.convertToNodeSpace(e)},_setOpacity:function(t){this.handle&&this.node.setOpacity(t)},_onScroll:function(t){if(this._scrollView){var e=this._scrollView.content;if(e){var i=e.getContentSize(),o=this._scrollView.node.getContentSize(),r=this.node.getContentSize();if(this._conditionalDisableScrollBar(i,o))return;this.enableAutoHide&&(this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity));var s=0,c=0,a=0,h=0,l=0;this.direction===n.HORIZONTAL?(s=i.width,c=o.width,l=r.width,a=t.x,h=-this._convertToScrollViewSpace(e).x):this.direction===n.VERTICAL&&(s=i.height,c=o.height,l=r.height,a=t.y,h=-this._convertToScrollViewSpace(e).y);var u=this._calculateLength(s,c,l,a),d=this._calculatePosition(s,c,l,h,a,u);this._updateLength(u),this._updateHanlderPosition(d)}}},_updateHanlderPosition:function(t){if(this.handle){var e=this._fixupHandlerPosition();this.handle.node.setPosition(cc.pAdd(t,e))}},_fixupHandlerPosition:function(){var t=this.node.getContentSize(),e=this.node.getAnchorPoint(),i=this.handle.node.getContentSize(),o=this.handle.node.parent,r=this.node.convertToWorldSpaceAR(cc.p(-t.width*e.x,-t.height*e.y)),s=o.convertToNodeSpaceAR(r);return this.direction===n.HORIZONTAL?s=cc.pAdd(s,cc.p(0,(t.height-i.height)/2)):this.direction===n.VERTICAL&&(s=cc.pAdd(s,cc.p((t.width-i.width)/2,0))),this.handle.node.setPosition(s),s},_onTouchBegan:function(){this.enableAutoHide&&(this._touching=!0)},_conditionalDisableScrollBar:function(t,e){return t.width<=e.width&&this.direction===n.HORIZONTAL||t.height<=e.height&&this.direction===n.VERTICAL},_onTouchEnded:function(){if(this.enableAutoHide&&(this._touching=!1,!(this.autoHideTime<=0))){if(this._scrollView){var t=this._scrollView.content;if(t){var e=t.getContentSize(),i=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(e,i))return}}this._autoHideRemainingTime=this.autoHideTime}},_calculateLength:function(t,e,i,n){var o=t;return n&&(o+=20*(n>0?n:-n)),i*(e/o)},_calculatePosition:function(t,e,i,o,r,s){var c=t-e;r&&(c+=Math.abs(r));var a=0;c&&(a=o/c,a=cc.clamp01(a));var h=(i-s)*a;return this.direction===n.VERTICAL?cc.p(0,h):cc.p(h,0)},_updateLength:function(t){if(this.handle){var e=this.handle.node,i=e.getContentSize();e.setAnchorPoint(cc.p(0,0)),this.direction===n.HORIZONTAL?e.setContentSize(t,i.height):e.setContentSize(i.width,t)}},_processAutoHide:function(t){if(this.enableAutoHide&&!(this._autoHideRemainingTime<=0)&&!this._touching&&(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this.autoHideTime)){this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime);var e=this._opacity*(this._autoHideRemainingTime/this.autoHideTime);this._setOpacity(e)}},start:function(){this.enableAutoHide&&this._setOpacity(0)},hide:function(){this._autoHideRemainingTime=0,this._setOpacity(0)},show:function(){this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity)},update:function(t){this._processAutoHide(t)}});cc.Scrollbar=e.exports=o}),{"./CCComponent":53}],68:[(function(t,e,i){var n=function(t){return(t-=1)*t*t*t*t+1},o=function(){return(new Date).getMilliseconds()},r=cc.Enum({SCROLL_TO_TOP:0,SCROLL_TO_BOTTOM:1,SCROLL_TO_LEFT:2,SCROLL_TO_RIGHT:3,SCROLLING:4,BOUNCE_TOP:5,BOUNCE_BOTTOM:6,BOUNCE_LEFT:7,BOUNCE_RIGHT:8,AUTOSCROLL_ENDED:9,TOUCH_UP:10,AUTOSCROLL_ENDED_WITH_THRESHOLD:11}),s={"scroll-to-top":r.SCROLL_TO_TOP,"scroll-to-bottom":r.SCROLL_TO_BOTTOM,"scroll-to-left":r.SCROLL_TO_LEFT,"scroll-to-right":r.SCROLL_TO_RIGHT,scrolling:r.SCROLLING,"bounce-bottom":r.BOUNCE_BOTTOM,"bounce-left":r.BOUNCE_LEFT,"bounce-right":r.BOUNCE_RIGHT,"bounce-top":r.BOUNCE_TOP,"scroll-ended":r.AUTOSCROLL_ENDED,"touch-up":r.TOUCH_UP,"scroll-ended-with-threshold":r.AUTOSCROLL_ENDED_WITH_THRESHOLD},c=cc.Class({name:"cc.ScrollView",extends:t("./CCViewGroup"),editor:!1,ctor:function(){this._topBoundary=0,this._bottomBoundary=0,this._leftBoundary=0,this._rightBoundary=0,this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._touchMoved=!1,this._autoScrolling=!1,this._autoScrollAttenuate=!1,this._autoScrollStartPosition=cc.p(0,0),this._autoScrollTargetDelta=cc.p(0,0),this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0,this._autoScrollCurrentlyOutOfBoundary=!1,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0),this._outOfBoundaryAmount=cc.p(0,0),this._outOfBoundaryAmountDirty=!0,this._stopMouseWheel=!1,this._mouseWheelEventElapsedTime=0,this._isScrollEndedWithThresholdEventFired=!1,this._scrollEventEmitMask=0,this._isBouncing=!1},properties:{content:{default:void 0,type:cc.Node,tooltip:!1},horizontal:{default:!0,animatable:!1,tooltip:!1},vertical:{default:!0,animatable:!1,tooltip:!1},inertia:{default:!0,tooltip:!1},brake:{default:.5,type:"Float",range:[0,1,.1],tooltip:!1},elastic:{default:!0,animatable:!1,tooltip:!1},bounceDuration:{default:1,range:[0,10],tooltip:!1},horizontalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.horizontalScrollBar&&(this.horizontalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},verticalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.verticalScrollBar&&(this.verticalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},scrollEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1},cancelInnerEvents:{default:!0,animatable:!1,tooltip:!1}},statics:{EventType:r},scrollToBottom:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i,!0)},scrollToTop:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,1),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToTopLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToTopRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToBottomLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToBottomRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToOffset:function(t,e,i){var n=this.getMaxScrollOffset(),o=cc.p(0,0);0===n.x?o.x=0:o.x=t.x/n.x,0===n.y?o.y=1:o.y=(n.y-t.y)/n.y,this.scrollTo(o,e,i)},getScrollOffset:function(){var t=this._getContentTopBoundary()-this._topBoundary,e=this._getContentLeftBoundary()-this._leftBoundary;return cc.p(e,t)},getMaxScrollOffset:function(){var t=this.node.getContentSize(),e=this.content.getContentSize(),i=e.width-t.width,n=e.height-t.height;return i=i>=0?i:0,n=n>=0?n:0,cc.p(i,n)},scrollToPercentHorizontal:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(t,0),applyToHorizontal:!0,applyToVertical:!1});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},scrollTo:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:t,applyToHorizontal:!0,applyToVertical:!0});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},scrollToPercentVertical:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(0,t),applyToHorizontal:!1,applyToVertical:!0});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},stopAutoScroll:function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},setContentPosition:function(t){cc.pFuzzyEqual(t,this.getContentPosition(),1e-4)||(this.content.setPosition(t),this._outOfBoundaryAmountDirty=!0)},getContentPosition:function(){return this.content.getPosition()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.off(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_onMouseWheel:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=cc.p(0,0),n=-.1;n=-7,this.vertical?i=cc.p(0,t.getScrollY()*n):this.horizontal&&(i=cc.p(t.getScrollY()*n,0)),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(i),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(t)}},_checkMouseWheel:function(t){var e=this._getHowMuchOutOfBoundary();if(!cc.pFuzzyEqual(e,cc.p(0,0),1e-4))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),void(this._stopMouseWheel=!1);this._mouseWheelEventElapsedTime+=t,this._mouseWheelEventElapsedTime>.1&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._stopMouseWheel=!1)},_calculateMovePercentDelta:function(t){var e=t.anchor,i=t.applyToHorizontal,n=t.applyToVertical;this._calculateBoundary(),e=cc.pClamp(e,cc.p(0,0),cc.p(1,1));var o=this.node.getContentSize(),r=this.content.getContentSize(),s=this._getContentBottomBoundary()-this._bottomBoundary;s=-s;var c=this._getContentLeftBoundary()-this._leftBoundary;c=-c;var a=cc.p(0,0),h=0;return i&&(h=r.width-o.width,a.x=c-h*e.x),n&&(h=r.height-o.height,a.y=s-h*e.y),a},_moveContentToTopLeft:function(t){var e=this.content.getContentSize(),i=this._getContentBottomBoundary()-this._bottomBoundary;i=-i;var n=cc.p(0,0),o=0,r=this._getContentLeftBoundary()-this._leftBoundary;r=-r,e.height<t.height?(o=e.height-t.height,n.y=i-o,this.verticalScrollBar&&this.verticalScrollBar.hide()):this.verticalScrollBar&&this.verticalScrollBar.show(),e.width<t.width?(o=e.width-t.width,n.x=r,this.horizontalScrollBar&&this.horizontalScrollBar.hide()):this.horizontalScrollBar&&this.horizontalScrollBar.show(),this._moveContent(n),this._adjustContentOutOfBoundary()},_calculateBoundary:function(){if(this.content){var t=this.content.getComponent(cc.Layout);t&&t.enabledInHierarchy&&t._updateLayout();var e=this.node.getContentSize(),i=this._convertToContentParentSpace(cc.p(0,0));this._leftBoundary=i.x,this._bottomBoundary=i.y;var n=this._convertToContentParentSpace(cc.p(e.width,e.height));this._rightBoundary=n.x,this._topBoundary=n.y,this._moveContentToTopLeft(e)}},_convertToContentParentSpace:function(t){var e=this.node.convertToWorldSpace(t);return this.content.parent.convertToNodeSpaceAR(e)},_hasNestedViewGroup:function(t,e){if(t.eventPhase===cc.Event.CAPTURING_PHASE){if(e)for(var i=0;i<e.length;++i){var n=e[i];if(this.node===n)return!!t.target.getComponent(cc.ViewGroup);if(n.getComponent(cc.ViewGroup))return!0}return!1}},_stopPropagationIfTargetIsMe:function(t){t.eventPhase===cc.Event.AT_TARGET&&t.target===this.node&&t.stopPropagation()},_onTouchBegan:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=t.touch;this.content&&this._handlePressLogic(i),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(t)}},_onTouchMoved:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=t.touch;if(this.content&&this._handleMoveLogic(i),this.cancelInnerEvents){var n=cc.pSub(i.getLocation(),i.getStartLocation());if(cc.pLength(n)>7&&!this._touchMoved&&t.target!==this.node){var o=new cc.Event.EventTouch(t.getTouches(),t.bubbles);o.type=cc.Node.EventType.TOUCH_CANCEL,o.touch=t.touch,o.simulate=!0,t.target.dispatchEvent(o),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(t)}}},_onTouchEnded:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){this._dispatchEvent("touch-up");var i=t.touch;this.content&&this._handleReleaseLogic(i),this._touchMoved?t.stopPropagation():this._stopPropagationIfTargetIsMe(t)}},_onTouchCancelled:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){if(!t.simulate){var i=t.touch;this.content&&this._handleReleaseLogic(i)}this._stopPropagationIfTargetIsMe(t)}},_processDeltaMove:function(t){this._scrollChildren(t),this._gatherTouchMove(t)},_handleMoveLogic:function(t){var e=t.getDelta();this._processDeltaMove(e)},_scrollChildren:function(t){var e,i=t=this._clampDelta(t);this.elastic&&(e=this._getHowMuchOutOfBoundary(),i.x*=0===e.x?1:.5,i.y*=0===e.y?1:.5),this.elastic||(e=this._getHowMuchOutOfBoundary(i),i=cc.pAdd(i,e));var n=-1;i.y>0?this.content.y-this.content.anchorY*this.content.height+i.y>this._bottomBoundary&&(n="scroll-to-bottom"):i.y<0?this.content.y-this.content.anchorY*this.content.height+this.content.height+i.y<=this._topBoundary&&(n="scroll-to-top"):i.x<0?this.content.x-this.content.anchorX*this.content.width+this.content.width+i.x<=this._rightBoundary&&(n="scroll-to-right"):i.x>0&&this.content.x-this.content.anchorX*this.content.width+i.x>=this._leftBoundary&&(n="scroll-to-left"),this._moveContent(i,!1),0===i.x&&0===i.y||this._dispatchEvent("scrolling"),-1!==n&&this._dispatchEvent(n)},_handlePressLogic:function(){this._autoScrolling&&this._dispatchEvent("scroll-ended"),this._autoScrolling=!1,this._isBouncing=!1,this._touchMovePreviousTimestamp=o(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._onScrollBarTouchBegan()},_clampDelta:function(t){var e=this.content.getContentSize(),i=this.node.getContentSize();return e.width<i.width&&(t.x=0),e.height<i.height&&(t.y=0),t},_gatherTouchMove:function(t){for(t=this._clampDelta(t);this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(t);var e=o();this._touchMoveTimeDeltas.push((e-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=e},_startBounceBackIfNeeded:function(){if(!this.elastic)return!1;var t=this._getHowMuchOutOfBoundary();if(t=this._clampDelta(t),cc.pFuzzyEqual(t,cc.p(0,0),1e-4))return!1;var e=Math.max(this.bounceDuration,0);return this._startAutoScroll(t,e,!0),this._isBouncing||(t.y>0&&this._dispatchEvent("bounce-top"),t.y<0&&this._dispatchEvent("bounce-bottom"),t.x>0&&this._dispatchEvent("bounce-right"),t.x<0&&this._dispatchEvent("bounce-left"),this._isBouncing=!0),!0},_processInertiaScroll:function(){if(!this._startBounceBackIfNeeded()&&this.inertia){var t=this._calculateTouchMoveVelocity();!cc.pFuzzyEqual(t,cc.p(0,0),1e-4)&&this.brake<1&&this._startInertiaScroll(t)}this._onScrollBarTouchEnded()},_handleReleaseLogic:function(t){var e=t.getDelta();this._gatherTouchMove(e),this._processInertiaScroll()},_isOutOfBoundary:function(){var t=this._getHowMuchOutOfBoundary();return!cc.pFuzzyEqual(t,cc.p(0,0),1e-4)},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},getScrollEndedEventTiming:function(){return 1e-4},_processAutoScrolling:function(t){var e=this._isNecessaryAutoScrollBrake(),i=e?.05:1;this._autoScrollAccumulatedTime+=t*(1/i);var o=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(o=n(o));var r=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,o)),s=Math.abs(o-1)<=1e-4;if(Math.abs(o-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent("scroll-ended-with-threshold"),this._isScrollEndedWithThresholdEventFired=!0),this.elastic){var c=cc.pSub(r,this._autoScrollBrakingStartPosition);e&&(c=cc.pMult(c,i)),r=cc.pAdd(this._autoScrollBrakingStartPosition,c)}else{var a=cc.pSub(r,this.getContentPosition()),h=this._getHowMuchOutOfBoundary(a);cc.pFuzzyEqual(h,cc.p(0,0),1e-4)||(r=cc.pAdd(r,h),s=!0)}s&&(this._autoScrolling=!1);var l=cc.pSub(r,this.getContentPosition());this._moveContent(l,s),this._dispatchEvent("scrolling"),this._autoScrolling||(this._isBouncing=!1,this._dispatchEvent("scroll-ended"))},_startInertiaScroll:function(t){var e=cc.pMult(t,.7);this._startAttenuatingAutoScroll(e,t)},_calculateAttenuatedFactor:function(t){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9))},_startAttenuatingAutoScroll:function(t,e){var i=this._calculateAutoScrollTimeByInitalSpeed(cc.pLength(e)),n=cc.pNormalize(t),o=this.content.getContentSize(),r=this.node.getContentSize(),s=o.width-r.width,c=o.height-r.height,a=this._calculateAttenuatedFactor(s),h=this._calculateAttenuatedFactor(c);n=cc.p(n.x*s*(1-this.brake)*a,n.y*c*h*(1-this.brake));var l=cc.pLength(t),u=cc.pLength(n)/l;n=cc.pAdd(n,t),this.brake>0&&u>7&&(u=Math.sqrt(u),n=cc.pAdd(cc.pMult(t,u),t)),this.brake>0&&u>3&&(i*=u=3),0===this.brake&&u>1&&(i*=u),this._startAutoScroll(n,i,!0)},_calculateAutoScrollTimeByInitalSpeed:function(t){return Math.sqrt(Math.sqrt(t/5))},_startAutoScroll:function(t,e,i){var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=i,this._autoScrollStartPosition=this.getContentPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition=cc.p(0,0);var o=this._getHowMuchOutOfBoundary();if(!cc.pFuzzyEqual(o,cc.p(0,0),1e-4)){this._autoScrollCurrentlyOutOfBoundary=!0;var r=this._getHowMuchOutOfBoundary(n);(o.x*r.x>0||o.y*r.y>0)&&(this._autoScrollBraking=!0)}},_calculateTouchMoveVelocity:function(){var t=0;if((t=this._touchMoveTimeDeltas.reduce((function(t,e){return t+e}),t))<=0||t>=.5)return cc.p(0,0);var e=cc.p(0,0);return e=this._touchMoveDisplacements.reduce((function(t,e){return cc.pAdd(t,e)}),e),cc.p(e.x*(1-this.brake)/t,e.y*(1-this.brake)/t)},_flattenVectorByDirection:function(t){var e=t;return e.x=this.horizontal?e.x:0,e.y=this.vertical?e.y:0,e},_moveContent:function(t,e){var i=this._flattenVectorByDirection(t),n=cc.pAdd(this.getContentPosition(),i);this.setContentPosition(n);var o=this._getHowMuchOutOfBoundary();this._updateScrollBar(o),this.elastic&&e&&this._startBounceBackIfNeeded()},_getContentLeftBoundary:function(){return this.getContentPosition().x-this.content.getAnchorPoint().x*this.content.getContentSize().width},_getContentRightBoundary:function(){var t=this.content.getContentSize();return this._getContentLeftBoundary()+t.width},_getContentTopBoundary:function(){var t=this.content.getContentSize();return this._getContentBottomBoundary()+t.height},_getContentBottomBoundary:function(){return this.getContentPosition().y-this.content.getAnchorPoint().y*this.content.getContentSize().height},_getHowMuchOutOfBoundary:function(t){if(t=t||cc.p(0,0),cc.pFuzzyEqual(t,cc.p(0,0),1e-4)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=cc.p(0,0);return this._getContentLeftBoundary()+t.x>this._leftBoundary?e.x=this._leftBoundary-(this._getContentLeftBoundary()+t.x):this._getContentRightBoundary()+t.x<this._rightBoundary&&(e.x=this._rightBoundary-(this._getContentRightBoundary()+t.x)),this._getContentTopBoundary()+t.y<this._topBoundary?e.y=this._topBoundary-(this._getContentTopBoundary()+t.y):this._getContentBottomBoundary()+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(this._getContentBottomBoundary()+t.y)),cc.pFuzzyEqual(t,cc.p(0,0),1e-4)&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),e=this._clampDelta(e)},_updateScrollBar:function(t){this.horizontalScrollBar&&this.horizontalScrollBar._onScroll(t),this.verticalScrollBar&&this.verticalScrollBar._onScroll(t)},_onScrollBarTouchBegan:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchBegan(),this.verticalScrollBar&&this.verticalScrollBar._onTouchBegan()},_onScrollBarTouchEnded:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchEnded(),this.verticalScrollBar&&this.verticalScrollBar._onTouchEnded()},_dispatchEvent:function(t){if("scroll-ended"===t)this._scrollEventEmitMask=0;else if("scroll-to-top"===t||"scroll-to-bottom"===t||"scroll-to-left"===t||"scroll-to-right"===t){var e=1<<s[t];if(this._scrollEventEmitMask&e)return;this._scrollEventEmitMask|=e}cc.Component.EventHandler.emitEvents(this.scrollEvents,this,s[t]),this.node.emit(t,this)},_adjustContentOutOfBoundary:function(){if(this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary()){var t=this._getHowMuchOutOfBoundary(cc.p(0,0)),e=cc.pAdd(this.getContentPosition(),t);this.content&&(this.content.setPosition(e),this._updateScrollBar(0))}},start:function(){this._calculateBoundary(),this.content&&cc.director.once(cc.Director.EVENT_AFTER_VISIT,this._adjustContentOutOfBoundary,this)},_hideScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.hide(),this.verticalScrollBar&&this.verticalScrollBar.hide()},_showScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.show(),this.verticalScrollBar&&this.verticalScrollBar.show()},onDisable:function(){this._unregisterEvent(),this.node.off("size-changed",this._calculateBoundary,this),this.content&&this.content.off("size-changed",this._calculateBoundary,this),this._hideScrollbar(),this.stopAutoScroll()},onEnable:function(){this._registerEvent(),this.node.on("size-changed",this._calculateBoundary,this),this.content&&this.content.on("size-changed",this._calculateBoundary,this),this._showScrollbar()},update:function(t){this._autoScrolling&&this._processAutoScrolling(t)}});cc.ScrollView=e.exports=c}),{"./CCViewGroup":76}],69:[(function(t,e,i){var n=cc.Enum({Horizontal:0,Vertical:1}),o=cc.Class({name:"cc.Slider",extends:t("./CCComponent"),editor:!1,ctor:function(){this._dragging=!1},properties:{handle:{default:null,type:cc.Button,tooltip:!1,notify:function(){}},direction:{default:n.Horizontal,type:n,tooltip:!1},progress:{default:.5,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateHandlePosition()}},slideEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Direction:n},__preload:function(){this._updateHandlePosition()},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.on(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.off(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},_onHandleDragStart:function(t){this._dragging=!0,t.stopPropagation()},_onTouchBegan:function(t){this.handle&&(this._dragging=!0,this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchMoved:function(t){this._dragging&&(this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchEnded:function(t){this._dragging=!1,t.stopPropagation()},_onTouchCancelled:function(t){this._dragging=!1,t.stopPropagation()},_handleSliderLogic:function(t){this._updateProgress(t),this._emitSlideEvent()},_emitSlideEvent:function(){cc.Component.EventHandler.emitEvents(this.slideEvents,this),this.node.emit("slide",this)},_updateProgress:function(t){if(this.handle){var e=null,i=0,o=this.node.convertTouchToNodeSpaceAR(t);this.direction===n.Horizontal?(e=this.node.width/2-this.handle.node.width*this.handle.node.anchorX,i=cc.clamp01((o.x+e)/(2*e),0,1)):this.direction===n.Vertical&&(e=this.node.height/2-this.handle.node.height*this.handle.node.anchorY,i=cc.clamp01((o.y+e)/(2*e),0,1)),this.progress=i}},_updateHandlePosition:function(){if(this.handle){var t;t=this.direction===n.Horizontal?cc.p(-this.node.width*this.node.anchorX+this.progress*this.node.width,0):cc.p(0,-this.node.height*this.node.anchorY+this.progress*this.node.height);var e=this.node.convertToWorldSpaceAR(t);this.handle.node.position=this.handle.node.parent.convertToNodeSpaceAR(e)}}});cc.Slider=e.exports=o}),{"./CCComponent":53}],70:[(function(t,e,i){var n=t("./CCRendererUnderSG"),o=cc.Scale9Sprite.RenderingType,r=cc.Scale9Sprite.FillType,s=cc.BlendFunc.BlendFactor,c=cc.Enum({CUSTOM:0,TRIMMED:1,RAW:2}),a=cc.Class({name:"cc.Sprite",extends:n,editor:!1,ctor:function(){this._blendFunc=new cc.BlendFunc(this._srcBlendFactor,this._dstBlendFactor)},properties:{_spriteFrame:{default:null,type:cc.SpriteFrame},_type:o.SIMPLE,_sizeMode:c.TRIMMED,_fillType:0,_fillCenter:cc.v2(0,0),_fillStart:0,_fillRange:0,_isTrimmedMode:!0,_srcBlendFactor:s.SRC_ALPHA,_dstBlendFactor:s.ONE_MINUS_SRC_ALPHA,_atlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,editorOnly:!0,visible:!0,animatable:!1},spriteFrame:{get:function(){return this._spriteFrame},set:function(t,e){var i=this._spriteFrame;i!==t&&(this._spriteFrame=t,this._applySpriteFrame(i))},type:cc.SpriteFrame},type:{get:function(){return this._type},set:function(t){this._type=t,this._sgNode.setRenderingType(t)},type:o,animatable:!1,tooltip:!1},fillType:{get:function(){return this._fillType},set:function(t){this._fillType=t,this._sgNode&&this._sgNode.setFillType(t)},type:r,tooltip:!1},fillCenter:{get:function(){return this._fillCenter},set:function(t){this._fillCenter=cc.v2(t),this._sgNode&&this._sgNode.setFillCenter(this._fillCenter)},tooltip:!1},fillStart:{get:function(){return this._fillStart},set:function(t){this._fillStart=cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillStart(t)},tooltip:!1},fillRange:{get:function(){return this._fillRange},set:function(t){this._fillRange=cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillRange(t)},tooltip:!1},trim:{get:function(){return this._isTrimmedMode},set:function(t){this._isTrimmedMode!==t&&(this._isTrimmedMode=t,this._sgNode.enableTrimmedContentSize(t))},animatable:!1,tooltip:!1},srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:s,tooltip:!1},dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:s,tooltip:!1},sizeMode:{get:function(){return this._sizeMode},set:function(t){this._sizeMode=t,t!==c.CUSTOM&&this._applySpriteSize()},animatable:!1,type:c,tooltip:!1}},statics:{FillType:r,Type:o,SizeMode:c},setVisible:function(t){this.enabled=t},setInsetLeft:function(t){this._sgNode.setInsetLeft(t)},getInsetLeft:function(){return this._sgNode.getInsetLeft()},setInsetTop:function(t){this._sgNode.setInsetTop(t)},getInsetTop:function(){return this._sgNode.getInsetTop()},setInsetRight:function(t){this._sgNode.setInsetRight(t)},getInsetRight:function(){return this._sgNode.getInsetRight()},setInsetBottom:function(t){this._sgNode.setInsetBottom(t)},getInsetBottom:function(){return this._sgNode.getInsetBottom()},onEnable:function(){this._sgNode&&this._spriteFrame&&this._spriteFrame.textureLoaded()&&this._sgNode.setVisible(!0)},_applyAtlas:!1,_applySpriteFrameInsets:function(){var t=this._spriteFrame,e=this._sgNode;e.setInsetTop(t.insetTop),e.setInsetBottom(t.insetBottom),e.setInsetRight(t.insetRight),e.setInsetLeft(t.insetLeft)},_applySpriteSize:function(){if(c.CUSTOM!==this._sizeMode&&this._spriteFrame)if(c.RAW===this._sizeMode){var t=this._spriteFrame.getOriginalSize();this.node.setContentSize(t)}else if(c.TRIMMED===this._sizeMode){var e=this._spriteFrame.getRect();this.node.setContentSize(cc.size(e.width,e.height))}else this.node.setContentSize(this.node.getContentSize(!0));else this.node.setContentSize(this.node.getContentSize(!0))},_onTextureLoaded:function(t){var e=this;if(e.isValid){var i=e._sgNode;i.setSpriteFrame(e._spriteFrame),e._applySpriteSize(),e.enabledInHierarchy&&!i.isVisible()&&i.setVisible(!0)}},_applySpriteFrame:function(t,e){var i=this._sgNode;t&&t.off&&t.off("load",this._onTextureLoaded,this);var n=this._spriteFrame;n?(e||this._applySpriteFrameInsets(),n.textureLoaded()?this._onTextureLoaded(null):(n.once("load",this._onTextureLoaded,this),n.ensureLoadTexture())):i.setVisible(!1)},_createSgNode:function(){return new cc.Scale9Sprite},_initSgNode:function(){var t=this._sgNode,e=0!==t.getInsetLeft()||0!==t.getInsetRight()||0!==t.getInsetTop()||0!==t.getInsetBottom();this._applySpriteFrame(null,e),t.setContentSize(this.node.getContentSize(!0)),this._applySpriteSize(),t.setRenderingType(this._type),t.setFillType(this._fillType),t.setFillCenter(this._fillCenter),t.setFillStart(this._fillStart),t.setFillRange(this._fillRange),t.enableTrimmedContentSize(this._isTrimmedMode),this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc)},_resized:!1}),h=["insetLeft","insetTop","insetRight","insetBottom"],l={type:[null,"setRenderingType"]};t("../utils/misc").propertyDefine(a,h,l),cc.Sprite=e.exports=a}),{"../utils/misc":162,"./CCRendererUnderSG":64}],71:[(function(t,e,i){var n=cc.Class({name:"cc.SpriteDistortion",extends:t("./CCComponent"),editor:!1,ctor:function(){this._spriteSGNode=null},properties:{_distortionOffset:cc.v2(0,0),offset:{get:function(){return this._distortionOffset},set:function(t){this._distortionOffset.x=t.x,this._distortionOffset.y=t.y,this._spriteSGNode&&this._spriteSGNode.setDistortionOffset(this._distortionOffset)}},_distortionTiling:cc.v2(1,1),tiling:{get:function(){return this._distortionTiling},set:function(t){this._distortionTiling.x=t.x,this._distortionTiling.y=t.y,this._spriteSGNode&&this._spriteSGNode.setDistortionTiling(this._distortionTiling)}}},onEnable:function(){var t=this.node.getComponent("cc.Sprite"),e=this._spriteSGNode=t&&t._sgNode;this._spriteSGNode&&(e.setState(cc.Scale9Sprite.state.DISTORTION),e.setDistortionOffset(this._distortionOffset),e.setDistortionTiling(this._distortionTiling))},onDisable:function(){this._spriteSGNode&&this._spriteSGNode.setState(cc.Scale9Sprite.state.NORMAL),this._spriteSGNode=null}});cc.SpriteDistortion=e.exports=n}),{"./CCComponent":53}],72:[(function(t,e,i){var n=cc.Enum({NONE:0,CHECKBOX:1,TEXT_ATLAS:2,SLIDER_BAR:3,LIST_VIEW:4,PAGE_VIEW:5}),o=cc.Enum({VERTICAL:0,HORIZONTAL:1}),r=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),s=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),c=cc.Class({name:"cc.StudioComponent",extends:cc.Component,editor:!1,properties:!1,statics:{ComponentType:n,ListDirection:o,VerticalAlign:r,HorizontalAlign:s}});cc.StudioComponent=e.exports=c}),{}],73:[(function(t,e,i){var n=cc.Class({name:"cc.Toggle",extends:t("./CCButton"),editor:!1,properties:{isChecked:{default:!0,tooltip:!1,notify:function(){this._updateCheckMark()}},toggleGroup:{default:null,tooltip:!1,type:cc.ToggleGroup},checkMark:{default:null,type:cc.Sprite,tooltip:!1},checkEvents:{default:[],type:cc.Component.EventHandler},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}}},__preload:function(){this._super()},onEnable:function(){this._super(),this._registerToggleEvent(),this.toggleGroup&&this.toggleGroup.enabled&&this.toggleGroup.addToggle(this)},onDisable:function(){this._super(),this._unregisterToggleEvent(),this.toggleGroup&&this.toggleGroup.enabled&&this.toggleGroup.removeToggle(this)},_updateCheckMark:function(){this.checkMark&&(this.checkMark.node.active=!!this.isChecked)},_updateDisabledState:function(){this._super(),this.checkMark&&this.checkMark._sgNode.setState(0),this.enableAutoGrayEffect&&this.checkMark&&!this.interactable&&this.checkMark._sgNode.setState(1)},_registerToggleEvent:function(){this.node.on("click",this.toggle,this)},_unregisterToggleEvent:function(){this.node.off("click",this.toggle,this)},toggle:function(t){this.toggleGroup&&this.toggleGroup.enabled&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!this.isChecked,this._updateCheckMark(),this.toggleGroup&&this.toggleGroup.enabled&&this.toggleGroup.updateToggles(this),this._emitToggleEvents(t))},_emitToggleEvents:function(){this.node.emit("toggle",this),this.checkEvents&&cc.Component.EventHandler.emitEvents(this.checkEvents,this)},check:function(){this.toggleGroup&&this.toggleGroup.enabled&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!0,this.toggleGroup&&this.toggleGroup.enabled&&this.toggleGroup.updateToggles(this),this._emitToggleEvents())},uncheck:function(){this.toggleGroup&&this.toggleGroup.enabled&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!1,this._emitToggleEvents())}});cc.Toggle=e.exports=n}),{"./CCButton":51}],74:[(function(t,e,i){var n=cc.Class({name:"cc.ToggleGroup",extends:cc.Component,ctor:function(){this._toggleItems=[]},editor:!1,properties:{allowSwitchOff:{tooltip:!1,default:!1},toggleItems:{get:function(){return this._toggleItems}}},updateToggles:function(t){this.enabledInHierarchy&&this._toggleItems.forEach((function(e){t.isChecked&&e!==t&&e.isChecked&&e.enabled&&(e.isChecked=!1)}))},addToggle:function(t){-1===this._toggleItems.indexOf(t)&&this._toggleItems.push(t),this._allowOnlyOneToggleChecked()},removeToggle:function(t){var e=this._toggleItems.indexOf(t);e>-1&&this._toggleItems.splice(e,1),this._makeAtLeastOneToggleChecked()},_allowOnlyOneToggleChecked:function(){var t=!1;return this._toggleItems.forEach((function(e){t&&e.enabled&&(e.isChecked=!1),e.isChecked&&e.enabled&&(t=!0)})),t},_makeAtLeastOneToggleChecked:function(){this._allowOnlyOneToggleChecked()||this.allowSwitchOff||this._toggleItems.length>0&&(this._toggleItems[0].isChecked=!0)},start:function(){this._makeAtLeastOneToggleChecked()}});cc.ToggleGroup=e.exports=n}),{}],75:[(function(i,n,o){i("../videoplayer/CCSGVideoPlayer");var r=_ccsg.VideoPlayer.EventType,s=cc.Enum({REMOTE:0,LOCAL:1}),c=cc.Class({name:"cc.VideoPlayer",extends:cc._RendererUnderSG,editor:!1,properties:{_resourceType:s.REMOTE,resourceType:{tooltip:!1,type:s,set:function(t){this._resourceType=t,this._updateVideoSource()},get:function(){return this._resourceType}},_remoteURL:"",remoteURL:{tooltip:!1,type:cc.String,set:function(t){this._remoteURL=t,this._updateVideoSource()},get:function(){return this._remoteURL}},_clip:{default:null,url:cc.RawAsset},clip:{tooltip:!1,get:function(){return this._clip},set:function(i){"string"!==("object"==(e=typeof i)?t(i):e)&&(i=""),this._clip=i,this._updateVideoSource()},url:cc.RawAsset},currentTime:{tooltip:!1,type:cc.Float,set:function(t){this._sgNode&&this._sgNode.seekTo(t)},get:function(){return this._sgNode?this._sgNode.currentTime():-1}},keepAspectRatio:{tooltip:!1,default:!0,type:cc.Boolean,notify:function(){this._sgNode.setKeepAspectRatioEnabled(this.keepAspectRatio)}},isFullscreen:{tooltip:!1,default:!1,type:cc.Boolean,notify:function(){this._sgNode.setFullScreenEnabled(this.isFullscreen)}},videoPlayerEvent:{default:[],type:cc.Component.EventHandler}},statics:{EventType:r,ResourceType:s},onLoad:function(){cc.sys.os!==cc.sys.OS_OSX&&cc.sys.os!==cc.sys.OS_WINDOWS||(this.enabled=!1)},_createSgNode:function(){return cc.sys.os===cc.sys.OS_OSX||cc.sys.os===cc.sys.OS_WINDOWS?(console.log("VideoPlayer is not supported on Mac and Windows!"),null):new _ccsg.VideoPlayer},_updateVideoSource:function(){var t=this._sgNode;this.resourceType===s.REMOTE?t.setURL(this.remoteURL):t.setURL(this._clip||"")},_initSgNode:function(){var t=this._sgNode;t&&(this._updateVideoSource(),t.seekTo(this.currentTime),t.setKeepAspectRatioEnabled(this.keepAspectRatio),t.setFullScreenEnabled(this.isFullscreen),t.setContentSize(this.node.getContentSize()),this.pause(),t.setEventListener(r.PLAYING,this.onPlaying.bind(this)),t.setEventListener(r.PAUSED,this.onPasued.bind(this)),t.setEventListener(r.STOPPED,this.onStopped.bind(this)),t.setEventListener(r.COMPLETED,this.onCompleted.bind(this)),t.setEventListener(r.META_LOADED,this.onMetaLoaded.bind(this)),t.setEventListener(r.CLICKED,this.onClicked.bind(this)),t.setEventListener(r.READY_TO_PLAY,this.onReadyToPlay.bind(this)))},onReadyToPlay:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,r.READY_TO_PLAY),this.node.emit("ready-to-play",this)},onMetaLoaded:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,r.META_LOADED),this.node.emit("meta-loaded",this)},onClicked:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,r.CLICKED),this.node.emit("clicked",this)},onPlaying:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,r.PLAYING),this.node.emit("playing",this)},onPasued:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,r.PAUSED),this.node.emit("paused",this)},onStopped:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,r.STOPPED),this.node.emit("stopped",this)},onCompleted:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,r.COMPLETED),this.node.emit("completed",this)},play:function(){this._sgNode&&this._sgNode.play()},resume:function(){this._sgNode&&this._sgNode.resume()},pause:function(){this._sgNode&&this._sgNode.pause()},stop:function(){this._sgNode&&this._sgNode.stop()},getDuration:function(){return this._sgNode?this._sgNode.duration():-1},isPlaying:function(){return!!this._sgNode&&this._sgNode.isPlaying()}});cc.VideoPlayer=n.exports=c}),{"../videoplayer/CCSGVideoPlayer":218}],76:[(function(t,e,i){var n=cc.Class({name:"cc.ViewGroup",extends:t("./CCComponent")});cc.ViewGroup=e.exports=n}),{"./CCComponent":53}],77:[(function(t,e,i){t("../webview/CCSGWebView");var n=_ccsg.WebView.EventType,o=cc.Class({name:"cc.WebView",extends:cc._RendererUnderSG,editor:!1,properties:{_useOriginalSize:!0,_url:"",url:{type:String,tooltip:!1,get:function(){return this._url},set:function(t){this._url=t;var e=this._sgNode;e&&e.loadURL(t)}},webviewEvents:{default:[],type:cc.Component.EventHandler}},statics:{EventType:n},onLoad:function(){cc.sys.os!==cc.sys.OS_OSX&&cc.sys.os!==cc.sys.OS_WINDOWS||(this.enabled=!1)},_createSgNode:function(){return cc.sys.os===cc.sys.OS_OSX||cc.sys.os===cc.sys.OS_WINDOWS?(console.log("WebView is not supported on Mac and Windows!"),null):new _ccsg.WebView},_initSgNode:function(){var t=this._sgNode;t&&(t.setEventListener(n.LOADED,this._onWebViewLoaded.bind(this)),t.setEventListener(n.LOADING,this._onWebViewLoading.bind(this)),t.setEventListener(n.ERROR,this._onWebViewLoadError.bind(this)),t.loadURL(this._url),t.setContentSize(this.node.getContentSize()))},_onWebViewLoaded:function(){cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.LOADED),this.node.emit("loaded",this)},_onWebViewLoading:function(){return cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.LOADING),this.node.emit("loading",this),!0},_onWebViewLoadError:function(){cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.ERROR),this.node.emit("error",this)},setJavascriptInterfaceScheme:function(t){this._sgNode&&this._sgNode.setJavascriptInterfaceScheme(t)},setOnJSCallback:function(t){this._sgNode&&this._sgNode.setOnJSCallback(t)}});cc.WebView=e.exports=o}),{"../webview/CCSGWebView":218}],78:[(function(t,e,i){var n=t("../base-ui/CCWidgetManager"),o=n._AlignFlags,r=o.TOP,s=o.MID,c=o.BOT,a=o.LEFT,h=o.CENTER,l=o.RIGHT,u=r|c,d=a|l,p=cc.Class({name:"cc.Widget",extends:t("./CCComponent"),editor:!1,properties:{target:{get:function(){return this._target},set:function(t){this._target=t},type:cc.Node,tooltip:!1},isAlignTop:{get:function(){return(this._alignFlags&r)>0},set:function(t){this._setAlign(r,t)},animatable:!1,tooltip:!1},isAlignVerticalCenter:{get:function(){return(this._alignFlags&s)>0},set:function(t){t?(this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=s):this._alignFlags&=~s},animatable:!1,tooltip:!1},isAlignBottom:{get:function(){return(this._alignFlags&c)>0},set:function(t){this._setAlign(c,t)},animatable:!1,tooltip:!1},isAlignLeft:{get:function(){return(this._alignFlags&a)>0},set:function(t){this._setAlign(a,t)},animatable:!1,tooltip:!1},isAlignHorizontalCenter:{get:function(){return(this._alignFlags&h)>0},set:function(t){t?(this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=h):this._alignFlags&=~h},animatable:!1,tooltip:!1},isAlignRight:{get:function(){return(this._alignFlags&l)>0},set:function(t){this._setAlign(l,t)},animatable:!1,tooltip:!1},isStretchWidth:{get:function(){return(this._alignFlags&d)===d},visible:!1},isStretchHeight:{get:function(){return(this._alignFlags&u)===u},visible:!1},top:{get:function(){return this._top},set:function(t){this._top=t},tooltip:!1},bottom:{get:function(){return this._bottom},set:function(t){this._bottom=t},tooltip:!1},left:{get:function(){return this._left},set:function(t){this._left=t},tooltip:!1},right:{get:function(){return this._right},set:function(t){this._right=t},tooltip:!1},horizontalCenter:{get:function(){return this._horizontalCenter},set:function(t){this._horizontalCenter=t},tooltip:!1},verticalCenter:{get:function(){return this._verticalCenter},set:function(t){this._verticalCenter=t},tooltip:!1},isAbsoluteHorizontalCenter:{get:function(){return this._isAbsHorizontalCenter},set:function(t){this._isAbsHorizontalCenter=t},animatable:!1},isAbsoluteVerticalCenter:{get:function(){return this._isAbsVerticalCenter},set:function(t){this._isAbsVerticalCenter=t},animatable:!1},isAbsoluteTop:{get:function(){return this._isAbsTop},set:function(t){this._isAbsTop=t},animatable:!1},isAbsoluteBottom:{get:function(){return this._isAbsBottom},set:function(t){this._isAbsBottom=t},animatable:!1},isAbsoluteLeft:{get:function(){return this._isAbsLeft},set:function(t){this._isAbsLeft=t},animatable:!1},isAbsoluteRight:{get:function(){return this._isAbsRight},set:function(t){this._isAbsRight=t},animatable:!1},isAlignOnce:{default:!0,tooltip:!1,displayName:"AlignOnce"},_target:null,_alignFlags:0,_left:0,_right:0,_top:0,_bottom:0,_verticalCenter:0,_horizontalCenter:0,_isAbsLeft:!0,_isAbsRight:!0,_isAbsTop:!0,_isAbsBottom:!0,_isAbsHorizontalCenter:!0,_isAbsVerticalCenter:!0,_originalWidth:0,_originalHeight:0},onEnable:function(){n.add(this)},onDisable:function(){n.remove(this)},_setAlign:function(t,e){if(e!=(this._alignFlags&t)>0){var i=(t&d)>0;e?(this._alignFlags|=t,i?(this.isAlignHorizontalCenter=!1,this.isStretchWidth&&(this._originalWidth=this.node.width)):(this.isAlignVerticalCenter=!1,this.isStretchHeight&&(this._originalHeight=this.node.height))):(i?this.isStretchWidth&&(this.node.width=this._originalWidth):this.isStretchHeight&&(this.node.height=this._originalHeight),this._alignFlags&=~t)}},updateAlignment:function(){n.updateAlignment(this.node)}});cc.Widget=e.exports=p}),{"../base-ui/CCWidgetManager":37,"./CCComponent":53}],79:[(function(t,e,i){t("./CCComponent"),t("./CCRendererInSG"),t("./CCRendererUnderSG"),t("./CCComponentEventHandler"),t("./missing-script"),e.exports=[t("./CCSprite"),t("./CCWidget"),t("./CCCanvas"),t("./CCAudioSource"),t("./CCAnimation"),t("./CCButton"),t("./CCLabel"),t("./CCProgressBar"),t("./CCMask"),t("./CCScrollBar"),t("./CCScrollView"),t("./CCPageViewIndicator"),t("./CCPageView"),t("./CCSlider"),t("./CCLayout"),t("./CCEditBox"),t("./CCVideoPlayer"),t("./CCWebView"),t("./CCSpriteDistortion"),t("./CCLabelOutline"),t("./CCRichText"),t("./CCToggleGroup"),t("./CCToggle"),t("./CCBlockInputEvents")]}),{"./CCAnimation":48,"./CCAudioSource":49,"./CCBlockInputEvents":50,"./CCButton":51,"./CCCanvas":52,"./CCComponent":53,"./CCComponentEventHandler":54,"./CCEditBox":55,"./CCLabel":56,"./CCLabelOutline":57,"./CCLayout":58,"./CCMask":59,"./CCPageView":60,"./CCPageViewIndicator":61,"./CCProgressBar":62,"./CCRendererInSG":63,"./CCRendererUnderSG":64,"./CCRichText":65,"./CCScrollBar":67,"./CCScrollView":68,"./CCSlider":69,"./CCSprite":70,"./CCSpriteDistortion":71,"./CCToggle":73,"./CCToggleGroup":74,"./CCVideoPlayer":75,"./CCWebView":77,"./CCWidget":78,"./missing-script":80}],80:[(function(t,e,i){var n=cc.js,o=t("../utils/misc").isBuiltinClassId,r=cc.Class({name:"cc.MissingClass",properties:{_$erialized:{default:null,visible:!1,editorOnly:!0}}}),s=cc.Class({name:"cc.MissingScript",extends:cc.Component,editor:{inspector:"packages://inspector/inspectors/comps/missing-script.js"},properties:{compiled:{default:!1,serializable:!1},_$erialized:{default:null,visible:!1,editorOnly:!0}},ctor:!1,statics:{safeFindClass:function(t,e){var i=n._getClassById(t);return i||(t?(cc.deserialize.reportMissingClass(t),s.getMissingWrapper(t,e)):null)},getMissingWrapper:function(t,e){return e.node&&(/^[0-9a-zA-Z+/]{23}$/.test(t)||o(t))?s:r}},onLoad:function(){cc.warnID(4600,this.node.name)}});cc._MissingScript=e.exports=s}),{"../utils/misc":162}],81:[(function(t,e,i){var n=cc.js;t("../event/event");var o=function(t,e){cc.Event.call(this,cc.Event.MOUSE,e),this._eventType=t,this._button=0,this._x=0,this._y=0,this._prevX=0,this._prevY=0,this._scrollX=0,this._scrollY=0};n.extend(o,cc.Event);var r=o.prototype;r.setScrollData=function(t,e){this._scrollX=t,this._scrollY=e},r.getScrollX=function(){return this._scrollX},r.getScrollY=function(){return this._scrollY},r.setLocation=function(t,e){this._x=t,this._y=e},r.getLocation=function(){return{x:this._x,y:this._y}},r.getLocationInView=function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y}},r._setPrevCursor=function(t,e){this._prevX=t,this._prevY=e},r.getPreviousLocation=function(){return{x:this._prevX,y:this._prevY}},r.getDelta=function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},r.getDeltaX=function(){return this._x-this._prevX},r.getDeltaY=function(){return this._y-this._prevY},r.setButton=function(t){this._button=t},r.getButton=function(){return this._button},r.getLocationX=function(){return this._x},r.getLocationY=function(){return this._y},o.NONE=0,o.DOWN=1,o.UP=2,o.MOVE=3,o.SCROLL=4,o.BUTTON_LEFT=0,o.BUTTON_RIGHT=2,o.BUTTON_MIDDLE=1,o.BUTTON_4=3,o.BUTTON_5=4,o.BUTTON_6=5,o.BUTTON_7=6,o.BUTTON_8=7;var s=function(t,e){cc.Event.call(this,cc.Event.TOUCH,e),this._eventCode=0,this._touches=t||[],this.touch=null,this.currentTouch=null};n.extend(s,cc.Event),(r=s.prototype).getEventCode=function(){return this._eventCode},r.getTouches=function(){return this._touches},r._setEventCode=function(t){this._eventCode=t},r._setTouches=function(t){this._touches=t},r.setLocation=function(t,e){this.touch&&this.touch.setTouchInfo(this.touch.getID(),t,e)},r.getLocation=function(){return this.touch?this.touch.getLocation():cc.v2()},r.getLocationInView=function(){return this.touch?this.touch.getLocationInView():cc.v2()},r.getPreviousLocation=function(){return this.touch?this.touch.getPreviousLocation():cc.v2()},r.getStartLocation=function(){return this.touch?this.touch.getStartLocation():cc.v2()},r.getID=function(){return this.touch?this.touch.getID():null},r.getDelta=function(){return this.touch?this.touch.getDelta():cc.v2()},r.getDeltaX=function(){return this.touch?this.touch.getDelta().x:0},r.getDeltaY=function(){return this.touch?this.touch.getDelta().y:0},r.getLocationX=function(){return this.touch?this.touch.getLocationX():0},r.getLocationY=function(){return this.touch?this.touch.getLocationY():0},s.MAX_TOUCHES=5,s.BEGAN=0,s.MOVED=1,s.ENDED=2,s.CANCELED=3;var c=function(t,e){cc.Event.call(this,cc.Event.ACCELERATION,e),this.acc=t};n.extend(c,cc.Event);var a=function(t,e,i){cc.Event.call(this,cc.Event.KEYBOARD,i),this.keyCode=t,this.isPressed=e};n.extend(a,cc.Event),cc.Event.EventMouse=o,cc.Event.EventTouch=s,cc.Event.EventAcceleration=c,cc.Event.EventKeyboard=a,e.exports=cc.Event}),{"../event/event":85}],82:[(function(t,e,i){var n=t("../event/event-target"),o=cc.Enum({KEY_DOWN:"keydown",KEY_UP:"keyup",DEVICEMOTION:"devicemotion"}),r=null,s=null,c=0,a=cc.Class({name:"SystemEvent",extends:n,statics:{EventType:o},on:function(t,e,i,n){if(this._super(t,e,i,n),(t===o.KEY_DOWN||t===o.KEY_UP)&&(r||(r=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:function(t,e){e.type=o.KEY_DOWN,e.keyCode=t,e.isPressed=!0,cc.systemEvent.dispatchEvent(e)},onKeyReleased:function(t,e){e.type=o.KEY_UP,e.keyCode=t,e.isPressed=!1,cc.systemEvent.dispatchEvent(e)}})),!cc.eventManager.hasEventListener(cc._EventListenerKeyboard.LISTENER_ID))){var a=cc.director.getTotalFrames();a!==c&&(cc.eventManager.addListener(r,1),c=a)}t===o.DEVICEMOTION&&(s||(s=cc.EventListener.create({event:cc.EventListener.ACCELERATION,callback:function(t,e){e.type=o.DEVICEMOTION,e.acc=t,cc.systemEvent.dispatchEvent(e)}})),cc.eventManager.hasEventListener(cc._EventListenerAcceleration.LISTENER_ID)||cc.eventManager.addListener(s,1))},off:function(t,e,i,n){if(this._super(t,e,i,n),r&&(t===o.KEY_DOWN||t===o.KEY_UP)){var c=this.hasEventListener(o.KEY_DOWN),a=this.hasEventListener(o.KEY_UP);c||a||cc.eventManager.removeListener(r)}s&&t===o.DEVICEMOTION&&cc.eventManager.removeListener(s)}});cc.SystemEvent=e.exports=a,cc.systemEvent=new cc.SystemEvent}),{"../event/event-target":84}],83:[(function(i,n,o){function r(){c.call(this)}var s=cc.js,c=i("../platform/callbacks-invoker").CallbacksHandler,a=c.REMOVE_PLACEHOLDER;s.extend(r,c),r.prototype.invoke=function(i,n){var o,r,s,c,h=i.type,l=this._callbackTable[h];if(this._invoking[h]=!0,l)if(1===l.length)(s=l[0])!==a&&s.call(i.currentTarget,i,n);else for(r=l.length-1,o=0;o<=r;){var u=1;if((s=l[o])!==a&&(c=l[o+1],c&&"object"===("object"==(e=typeof c)?t(c):e)?(s.call(c,i,n),u=2):s.call(i.currentTarget,i,n),i._propagationImmediateStopped||o+u>r))break;o+=u}this._invoking[h]=!1,this._clearToRemove(h)},n.exports=r}),{"../platform/callbacks-invoker":145}],84:[(function(i,n,o){function r(){this._capturingListeners=null,this._bubblingListeners=null}var s=i("./event-listeners");i("./event");var c=cc.js.array.fastRemove,a=new Array(16);a.length=0;var h=function(t,e){var i,n;for(e.target=t,a.length=0,t._getCapturingTargets(e.type,a),e.eventPhase=1,n=a.length-1;n>=0;--n)if((i=a[n])._isTargetActive(e.type)&&i._capturingListeners&&(e.currentTarget=i,i._capturingListeners.invoke(e,a),e._propagationStopped))return void(a.length=0);if(a.length=0,t._isTargetActive(e.type)&&(e.eventPhase=2,e.currentTarget=t,t._capturingListeners&&t._capturingListeners.invoke(e),!e._propagationImmediateStopped&&t._bubblingListeners&&t._bubblingListeners.invoke(e)),!e._propagationStopped&&e.bubbles)for(t._getBubblingTargets(e.type,a),e.eventPhase=3,n=0;n<a.length;++n)if((i=a[n])._isTargetActive(e.type)&&i._bubblingListeners&&(e.currentTarget=i,i._bubblingListeners.invoke(e),e._propagationStopped))return void(a.length=0);a.length=0},l=r.prototype;l.hasEventListener=function(t,e){return!!(e&&this._capturingListeners&&this._capturingListeners.has(t))||!(e||!this._bubblingListeners||!this._bubblingListeners.has(t))},l.on=function(i,n,o,r){"boolean"===("object"==(e=typeof o)?t(o):e)?(r=o,o=void 0):r=!!r;if(n){var c=null;return(c=r?this._capturingListeners=this._capturingListeners||new s:this._bubblingListeners=this._bubblingListeners||new s).has(i,n,o)||(c.add(i,n,o),o&&o.__eventTargets&&o.__eventTargets.push(this)),n}cc.errorID(6800)},l.off=function(i,n,o,r){if("boolean"===("object"==(e=typeof o)?t(o):e)?(r=o,o=void 0):r=!!r,n){var s=r?this._capturingListeners:this._bubblingListeners;s&&(s.remove(i,n,o),o&&o.__eventTargets&&c(o.__eventTargets,this))}else this._capturingListeners&&this._capturingListeners.removeAll(i),this._bubblingListeners&&this._bubblingListeners.removeAll(i)},l.targetOff=function(t){this._capturingListeners&&this._capturingListeners.removeAll(t),this._bubblingListeners&&this._bubblingListeners.removeAll(t)},l.once=function(t,e,i,n){var o=this,r=function(s){o.off(t,r,i,n),e.call(this,s)};this.on(t,r,i,n)},l.dispatchEvent=function(t){h(this,t),a.length=0},l.emit=function(t,e){var i=this._capturingListeners&&this._capturingListeners._callbackTable[t],n=this._bubblingListeners&&this._bubblingListeners._callbackTable[t];if(i&&0!==i.length||n&&0!==n.length){var o=cc.Event.EventCustom.get(t);o.detail=e,o.eventPhase=2,o.target=o.currentTarget=this,i&&this._capturingListeners.invoke(o),n&&!o._propagationImmediateStopped&&this._bubblingListeners.invoke(o),cc.Event.EventCustom.put(o)}},l._isTargetActive=function(t){return!0},l._getCapturingTargets=function(t,e){},l._getBubblingTargets=function(t,e){},r.prototype._EventTargetOn=r.prototype.on,r.prototype._EventTargetOnce=r.prototype.once,r.prototype._EventTargetOff=r.prototype.off,r.prototype._EventTargetTargetOff=r.prototype.targetOff,cc.EventTarget=n.exports=r}),{"./event":85,"./event-listeners":83}],85:[(function(t,e,i){var n=t("../platform/js");cc.Event=function(t,e){this.type=t,this.bubbles=!!e,this.target=null,this.currentTarget=null,this.eventPhase=0,this._propagationStopped=!1,this._propagationImmediateStopped=!1},cc.Event.prototype={constructor:cc.Event,unuse:function(){this.type=cc.Event.NO_TYPE,this.target=null,this.currentTarget=null,this.eventPhase=cc.Event.NONE,this._propagationStopped=!1,this._propagationImmediateStopped=!1},reuse:function(t,e){this.type=t,this.bubbles=e||!1},stopPropagation:function(){this._propagationStopped=!0},stopPropagationImmediate:function(){this._propagationImmediateStopped=!0},isStopped:function(){return this._propagationStopped||this._propagationImmediateStopped},getCurrentTarget:function(){return this.currentTarget},getType:function(){return this.type}},cc.Event.NO_TYPE="no_type",cc.Event.TOUCH="touch",cc.Event.MOUSE="mouse",cc.Event.KEYBOARD="keyboard",cc.Event.ACCELERATION="acceleration",cc.Event.NONE=0,cc.Event.CAPTURING_PHASE=1,cc.Event.AT_TARGET=2,cc.Event.BUBBLING_PHASE=3;var o=function(t,e){cc.Event.call(this,t,e),this.detail=null};n.extend(o,cc.Event),o.prototype.reset=o,o.prototype.setUserData=function(t){this.detail=t},o.prototype.getUserData=function(){return this.detail},o.prototype.getEventName=cc.Event.prototype.getType;var r=new n.Pool(10);o.put=function(t){r.put(t)},o.get=function(t,e){var i=r._get();return i?i.reset(t,e):i=new o(t,e),i},cc.Event.EventCustom=o,e.exports=cc.Event}),{"../platform/js":151}],86:[(function(t,e,i){t("./event"),t("./event-listeners"),t("./event-target")}),{"./event":85,"./event-listeners":83,"./event-target":84}],87:[(function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n=e&&e.length,r=n?e[0]*i:t.length,c=o(t,0,r,i,!0),a=[];if(!c)return a;var h,l,d,p,_,f,g;if(n&&(c=u(t,e,c,i)),t.length>80*i){h=d=t[0],l=p=t[1];for(var v=i;v<r;v+=i)_=t[v],f=t[v+1],_<h&&(h=_),f<l&&(l=f),_>d&&(d=_),f>p&&(p=f);g=Math.max(d-h,p-l)}return s(c,a,i,h,l,g),a}function o(t,e,i,n,o){var r,s;if(o===L(t,e,i,n)>0)for(r=e;r<i;r+=n)s=O(r,t[r],t[r+1],s);else for(r=i-n;r>=e;r-=n)s=O(r,t[r],t[r+1],s);return s&&T(s,s.next)&&(I(s),s=s.next),s}function r(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!T(n,n.next)&&0!==C(n.prev,n,n.next))n=n.next;else{if(I(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e}function s(t,e,i,n,o,u,d){if(t){!d&&u&&f(t,n,o,u);for(var p,_,g=t;t.prev!==t.next;)if(p=t.prev,_=t.next,u?a(t,n,o,u):c(t))e.push(p.i/i),e.push(t.i/i),e.push(_.i/i),I(t),t=_.next,g=_.next;else if((t=_)===g){d?1===d?s(t=h(t,e,i),e,i,n,o,u,2):2===d&&l(t,e,i,n,o,u):s(r(t),e,i,n,o,u,1);break}}}function c(t){var e=t.prev,i=t,n=t.next;if(C(e,i,n)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(m(e.x,e.y,i.x,i.y,n.x,n.y,o.x,o.y)&&C(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function a(t,e,i,n){var o=t.prev,r=t,s=t.next;if(C(o,r,s)>=0)return!1;for(var c=o.x<r.x?o.x<s.x?o.x:s.x:r.x<s.x?r.x:s.x,a=o.y<r.y?o.y<s.y?o.y:s.y:r.y<s.y?r.y:s.y,h=o.x>r.x?o.x>s.x?o.x:s.x:r.x>s.x?r.x:s.x,l=o.y>r.y?o.y>s.y?o.y:s.y:r.y>s.y?r.y:s.y,u=v(c,a,e,i,n),d=v(h,l,e,i,n),p=t.nextZ;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&m(o.x,o.y,r.x,r.y,s.x,s.y,p.x,p.y)&&C(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&m(o.x,o.y,r.x,r.y,s.x,s.y,p.x,p.y)&&C(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function h(t,e,i){var n=t;do{var o=n.prev,r=n.next.next;!T(o,r)&&S(o,n,n.next,r)&&x(o,r)&&x(r,o)&&(e.push(o.i/i),e.push(n.i/i),e.push(r.i/i),I(n),I(n.next),n=t=r),n=n.next}while(n!==t);return n}function l(t,e,i,n,o,c){var a=t;do{for(var h=a.next.next;h!==a.prev;){if(a.i!==h.i&&b(a,h)){var l=w(a,h);return a=r(a,a.next),l=r(l,l.next),s(a,e,i,n,o,c),void s(l,e,i,n,o,c)}h=h.next}a=a.next}while(a!==t)}function u(t,e,i,n){var s,c,a,h=[];for(s=0,c=e.length;s<c;s++)(a=o(t,e[s]*n,s<c-1?e[s+1]*n:t.length,n,!1))===a.next&&(a.steiner=!0),h.push(y(a));for(h.sort(d),s=0;s<h.length;s++)p(h[s],i),i=r(i,i.next);return i}function d(t,e){return t.x-e.x}function p(t,e){if(e=_(t,e)){var i=w(e,t);r(i,i.next)}}function _(t,e){var i,n=e,o=t.x,r=t.y,s=-1/0;do{if(r<=n.y&&r>=n.next.y){var c=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(c<=o&&c>s){if(s=c,c===o){if(r===n.y)return n;if(r===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(o===s)return i.prev;var a,h=i,l=i.x,u=i.y,d=1/0;for(n=i.next;n!==h;)o>=n.x&&n.x>=l&&m(r<u?o:s,r,l,u,r<u?s:o,r,n.x,n.y)&&((a=Math.abs(r-n.y)/(o-n.x))<d||a===d&&n.x>i.x)&&x(n,t)&&(i=n,d=a),n=n.next;return i}function f(t,e,i,n){var o=t;do{null===o.z&&(o.z=v(o.x,o.y,e,i,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,g(o)}function g(t){var e,i,n,o,r,s,c,a,h=1;do{for(i=t,t=null,r=null,s=0;i;){for(s++,n=i,c=0,e=0;e<h&&(c++,n=n.nextZ);e++);for(a=h;c>0||a>0&&n;)0===c?(o=n,n=n.nextZ,a--):0!==a&&n?i.z<=n.z?(o=i,i=i.nextZ,c--):(o=n,n=n.nextZ,a--):(o=i,i=i.nextZ,c--),r?r.nextZ=o:t=o,o.prevZ=r,r=o;i=n}r.nextZ=null,h*=2}while(s>1);return t}function v(t,e,i,n,o){return t=32767*(t-i)/o,e=32767*(e-n)/o,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function y(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function m(t,e,i,n,o,r,s,c){return(o-s)*(e-c)-(t-s)*(r-c)>=0&&(t-s)*(n-c)-(i-s)*(e-c)>=0&&(i-s)*(r-c)-(o-s)*(n-c)>=0}function b(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!E(t,e)&&x(t,e)&&x(e,t)&&A(t,e)}function C(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function T(t,e){return t.x===e.x&&t.y===e.y}function S(t,e,i,n){return!!(T(t,e)&&T(i,n)||T(t,n)&&T(i,e))||C(t,e,i)>0!=C(t,e,n)>0&&C(i,n,t)>0!=C(i,n,e)>0}function E(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&S(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function x(t,e){return C(t.prev,t,t.next)<0?C(t,e,t.next)>=0&&C(t,t.prev,e)>=0:C(t,e,t.prev)<0||C(t,t.next,e)<0}function A(t,e){var i=t,n=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&o<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}function w(t,e){var i=new N(t.i,t.x,t.y),n=new N(e.i,e.x,e.y),o=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=o,o.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function O(t,e,i,n){var o=new N(t,e,i);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function I(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function N(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function L(t,e,i,n){for(var o=0,r=e,s=i-n;r<i;r+=n)o+=(t[s]-t[r])*(t[r+1]+t[s+1]),s=r;return o}e.exports=n,n.deviation=function(t,e,i,n){var o=e&&e.length,r=o?e[0]*i:t.length,s=Math.abs(L(t,0,r,i));if(o)for(var c=0,a=e.length;c<a;c++){var h=e[c]*i,l=c<a-1?e[c+1]*i:t.length;s-=Math.abs(L(t,h,l,i))}var u=0;for(c=0;c<n.length;c+=3){var d=n[c]*i,p=n[c+1]*i,_=n[c+2]*i;u+=Math.abs((t[d]-t[_])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[_+1]-t[d+1]))}return 0===s&&0===u?0:Math.abs((u-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var s=0;s<e;s++)i.vertices.push(t[o][r][s]);o>0&&(n+=t[o-1].length,i.holes.push(n))}return i}}),{}],88:[(function(i,n,o){cc.js;var r=i("./types").LineCap,s=i("./types").LineJoin,c=i("./helper"),a=function(t){this._rootCtor(t),this._needDraw=!0,this.cmds=[],this.style={strokeStyle:"black",fillStyle:"white",lineCap:"butt",lineJoin:"miter",miterLimit:10}},h=a.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);h.constructor=a,h._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,this._currentRegion.setTo(0,0,cc.visibleRect.width,cc.visibleRect.height)},h.rendering=function(i,n,o){var r=i||cc._renderContext,s=r.getContext();r.setTransform(this._worldTransform,n,o),s.save(),s.scale(1,-1);var c=this.style;s.strokeStyle=c.strokeStyle,s.fillStyle=c.fillStyle,s.lineWidth=c.lineWidth,s.lineJoin=c.lineJoin,s.miterLimit=c.miterLimit;for(var a=!0,h=this.cmds,l=0,u=h.length;l<u;l++){var d=h[l],p=d[0],_=d[1];"moveTo"===p&&a?(s.beginPath(),a=!1):"fill"!==p&&"stroke"!==p&&"fillRect"!==p||(a=!0),"function"===("object"==(e=typeof s[p])?t(s[p]):e)?s[p].apply(s,_):s[p]=_}s.restore()},h.setStrokeColor=function(t){var e="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")";this.cmds.push(["strokeStyle",e]),this.style.strokeStyle=e},h.setFillColor=function(t){var e="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")";this.cmds.push(["fillStyle",e]),this.style.fillStyle=e},h.setLineWidth=function(t){this.cmds.push(["lineWidth",t]),this.style.lineWidth=t},h.setLineCap=function(t){var e="butt";t===r.BUTT?e="butt":t===r.ROUND?e="round":t===r.SQUARE&&(e="square"),this.cmds.push(["lineCap",e]),this.style.lineCap=e},h.setLineJoin=function(t){var e="bevel";t===s.BEVEL?e="bevel":t===s.ROUND?e="round":t===s.MITER&&(e="miter"),this.cmds.push(["lineJoin",e]),this.style.lineJoin=e},h.setMiterLimit=function(t){this.cmds.push(["miterLimit",t]),this.style.miterLimit=t},h.beginPath=function(){},h.moveTo=function(t,e){this.cmds.push(["moveTo",[t,e]])},h.lineTo=function(t,e){this.cmds.push(["lineTo",[t,e]])},h.bezierCurveTo=function(t,e,i,n,o,r){this.cmds.push(["bezierCurveTo",[t,e,i,n,o,r]])},h.quadraticCurveTo=function(t,e,i,n){this.cmds.push(["quadraticCurveTo",[t,e,i,n]])},h.arc=function(t,e,i,n,o,r){c.arc(this,t,e,i,n,o,r)},h.ellipse=function(t,e,i,n){c.ellipse(this,t,e,i,n)},h.circle=function(t,e,i){c.ellipse(this,t,e,i,i)},h.rect=function(t,e,i,n){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.close()},h.roundRect=function(t,e,i,n,o){c.roundRect(this,t,e,i,n,o)},h.fillRect=function(t,e,i,n){this.cmds.push(["fillRect",[t,e,i,n]]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},h.close=function(){this.cmds.push(["closePath",[]])},h.stroke=function(){this.cmds.push(["stroke",[]]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},h.fill=function(){this.cmds.push(["fill",[]]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},h.clear=function(){this.cmds.length=0,this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},n.exports=a}),{"./helper":92,"./types":94}],89:[(function(t,e,i){var n=t("./graphics-canvas-cmd"),o=t("./graphics-webgl-cmd"),r=t("./types").LineCap,s=t("./types").LineJoin,c=(cc.js,_ccsg.Node.extend({ctor:function(){this._super(),this.strokeColor=cc.Color.BLACK,this.fillColor=cc.Color.WHITE},clear:function(t){this._renderCmd.clear(t)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new n(this):new o(this)}})),a=c.prototype;a._strokeColor=null,a._fillColor=null,a._lineWidth=1,a._lineCap=r.BUTT,a._lineJoin=s.MITER,a._miterLimit=10,a.setStrokeColor=function(t){this._strokeColor=t,this._renderCmd.setStrokeColor(t)},a.getStrokeColor=function(){return this._strokeColor},a.setFillColor=function(t){this._fillColor=t,this._renderCmd.setFillColor(t)},a.getFillColor=function(){return this._fillColor},a.setLineWidth=function(t){this._lineWidth=t,this._renderCmd.setLineWidth(t)},a.getLineWidth=function(){return this._lineWidth},a.setLineCap=function(t){this._lineCap=t,this._renderCmd.setLineCap(t)},a.getLineCap=function(){return this._lineCap},a.setLineJoin=function(t){this._lineJoin=t,this._renderCmd.setLineJoin(t)},a.getLineJoin=function(){return this._lineJoin},a.setMiterLimit=function(t){this._miterLimit=t,this._renderCmd.setMiterLimit(t)},a.getMiterLimit=function(){return this._miterLimit},a.beginPath=function(){this._renderCmd.beginPath()},a.moveTo=function(t,e){this._renderCmd.moveTo(t,e)},a.lineTo=function(t,e){this._renderCmd.lineTo(t,e)},a.bezierCurveTo=function(t,e,i,n,o,r){this._renderCmd.bezierCurveTo(t,e,i,n,o,r)},a.quadraticCurveTo=function(t,e,i,n){this._renderCmd.quadraticCurveTo(t,e,i,n)},a.arc=function(t,e,i,n,o,r){this._renderCmd.arc(t,e,i,n,o,r)},a.ellipse=function(t,e,i,n){this._renderCmd.ellipse(t,e,i,n)},a.circle=function(t,e,i){this._renderCmd.circle(t,e,i)},a.rect=function(t,e,i,n){this._renderCmd.rect(t,e,i,n)},a.roundRect=function(t,e,i,n,o){this._renderCmd.roundRect(t,e,i,n,o)},a.fillRect=function(t,e,i,n){this._renderCmd.fillRect(t,e,i,n)},a.close=function(){this._renderCmd.close()},a.stroke=function(){this._renderCmd.stroke()},a.fill=function(){this._renderCmd.fill()},e.exports=c}),{"./graphics-canvas-cmd":88,"./graphics-webgl-cmd":90,"./types":94}],90:[(function(t,e,i){function n(t,e,i){return t<e?e:t>i?i:t}function o(t,e){d.call(this,t,e),this.reset()}function r(){this.reset()}function s(){this.vertsOffset=0,this.vertsVBO=gl.createBuffer(),this.vertsBuffer=null,this.uint32VertsBuffer=null,this.vertsDirty=!1,this.indicesOffset=0,this.indicesVBO=gl.createBuffer(),this.indicesBuffer=null,this.indicesDirty=!1}function c(t){this._rootCtor(t),this._needDraw=!0;cc._renderContext;this._buffers=[],this._buffer=null,this._allocBuffer(),this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._paths=[],this._points=[],this._curColorValue=0,this._blendFunc=new cc.BlendFunc(cc.macro.BLEND_SRC,cc.macro.BLEND_DST);var e=new cc.GLProgram;e.initWithVertexShaderByteArray(cc.PresetShaders.POSITION_COLOR_VERT,cc.PresetShaders.POSITION_COLOR_FRAG),e.retain(),e.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),e.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),e.link(),e.updateUniforms(),this._shaderProgram=e,this._allocVerts(_)}var a=t("./types").LineCap,h=t("./types").LineJoin,l=t("./earcut"),u=t("./helper"),d=cc.Vec2,p=cc.js,_=32,f=Math.PI,g=Math.min,v=Math.max,y=Math.ceil,m=Math.acos,b=Math.cos,C=Math.sin,T=Math.atan2,S=Math.abs,E=cc.Enum({PT_CORNER:1,PT_LEFT:2,PT_BEVEL:4,PT_INNERBEVEL:8});p.extend(o,d),o.prototype.reset=function(){this.dx=0,this.dy=0,this.dmx=0,this.dmy=0,this.flags=0,this.len=0},r.prototype.reset=function(){this.closed=!1,this.nbevel=0,this.complex=!0,this.points?this.points.length=0:this.points=[]},s.prototype.clear=function(){this.vertsOffset=0,this.indicesOffset=0},s.prototype.alloc=function(t,e){var i=this.vertsOffset+t;if(i>65535)return!1;var n=this.vertsBuffer,o=n?n.length/3:0;if(i>o){for(0===o&&(o=_);i>o;)o*=2;var r=new Float32Array(3*o),s=new Uint32Array(r.buffer);if(n)for(var c=this.uint32VertsBuffer,a=0,h=n.length;a<h;a+=3)r[a]=n[a],r[a+1]=n[a+1],s[a+2]=c[a+2];this.vertsBuffer=r,this.uint32VertsBuffer=s}var l=this.indicesBuffer,u=this.indicesOffset+e,d=l?l.length:0;if(u>d){for(0===d&&(d=3*_);u>d;)d*=2;var p=new Uint16Array(d);if(l)for(var a=0,h=l.length;a<h;a++)p[a]=l[a];this.indicesBuffer=p}return!0},(c.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype)).constructor=c;var x=c.prototype;x._tessTol=.25,x._distTol=.01,x.lineWidth=1,x.lineCap=a.BUTT,x.lineJoin=h.MITER,x.miterLimit=10,x.beginPath=function(){this._pathOffset=this._pathLength},x.moveTo=function(t,e){this._updatePathOffset&&(this._pathOffset=this._pathLength,this._updatePathOffset=!1),this._addPath(),this._addPoint(t,e,E.PT_CORNER),this._commandx=t,this._commandy=e},x.lineTo=function(t,e){this._addPoint(t,e,E.PT_CORNER),this._commandx=t,this._commandy=e},x.bezierCurveTo=function(t,e,i,n,o,r){var s=this._curPath,c=s.points[s.points.length-1];c.x!==t||c.y!==e||i!==o||n!==r?(this._tesselateBezier(c.x,c.y,t,e,i,n,o,r,0,E.PT_CORNER),this._commandx=o,this._commandy=r):this.lineTo(o,r)},x.quadraticCurveTo=function(t,e,i,n){var o=this._commandx,r=this._commandy;this.bezierCurveTo(o+2/3*(t-o),r+2/3*(e-r),i+2/3*(t-i),n+2/3*(e-n),i,n)},x.arc=function(t,e,i,n,o,r){u.arc(this,t,e,i,n,o,r)},x.ellipse=function(t,e,i,n){u.ellipse(this,t,e,i,n),this._curPath.complex=!1},x.circle=function(t,e,i){u.ellipse(this,t,e,i,i),this._curPath.complex=!1},x.rect=function(t,e,i,n){this.moveTo(t,e),this.lineTo(t,e+n),this.lineTo(t+i,e+n),this.lineTo(t+i,e),this.close(),this._curPath.complex=!1},x.roundRect=function(t,e,i,n,o){u.roundRect(this,t,e,i,n,o),this._curPath.complex=!1},x.fillRect=function(t,e,i,n){this.rect(t,e,i,n),this.fill()},x.close=function(){this._curPath.closed=!0},x.stroke=function(){this._flattenPaths();var t=this._strokeColor;this._curColorValue=(t.a<<24>>>0)+(t.b<<16)+(t.g<<8)+t.r,this._expandStroke(),this._updatePathOffset=!0},x.fill=function(){var t=this._fillColor;this._curColorValue=(t.a<<24>>>0)+(t.b<<16)+(t.g<<8)+t.r,this._expandFill(),this._updatePathOffset=!0,this._filling=!1},x._strokeColor=null,x._fillColor=null,x.setStrokeColor=function(t){this._strokeColor=t},x.getStrokeColor=function(){return this._strokeColor},x.setFillColor=function(t){this._fillColor=t},x.getFillColor=function(){return this._fillColor},x.setLineWidth=function(t){this.lineWidth=t},x.setLineJoin=function(t){this.lineJoin=t},x.setLineCap=function(t){this.lineCap=t},x.setMiterLimit=function(t){this.miterLimit=t},p.getset(x,"strokeColor",x.getStrokeColor,x.setStrokeColor),p.getset(x,"fillColor",x.getFillColor,x.setFillColor),x._render=function(){var t=this._buffers;if(0!==t.length)for(var e=cc._renderContext,i=0,n=t.length;i<n;i++){var o=t[i];e.bindBuffer(e.ARRAY_BUFFER,o.vertsVBO),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o.indicesVBO),o.vertsDirty&&(e.bufferData(e.ARRAY_BUFFER,o.vertsBuffer,e.STREAM_DRAW),o.vertsDirty=!1),o.indicesDirty&&o.indicesBuffer&&(e.bufferData(e.ELEMENT_ARRAY_BUFFER,o.indicesBuffer,e.STREAM_DRAW),o.indicesDirty=!1),e.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),e.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),e.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,12,0),e.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,12,8),e.drawElements(e.TRIANGLES,o.indicesOffset,e.UNSIGNED_SHORT,0),cc.g_NumberOfDraws++}},x.rendering=function(){cc.gl.blendFunc(this._blendFunc.src,this._blendFunc.dst);var t=this._worldTransform,e=this._matrix.mat;e[0]=t.a,e[4]=t.c,e[12]=t.tx,e[1]=t.b,e[5]=t.d,e[13]=t.ty;var i=this._shaderProgram;i.use(),i._setUniformForMVPMatrixWithMat4(this._matrix),this._render()},x.clear=function(t){if(this._pathLength=0,this._pathOffset=0,this._pointsOffset=0,this._curPath=null,t)this._paths.length=0,this._points.length=0,this._buffer=null,this._buffers=[];else{for(var e=this._buffers,i=0;i<e.length;i++)e[i].clear();this._buffer=e[0]}},x._updatePathOffset=!1,x._paths=null,x._pathLength=0,x._pathOffset=0,x._points=null,x._pointsOffset=0,x._commandx=0,x._commandy=0,x._addPath=function(){var t=this._pathLength,e=this._paths[t];return e?e.reset():(e=new r,this._paths.push(e)),this._pathLength++,this._curPath=e,e},x._addPoint=function(t,e,i){var n=this._curPath;if(n){var r,s=this._points,c=n.points;(r=s[this._pointsOffset++])?(r.x=t,r.y=e):(r=new o(t,e),s.push(r)),r.flags=i,c.push(r)}},x._flattenPaths=function(){for(var t=this._paths,e=this._pathOffset,i=this._pathLength;e<i;e++){var n=t[e],o=n.points,r=o[o.length-1],s=o[0];r.equals(s)&&(n.closed=!0,o.pop(),r=o[o.length-1]);for(var c=0,a=o.length;c<a;c++){var h=s.sub(r);r.len=h.mag(),(h.x||h.y)&&h.normalizeSelf(),r.dx=h.x,r.dy=h.y,r=s,s=o[c+1]}}},x._allocBuffer=function(){if(this._buffer){var t=this._buffers.indexOf(this._buffer);if(t<this._buffers.length-1)return void(this._buffer=this._buffers[t+1])}var e=new s;this._buffers.push(e),this._buffer=e},x._allocVerts=function(t){this._buffer||this._allocBuffer();var e=3*(t-2*(this._pathLength-this._pathOffset));this._buffer.alloc(t,e)||(this._allocBuffer(),this._buffer.alloc(t,e)),this._buffer.vertsDirty=!0},x._expandStroke=function(){var t=.5*this.lineWidth,e=this.lineCap,i=this.lineJoin,n=this.miterLimit,o=this._curveDivs(t,f,this._tessTol),r=this._paths;this._calculateJoins(t,i,n);for(var s=0,c=this._pathOffset,l=this._pathLength;c<l;c++){b=(y=r[c]).points.length;i===h.ROUND?s+=2*(b+y.nbevel*(o+2)+1):s+=2*(b+5*y.nbevel+1),y.closed||(e===a.ROUND?s+=2*(2*o+2):s+=12)}this._allocVerts(s);for(var u=this._buffer,c=this._pathOffset,l=this._pathLength;c<l;c++){var d,p,_,g,v,y=r[c],m=y.points,b=y.points.length;v=y.closed;var C=u.vertsOffset;if(v?(d=m[b-1],p=m[0],_=0,g=b):(d=m[0],p=m[1],_=1,g=b-1),!v){(w=p.sub(d)).normalizeSelf();var T=w.x,S=w.y;e===a.BUTT?this._buttCap(d,T,S,t,0):e===a.SQUARE?this._buttCap(d,T,S,t,t):e===a.ROUND&&this._roundCapStart(d,T,S,t,o)}for(var x=_;x<g;++x)i===h.ROUND?this._roundJoin(d,p,t,t,o):0!=(p.flags&(E.PT_BEVEL|E.PT_INNERBEVEL))?this._bevelJoin(d,p,t,t):(this._vset(p.x+p.dmx*t,p.y+p.dmy*t),this._vset(p.x-p.dmx*t,p.y-p.dmy*t)),d=p,p=m[x+1];if(v){var A=u.vertsBuffer;this._vset(A[3*C],A[3*C+1]),this._vset(A[3*(C+1)],A[3*(C+1)+1])}else{var w=p.sub(d);w.normalizeSelf();var T=w.x,S=w.y;e===a.BUTT?this._buttCap(p,T,S,t,0):e===a.BUTT||e===a.SQUARE?this._buttCap(p,T,S,t,t):e===a.ROUND&&this._roundCapEnd(p,T,S,t,o)}for(var O=u.indicesOffset,I=u.indicesBuffer,N=C+2,L=u.vertsOffset;N<L;N++)I[O++]=N-2,I[O++]=N-1,I[O++]=N;u.indicesOffset=O,u.indicesDirty=!0}},x._expandFill=function(){for(var t=this._paths,e=0,i=this._pathOffset,n=this._pathLength;i<n;i++)e+=c=(r=t[i]).points.length;this._allocVerts(e);for(var o=this._buffer,i=this._pathOffset,n=this._pathLength;i<n;i++){var r=t[i],s=r.points,c=s.length;if(0!==c){for(var a=o.vertsOffset,h=0;h<c;++h)this._vset(s[h].x,s[h].y,.5,1);var u=r.indicesOffset=o.indicesOffset,d=o.indicesBuffer,p=0;if(r.complex){for(var _=[],f=3*a,g=3*o.vertsOffset,i=f;i<g;i+=3)_.push(o.vertsBuffer[i]),_.push(o.vertsBuffer[i+1]);var v=l(_,null,2);if(!v||0===v.length)continue;for(var h=0,y=p=v.length;h<y;h++)d[u+h]=v[h]+a}else{for(var m=a,f=a+2,g=o.vertsOffset;f<g;f++)d[u++]=m,d[u++]=f-1,d[u++]=f;p=u-o.indicesOffset}o.indicesOffset+=p,o.indicesDirty=!0}}},x._curveDivs=function(t,e,i){var n=2*m(t/(t+i));return v(2,y(e/n))},x._calculateJoins=function(t,e,i){var n=0;t>0&&(n=1/t);for(var o=this._paths,r=this._pathOffset,s=this._pathLength;r<s;r++){var c=o[r],a=c.points,l=a.length,u=a[l-1],d=a[0];c.nbevel=0;for(var p=0;p<l;p++){var _,f,y=u.dy,m=-u.dx,b=d.dy,C=-d.dx;if(d.dmx=.5*(y+b),d.dmy=.5*(m+C),(_=d.dmx*d.dmx+d.dmy*d.dmy)>1e-6){var T=1/_;T>600&&(T=600),d.dmx*=T,d.dmy*=T}d.dx*u.dy-u.dx*d.dy>0&&(0,d.flags|=E.PT_LEFT),_*(f=v(11,g(u.len,d.len)*n))*f<1&&(d.flags|=E.PT_INNERBEVEL),d.flags&E.PT_CORNER&&(_*i*i<1||e===h.BEVEL||e===h.ROUND)&&(d.flags|=E.PT_BEVEL),0!=(d.flags&(E.PT_BEVEL|E.PT_INNERBEVEL))&&c.nbevel++,u=d,d=a[p+1]}}},x._vset=function(t,e){var i=this._buffer,n=3*i.vertsOffset,o=i.vertsBuffer;o[n]=t,o[n+1]=e,i.uint32VertsBuffer[n+2]=this._curColorValue,i.vertsOffset++},x._chooseBevel=function(t,e,i,n){var o,r,s,c,a=i.x,h=i.y;return 0!==t?(o=a+e.dy*n,r=h-e.dx*n,s=a+i.dy*n,c=h-i.dx*n):(o=s=a+i.dmx*n,r=c=h+i.dmy*n),[o,r,s,c]},x._buttCap=function(t,e,i,n,o){var r=t.x-e*o,s=t.y-i*o,c=i,a=-e;this._vset(r+c*n,s+a*n),this._vset(r-c*n,s-a*n)},x._roundCapStart=function(t,e,i,n,o){for(var r=t.x,s=t.y,c=i,a=-e,h=0;h<o;h++){var l=h/(o-1)*f,u=b(l)*n,d=C(l)*n;this._vset(r-c*u-e*d,s-a*u-i*d),this._vset(r,s)}this._vset(r+c*n,s+a*n),this._vset(r-c*n,s-a*n)},x._roundCapEnd=function(t,e,i,n,o){var r=t.x,s=t.y,c=i,a=-e;this._vset(r+c*n,s+a*n),this._vset(r-c*n,s-a*n);for(var h=0;h<o;h++){var l=h/(o-1)*f,u=b(l)*n,d=C(l)*n;this._vset(r,s),this._vset(r-c*u+e*d,s-a*u+i*d)}},x._roundJoin=function(t,e,i,o,r){var s=t.dy,c=-t.dx,a=e.dy,h=-e.dx,l=e.x,u=e.y;if(0!=(e.flags&E.PT_LEFT)){var d=(w=this._chooseBevel(e.flags&E.PT_INNERBEVEL,t,e,i))[0],p=w[1],_=w[2],g=w[3],v=T(-c,-s);(R=T(-h,-a))>v&&(R-=2*f),this._vset(d,p),this._vset(l-s*o,e.y-c*o);for(var m=n(y((v-R)/f)*r,2,r),S=0;S<m;S++){var x=l+b(B=v+(P=S/(m-1))*(R-v))*o,A=u+C(B)*o;this._vset(l,u),this._vset(x,A)}this._vset(_,g),this._vset(l-a*o,u-h*o)}else{var w=this._chooseBevel(e.flags&E.PT_INNERBEVEL,t,e,-o),O=w[0],I=w[1],N=w[2],L=w[3],v=T(c,s),R=T(h,a);R<v&&(R+=2*f),this._vset(l+s*o,u+c*o),this._vset(O,I);for(var m=n(y((R-v)/f)*r,2,r),S=0;S<m;S++){var P=S/(m-1),B=v+P*(R-v),D=l+b(B)*i,M=u+C(B)*i;this._vset(D,M),this._vset(l,u)}this._vset(l+a*o,u+h*o),this._vset(N,L)}},x._bevelJoin=function(t,e,i,n){var o,r,s,c,a,h,l,u,d=t.dy,p=-t.dx,_=e.dy,f=-e.dx;if(e.flags&E.PT_LEFT)a=(g=this._chooseBevel(e.flags&E.PT_INNERBEVEL,t,e,i))[0],h=g[1],l=g[2],u=g[3],this._vset(a,h),this._vset(e.x-d*n,e.y-p*n),this._vset(l,u),this._vset(e.x-_*n,e.y-f*n);else{var g=this._chooseBevel(e.flags&E.PT_INNERBEVEL,t,e,-n);o=g[0],r=g[1],s=g[2],c=g[3],this._vset(e.x+d*i,e.y+p*i),this._vset(o,r),this._vset(e.x+_*i,e.y+f*i),this._vset(s,c)}},x._tesselateBezier=function(t,e,i,n,o,r,s,c,a,h){var l,u,d,p,_,f,g,v,y,m,b,C,T,x,A,w;a>10||(_=.5*(o+s),f=.5*(r+c),g=.5*((l=.5*(t+i))+(d=.5*(i+o))),v=.5*((u=.5*(e+n))+(p=.5*(n+r))),((A=S((i-s)*(x=c-e)-(n-c)*(T=s-t)))+(w=S((o-s)*x-(r-c)*T)))*(A+w)<this._tessTol*(T*T+x*x)?this._addPoint(s,c,0===h?h|E.PT_BEVEL:h):(b=.5*(g+(y=.5*(d+_))),C=.5*(v+(m=.5*(p+f))),this._tesselateBezier(t,e,l,u,g,v,b,C,a+1,0),this._tesselateBezier(b,C,y,m,_,f,s,c,a+1,h)))},e.exports=c}),{"./earcut":87,"./helper":92,"./types":94}],91:[(function(t,e,i){var n=t("./types").LineCap,o=t("./types").LineJoin,r=cc.Class({name:"cc.Graphics",extends:cc._RendererUnderSG,editor:!1,properties:{_lineWidth:1,_strokeColor:cc.Color.BLACK,_lineJoin:o.MITER,_lineCap:n.BUTT,_fillColor:cc.Color.WHITE,_miterLimit:10,lineWidth:{get:function(){return this._lineWidth},set:function(t){this._sgNode.lineWidth=this._lineWidth=t}},lineJoin:{get:function(){return this._lineJoin},set:function(t){this._sgNode.lineJoin=this._lineJoin=t},type:o},lineCap:{get:function(){return this._lineCap},set:function(t){this._sgNode.lineCap=this._lineCap=t},type:n},strokeColor:{get:function(){return this._strokeColor},set:function(t){this._sgNode.strokeColor=this._strokeColor=t}},fillColor:{get:function(){return this._fillColor},set:function(t){this._sgNode.fillColor=this._fillColor=t}},miterLimit:{get:function(){return this._miterLimit},set:function(t){this._sgNode.miterLimit=this._miterLimit=t}}},statics:{LineJoin:o,LineCap:n},_createSgNode:function(){if(!_ccsg.GraphicsNode){var t=new _ccsg.Node,e=function(){};return["moveTo","lineTo","bezierCurveTo","quadraticCurveTo","arc","ellipse","circle","rect","roundRect","fillRect","clear","close","stroke","fill"].forEach((function(i){t[i]=e})),t}return new _ccsg.GraphicsNode},_initSgNode:function(){var t=this._sgNode;t.lineWidth=this._lineWidth,t.lineJoin=this._lineJoin,t.lineCap=this._lineCap,t.strokeColor=this._strokeColor,t.fillColor=this._fillColor,t.miterLimit=this._miterLimit,t.setContentSize(this.node.getContentSize(!0))},moveTo:function(t,e){this._sgNode.moveTo(t,e)},lineTo:function(t,e){this._sgNode.lineTo(t,e)},bezierCurveTo:function(t,e,i,n,o,r){this._sgNode.bezierCurveTo(t,e,i,n,o,r)},quadraticCurveTo:function(t,e,i,n){this._sgNode.quadraticCurveTo(t,e,i,n)},arc:function(t,e,i,n,o,r){r=r||!1,this._sgNode.arc(t,e,i,n,o,r)},ellipse:function(t,e,i,n){this._sgNode.ellipse(t,e,i,n)},circle:function(t,e,i){this._sgNode.circle(t,e,i)},rect:function(t,e,i,n){this._sgNode.rect(t,e,i,n)},roundRect:function(t,e,i,n,o){this._sgNode.roundRect(t,e,i,n,o)},fillRect:function(t,e,i,n){this._sgNode.fillRect(t,e,i,n)},clear:function(t){this._sgNode.clear(!!t)},close:function(){this._sgNode.close()},stroke:function(){this._sgNode.stroke()},fill:function(){this._sgNode.fill()}});cc.Graphics=e.exports=r}),{"./types":94}],92:[(function(t,e,i){var n=Math.PI,o=Math.min,r=Math.max,s=Math.cos,c=Math.sin,a=Math.abs,h=Math.sign,l=.5522847493;e.exports={arc:function(t,e,i,h,l,u,d){var p,_,f=0,g=0,v=0,y=0,m=0,b=0,C=0,T=0,S=0,E=0,x=0,A=0,w=0,O=0;if(g=u-l,d=d||!1)if(a(g)>=2*n)g=2*n;else for(;g<0;)g+=2*n;else if(a(g)>=2*n)g=2*-n;else for(;g>0;)g-=2*n;for(_=0|r(1,o(a(g)/(.5*n)+.5,5)),y=a(4/3*(1-s(v=g/_/2))/c(v)),d||(y=-y),p=0;p<=_;p++)C=e+(m=s(f=l+g*(p/_)))*h,T=i+(b=c(f))*h,S=-b*h*y,E=m*h*y,0===p?t.moveTo(C,T):t.bezierCurveTo(x+w,A+O,C-S,T-E,C,T),x=C,A=T,w=S,O=E},ellipse:function(t,e,i,n,o){t.moveTo(e-n,i),t.bezierCurveTo(e-n,i+o*l,e-n*l,i+o,e,i+o),t.bezierCurveTo(e+n*l,i+o,e+n,i+o*l,e+n,i),t.bezierCurveTo(e+n,i-o*l,e+n*l,i-o,e,i-o),t.bezierCurveTo(e-n*l,i-o,e-n,i-o*l,e-n,i),t.close()},roundRect:function(t,e,i,n,r,s){if(s<.1)t.rect(e,i,n,r);else{var c=o(s,.5*a(n))*h(n),u=o(s,.5*a(r))*h(r);t.moveTo(e,i+u),t.lineTo(e,i+r-u),t.bezierCurveTo(e,i+r-u*(1-l),e+c*(1-l),i+r,e+c,i+r),t.lineTo(e+n-c,i+r),t.bezierCurveTo(e+n-c*(1-l),i+r,e+n,i+r-u*(1-l),e+n,i+r-u),t.lineTo(e+n,i+u),t.bezierCurveTo(e+n,i+u*(1-l),e+n-c*(1-l),i,e+n-c,i),t.lineTo(e+c,i),t.bezierCurveTo(e+c*(1-l),i,e,i+u*(1-l),e,i+u),t.close()}}}}),{}],93:[(function(t,e,i){"use strict";var n;(n=cc.sys.isNative?_ccsg.GraphicsNode=cc.GraphicsNode:_ccsg.GraphicsNode=t("./graphics-node"))&&t("../utils/misc").propertyDefine(n,["lineWidth","lineCap","lineJoin","miterLimit","strokeColor","fillColor"],{}),t("./graphics")}),{"../utils/misc":162,"./graphics":91,"./graphics-node":89}],94:[(function(t,e,i){"use strict";var n=cc.Enum({BUTT:0,ROUND:1,SQUARE:2}),o=cc.Enum({BEVEL:0,ROUND:1,MITER:2});e.exports={LineCap:n,LineJoin:o}}),{}],95:[(function(t,e,i){t("./platform"),t("./assets"),t("./CCNode"),t("./CCScene"),t("./components"),t("./graphics"),t("./collider"),t("./physics"),t("./camera/CCCamera"),t("./base-ui/CCWidgetManager")}),{"./CCNode":23,"./CCScene":24,"./assets":36,"./base-ui/CCWidgetManager":37,"./camera/CCCamera":38,"./collider":46,"./components":79,"./graphics":93,"./physics":124,"./platform":148}],96:[(function(t,e,i){var n=/^(click)(\s)*=/,o=/(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=/;cc.HtmlTextParser=function(){this._parsedObject={},this._specialSymbolArray=[],this._specialSymbolArray.push([/&lt;/g,"<"]),this._specialSymbolArray.push([/&gt;/g,">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"])},cc.HtmlTextParser.prototype={constructor:cc.HtmlTextParser,parse:function(t){this._resultObjectArray=[],this._stack=[];for(var e=0,i=t.length;e<i;){var n=t.indexOf("<",e);if(n<0)this._stack.pop(),this._processResult(t.substring(e)),e=i;else{this._processResult(t.substring(e,n));var o=t.indexOf(">",e);-1===o?o=n:"/"===t.charAt(n+1)?this._stack.pop():this._addToStack(t.substring(n+1,o)),e=o+1}}return this._resultObjectArray},_attributeToObject:function(t){var e,i,n,r,s={},c=(t=t.trim()).match(/^(color|size)(\s)*=/);if(c){if(e=c[0],""===(t=t.substring(e.length).trim()))return s;switch(i=t.indexOf(" "),e[0]){case"c":s.color=i>-1?t.substring(0,i).trim():t;break;case"s":s.size=parseInt(t)}return i>-1&&(r=t.substring(i+1).trim(),n=this._processEventHandler(r),s.event=n),s}if((c=t.match(/^(br(\s)*\/)/))&&c[0].length>0&&(e=c[0].trim()).startsWith("br")&&"/"===e[e.length-1])return s.isNewLine=!0,this._resultObjectArray.push({text:"",style:{newline:!0}}),s;if((c=t.match(/^(img(\s)*src(\s)*=[^>]+\/)/))&&c[0].length>0&&(e=c[0].trim()).startsWith("img")&&"/"===e[e.length-1]){c=t.match(o);for(var a,h=!1;c;)e=(t=t.substring(t.indexOf(c[0]))).substr(0,c[0].length),d=(i=(a=t.substring(e.length).trim()).indexOf(" "))>-1?a.substr(0,i):a,e=(e=e.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),t=a.substring(i).trim(),"src"===e?(s.isImage=!0,d.endsWith("/")&&(d=d.substring(0,d.length-1)),0===d.indexOf("'")?(h=!0,d=d.substring(1,d.length-1)):0===d.indexOf('"')&&(h=!0,d=d.substring(1,d.length-1)),s.src=d):"height"===e?s.imageHeight=parseInt(d):"width"===e?s.imageWidth=parseInt(d):"click"===e&&(s.event=this._processEventHandler(e+"="+d)),c=t.match(o);return h&&s.isImage&&this._resultObjectArray.push({text:"",style:s}),{}}if(c=t.match(/^(outline(\s)*[^>]*)/)){var l={color:"#ffffff",width:1};if(t=c[0].substring("outline".length).trim()){var u=/(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=/;c=t.match(u);for(var d;c;)e=(t=t.substring(t.indexOf(c[0]))).substr(0,c[0].length),d=(i=(a=t.substring(e.length).trim()).indexOf(" "))>-1?a.substr(0,i):a,e=(e=e.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),t=a.substring(i).trim(),"click"===e?s.event=this._processEventHandler(e+"="+d):"color"===e?l.color=d:"width"===e&&(l.width=parseInt(d)),c=t.match(u)}s.outline=l}if((c=t.match(/^(on|u|b|i)(\s)*/))&&c[0].length>0){switch(e=c[0],t=t.substring(e.length).trim(),e[0]){case"u":s.underline=!0;break;case"i":s.italic=!0;break;case"b":s.bold=!0}if(""===t)return s;n=this._processEventHandler(t),s.event=n}return s},_processEventHandler:function(t){for(var e=0,i={},o=t.match(n),r=!1;o;){var s=o[0],c="";if(r=!1,'"'===(t=t.substring(s.length).trim()).charAt(0))(e=t.indexOf('"',1))>-1&&(c=t.substring(1,e).trim(),r=!0),e++;else if("'"===t.charAt(0))(e=t.indexOf("'",1))>-1&&(c=t.substring(1,e).trim(),r=!0),e++;else{var a=t.match(/(\S)+/);e=(c=a?a[0]:"").length}r&&(i[s=s.substring(0,s.length-1).trim()]=c),o=(t=t.substring(e).trim()).match(n)}return i},_addToStack:function(t){var e=this._attributeToObject(t);if(0===this._stack.length)this._stack.push(e);else{if(e.isNewLine||e.isImage)return;var i=this._stack[this._stack.length-1];for(var n in i)e[n]||(e[n]=i[n]);this._stack.push(e)}},_processResult:function(t){""!==t&&(t=this._escapeSpecialSymbol(t),this._stack.length>0?this._resultObjectArray.push({text:t,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:t}))},_escapeSpecialSymbol:function(t){for(var e=0;e<this._specialSymbolArray.length;++e){var i=this._specialSymbolArray[e][0],n=this._specialSymbolArray[e][1];t=t.replace(i,n)}return t}},cc.htmlTextParser=new cc.HtmlTextParser}),{}],97:[(function(t,e,i){var n=function(){this._status="unloaded",this._observers=[],this._isLoadWithCSS=!1};n.prototype.onLoaded=function(){this._status="loaded",this._observers.forEach((function(t){t()}))},n.prototype.isLoaded=function(){return"loaded"===this._status},n.prototype.addHandler=function(t){-1===this._observers.indexOf(t)&&this._observers.push(t)};var o={_fontCache:{},_fontWidthCache:{},_canvasContext:null,_testString:"BESbswy",_allFontsLoaded:!1,_intervalId:0,loadTTF:function(t,e){var i=this._getFontFamily(t),n=cc.loader.md5Pipe;n&&(t=n.transformURL(t));var o=cc.sys.browserType!==cc.sys.BROWSER_TYPE_BAIDU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_BAIDU_APP&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_MOBILE_QQ;window.FontFace&&o?this._loadWithFontFace(i,t,e):this._loadWithCSS(i,t,e),0===this._intervalId&&(this._intervalId=setInterval(this._checkFontLoaded.bind(this),100))},_checkFontLoaded:function(){this._allFontsLoaded=!0;for(var t in this._fontCache){var e=this._fontCache[t];if(!e.isLoaded()&&e._isLoadWithCSS){var i=this._fontWidthCache[t];this._canvasContext.font="40px "+t,i!==this._canvasContext.measureText(this._testString).width?e.onLoaded():this._allFontsLoaded=!1}}this._allFontsLoaded&&(clearInterval(this._intervalId),this._intervalId=0)},_loadWithFontFace:function(t,e,i){var o=this._fontCache[t];if(o)o.isLoaded()||o.addHandler(i);else{var r=new FontFace(t,"url('"+e+"')");document.fonts.add(r),(o=new n).addHandler(i),this._fontCache[t]=o,r.loaded.then((function(){o.onLoaded()}))}},_loadWithCSS:function(t,e,i){var o=this._fontCache[t];if(o)o.isLoaded()||o.addHandler(i);else{var r=document,s=document.createElement("style");s.type="text/css",r.body.appendChild(s);var c="";isNaN(t-0)?c+="@font-face { font-family:"+t+"; src:":c+="@font-face { font-family:'"+t+"'; src:",c+="url('"+e+"');",s.textContent=c+"}";var a=document.createElement("div"),h=a.style;if(h.fontFamily=t,a.innerHTML=".",h.position="absolute",h.left="-100px",h.top="-100px",r.body.appendChild(a),(o=new n).addHandler(i),this._fontCache[t]=o,o._isLoadWithCSS=!0,!this._canvasContext){var l=document.createElement("canvas");l.width=100,l.height=100,this._canvasContext=l.getContext("2d")}var u="40px "+t;this._canvasContext.font=u;var d=this._canvasContext.measureText(this._testString).width;this._fontWidthCache[t]=d;var p=this;s.onload=function(){setTimeout((function(){p._allFontsLoaded||(cc.logID(4004),o.onLoaded(),cc.director.getScheduler().unschedule(this._checkFontLoaded,this))}),2e4)}}},_getFontFamily:function(t){var e=t.lastIndexOf(".ttf");if(-1===e)return t;var i=t.lastIndexOf("/");return-1===i?t.substring(0,e)+"_LABEL":t.substring(i+1,e)+"_LABEL"}},r={label_wordRex:/([a-zA-Z0-9--]+|\S)/,label_symbolRex:/^[!,.:;}\]%\?>]/,label_lastWordRex:/([a-zA-Z0-9--]+|\S)$/,label_lastEnglish:/[a-zA-Z0-9--]+$/,label_firsrEnglish:/^[a-zA-Z0-9--]/,label_wrapinspection:!0,isUnicodeCJK:function(t){var e=/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,i=/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/;return/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/.test(t)||e.test(t)||i.test(t)},isUnicodeSpace:function(t){return(t=t.charCodeAt(0))>=9&&t<=13||32===t||133===t||160===t||5760===t||t>=8192&&t<=8202||8232===t||8233===t||8239===t||8287===t||12288===t},fragmentText:function(t,e,i,n){var o=[];if(0===t.length||i<0)return o.push(""),o;for(var r=t;e>i&&r.length>1;){for(var s=r.length*(i/e)|0,c=r.substr(s),a=e-n(c),h=c,l=0,u=0;a>i&&u++<10;)s*=i/a,s|=0,a=e-n(c=r.substr(s));for(u=0;a<i&&u++<10;){if(c){var d=this.label_wordRex.exec(c);l=d?d[0].length:1,h=c}s+=l,a=e-n(c=r.substr(s))}0===(s-=l)&&(s=1,h=h.substr(1));var p,_=r.substr(0,s);this.label_wrapinspection&&this.label_symbolRex.test(h||c)&&(0===(s-=(p=this.label_lastWordRex.exec(_))?p[0].length:0)&&(s=1),h=r.substr(s),_=r.substr(0,s)),this.label_firsrEnglish.test(h)&&(p=this.label_lastEnglish.exec(_))&&_!==p[0]&&(s-=p[0].length,h=r.substr(s),_=r.substr(0,s)),_.trim().length>0&&o.push(_),e=n(r=h||c)}return r.length>0&&o.push(r),o}};cc.TextUtils=e.exports=r,cc.CustomFontLoader=e.exports=o}),{}],98:[(function(i,n,o){function r(i){var n,o,r;if("object"===("object"==(e=typeof i)?t(i):e)){if(o=i,i.url)return o;n=i.uuid}else o={},n=i;return r=o.type?"uuid"===o.type:cc.AssetLibrary._getAssetUrl(n),cc.AssetLibrary._getAssetInfoInRuntime(n,v),o.url=r?v.url:n,v.url&&"uuid"===o.type&&v.raw?(o.type=null,o.isRawAsset=!0):r||(o.isRawAsset=!0),o}function s(){var t=new l,e=new u,i=new d;a.call(this,[t,e,i]),this.assetLoader=t,this.downloader=e,this.loader=i,this.onProgress=null,this._autoReleaseSetting={}}var c=i("../platform/js"),a=i("./pipeline"),h=i("./loading-items"),l=i("./asset-loader"),u=i("./downloader"),d=i("./loader"),p=i("./asset-table"),_=i("../platform/utils").callInNextTick,f=i("./auto-release-utils"),g=new p,v={url:null,raw:!1},y=[],m=[];c.extend(s,a);var b=s.prototype;b.getXMLHttpRequest=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},b.addDownloadHandlers=function(t){this.downloader.addHandlers(t)},b.addLoadHandlers=function(t){this.loader.addHandlers(t)},b.load=function(t,e,i){void 0===i&&(i=e,e=this.onProgress||null);var n=this,o=!1;t instanceof Array||(o=!0,t=t?[t]:[]),y.length=0;for(var s=0;s<t.length;++s){var c=t[s];c&&c.id&&(cc.warnID(4920,c.id),c.uuid||c.url||(c.url=c.id));var a=r(c);if(a.url||a.uuid){var l=this._cache[a.url];y.push(l||a)}}var u=h.create(this,e,(function(t,e){_((function(){if(i){if(o){r=a.url;i.call(n,e.getError(r),e.getContent(r))}else i.call(n,t,e);i=null}var r;e.destroy()}))}));h.initQueueDeps(u),u.append(y),y.length=0},b.flowInDeps=function(t,e,i){m.length=0;for(var n=0;n<e.length;++n){var o=r(e[n]);if(o.url||o.uuid){var s=this._cache[o.url];s?m.push(s):m.push(o)}}var c=h.create(this,t?function(t,e,i){this._ownerQueue&&this._ownerQueue.onProgress&&this._ownerQueue._childOnProgress(i)}:null,(function(e,n){i(e,n),t&&t.deps&&(t.deps.length=0),n.destroy()}));if(t){var a=h.getQueue(t);c._ownerQueue=a._ownerQueue||a}var l=c.append(m,t);return m.length=0,l},b._resources=g,b._getResUuid=function(t,e,i){if(!t)return null;var n=t.indexOf("?");-1!==n&&(t=t.substr(0,n));var o=g.getUuid(t,e);if(!o){var r=cc.path.extname(t);r&&(t=t.slice(0,-r.length),(o=g.getUuid(t,e))&&!i&&cc.warnID(4901,t,r))}return o},b._getReferenceKey=function(i){var n;return"object"===("object"==(e=typeof i)?t(i):e)?n=i._uuid||null:"string"===("object"==(e=typeof i)?t(i):e)&&(n=this._getResUuid(i,null,!0)||i),n?(cc.AssetLibrary._getAssetInfoInRuntime(n,v),this._cache[v.url]?v.url:n):(cc.warnID(4800,i),n)},b._urlNotFound=function(t,e,i){_((function(){t=cc.url.normalize(t);var n=(e?c.getClassName(e):"Asset")+' in "resources/'+t+'" does not exist.';i&&i(new Error(n),[])}))},b._parseLoadResArgs=function(t,e,i){if(void 0===i){var n=cc.isChildClassOf(t,cc.RawAsset);e?(i=e,n&&(e=this.onProgress||null)):void 0!==e||n||(i=t,e=this.onProgress||null,t=null),void 0===e||n||(e=t,t=null)}return{type:t,onProgress:e,onComplete:i}},b.loadRes=function(t,e,i,n){var o=this._parseLoadResArgs(e,i,n);e=o.type,i=o.onProgress,n=o.onComplete;var r=this,s=r._getResUuid(t,e);s?this.load({type:"uuid",uuid:s},i,(function(t,e){e&&r.setAutoReleaseRecursively(s,!1),n&&n(t,e)})):r._urlNotFound(t,e,n)},b._loadResUuids=function(t,e,i,n){if(t.length>0){var o=this,r=t.map((function(t){return{type:"uuid",uuid:t}}));this.load(r,e,(function(t,e){if(i){for(var s=[],c=n&&[],a=0;a<r.length;++a){var h=r[a].uuid,l=this._getReferenceKey(h),u=e.getContent(l);u&&(o.setAutoReleaseRecursively(h,!1),s.push(u),c&&c.push(n[a]))}n?i(t,s,c):i(t,s)}}))}else i&&_((function(){n?i(null,[],[]):i(null,[])}))},b.loadResArray=function(t,e,i,n){var o=this._parseLoadResArgs(e,i,n);e=o.type,i=o.onProgress,n=o.onComplete;for(var r=[],s=0;s<t.length;s++){var c=t[s],a=this._getResUuid(c,e);if(!a)return void this._urlNotFound(c,e,n);r.push(a)}this._loadResUuids(r,i,n)},b.loadResDir=function(t,e,i,n){var o=this._parseLoadResArgs(e,i,n);e=o.type,i=o.onProgress,n=o.onComplete;var r=[],s=g.getUuidArray(t,e,r);this._loadResUuids(s,i,n,r)},b.getRes=function(t,e){var i=this._cache[t];if(!i){var n=this._getResUuid(t,e,!0);if(!n)return null;var o=this._getReferenceKey(n);i=this._cache[o]}return i&&i.alias&&(i=i.alias),i&&i.complete?i.content:null},b.getResCount=function(){return Object.keys(this._cache).length},b.getDependsRecursively=function(t){if(t){var e=this._getReferenceKey(t),i=f.getDependsRecursively(e);return i.push(e),i}return[]},b.release=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var i=t[e];this.release(i)}else if(t){var n=this._getReferenceKey(t),o=this.getItem(n);if(o){var r=this.removeItem(n);if((t=o.content)instanceof cc.Asset){t instanceof cc.SpriteFrame&&r&&t.release();for(var s=t.rawUrls,c=0;c<s.length;c++)this.release(s[c])}else t instanceof cc.Texture2D&&cc.textureCache.removeTextureForKey(o.url)}}},b.releaseAsset=function(t){var e=t._uuid;e&&this.release(e)},b.releaseRes=function(t,e){var i=this._getResUuid(t,e);i?this.release(i):cc.errorID(4914,t)},b.releaseResDir=function(t,e){for(var i=g.getUuidArray(t,e),n=0;n<i.length;n++){var o=i[n];this.release(o)}},b.releaseAll=function(){for(var t in this._cache)this.release(t)},b.removeItem=function(t){var e=a.prototype.removeItem.call(this,t);return delete this._autoReleaseSetting[t],e},b.setAutoRelease=function(t,e){var i=this._getReferenceKey(t);i&&(this._autoReleaseSetting[i]=!!e)},b.setAutoReleaseRecursively=function(t,e){e=!!e;var i=this._getReferenceKey(t);if(i){this._autoReleaseSetting[i]=e;for(var n=f.getDependsRecursively(i),o=0;o<n.length;o++){var r=n[o];this._autoReleaseSetting[r]=e}}},b.isAutoRelease=function(t){var e=this._getReferenceKey(t);return!!e&&!!this._autoReleaseSetting[e]},cc.loader=new s,n.exports=cc.loader}),{"../platform/js":151,"../platform/utils":156,"./asset-loader":99,"./asset-table":100,"./auto-release-utils":101,"./downloader":102,"./loader":105,"./loading-items":106,"./pipeline":109}],99:[(function(t,e,i){var n=t("../utils/CCPath"),o=t("./pipeline"),r=t("./loading-items"),s="AssetLoader",c=function(t){this.id=s,this.async=!0,this.pipeline=null};c.ID=s;var a=[];c.prototype.handle=function(t,e){var i=t.uuid;if(!i)return t.content?t.content:null;cc.AssetLibrary.queryAssetInfo(i,(function(o,s,c){if(o)e(o);else if(t.url=t.rawUrl=s,t.isRawAsset=c,c){var h=n.extname(s).toLowerCase();if(!h)return void e(new Error("Download Uuid: can not find type of raw asset["+i+"]: "+s));h=h.substr(1);var l=r.getQueue(t);a[0]={queueId:t.queueId,id:s,url:s,type:h,error:null,alias:t,complete:!0},l.append(a),t.type=h,e(null,t.content)}else t.type="uuid",e(null,t.content)}))},o.AssetLoader=e.exports=c}),{"../utils/CCPath":157,"./loading-items":106,"./pipeline":109}],100:[(function(t,e,i){function n(t,e){this.uuid=t,this.type=e}function o(){this._pathToUuid={}}function r(t,e){if(t.length>e.length){var i=t.charCodeAt(e.length);return 46===i||47===i}return!0}var s=o.prototype;s.getUuid=function(t,e){t=cc.url.normalize(t);var i=this._pathToUuid[t];if(i)if(Array.isArray(i)){if(!e)return i[0].uuid;for(var n=0;n<i.length;n++){var o=i[n];if(cc.isChildClassOf(o.type,e))return o.uuid}}else if(!e||cc.isChildClassOf(i.type,e))return i.uuid;return""},s.getUuidArray=function(t,e,i){"/"===(t=cc.url.normalize(t))[t.length-1]&&(t=t.slice(0,-1));var n=this._pathToUuid,o=[],s=cc.isChildClassOf;for(var c in n)if(c.startsWith(t)&&r(c,t)||!t){var a=n[c];if(Array.isArray(a))for(var h=0;h<a.length;h++){var l=a[h];e&&!s(l.type,e)||(o.push(l.uuid),i&&i.push(c))}else e&&!s(a.type,e)||(o.push(a.uuid),i&&i.push(c))}return o},s.getAllPaths=function(){return Object.keys(this._pathToUuid)},s.add=function(t,e,i,o){t=t.substring(0,t.length-cc.path.extname(t).length);var r=new n(e,i),s=this._pathToUuid,c=s[t];c?Array.isArray(c)?o?c.unshift(r):c.push(r):s[t]=o?[r,c]:[c,r]:s[t]=r},s.reset=function(){this._pathToUuid={}},e.exports=o}),{}],101:[(function(i,n,o){function r(t,e){var i=cc.loader.getItem(t);if(i){var n=i.dependKeys;if(n)for(var o=0;o<n.length;o++){var s=n[o];e[s]||(e[s]=!0,r(s,e))}}}function s(t,e){var i=cc.loader._getReferenceKey(t);e[i]||(e[i]=!0,r(i,e))}function c(i,n){for(var o=Object.getOwnPropertyNames(i),r=0;r<o.length;r++){var c=i[o[r]];if("object"===("object"==(e=typeof c)?t(c):e)&&c)if(Array.isArray(c))for(var a=0;a<c.length;a++){var h=c[a];h instanceof cc.RawAsset&&s(h,n)}else if(c.constructor&&c.constructor!==Object)c instanceof cc.RawAsset&&s(c,n);else for(var l=Object.getOwnPropertyNames(c),u=0;u<l.length;u++){var d=c[l[u]];d instanceof cc.RawAsset&&s(d,n)}}}function a(t,e){for(var i=0;i<t._components.length;i++)c(t._components[i],e);for(var n=0;n<t._children.length;n++)a(t._children[n],e)}var h=i("../platform/js");n.exports={autoRelease:function(t,e,i){var n=cc.loader._autoReleaseSetting,o=h.createMap();if(e)for(var r=0;r<e.length;r++)o[e[r]]=!0;for(var s=0;s<i.length;s++)a(i[s],o);if(t)for(var c=0;c<t.length;c++){var l=t[c];!1===n[l]||o[l]||cc.loader.release(l)}for(var u=Object.keys(n),d=0;d<u.length;d++){var p=u[d];!0!==n[p]||o[p]||cc.loader.release(p)}},getDependsRecursively:function(t){var e={};return r(t,e),Object.keys(e)}}}),{"../platform/js":151}],102:[(function(t,e,i){function n(t,e,i,o){void 0===i&&(i=!0);var r=p(t.url);if(o=o||h.imagePool.get(),i&&"file:"!==window.location.protocol?o.crossOrigin="anonymous":o.crossOrigin=null,o.complete&&o.naturalWidth>0&&o.src===r)return o;!(function(){function i(){o.removeEventListener("load",i),o.removeEventListener("error",s),e(null,o)}function s(){o.removeEventListener("load",i),o.removeEventListener("error",s),"https:"!==window.location.protocol&&o.crossOrigin&&"anonymous"===o.crossOrigin.toLowerCase()?n(t,e,!1,o):e(new Error("Load image ("+r+") failed"))}o.addEventListener("load",i),o.addEventListener("error",s),o.src=r})()}function o(t,e,i){var n=document,o=document.createElement("style");o.type="text/css",n.body.appendChild(o);var r="";if(isNaN(t-0)?r+="@font-face { font-family:"+t+"; src:":r+="@font-face { font-family:'"+t+"'; src:",e instanceof Array)for(var s=0,c=e.length;s<c;s++){var h=e[s];i=a.extname(h).toLowerCase(),r+="url('"+e[s]+"') format('"+_[i]+"')",r+=s===c-1?";":","}else i=i.toLowerCase(),r+="url('"+e+"') format('"+_[i]+"');";o.textContent+=r+"}";var l=document.createElement("div"),u=l.style;u.fontFamily=t,l.innerHTML=".",u.position="absolute",u.left="-100px",u.top="-100px",n.body.appendChild(l)}function r(t,e){var i=t.url,n=t.type,r=t.name,s=t.srcs;if(r&&s?(-1===s.indexOf(i)&&s.push(i),o(r,s)):(n=a.extname(i),o(r=a.basename(i,n),i,n)),!document.fonts)return null;document.fonts.load("1em "+r).then((function(){e(null,null)}),(function(t){e(t)}))}var s,c=t("../platform/js"),a=t("../utils/CCPath"),h=t("../utils/misc"),l=t("./pipeline"),u=t("./pack-downloader"),d=t("./text-downloader"),p=t("./utils").urlAppendTimestamp,_={".eot":"embedded-opentype",".ttf":"truetype",".ttc":"truetype",".woff":"woff",".svg":"svg"},f={js:function(t,e,i){function n(){c.parentNode.removeChild(c),c.removeEventListener("load",n,!1),c.removeEventListener("error",o,!1),e(null,r)}function o(){c.parentNode.removeChild(c),c.removeEventListener("load",n,!1),c.removeEventListener("error",o,!1),e(new Error("Load "+r+" failed!"),r)}var r=t.url,s=document,c=document.createElement("script");c.async=i,c.src=p(r),c.addEventListener("load",n,!1),c.addEventListener("error",o,!1),s.body.appendChild(c)},png:n,jpg:n,bmp:n,jpeg:n,gif:n,ico:n,tiff:n,webp:function(t,e,i,o){return cc.sys.capabilities.webp?n(t,e,i,o):new Error("Load Webp ( "+t.url+" ) failed")},image:n,mp3:s=t("./audio-downloader"),ogg:s,wav:s,m4a:s,txt:d,xml:d,vsh:d,fsh:d,atlas:d,tmx:d,tsx:d,json:d,ExportJson:d,plist:d,fnt:d,font:r,eot:r,ttf:r,woff:r,svg:r,ttc:r,uuid:function(t,e){var i=u.load(t,e);return void 0===i?this.extMap.json(t,e):i||void 0},default:d},g="Downloader",v=function(t){this.id=g,this.async=!0,this.pipeline=null,this._curConcurrent=0,this._loadQueue=[],this.extMap=c.mixin(t,f)};v.ID=g,v.prototype.addHandlers=function(t){c.mixin(this.extMap,t)},v.prototype._handleLoadQueue=function(){for(;this._curConcurrent<cc.macro.DOWNLOAD_MAX_CONCURRENT;){var t=this._loadQueue.shift();if(!t)break;var e=this.handle(t.item,t.callback);void 0!==e&&(e instanceof Error?t.callback(e):t.callback(null,e))}},v.prototype.handle=function(t,e){var i=this,n=this.extMap[t.type]||this.extMap.default,o=void 0;if(this._curConcurrent<cc.macro.DOWNLOAD_MAX_CONCURRENT){if(this._curConcurrent++,void 0!==(o=n.call(this,t,(function(t,n){i._curConcurrent=Math.max(0,i._curConcurrent-1),i._handleLoadQueue(),e&&e(t,n)}))))return this._curConcurrent=Math.max(0,this._curConcurrent-1),this._handleLoadQueue(),o}else if(t.ignoreMaxConcurrency){if(void 0!==(o=n.call(this,t,e)))return o}else this._loadQueue.push({item:t,callback:e})},l.Downloader=e.exports=v}),{"../platform/js":151,"../utils/CCPath":157,"../utils/misc":162,"./audio-downloader":218,"./pack-downloader":108,"./pipeline":109,"./text-downloader":110,"./utils":111}],103:[(function(t,e,i){t("./downloader"),t("./loader"),t("./json-unpacker"),t("./loading-items"),t("./pipeline"),t("./CCLoader")}),{"./CCLoader":98,"./downloader":102,"./json-unpacker":104,"./loader":105,"./loading-items":106,"./pipeline":109}],104:[(function(i,n,o){function r(){this.jsons={},this.state=-1}r.prototype.read=function(i,n){var o="string"===("object"==(e=typeof n)?t(n):e)?JSON.parse(n):n;o.length!==i.length&&cc.errorID(4915);for(var r=0;r<i.length;r++){var s=i[r],c=o[r];this.jsons[s]=c}},r.prototype.retrieve=function(t){return this.jsons[t]||null},n.exports=r}),{}],105:[(function(i,n,o){function r(i,n){if("string"!==("object"==(e=typeof i.content)?t(i.content):e))return new Error("JSON Loader: Input item doesn't contain string content");try{return JSON.parse(i.content)}catch(t){return new Error("JSON Loader: Parse json ["+i.id+"] failed : "+t)}}function s(t,e){if(!(t.content instanceof Image))return new Error("Image Loader: Input item doesn't contain Image content");var i=t.rawUrl,n=cc.textureCache.getTextureForKey(i)||new h;return n.url=i,n.initWithElement(t.content),n.handleLoadedTexture(),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&u.imagePool.put(t.content),cc.textureCache.cacheImage(i,n),n}var c=i("../platform/js"),a=i("./pipeline"),h=i("../textures/CCTexture2D"),l=i("./uuid-loader"),u=i("../utils/misc"),d={png:s,jpg:s,bmp:s,jpeg:s,gif:s,ico:s,tiff:s,webp:s,image:s,json:r,ExportJson:r,plist:function(i,n){if("string"!==("object"==(e=typeof i.content)?t(i.content):e))return new Error("Plist Loader: Input item doesn't contain string content");var o=cc.plistParser.parse(i.content);return o||new Error("Plist Loader: Parse ["+i.id+"] failed")},uuid:l,prefab:l,fire:l,scene:l,default:function(t,e){return null}},p=function(t){this.id="Loader",this.async=!0,this.pipeline=null,this.extMap=c.mixin(t,d)};p.ID="Loader",p.prototype.addHandlers=function(t){this.extMap=c.mixin(this.extMap,t)},p.prototype.handle=function(t,e){return(this.extMap[t.type]||this.extMap.default).call(this,t,e)},a.Loader=n.exports=p}),{"../platform/js":151,"../textures/CCTexture2D":218,"../utils/misc":162,"./pipeline":109,"./uuid-loader":112}],106:[(function(i,n,o){function r(i){var n=i.url||i;return"string"===("object"==(e=typeof n)?t(n):e)}function s(t){if(t){var e=t.split("?");if(e&&e[0]&&e[1]){var i={};return e[1].split("&").forEach((function(t){var e=t.split("=");i[e[0]]=e[1]})),i}}}function c(i,n){var o="object"===("object"==(e=typeof i)?t(i):e)?i.url:i,r={queueId:n,id:o,url:o,rawUrl:void 0,urlParam:s(o),type:"",error:null,content:null,complete:!1,states:{},deps:null};if("object"===("object"==(e=typeof i)?t(i):e)&&(u.mixin(r,i),i.skips))for(var c=0;c<i.skips.length;c++){var a=i.skips[c];r.states[a]=f.COMPLETE}return r.rawUrl=r.url,o&&!r.type&&(r.type=l.extname(o).toLowerCase().substr(1)),r}function a(t,e,i){if(!t||!e)return!1;var n=!1;if(v.push(e.id),e.deps){var o,r,s=e.deps;for(o=0;o<s.length;o++){if((r=s[o]).id===t.id){n=!0;break}if(!(v.indexOf(r.id)>=0)&&(r.deps&&a(t,r,!0))){n=!0;break}}}return i||(v.length=0),n}var h=i("../platform/callbacks-invoker"),l=i("../utils/CCPath"),u=i("../platform/js"),d=0|998*Math.random(),p={},_=[],f={WORKING:1,COMPLETE:2,ERROR:3},g={},v=[],y=function(t,e,i,n){h.call(this),this._id=++d,p[this._id]=this,this._pipeline=t,this._errorUrls=[],this._appending=!1,this._ownerQueue=null,this.onProgress=i,this.onComplete=n,this.map={},this.completed={},this.totalCount=0,this.completedCount=0,this._pipeline?this.active=!0:this.active=!1,e&&(e.length>0?this.append(e):this.allComplete())};y.ItemState=new cc.Enum(f),y.create=function(i,n,o,r){void 0===o?"function"===("object"==(e=typeof n)?t(n):e)&&(r=n,n=o=null):void 0===r&&("function"===("object"==(e=typeof n)?t(n):e)?(r=o,o=n,n=null):(r=o,o=null));var s=_.pop();return s?(s._pipeline=i,s.onProgress=o,s.onComplete=r,p[s._id]=s,s._pipeline&&(s.active=!0),n&&s.append(n)):s=new y(i,n,o,r),s},y.getQueue=function(t){return t.queueId?p[t.queueId]:null},y.itemComplete=function(t){var e=p[t.queueId];e&&e.itemComplete(t.id)},y.initQueueDeps=function(t){var e=g[t._id];e?(e.completed.length=0,e.deps.length=0):e=g[t._id]={completed:[],deps:[]}},y.registerQueueDep=function(t,e){var i=t.queueId||t;if(!i)return!1;var n=g[i];if(n)-1===n.deps.indexOf(e)&&n.deps.push(e);else if(t.id)for(var o in g){var r=g[o];-1!==r.deps.indexOf(t.id)&&-1===r.deps.indexOf(e)&&r.deps.push(e)}},y.finishDep=function(t){for(var e in g){var i=g[e];-1!==i.deps.indexOf(t)&&-1===i.completed.indexOf(t)&&i.completed.push(t)}};var m=y.prototype;u.mixin(m,h.prototype),m.append=function(t,e){if(!this.active)return[];e&&!e.deps&&(e.deps=[]),this._appending=!0;var i,n,o,s=[];for(i=0;i<t.length;++i)if(!(n=t[i]).queueId||this.map[n.id]){if(r(n)){var h=(o=c(n,this._id)).id;this.map[h]||(this.map[h]=o,this.totalCount++,e&&e.deps.push(o),y.registerQueueDep(e||this._id,h),s.push(o))}}else{if(this.map[n.id]=n,e&&e.deps.push(n),n.complete||a(e,n)){this.totalCount++,this.itemComplete(n.id);continue}var l=this,u=p[n.queueId];u&&(this.totalCount++,y.registerQueueDep(e||this._id,n.id),u.addListener(n.id,(function(t){l.itemComplete(t.id)})))}return this._appending=!1,this.completedCount===this.totalCount?this.allComplete():this._pipeline.flowIn(s),s},m._childOnProgress=function(t){if(this.onProgress){var e=g[this._id];this.onProgress(e?e.completed.length:this.completedCount,e?e.deps.length:this.totalCount,t)}},m.allComplete=function(){var t=0===this._errorUrls.length?null:this._errorUrls;this.onComplete&&this.onComplete(t,this)},m.isCompleted=function(){return this.completedCount>=this.totalCount},m.isItemCompleted=function(t){return!!this.completed[t]},m.exists=function(t){return!!this.map[t]},m.getContent=function(t){var e=this.map[t],i=null;return e&&(e.content?i=e.content:e.alias&&(i=e.alias.content)),i},m.getError=function(t){var e=this.map[t],i=null;return e&&(e.error?i=e.error:e.alias&&(i=e.alias.error)),i},m.addListener=h.prototype.add,m.hasListener=h.prototype.has,m.removeListener=h.prototype.remove,m.removeAllListeners=h.prototype.removeAll,m.removeItem=function(t){var e=this.map[t];e&&this.completed[e.alias||t]&&(delete this.completed[t],delete this.map[t],e.alias&&(delete this.completed[e.alias.id],delete this.map[e.alias.id]),this.completedCount--,this.totalCount--)},m.itemComplete=function(t){var e=this.map[t];if(e){var i=this._errorUrls.indexOf(t);if(e.error&&-1===i?this._errorUrls.push(t):e.error||-1===i||this._errorUrls.splice(i,1),this.completed[t]=e,this.completedCount++,y.finishDep(e.id),this.onProgress){var n=g[this._id];this.onProgress(n?n.completed.length:this.completedCount,n?n.deps.length:this.totalCount,e)}this.invokeAndRemove(t,e),!this._appending&&this.completedCount>=this.totalCount&&this.allComplete()}},m.destroy=function(){this.active=!1,this._appending=!1,this._pipeline=null,this._ownerQueue=null,this._errorUrls.length=0,this.onProgress=null,this.onComplete=null,this.map={},this.completed={},this.totalCount=0,this.completedCount=0,h.call(this),p[this._id]=null,g[this._id]&&(g[this._id].completed.length=0,g[this._id].deps.length=0),-1===_.indexOf(this)&&_.length<10&&_.push(this)},cc.LoadingItems=n.exports=y}),{"../platform/callbacks-invoker":145,"../platform/js":151,"../utils/CCPath":157}],107:[(function(t,e,i){var n=t("./pipeline"),o="MD5Pipe",r=/(\.[^.\n\\/]*)$/,s=function(t,e,i){this.id=o,this.async=!1,this.pipeline=null,this.md5AssetsMap=t,this.libraryBase=e,this.rawAssetsBase=i};s.ID=o,s.prototype.handle=function(t){return t.url=this.transformURL(t.url),t},s.prototype.transformURL=function(t){var e=t.indexOf("?"),i=t;if(-1!==e&&(i=t.substr(0,e)),i.startsWith(this.libraryBase))i=i.slice(this.libraryBase.length);else{if(!i.startsWith(this.rawAssetsBase))return t;i=i.slice(this.rawAssetsBase.length)}var n=this.md5AssetsMap[i];if(n){var o=!1;t=t.replace(r,(function(t,e){return o=!0,"."+n+e})),o||(t=t+"."+n)}return t},n.MD5Pipe=e.exports=s}),{"./pipeline":109}],108:[(function(t,e,i){function n(t,e){return new Error("Can not retrieve "+t+" from packer "+e)}var o=t("./json-unpacker"),r={},s={},c={},a={Invalid:0,Removed:1,Downloading:2,Loaded:3};e.exports={initPacks:function(t){s=t;for(var e in t)for(var i=t[e],n=0;n<i.length;n++){var o=i[n],c=r[o];if(c){if(Array.isArray(c)?c.push(e):r[o]=c=[c,e],1===i.length){var a=c[0];c[0]=c[c.length-1],c[c.length-1]=a}}else r[o]=e}},_loadNewPack:function(t,e,i){var o=this,r=cc.AssetLibrary.getLibUrlNoExt(e)+".json";cc.loader.load({url:r,ignoreMaxConcurrency:!0},(function(r,s){if(r)return cc.errorID(4916,t),i(r);var c=o._doLoadNewPack(t,e,s);c?i(null,c):i(n(t,e))}))},_doLoadNewPack:function(t,e,i){var n=c[e];return n.state!==a.Loaded&&(n.read(s[e],i),n.state=a.Loaded),n.retrieve(t)},_selectLoadedPack:function(t){for(var e=a.Invalid,i="",n=0;n<t.length;n++){var o=t[n],r=c[o];if(r){var s=r.state;if(s===a.Loaded)return o;s>e&&(e=s,i=o)}}return e!==a.Invalid?i:t[0]},load:function(t,e){var i=t.uuid,s=r[i];if(s){Array.isArray(s)&&(s=this._selectLoadedPack(s));var h=c[s];if(h&&h.state===a.Loaded){var l=h.retrieve(i);return l||n(i,s)}return h||(console.log("Create unpacker %s for %s",s,i),(h=c[s]=new o).state=a.Downloading),this._loadNewPack(i,s,e),null}}}}),{"./json-unpacker":104}],109:[(function(t,e,i){function n(t,e){var i=t.id,o=e.states[i],s=t.next,c=t.pipeline;if(!e.error&&o!==r.WORKING&&o!==r.ERROR)if(o===r.COMPLETE)s?n(s,e):c.flowOut(e);else{e.states[i]=r.WORKING;var a=t.handle(e,(function(t,o){t?(e.error=t,e.states[i]=r.ERROR,c.flowOut(e)):(o&&(e.content=o),e.states[i]=r.COMPLETE,s?n(s,e):c.flowOut(e))}));a instanceof Error?(e.error=a,e.states[i]=r.ERROR,c.flowOut(e)):void 0!==a&&(null!==a&&(e.content=a),e.states[i]=r.COMPLETE,s?n(s,e):c.flowOut(e))}}t("../platform/js");var o=t("./loading-items"),r=o.ItemState,s=function(t){this._pipes=t,this._cache={};for(var e=0;e<t.length;++e){var i=t[e];i.handle&&i.id&&(i.pipeline=this,i.next=e<t.length-1?t[e+1]:null)}};s.ItemState=r;var c=s.prototype;c.insertPipe=function(t,e){if(!t.handle||!t.id||e>this._pipes.length)cc.warnID(4921);else if(this._pipes.indexOf(t)>0)cc.warnID(4922);else{t.pipeline=this;var i=null;e<this._pipes.length&&(i=this._pipes[e]);var n=null;e>0&&(n=this._pipes[e-1]),n&&(n.next=t),t.next=i,this._pipes.splice(e,0,t)}},c.insertPipeAfter=function(t,e){var i=this._pipes.indexOf(t);i<0||this.insertPipe(e,i+1)},c.appendPipe=function(t){t.handle&&t.id&&(t.pipeline=this,t.next=null,this._pipes.length>0&&(this._pipes[this._pipes.length-1].next=t),this._pipes.push(t))},c.flowIn=function(t){var e,i,o=this._pipes[0];if(o){for(e=0;e<t.length;e++)i=t[e],this._cache[i.id]=i;for(e=0;e<t.length;e++)n(o,i=t[e])}else for(e=0;e<t.length;e++)this.flowOut(t[e])},c.flowInDeps=function(t,e,i){return o.create(this,(function(t,e){i(t,e),e.destroy()})).append(e,t)},c.flowOut=function(t){t.error?delete this._cache[t.id]:this._cache[t.id]||(this._cache[t.id]=t),t.complete=!0,o.itemComplete(t)},c.copyItemStates=function(t,e){if(e instanceof Array)for(var i=0;i<e.length;++i)e[i].states=t.states;else e.states=t.states},c.isFlowing=function(){return!0},c.getItems=function(){return null},c.getItem=function(t){var e=this._cache[t];return e?(e.alias&&(e=e.alias),e):e},c.removeItem=function(t){var e=this._cache[t];return e&&e.complete&&delete this._cache[t],e},c.clear=function(){for(var t in this._cache){var e=this._cache[t];delete this._cache[t],e.complete||(e.error=new Error("Canceled manually"),this.flowOut(e))}},cc.Pipeline=e.exports=s}),{"../platform/js":151,"./loading-items":106}],110:[(function(i,n,o){n.exports=function(i,n){var o=i.url,r=jsb.fileUtils.getStringFromFile(o);return"string"===("object"==(e=typeof r)?t(r):e)&&r?r:new Error("Download text failed: "+o)}}),{"./utils":111}],111:[(function(i,n,o){var r=/\?/;n.exports={urlAppendTimestamp:function(i){return cc.game.config.noCache&&"string"===("object"==(e=typeof i)?t(i):e)&&(r.test(i)?i+="&_t="+(new Date-0):i+="?_t="+(new Date-0)),i}}}),{}],112:[(function(i,n,o){function r(t){return t&&(t[0]&&"cc.Scene"===t[0].__type__||t[1]&&"cc.Scene"===t[1].__type__||t[0]&&"cc.Prefab"===t[0].__type__)}function s(t,e,i,n,o,r){var s,c,a,h,u,d=n.uuidList,p=e.dependKeys=[];if(o)for(s=[],c=[],a=[],h=0;h<d.length;h++){u=d[h];var _=n.uuidObjList[h],f=n.uuidPropList[h],g=cc.AssetLibrary._getAssetInfoInRuntime(u);if(g.raw){var v=g.url;_[f]=v,p.push(v)}else s.push(_),c.push(f),a.push({type:"uuid",uuid:u,deferredLoadRaw:!0})}else for(s=n.uuidObjList,c=n.uuidPropList,a=new Array(d.length),h=0;h<d.length;h++)u=d[h],a[h]={type:"uuid",uuid:u};if(n.rawProp&&(s.push(i),c.push(n.rawProp),a.push(e.url)),i._preloadRawFiles){var y=r;r=function(){i._preloadRawFiles((function(t){y(t||null,i)}))}}if(0===a.length)return cc.deserialize.Details.pool.put(n),r(null,i);e.content=i,t.flowInDeps(e,a,(function(t,e){var o;for(var h in e.map)(o=e.map[h]).uuid&&o.content&&(o.content._uuid=o.uuid);for(var u=0;u<a.length;u++){var d=a[u].uuid,_=a[u].url,f=s[u],g=c[u];if(o=e.map[_]){var v={obj:f,prop:g};function y(t){var e=t.isRawAsset?t.rawUrl:t.content;this.obj[this.prop]=e,t.uuid!==i._uuid&&p.indexOf(t.id)<0&&p.push(t.id)}if(o.complete||o.content)o.error?cc._throw(o.error):y.call(v,o);else{var m=l.getQueue(o),b=m._callbackTable[d];b?b.unshift(y,v):m.addListener(d,y,v)}}}cc.deserialize.Details.pool.put(n),r(null,i)}))}function c(t,e,i){return!1}function a(i,n){var o;if("string"===("object"==(e=typeof i.content)?t(i.content):e))try{o=JSON.parse(i.content)}catch(t){return new Error("Uuid Loader: Parse asset ["+i.id+"] failed : "+t.stack)}else{if("object"!==("object"==(e=typeof i.content)?t(i.content):e))return new Error("JSON Loader: Input item doesn't contain string content");o=i.content}var a,l=r(o);a=l?cc._MissingScript.safeFindClass:function(t){var e=h._getClassById(t);return e||(cc.warnID(4903,t),Object)};var u,d=cc.deserialize.Details.pool.get();try{u=cc.deserialize(o,d,{classFinder:a,target:i.existingAsset,customEnv:i})}catch(t){cc.deserialize.Details.pool.put(d);var p=t+"\n"+t.stack;return new Error("Uuid Loader: Deserialize asset ["+i.id+"] failed : "+p)}u._uuid=i.uuid;var _=c(u,i,l);s(this.pipeline,i,u,d,_,n)}var h=i("../platform/js");i("../platform/deserialize");var l=i("./loading-items");n.exports=a,a.isSceneObj=r}),{"../platform/deserialize":146,"../platform/js":151,"./loading-items":106}],113:[(function(i,n,o){function r(t,e,i){e?t._removeComponent(e):h.array.removeAt(t._components,i)}function s(){this._activatingStack=[]}var c=i("./component-scheduler"),a=i("./platform/CCObject").Flags,h=i("./platform/js"),l=a.IsPreloadStarted,u=a.IsOnLoadStarted,d=a.IsOnLoadCalled,p=a.Deactivating,_=cc.Class({extends:c.LifeCycleInvoker,add:function(t){this._zero.array.push(t)},remove:function(t){this._zero.fastRemove(t)},cancelInactive:function(t){c.LifeCycleInvoker.stableRemoveInactive(this._zero,t)},invoke:function(){this._invoke(this._zero),this._zero.array.length=0}}),f=c.createInvokeImpl("c.__preload();"),g=c.createInvokeImpl("c.onLoad();c._objFlags|="+d),v=new h.Pool(4);v.get=function(){var t=this._get()||{preload:new _(f),onLoad:new c.OneOffInvoker(g),onEnable:new c.OneOffInvoker(c.invokeOnEnable)};t.preload._zero.i=-1;var e=t.onLoad;return e._zero.i=-1,e._neg.i=-1,e._pos.i=-1,e=t.onEnable,e._zero.i=-1,e._neg.i=-1,e._pos.i=-1,t};var y=cc.Class({ctor:s,reset:s,_activateNodeRecursively:function(t,e,i,n){if(t._objFlags&p)cc.errorID(3816,t.name);else{t._activeInHierarchy=!0;for(var o=t._components.length,s=0;s<o;++s){var c=t._components[s];c instanceof cc.Component?this.activateComp(c,e,i,n):(r(t,c,s),--s,--o)}for(var a=0,h=t._children.length;a<h;++a){var l=t._children[a];l._active&&this._activateNodeRecursively(l,e,i,n)}t._onPostActivated(!0)}},_deactivateNodeRecursively:function(t){t._objFlags|=p,t._activeInHierarchy=!1;for(var e=t._components.length,i=0;i<e;++i){var n=t._components[i];if(n._enabled&&(cc.director._compScheduler.disableComp(n),t._activeInHierarchy))return void(t._objFlags&=~p)}for(var o=0,r=t._children.length;o<r;++o){var s=t._children[o];if(s._activeInHierarchy&&(this._deactivateNodeRecursively(s),t._activeInHierarchy))return void(t._objFlags&=~p)}t._onPostActivated(!1),t._objFlags&=~p},activateNode:function(t,e){if(e){var i=v.get();this._activatingStack.push(i),this._activateNodeRecursively(t,i.preload,i.onLoad,i.onEnable),i.preload.invoke(),i.onLoad.invoke(),i.onEnable.invoke(),this._activatingStack.pop(),v.put(i)}else{this._deactivateNodeRecursively(t);for(var n=this._activatingStack,o=0;o<n.length;o++){var r=n[o];r.preload.cancelInactive(l),r.onLoad.cancelInactive(u),r.onEnable.cancelInactive()}}t.emit("active-in-hierarchy-changed",t)},activateComp:function(i,n,o,r){if(i._objFlags&l||(i._objFlags|=l,"function"===("object"==(e=typeof i.__preload)?t(i.__preload):e)&&(n?n.add(i):i.__preload())),i._objFlags&u||(i._objFlags|=u,i.onLoad?o?o.add(i):(i.onLoad(),i._objFlags|=d):i._objFlags|=d),i._enabled){if(!i.node._activeInHierarchy)return;cc.director._compScheduler.enableComp(i,r)}},destroyComp:function(t){cc.director._compScheduler.disableComp(t),t.onDestroy&&t._objFlags&d&&t.onDestroy()},resetComp:!1});n.exports=y}),{"./component-scheduler":47,"./platform/CCObject":140,"./platform/js":151,"./utils/misc":162}],114:[(function(t,e,i){function n(){this.localPoint=cc.v2(),this.normalImpulse=0,this.tangentImpulse=0}function o(){}var r=t("./CCPhysicsTypes").PTM_RATIO,s=t("./CCPhysicsTypes").ContactType,c=[],a=[cc.v2(),cc.v2()],h={points:[],separations:[],normal:cc.v2()},l=[new n,new n],u={type:0,localPoint:cc.v2(),localNormal:cc.v2(),points:[]},d={normalImpulses:[],tangentImpulses:[]};o.prototype.init=function(t){this.colliderA=t.GetFixtureA().collider,this.colliderB=t.GetFixtureB().collider,this.disabled=!1,this.disabledOnce=!1,this._impulse=null,this._inverted=!1,this._b2contact=t,t._contact=this},o.prototype.reset=function(){this.colliderA=null,this.colliderB=null,this.disabled=!1,this._impulse=null,this._b2contact._contact=null,this._b2contact=null},o.prototype.getWorldManifold=function(){var t=h.points,e=h.separations,i=h.normal,n=cc.PhysicsUtils.getContactWorldManifoldWrapper(this._b2contact),o=n.getCount();t.length=e.length=o;for(var r=0;r<o;r++){var s=a[r];s.x=n.getX(r),s.y=n.getY(r),t[r]=s,e[r]=n.getSeparation(r)}return i.x=n.getNormalX(),i.y=n.getNormalY(),this._inverted&&(i.x*=-1,i.y*=-1),h},o.prototype.getManifold=function(){for(var t,e=u.points,i=u.localNormal,n=u.localPoint,o=cc.PhysicsUtils.getContactManifoldWrapper(),r=e.length=o.getCount(),s=0;s<r;s++)(t=l[s]).localPoint.x=o.getX(s),t.localPoint.y=o.getX(s),t.normalImpulse=o.getNormalImpulse(s),t.tangentImpulse=o.getTangentImpulse(s),e[s]=t;return i.x=o.getLocalNormalX(),i.y=o.getLocalNormalY(),n.x=o.getLocalPointX(),n.y=o.getLocalPointY(),u.type=o.getType(),this._inverted&&(i.x*=-1,i.y*=-1),u},o.prototype.getImpulse=function(){var t=this._impulse;if(!t)return null;var e,i=d.normalImpulses,n=d.tangentImpulses;e=t.getCount();for(var o=0;o<e;o++)i[o]=t.getNormalImpulse(o),n[o]=t.getTangentImpulse(o);return n.length=i.length=e,d},o.prototype.emit=function(t){var e;switch(t){case s.BEGIN_CONTACT:e="onBeginContact";break;case s.END_CONTACT:e="onEndContact";break;case s.PRE_SOLVE:e="onPreSolve";break;case s.POST_SOLVE:e="onPostSolve"}var i,n,o,r,c=this.colliderA,a=this.colliderB,h=c.body,l=a.body;if(h.enabledContactListener)for(i=h.node._components,this._inverted=!1,n=0,o=i.length;n<o;n++)(r=i[n])[e]&&r[e](this,c,a);if(l.enabledContactListener)for(i=l.node._components,this._inverted=!0,n=0,o=i.length;n<o;n++)(r=i[n])[e]&&r[e](this,a,c);(this.disabled||this.disabledOnce)&&(this.setEnabled(!1),this.disabledOnce=!1)},o.get=function(t){var e;return(e=0===c.length?new cc.PhysicsContact:c.pop()).init(t),e},o.put=function(t){var e=t._contact;e&&(c.push(e),e.reset())};var p=o.prototype;p.setEnabled=function(t){this._b2contact.SetEnabled(t)},p.isTouching=function(){return this._b2contact.IsTouching()},p.setTangentSpeed=function(t){this._b2contact.SetTangentSpeed(t/r)},p.getTangentSpeed=function(){return this._b2contact.GetTangentSpeed()*r},p.setFriction=function(t){this._b2contact.SetFriction(t)},p.getFriction=function(){return this._b2contact.GetFriction()},p.resetFriction=function(){return this._b2contact.ResetFriction()},p.setRestitution=function(t){this._b2contact.SetRestitution(t)},p.getRestitution=function(){return this._b2contact.GetRestitution()},p.resetRestitution=function(){return this._b2contact.ResetRestitution()},o.ContactType=s,cc.PhysicsContact=e.exports=o}),{"./CCPhysicsTypes":116}],115:[(function(t,e,i){var n=t("./CCPhysicsTypes").ContactType,o=t("./CCPhysicsTypes").BodyType,r=t("./CCPhysicsTypes").RayCastType,s=t("./CCPhysicsTypes").PTM_RATIO,c=(t("./CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,t("./CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE,new b2.AABB),a=new b2.Vec2,h=new b2.Vec2,l=cc.Class({mixins:[cc.EventTarget],statics:{DrawBits:b2.Draw,PTM_RATIO:s,VELOCITY_ITERATIONS:10,POSITION_ITERATIONS:10},ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._debugDrawFlags=0,this._debugDrawer=null,this._world=null,this._bodies=[],this._contactMap={},this._contactID=0,this._delayEvents=[],this._accumulator=0,this.enabledAccumulator=!1},pushDelayEvent:function(t,e,i){this._steping?this._delayEvents.push({target:t,func:e,args:i}):t[e].apply(t,i)},update:function(t){var e=this._world;if(e&&this.enabled){this.emit("before-step"),this._steping=!0;var i=l.VELOCITY_ITERATIONS,n=l.POSITION_ITERATIONS;if(this.enabledAccumulator)for(this._accumulator+=t,this._accumulator>.2&&(this._accumulator=.2);this._accumulator>1/60;)e.Step(1/60,i,n),this._accumulator-=1/60;else{var o=1/cc.game.config.frameRate;e.Step(o,i,n)}e.DrawDebugData(),this._steping=!1;for(var r=this._delayEvents,s=0,c=r.length;s<c;s++){var a=r[s];a.target[a.func].apply(a.target,a.args)}r.length=0,this._syncNode()}},testPoint:function(t){var e=a.x=t.x/s,i=a.y=t.y/s,n=.2/s;c.lowerBound.x=e-n,c.lowerBound.y=i-n,c.upperBound.x=e+n,c.upperBound.y=i+n;var o=this._aabbQueryCallback;o.init(a),this._world.QueryAABB(o,c);var r=o.getFixture();return r?r.collider:null},testAABB:function(t){c.lowerBound.x=t.xMin/s,c.lowerBound.y=t.yMin/s,c.upperBound.x=t.xMax/s,c.upperBound.y=t.yMax/s;var e=this._aabbQueryCallback;return e.init(),this._world.QueryAABB(e,c),e.getFixtures().map((function(t){return t.collider}))},rayCast:function(t,e,i){if(t.equals(e))return[];i=i||r.Closest,a.x=t.x/s,a.y=t.y/s,h.x=e.x/s,h.y=e.y/s;var n=this._raycastQueryCallback;n.init(i),this._world.RayCast(n,a,h);var o=n.getFixtures();if(o.length>0){for(var c=n.getPoints(),l=n.getNormals(),u=n.getFractions(),d=[],p=0,_=o.length;p<_;p++){var f=o[p],g=f.collider;if(i===r.AllClosest){var v=d.find((function(t){return t.collider===g}));if(v){u[p]<v.fraction&&(v.fixtureIndex=g._getFixtureIndex(f),v.point.x=c[p].x*s,v.point.y=c[p].y*s,v.normal.x=l[p].x,v.normal.y=l[p].y,v.fraction=u[p]);continue}}d.push({collider:g,fixtureIndex:g._getFixtureIndex(f),point:cc.v2(c[p].x*s,c[p].y*s),normal:cc.v2(l[p]),fraction:u[p]})}return d}return[]},syncPosition:function(){for(var t=this._bodies,e=0;e<t.length;e++)t[e].syncPosition()},syncRotation:function(){for(var t=this._bodies,e=0;e<t.length;e++)t[e].syncRotation()},attachDebugDrawToCamera:function(t){this._debugDrawer&&t.addTarget(this._debugDrawer.getDrawer())},detachDebugDrawFromCamera:function(t){this._debugDrawer&&t.removeTarget(this._debugDrawer.getDrawer())},_registerContactFixture:function(t){this._contactListener.registerContactFixture(t)},_unregisterContactFixture:function(t){this._contactListener.unregisterContactFixture(t)},_addBody:function(t,e){var i=this._world,n=t.node;i&&n&&(t._b2Body=i.CreateBody(e),t._b2Body.SetUserData(n._sgNode),t._b2Body.body=t,this._utils.addB2Body(t._b2Body),this._bodies.push(t))},_removeBody:function(t){var e=this._world;if(e){t._b2Body.SetUserData(null),t._b2Body.body=null,this._utils.removeB2Body(t._b2Body),e.DestroyBody(t._b2Body),t._b2Body=null;var i=this._bodies.indexOf(t);-1!==i&&this._bodies.splice(i,1)}},_initCallback:function(){if(this._world){if(!this._contactListener){var t=new cc.PhysicsContactListener;t.setBeginContact(this._onBeginContact),t.setEndContact(this._onEndContact),t.setPreSolve(this._onPreSolve),t.setPostSolve(this._onPostSolve),this._world.SetContactListener(t),this._contactListener=t,this._aabbQueryCallback=new cc.PhysicsAABBQueryCallback,this._raycastQueryCallback=new cc.PhysicsRayCastCallback}}else cc.warn("Please init PhysicsManager first")},_init:function(){this.enabled=!0,this.debugDrawFlags=b2.Draw.e_shapeBit},_getWorld:function(){return this._world},_syncNode:function(){this._utils.syncNode();for(var t=this._bodies,e=0,i=t.length;e<i;e++){var n=t[e],r=n.node;r._position.x=r._sgNode.getPositionX(),r._position.y=r._sgNode.getPositionY(),r._rotationX=r._rotationY=r._sgNode.getRotation(),n.type===o.Animated&&n.resetVelocity()}},_onSceneLaunched:function(){this._debugDrawer.AddDrawerToNode(cc.director.getScene()._sgNode)},_onBeginContact:function(t){cc.PhysicsContact.get(t).emit(n.BEGIN_CONTACT)},_onEndContact:function(t){var e=t._contact;e&&(e.emit(n.END_CONTACT),cc.PhysicsContact.put(t))},_onPreSolve:function(t){var e=t._contact;e&&e.emit(n.PRE_SOLVE)},_onPostSolve:function(t,e){var i=t._contact;i&&(i._impulse=e,i.emit(n.POST_SOLVE),i._impulse=null)}});cc.js.getset(l.prototype,"enabled",(function(){return this._enabled}),(function(t){if(t&&!this._world){var e=new b2.World(new b2.Vec2(0,-10));e.SetAllowSleeping(!0),this._world=e,this._utils=new cc.PhysicsUtils,this._initCallback()}this._enabled=t})),cc.js.getset(l.prototype,"debugDrawFlags",(function(){return this._debugDrawFlags}),(function(t){t&&!this._debugDrawFlags?(this._debugDrawer||(this._debugDrawer=new cc.PhysicsDebugDraw(s),this._world.SetDebugDraw(this._debugDrawer)),cc.director.getScene()&&this._debugDrawer.AddDrawerToNode(cc.director.getScene()._sgNode),cc.director.on(cc.Director.EVENT_AFTER_SCENE_LAUNCH,this._onSceneLaunched,this)):!t&&this._debugDrawFlags&&cc.director.off(cc.Director.EVENT_AFTER_SCENE_LAUNCH,this._onSceneLaunched,this),this._debugDrawFlags=t,this._debugDrawer&&this._debugDrawer.SetFlags(t)})),cc.js.getset(l.prototype,"gravity",(function(){if(this._world){var t=this._world.GetGravity();return cc.v2(t.x*s,t.y*s)}return cc.v2()}),(function(t){this._world&&this._world.SetGravity(new b2.Vec2(t.x/s,t.y/s))})),cc.PhysicsManager=e.exports=l}),{"./CCPhysicsTypes":116}],116:[(function(t,e,i){var n={BEGIN_CONTACT:"begin-contact",END_CONTACT:"end-contact",PRE_SOLVE:"pre-solve",POST_SOLVE:"post-solve"},o=cc.Enum({Static:0,Kinematic:1,Dynamic:2,Animated:3});cc.RigidBodyType=o;var r=cc.Enum({Closest:0,Any:1,AllClosest:2,All:3});cc.RayCastType=r,e.exports={BodyType:o,ContactType:n,RayCastType:r,PTM_RATIO:32,ANGLE_TO_PHYSICS_ANGLE:-Math.PI/180,PHYSICS_ANGLE_TO_ANGLE:-180/Math.PI}}),{}],117:[(function(i,n,o){function r(t,e){var i=e.length;return e[t<0?i- -t%i:t%i]}function s(t,e,i){for(var n=[];e<t;)e+=i.length;for(;t<=e;++t)n.push(r(t,i));return n}function c(t){f(t);for(var e,i,n,o,g,v,m=[],b=cc.v2(),C=cc.v2(),T=0,S=0,E=0;E<t.length;++E)if(h(E,t)){i=n=1e8;for(O=0;O<t.length;++O)u(r(E-1,t),r(E,t),r(O,t))&&p(r(E-1,t),r(E,t),r(O-1,t))&&(o=y(r(E-1,t),r(E,t),r(O,t),r(O-1,t)),l(r(E+1,t),r(E,t),o)&&(e=_(r(E,t),o))<i&&(i=e,b=o,T=O)),u(r(E+1,t),r(E,t),r(O+1,t))&&p(r(E+1,t),r(E,t),r(O,t))&&(o=y(r(E+1,t),r(E,t),r(O,t),r(O+1,t)),u(r(E-1,t),r(E,t),o)&&(e=_(r(E,t),o))<n&&(n=e,S=O,C=o));if(T==(S+1)%t.length){var x=b.add(C).div(2);(g=s(E,S,t)).push(x),(v=s(T,E,t)).push(x)}else{for(var A=0,w=T;S<T;)S+=t.length;for(var O=T;O<=S;++O)if(a(E,O,t)){var I=1/(_(r(E,t),r(O,t))+1);h(O,t)?p(r(O-1,t),r(O,t),r(E,t))&&d(r(O+1,t),r(O,t),r(E,t))?I+=3:I+=2:I+=1,I>A&&(w=O,A=I)}g=s(E,w,t),v=s(w,E,t)}return m=m.concat(c(g)),m=m.concat(c(v))}m.push(t);for(E=m.length-1;E>=0;E--)0==m[E].length&&m.splice(E,0);return m}function a(t,e,i){if(h(t,i)){if(d(r(t,i),r(t-1,i),r(e,i))&&p(r(t,i),r(t+1,i),r(e,i)))return!1}else if(p(r(t,i),r(t+1,i),r(e,i))||d(r(t,i),r(t-1,i),r(e,i)))return!1;if(h(e,i)){if(d(r(e,i),r(e-1,i),r(t,i))&&p(r(e,i),r(e+1,i),r(t,i)))return!1}else if(p(r(e,i),r(e+1,i),r(t,i))||d(r(e,i),r(e-1,i),r(t,i)))return!1;for(var n=0;n<i.length;++n)if((n+1)%i.length!=t&&n!=t&&(n+1)%i.length!=e&&n!=e){var o=cc.v2();if(m(r(t,i),r(e,i),r(n,i),r(n+1,i),o))return!1}return!0}function h(t,e){return l(t,e)}function l(i,n,o){if("undefined"===("object"==(e=typeof o)?t(o):e)){var s=i,c=n;i=r(s-1,c),n=r(s,c),o=r(s+1,c)}return C(i,n,o)<0}function u(t,e,i){return C(t,e,i)>0}function d(t,e,i){return C(t,e,i)>=0}function p(t,e,i){return C(t,e,i)<=0}function _(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function f(t){g(t)||t.reverse()}function g(t){return t.length<3||v(t)>0}function v(t){var e,i=0;for(e=0;e<t.length;e++){var n=(e+1)%t.length;i+=t[e].x*t[n].y,i-=t[e].y*t[n].x}return i/=2}function y(t,e,i,n){var o=cc.v2(),r=e.y-t.y,s=t.x-e.x,c=r*t.x+s*t.y,a=n.y-i.y,h=i.x-n.x,l=a*i.x+h*i.y,u=r*h-a*s;return b(u,0)||(o.x=(h*c-s*l)/u,o.y=(r*l-a*c)/u),o}function m(t,e,i,n,o){if(t==i||t==n||e==i||e==n)return!1;var r=t.x,s=t.y,c=e.x,a=e.y,h=i.x,l=i.y,u=n.x,d=n.y;if(Math.max(r,c)<Math.min(h,u)||Math.max(h,u)<Math.min(r,c))return!1;if(Math.max(s,a)<Math.min(l,d)||Math.max(l,d)<Math.min(s,a))return!1;var p=(u-h)*(s-l)-(d-l)*(r-h),_=(c-r)*(s-l)-(a-s)*(r-h),f=(d-l)*(c-r)-(u-h)*(a-s);return!(Math.abs(f)<1e-6)&&(p/=f,_/=f,0<p&&p<1&&0<_&&_<1&&(o.x=r+p*(c-r),o.y=s+p*(a-s),!0))}function b(t,e){return Math.abs(t-e)<=1e-6}function C(t,e,i){return t.x*(e.y-i.y)+e.x*(i.y-t.y)+i.x*(t.y-e.y)}n.exports={ConvexPartition:c,ForceCounterClockWise:f,IsCounterClockWise:g}}),{}],118:[(function(t,e,i){var n=t("./CCPhysicsTypes").PTM_RATIO,o=t("./CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,r=t("./CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE,s=t("./utils").getWorldRotation,c=t("./CCPhysicsTypes").BodyType,a=new b2.Vec2,h=new b2.Vec2,l=cc.Vec2.ZERO,u=cc.Class({name:"cc.RigidBody",extends:cc.Component,editor:!1,properties:{_type:c.Dynamic,_allowSleep:!0,_gravityScale:1,_linearDamping:0,_angularDamping:0,_linearVelocity:cc.v2(0,0),_angularVelocity:0,_fixedRotation:!1,enabled:{get:function(){return this._enabled},set:function(){cc.warnID("8200")},visible:!1,override:!0},enabledContactListener:{default:!1,tooltip:!1},bullet:{default:!1,tooltip:!1},type:{type:c,tooltip:!1,get:function(){return this._type},set:function(t){this._type=t,this._b2Body&&(t===c.Animated?this._b2Body.SetType(c.Kinematic):this._b2Body.SetType(t))}},allowSleep:{tooltip:!1,get:function(){return this._b2Body?this._b2Body.IsSleepingAllowed():this._allowSleep},set:function(t){this._allowSleep=t,this._b2Body&&this._b2Body.SetAllowSleeping(t)}},gravityScale:{tooltip:!1,get:function(){return this._gravityScale},set:function(t){this._gravityScale=t,this._b2Body&&this._b2Body.SetGravityScale(t)}},linearDamping:{tooltip:!1,get:function(){return this._linearDamping},set:function(t){this._linearDamping=t,this._b2Body&&this._b2Body.SetLinearDamping(this._linearDamping)}},angularDamping:{tooltip:!1,get:function(){return this._angularDamping},set:function(t){this._angularDamping=t,this._b2Body&&this._b2Body.SetAngularDamping(t)}},linearVelocity:{tooltip:!1,type:cc.Vec2,get:function(){var t=this._linearVelocity;if(this._b2Body){var e=this._b2Body.GetLinearVelocity();t.x=e.x*n,t.y=e.y*n}return t},set:function(t){this._linearVelocity=t;var e=this._b2Body;if(e){var i=a;i.Set(t.x/n,t.y/n),e.SetLinearVelocity(i)}}},angularVelocity:{tooltip:!1,get:function(){return this._b2Body?this._b2Body.GetAngularVelocity()*r:this._angularVelocity},set:function(t){this._angularVelocity=t,this._b2Body&&this._b2Body.SetAngularVelocity(t*o)}},fixedRotation:{tooltip:!1,get:function(){return this._fixedRotation},set:function(t){this._fixedRotation=t,this._b2Body&&this._b2Body.SetFixedRotation(t)}},awake:{tooltip:!1,get:function(){return!!this._b2Body&&this._b2Body.IsAwake()},set:function(t){this._b2Body&&this._b2Body.SetAwake(t)}},active:{visible:!1,get:function(){return!!this._b2Body&&this._b2Body.IsActive()},set:function(t){this._b2Body&&this._b2Body.SetActive(t)}}},getLocalPoint:function(t,e){if(e=e||cc.v2(),this._b2Body){a.Set(t.x/n,t.y/n);var i=this._b2Body.GetLocalPoint(a);e.x=i.x*n,e.y=i.y*n}return e},getWorldPoint:function(t,e){if(e=e||cc.v2(),this._b2Body){a.Set(t.x/n,t.y/n);var i=this._b2Body.GetWorldPoint(a);e.x=i.x*n,e.y=i.y*n}return e},getWorldVector:function(t,e){if(e=e||cc.v2(),this._b2Body){a.Set(t.x/n,t.y/n);var i=this._b2Body.GetWorldVector(a);e.x=i.x*n,e.y=i.y*n}return e},getLocalVector:function(t,e){if(e=e||cc.v2(),this._b2Body){a.Set(t.x/n,t.y/n);var i=this._b2Body.GetLocalVector(a);e.x=i.x*n,e.y=i.y*n}return e},getWorldPosition:function(t){if(t=t||cc.v2(),this._b2Body){var e=this._b2Body.GetPosition();t.x=e.x*n,t.y=e.y*n}return t},getWorldRotation:function(){return this._b2Body?this._b2Body.GetAngle()*r:0},getLocalCenter:function(t){if(t=t||cc.v2(),this._b2Body){var e=this._b2Body.GetLocalCenter();t.x=e.x*n,t.y=e.y*n}return t},getWorldCenter:function(t){if(t=t||cc.v2(),this._b2Body){var e=this._b2Body.GetWorldCenter();t.x=e.x*n,t.y=e.y*n}return t},getLinearVelocityFromWorldPoint:function(t,e){if(e=e||cc.v2(),this._b2Body){a.Set(t.x/n,t.y/n);var i=this._b2Body.GetLinearVelocityFromWorldPoint(a);e.x=i.x*n,e.y=i.y*n}return e},getMass:function(){return this._b2Body?this._b2Body.GetMass():0},getInertia:function(){return this._b2Body?this._b2Body.GetInertia()*n*n:0},getJointList:function(){if(!this._b2Body)return[];for(var t=this._b2Body.GetJointList(),e=0;e<t.length;e++)t[e]=t[e]._joint;return t},applyForce:function(t,e,i){this._b2Body&&(a.Set(t.x/n,t.y/n),h.Set(e.x/n,e.y/n),this._b2Body.ApplyForce(a,h,i))},applyForceToCenter:function(t,e){this._b2Body&&(a.Set(t.x/n,t.y/n),this._b2Body.ApplyForceToCenter(a,e))},applyTorque:function(t,e){this._b2Body&&this._b2Body.ApplyTorque(t/n,e)},applyLinearImpulse:function(t,e,i){this._b2Body&&(a.Set(t.x/n,t.y/n),h.Set(e.x/n,e.y/n),this._b2Body.ApplyLinearImpulse(a,h,i))},applyAngularImpulse:function(t,e){this._b2Body&&this._b2Body.ApplyAngularImpulse(t/n/n,e)},syncPosition:function(t){var e=this._b2Body;if(e){var i,o=this.node.convertToWorldSpaceAR(l);if(i=a,i.x=o.x/n,i.y=o.y/n,this.type===c.Animated&&t){var r=e.GetPosition(),s=cc.game.config.frameRate;i.x=(i.x-r.x)*s,i.y=(i.y-r.y)*s,e.SetAwake(!0),e.SetLinearVelocity(i)}else e.SetTransform(i,e.GetAngle())}},syncRotation:function(t){var e=this._b2Body;if(e){var i=o*s(this.node);if(this.type===c.Animated&&t){var n=e.GetAngle(),r=cc.game.config.frameRate;e.SetAwake(!0),e.SetAngularVelocity((i-n)*r)}else e.SetTransform(e.GetPosition(),i)}},resetVelocity:function(){var t=this._b2Body;if(t){var e=a;e.Set(0,0),t.SetLinearVelocity(e),t.SetAngularVelocity(0)}},onEnable:function(){this._init()},onDisable:function(){this._destroy()},_registerNodeEvents:function(){var t=this.node;t.on("position-changed",this._onNodePositionChanged,this),t.on("rotation-changed",this._onNodeRotationChanged,this),t.on("scale-changed",this._onNodeScaleChanged,this)},_unregisterNodeEvents:function(){var t=this.node;t.off("position-changed",this._onNodePositionChanged,this),t.off("rotation-changed",this._onNodeRotationChanged,this),t.off("scale-changed",this._onNodeScaleChanged,this)},_onNodePositionChanged:function(){this.syncPosition(!0)},_onNodeRotationChanged:function(t){this.syncRotation(!0)},_onNodeScaleChanged:function(t){if(this._b2Body)for(var e=this.getComponents(cc.PhysicsCollider),i=0;i<e.length;i++)e[i].apply()},_init:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__init",[])},_destroy:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__destroy",[])},__init:function(){if(!this._inited){this._registerNodeEvents();var t=new b2.BodyDef;this.type===c.Animated?t.type=c.Kinematic:t.type=this.type,t.allowSleep=this.allowSleep,t.gravityScale=this.gravityScale,t.linearDamping=this.linearDamping,t.angularDamping=this.angularDamping;var e=this.linearVelocity;t.linearVelocity=new b2.Vec2(e.x/n,e.y/n),t.angularVelocity=this.angularVelocity*o,t.fixedRotation=this.fixedRotation,t.bullet=this.bullet;var i=this.node,r=i.convertToWorldSpaceAR(l);t.position=new b2.Vec2(r.x/n,r.y/n),t.angle=-Math.PI/180*s(i),cc.director.getPhysicsManager()._addBody(this,t),this._inited=!0}},__destroy:function(){this._inited&&(cc.director.getPhysicsManager()._removeBody(this),this._unregisterNodeEvents(),this._inited=!1)},_getBody:function(){return this._b2Body}});cc.RigidBody=e.exports=u}),{"./CCPhysicsTypes":116,"./utils":134}],119:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=cc.Class({name:"cc.PhysicsBoxCollider",extends:cc.PhysicsCollider,mixins:[cc.Collider.Box],editor:{menu:!1,requireComponent:cc.RigidBody},_createShape:function(t){var e=Math.abs(t.x),i=Math.abs(t.y),o=this.size.width/2/n*e,r=this.size.height/2/n*i,s=this.offset.x/n*e,c=this.offset.y/n*i,a=new b2.PolygonShape;return a.SetAsBox(o,r,new b2.Vec2(s,c),0),a}});cc.PhysicsBoxCollider=e.exports=o}),{"../CCPhysicsTypes":116}],120:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=cc.Class({name:"cc.PhysicsChainCollider",extends:cc.PhysicsCollider,editor:{menu:!1,inspector:!1,requireComponent:cc.RigidBody},properties:{loop:!1,points:{default:function(){return[cc.v2(-50,0),cc.v2(50,0)]},type:[cc.Vec2]},threshold:{default:1,serializable:!1,visible:!1}},_createShape:function(t){for(var e=new b2.ChainShape,i=this.points,o=[],r=0;r<i.length;r++){var s=i[r];o.push(new b2.Vec2(s.x/n*t.x,s.y/n*t.y))}return this.loop?e.CreateLoop(o,o.length):e.CreateChain(o,o.length),e},resetInEditor:!1,resetPointsByContour:!1});cc.PhysicsChainCollider=e.exports=o}),{"../CCPhysicsTypes":116}],121:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=cc.Class({name:"cc.PhysicsCircleCollider",extends:cc.PhysicsCollider,mixins:[cc.Collider.Circle],editor:{menu:!1,requireComponent:cc.RigidBody},_createShape:function(t){var e=Math.abs(t.x),i=Math.abs(t.y),o=this.offset.x/n*e,r=this.offset.y/n*i,s=new b2.CircleShape;return s.m_radius=this.radius/n*e,s.m_p=new b2.Vec2(o,r),s}});cc.PhysicsCircleCollider=e.exports=o}),{"../CCPhysicsTypes":116}],122:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=t("../utils").getWorldScale,r=cc.Class({name:"cc.PhysicsCollider",extends:cc.Collider,ctor:function(){this._fixtures=[],this._shapes=[],this._inited=!1,this._rect=cc.rect()},properties:{_density:1,_sensor:!1,_friction:.2,_restitution:0,density:{tooltip:!1,get:function(){return this._density},set:function(t){this._density=t}},sensor:{tooltip:!1,get:function(){return this._sensor},set:function(t){this._sensor=t}},friction:{tooltip:!1,get:function(){return this._friction},set:function(t){this._friction=t}},restitution:{tooltip:!1,get:function(){return this._restitution},set:function(t){this._restitution=t}},body:{default:null,type:cc.RigidBody,visible:!1}},onDisable:function(){this._destroy()},onEnable:function(){this._init()},start:function(){this._init()},_getFixtureIndex:function(t){return this._fixtures.indexOf(t)},_init:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__init",[])},_destroy:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__destroy",[])},__init:function(){if(!this._inited){var t=this.body||this.getComponent(cc.RigidBody);if(t){var e=t._getBody();if(e){var i=t.node,n=o(i),r=0===n.x&&0===n.y?[]:this._createShape(n);r instanceof Array||(r=[r]);for(var s=1<<i.groupIndex,c=0,a=cc.game.collisionMatrix[i.groupIndex],h=0;h<a.length;h++)a[h]&&(c|=1<<h);for(var l={categoryBits:s,maskBits:c,groupIndex:0},u=cc.director.getPhysicsManager(),d=0;d<r.length;d++){var p=r[d],_=new b2.FixtureDef;_.density=this.density,_.isSensor=this.sensor,_.friction=this.friction,_.restitution=this.restitution,_.shape=p,_.filter=l;var f=e.CreateFixture(_);f.collider=this,t.enabledContactListener&&u._registerContactFixture(f),this._shapes.push(p),this._fixtures.push(f)}this.body=t,this._inited=!0}}}},__destroy:function(){if(this._inited){for(var t=this._fixtures,e=this.body._getBody(),i=cc.director.getPhysicsManager(),n=t.length-1;n>=0;n--){var o=t[n];o.collider=null,i._unregisterContactFixture(o),e&&e.DestroyFixture(o)}this.body=null,this._fixtures.length=0,this._shapes.length=0,this._inited=!1}},_createShape:function(){},apply:function(){this._destroy(),this._init()},getAABB:function(){for(var t=1e7,e=1e7,i=-1e7,o=-1e7,r=this._fixtures,s=0;s<r.length;s++)for(var c=r[s],a=c.GetShape().GetChildCount(),h=0;h<a;h++){var l=c.GetAABB(h);l.lowerBound.x<t&&(t=l.lowerBound.x),l.lowerBound.y<e&&(e=l.lowerBound.y),l.upperBound.x>i&&(i=l.upperBound.x),l.upperBound.y>o&&(o=l.upperBound.y)}t*=n,e*=n,i*=n,o*=n;var u=this._rect;return u.x=t,u.y=e,u.width=i-t,u.height=o-e,u}});cc.PhysicsCollider=e.exports=r}),{"../CCPhysicsTypes":116,"../utils":134}],123:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=t("../CCPolygonSeparator"),r=cc.Class({name:"cc.PhysicsPolygonCollider",extends:cc.PhysicsCollider,mixins:[cc.Collider.Polygon],editor:{menu:!1,inspector:!1,requireComponent:cc.RigidBody},_createShape:function(t){var e=[],i=this.points;i.length>0&&i[0].equals(i[i.length-1])&&(i.length-=1);for(var r=o.ConvexPartition(i),s=this.offset,c=0;c<r.length;c++){for(var a=r[c],h=null,l=[],u=null,d=0,p=a.length;d<p;d++){h||(h=new b2.PolygonShape);var _=a[d],f=(_.x+s.x)/n*t.x,g=(_.y+s.y)/n*t.y,v=new b2.Vec2(f,g);l.push(v),u||(u=v),l.length===b2.maxPolygonVertices&&(h.Set(l,l.length),e.push(h),h=null,d<p-1&&(l=[u,l[l.length-1]]))}h&&(h.Set(l,l.length),e.push(h))}return e}});cc.PhysicsPolygonCollider=e.exports=r}),{"../CCPhysicsTypes":116,"../CCPolygonSeparator":117}],124:[(function(t,e,i){t("./CCPhysicsManager"),t("./CCRigidBody"),t("./CCPhysicsContact"),t("./collider/CCPhysicsCollider"),t("./collider/CCPhysicsChainCollider"),t("./collider/CCPhysicsCircleCollider"),t("./collider/CCPhysicsBoxCollider"),t("./collider/CCPhysicsPolygonCollider"),t("./joint/CCJoint"),t("./joint/CCDistanceJoint"),t("./joint/CCRevoluteJoint"),t("./joint/CCMouseJoint"),t("./joint/CCMotorJoint"),t("./joint/CCPrismaticJoint"),t("./joint/CCWeldJoint"),t("./joint/CCWheelJoint"),t("./joint/CCRopeJoint")}),{"../../../external/box2d/box2d":218,"./CCPhysicsContact":114,"./CCPhysicsManager":115,"./CCRigidBody":118,"./collider/CCPhysicsBoxCollider":119,"./collider/CCPhysicsChainCollider":120,"./collider/CCPhysicsCircleCollider":121,"./collider/CCPhysicsCollider":122,"./collider/CCPhysicsPolygonCollider":123,"./joint/CCDistanceJoint":125,"./joint/CCJoint":126,"./joint/CCMotorJoint":127,"./joint/CCMouseJoint":128,"./joint/CCPrismaticJoint":129,"./joint/CCRevoluteJoint":130,"./joint/CCRopeJoint":131,"./joint/CCWeldJoint":132,"./joint/CCWheelJoint":133,"./platform/CCPhysicsAABBQueryCallback":218,"./platform/CCPhysicsContactListner":218,"./platform/CCPhysicsDebugDraw":218,"./platform/CCPhysicsRayCastCallback":218,"./platform/CCPhysicsUtils":218}],125:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=cc.Class({name:"cc.DistanceJoint",extends:cc.Joint,editor:!1,properties:{_distance:1,_frequency:0,_dampingRatio:0,distance:{tooltip:!1,get:function(){return this._distance},set:function(t){this._distance=t,this._joint&&this._joint.SetLength(t)}},frequency:{tooltip:!1,get:function(){return this._frequency},set:function(t){this._frequency=t,this._joint&&this._joint.SetFrequency(t)}},dampingRatio:{tooltip:!1,get:function(){return this._dampingRatio},set:function(t){this._dampingRatio=t,this._joint&&this._joint.SetDampingRatio(t)}}},_createJointDef:function(){var t=new b2.DistanceJointDef;return t.localAnchorA=new b2.Vec2(this.anchor.x/n,this.anchor.y/n),t.localAnchorB=new b2.Vec2(this.connectedAnchor.x/n,this.connectedAnchor.y/n),t.length=this.distance/n,t.dampingRatio=this.dampingRatio,t.frequencyHz=this.frequency,t}});cc.DistanceJoint=e.exports=o}),{"../CCPhysicsTypes":116}],126:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=cc.Class({name:"cc.Joint",extends:cc.Component,editor:{requireComponent:cc.RigidBody},properties:{anchor:{default:cc.v2(0,0),tooltip:!1},connectedAnchor:{default:cc.v2(0,0),tooltip:!1},connectedBody:{default:null,type:cc.RigidBody,tooltip:!1},collideConnected:{default:!1,tooltip:!1}},onDisable:function(){this._destroy()},onEnable:function(){this._init()},start:function(){this._init()},apply:function(){this._destroy(),this._init()},getWorldAnchor:function(){if(this._joint){var t=this._joint.GetAnchorA();return cc.v2(t.x*n,t.y*n)}return cc.Vec2.ZERO},getWorldConnectedAnchor:function(){if(this._joint){var t=this._joint.GetAnchorB();return cc.v2(t.x*n,t.y*n)}return cc.Vec2.ZERO},getReactionForce:function(t){return this._joint?this._joint.GetReactionForce(t):0},getReactionTorque:function(t){return this._joint?this._joint.GetReactionTorque(t):0},_init:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__init",[])},_destroy:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__destroy",[])},__init:function(){if(!this._inited&&(this.body=this.getComponent(cc.RigidBody),this._isValid())){var t=cc.director.getPhysicsManager()._getWorld(),e=this._createJointDef();if(!e)return;e.bodyA=this.body._getBody(),e.bodyB=this.connectedBody._getBody(),e.collideConnected=this.collideConnected,this._joint=t.CreateJoint(e),this._joint&&(this._joint._joint=this),this._inited=!0}},__destroy:function(){this._inited&&(this._isValid()&&cc.director.getPhysicsManager()._getWorld().DestroyJoint(this._joint),this._joint&&(this._joint._joint=null),this._joint=null,this._inited=!1)},_createJointDef:function(){return null},_isValid:function(){return this.body&&this.body._getBody()&&this.connectedBody&&this.connectedBody._getBody()}});cc.Joint=e.exports=o}),{"../CCPhysicsTypes":116}],127:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,r=cc.Class({name:"cc.MotorJoint",extends:cc.Joint,editor:!1,properties:{_linearOffset:cc.v2(0,0),_angularOffset:0,_maxForce:1,_maxTorque:1,_correctionFactor:.3,anchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},connectedAnchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},linearOffset:{tooltip:!1,get:function(){return this._linearOffset},set:function(t){this._linearOffset=t,this._joint&&this._joint.SetLinearOffset(new b2.Vec2(t.x/n,t.y/n))}},angularOffset:{tooltip:!1,get:function(){return this._angularOffset},set:function(t){this._angularOffset=t,this._joint&&this._joint.SetAngularOffset(t)}},maxForce:{tooltip:!1,get:function(){return this._maxForce},set:function(t){this._maxForce=t,this._joint&&this._joint.SetMaxForce(t)}},maxTorque:{tooltip:!1,get:function(){return this._maxTorque},set:function(t){this._maxTorque=t,this._joint&&this._joint.SetMaxTorque(t)}},correctionFactor:{tooltip:!1,get:function(){return this._correctionFactor},set:function(t){this._correctionFactor=t,this._joint&&this._joint.SetCorrectionFactor(t)}}},_createJointDef:function(){var t=new b2.MotorJointDef;return t.linearOffset=new b2.Vec2(this.linearOffset.x/n,this.linearOffset.y/n),t.angularOffset=this.angularOffset*o,t.maxForce=this.maxForce,t.maxTorque=this.maxTorque,t.correctionFactor=this.correctionFactor,t}});cc.MotorJoint=e.exports=r}),{"../CCPhysicsTypes":116}],128:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=new b2.Vec2,r=cc.Class({name:"cc.MouseJoint",extends:cc.Joint,editor:!1,properties:{_target:1,_frequency:5,_dampingRatio:.7,_maxForce:0,connectedBody:{default:null,type:cc.RigidBody,visible:!1,override:!0},collideConnected:{default:!0,visible:!1,override:!0},anchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},connectedAnchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},mouseRegion:{tooltip:!1,default:null,type:cc.Node},target:{tooltip:!1,visible:!1,get:function(){return this._target},set:function(t){this._target=t,this._joint&&(o.x=t.x/n,o.y=t.y/n,this._joint.SetTarget(o))}},frequency:{tooltip:!1,get:function(){return this._frequency},set:function(t){this._frequency=t,this._joint&&this._joint.SetFrequency(t)}},dampingRatio:{tooltip:!1,get:function(){return this._dampingRatio},set:function(t){this._dampingRatio=t,this._joint&&this._joint.SetDampingRatio(t)}},maxForce:{tooltip:!1,visible:!1,get:function(){return this._maxForce},set:function(t){this._maxForce=t,this._joint&&this._joint.SetMaxForce(t)}}},onLoad:function(){var t=this.mouseRegion||this.node;t.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},onEnable:function(){},start:function(){},onTouchBegan:function(t){var e=cc.director.getPhysicsManager(),i=this._pressPoint=t.touch.getLocation();cc.Camera&&cc.Camera.main&&(i=cc.Camera.main.getCameraToWorldPoint(i));var n=e.testPoint(i);n&&((this.connectedBody=n.body).awake=!0,this.maxForce=1e3*this.connectedBody.getMass(),this.target=i,this._init())},onTouchMove:function(t){this._pressPoint=t.touch.getLocation()},onTouchEnd:function(t){this._destroy(),this._pressPoint=null},_createJointDef:function(){var t=new b2.MouseJointDef;return o.x=this.target.x/n,o.y=this.target.y/n,t.target=o,t.maxForce=this.maxForce,t.dampingRatio=this.dampingRatio,t.frequencyHz=this.frequency,t},update:function(){this._pressPoint&&this._isValid()&&(cc.Camera&&cc.Camera.main?this.target=cc.Camera.main.getCameraToWorldPoint(this._pressPoint):this.target=this._pressPoint)}});cc.MouseJoint=e.exports=r}),{"../CCPhysicsTypes":116}],129:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,r=cc.Class({name:"cc.PrismaticJoint",extends:cc.Joint,editor:!1,properties:{localAxisA:{default:cc.v2(1,0),tooltip:!1},referenceAngle:{default:0,tooltip:!1},enableLimit:{default:!1,tooltip:!1},enableMotor:{default:!1,tooltip:!1},lowerLimit:{default:0,tooltip:!1},upperLimit:{default:0,tooltip:!1},_maxMotorForce:0,_motorSpeed:0,maxMotorForce:{tooltip:!1,get:function(){return this._maxMotorForce},set:function(t){this._maxMotorForce=t,this._joint&&this._joint.SetMaxMotorForce(t)}},motorSpeed:{tooltip:!1,get:function(){return this._motorSpeed},set:function(t){this._motorSpeed=t,this._joint&&this._joint.SetMotorSpeed(t)}}},_createJointDef:function(){var t=new b2.PrismaticJointDef;return t.localAnchorA=new b2.Vec2(this.anchor.x/n,this.anchor.y/n),t.localAnchorB=new b2.Vec2(this.connectedAnchor.x/n,this.connectedAnchor.y/n),t.localAxisA=new b2.Vec2(this.localAxisA.x,this.localAxisA.y),t.referenceAngle=this.referenceAngle*o,t.enableLimit=this.enableLimit,t.lowerTranslation=this.lowerLimit/n,t.upperTranslation=this.upperLimit/n,t.enableMotor=this.enableMotor,t.maxMotorForce=this.maxMotorForce,t.motorSpeed=this.motorSpeed,t}});cc.PrismaticJoint=e.exports=r}),{"../CCPhysicsTypes":116}],130:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,r=t("../CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE,s=cc.Class({name:"cc.RevoluteJoint",extends:cc.Joint,editor:!1,properties:{_maxMotorTorque:0,_motorSpeed:0,_enableLimit:!1,_enableMotor:!1,referenceAngle:{default:0,tooltip:!1},lowerAngle:{default:0,tooltip:!1},upperAngle:{default:0,tooltip:!1},maxMotorTorque:{tooltip:!1,get:function(){return this._maxMotorTorque},set:function(t){this._maxMotorTorque=t,this._joint&&this._joint.SetMaxMotorTorque(t)}},motorSpeed:{tooltip:!1,get:function(){return this._motorSpeed},set:function(t){this._motorSpeed=t,this._joint&&this._joint.SetMotorSpeed(t*o)}},enableLimit:{tooltip:!1,get:function(){return this._enableLimit},set:function(t){this._enableLimit=t,this._joint&&this._joint.EnableLimit(t)}},enableMotor:{tooltip:!1,get:function(){return this._enableMotor},set:function(t){this._enableMotor=t,this._joint&&this._joint.EnableMotor(t)}}},getJointAngle:function(){return this._joint?this._joint.GetJointAngle()*r:0},_createJointDef:function(){var t=new b2.RevoluteJointDef;return t.localAnchorA=new b2.Vec2(this.anchor.x/n,this.anchor.y/n),t.localAnchorB=new b2.Vec2(this.connectedAnchor.x/n,this.connectedAnchor.y/n),t.lowerAngle=(this.upperAngle+90)*o,t.upperAngle=(this.lowerAngle+90)*o,t.maxMotorTorque=this.maxMotorTorque,t.motorSpeed=this.motorSpeed*o,t.enableLimit=this.enableLimit,t.enableMotor=this.enableMotor,t.referenceAngle=this.referenceAngle*o,t}});cc.RevoluteJoint=e.exports=s}),{"../CCPhysicsTypes":116}],131:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=cc.Class({name:"cc.RopeJoint",extends:cc.Joint,editor:!1,properties:{_maxLength:1,maxLength:{tooltip:!1,get:function(){return this._maxLength},set:function(t){this._maxLength=t,this._joint&&this._joint.SetMaxLength(t)}}},_createJointDef:function(){var t=new b2.RopeJointDef;return t.localAnchorA=new b2.Vec2(this.anchor.x/n,this.anchor.y/n),t.localAnchorB=new b2.Vec2(this.connectedAnchor.x/n,this.connectedAnchor.y/n),t.maxLength=this.maxLength/n,t}});cc.RopeJoint=e.exports=o}),{"../CCPhysicsTypes":116}],132:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,r=cc.Class({name:"cc.WeldJoint",extends:cc.Joint,editor:!1,properties:{referenceAngle:{default:0,tooltip:!1},_frequency:0,_dampingRatio:0,frequency:{tooltip:!1,get:function(){return this._frequency},set:function(t){this._frequency=t,this._joint&&this._joint.SetFrequency(t)}},dampingRatio:{tooltip:!1,get:function(){return this._dampingRatio},set:function(t){this._dampingRatio=t,this._joint&&this._joint.SetDampingRatio(t)}}},_createJointDef:function(){var t=new b2.WeldJointDef;return t.localAnchorA=new b2.Vec2(this.anchor.x/n,this.anchor.y/n),t.localAnchorB=new b2.Vec2(this.connectedAnchor.x/n,this.connectedAnchor.y/n),t.referenceAngle=this.referenceAngle*o,t.frequencyHz=this.frequency,t.dampingRatio=this.dampingRatio,t}});cc.WeldJoint=e.exports=r}),{"../CCPhysicsTypes":116}],133:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,o=t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,r=cc.Class({name:"cc.WheelJoint",extends:cc.Joint,editor:!1,properties:{_maxMotorTorque:0,_motorSpeed:0,_enableMotor:!1,_frequency:2,_dampingRatio:.7,localAxisA:{default:cc.v2(1,0),tooltip:!1},maxMotorTorque:{tooltip:!1,get:function(){return this._maxMotorTorque},set:function(t){this._maxMotorTorque=t,this._joint&&this._joint.SetMaxMotorTorque(t)}},motorSpeed:{tooltip:!1,get:function(){return this._motorSpeed},set:function(t){this._motorSpeed=t,this._joint&&this._joint.SetMotorSpeed(t*o)}},enableMotor:{tooltip:!1,get:function(){return this._enableMotor},set:function(t){this._enableMotor=t,this._joint&&this._joint.EnableMotor(t)}},frequency:{tooltip:!1,get:function(){return this._frequency},set:function(t){this._frequency=t,this._joint&&this._joint.SetFrequency(t)}},dampingRatio:{tooltip:!1,get:function(){return this._dampingRatio},set:function(t){this._dampingRatio=t,this._joint&&this._joint.SetDampingRatio(t)}}},_createJointDef:function(){var t=new b2.WheelJointDef;return t.localAnchorA=new b2.Vec2(this.anchor.x/n,this.anchor.y/n),t.localAnchorB=new b2.Vec2(this.connectedAnchor.x/n,this.connectedAnchor.y/n),t.localAxisA=new b2.Vec2(this.localAxisA.x,this.localAxisA.y),t.maxMotorTorque=this.maxMotorTorque,t.motorSpeed=this.motorSpeed*o,t.enableMotor=this.enableMotor,t.dampingRatio=this.dampingRatio,t.frequencyHz=this.frequency,t}});cc.WheelJoint=e.exports=r}),{"../CCPhysicsTypes":116}],134:[(function(t,e,i){e.exports={getWorldRotation:function(t){for(var e=t.rotationX,i=t.parent;i.parent;)e+=i.rotationX,i=i.parent;return e},getWorldScale:function(t){for(var e=t.scaleX,i=t.scaleY,n=t.parent;n.parent;)e*=n.scaleX,i*=n.scaleY,n=n.parent;return cc.v2(e,i)},convertToNodeRotation:function(t,e){e-=t.rotationX;for(var i=t.parent;i.parent;)e-=i.rotationX,i=i.parent;return e}}}),{}],135:[(function(i,n,o){function r(t){return t&&(t.constructor===cc.SceneAsset||t instanceof cc.Scene)}function s(t,e){this.url=t,this.type=e}var c=i("../assets/CCAsset"),a=i("./utils").callInNextTick,h=i("../load-pipeline/CCLoader"),l=i("../load-pipeline/pack-downloader"),u=i("../load-pipeline/auto-release-utils"),d=i("../utils/decode-uuid"),p=i("../load-pipeline/md5-pipe"),_="",f="",g={},v={loadAsset:function(i,n,o){if("string"!==("object"==(e=typeof i)?t(i):e))return a(n,new Error("[AssetLibrary] uuid must be string"),null);var s={uuid:i,type:"uuid"};o&&o.existingAsset&&(s.existingAsset=o.existingAsset),h.load(s,(function(t,e){if(t||!e)t=new Error("[AssetLibrary] loading JSON or dependencies failed: "+(t?t.message:"Unknown error"));else{if(e.constructor===cc.SceneAsset){var o=cc.loader._getReferenceKey(i);e.scene.dependAssets=u.getDependsRecursively(o)}if(r(e)){var s=cc.loader._getReferenceKey(i);h.removeItem(s)}}n&&n(t,e)}))},getLibUrlNoExt:function(t){return t=d(t),_+t.slice(0,2)+"/"+t},_queryAssetInfoInEditor:function(t,e){},_getAssetInfoInRuntime:function(t,e){e=e||{url:null,raw:!1};var i=g[t];return i&&!cc.isChildClassOf(i.type,cc.Asset)?(e.url=f+i.url,e.raw=!0):(e.url=this.getLibUrlNoExt(t)+".json",e.raw=!1),e},_getAssetUrl:function(t){var e=g[t];return e?f+e.url:null},queryAssetInfo:function(t,e){var i=this._getAssetInfoInRuntime(t);e(null,i.url,i.raw)},parseUuidInEditor:function(t){},loadJson:function(t,e){var i=""+((new Date).getTime()+Math.random()),n={uuid:i,type:"uuid",content:t,skips:[h.assetLoader.id,h.downloader.id]};h.load(n,(function(t,n){if(t)t=new Error("[AssetLibrary] loading JSON or dependencies failed: "+t.message);else{if(n.constructor===cc.SceneAsset){var o=cc.loader._getReferenceKey(i);n.scene.dependAssets=u.getDependsRecursively(o)}if(r(n)){var s=cc.loader._getReferenceKey(i);h.removeItem(s)}}n._uuid="",e&&e(t,n)}))},getAssetByUuid:function(t){return v._uuidToAsset[t]||null},init:function(t){var e=t.libraryPath;e=e.replace(/\\/g,"/"),_=cc.path.stripSep(e)+"/",f=t.rawAssetsBase;var i=t.md5AssetsMap;if(i){var n=new p(i,_,f);cc.loader.insertPipeAfter(cc.loader.assetLoader,n),cc.loader.md5Pipe=n}var o=h._resources;o.reset();var r=t.rawAssets;if(r){for(var a in r){var u=r[a];for(var d in u){var v=u[d],y=v[0],m=v[1],b=cc.js._getClassById(m);if(b){if(g[d]=new s(a+"/"+y,b),"assets"===a&&y.startsWith("resources/")){if(cc.isChildClassOf(b,c)){var C=cc.path.extname(y);y=C?y.slice("resources/".length,-C.length):y.slice("resources/".length)}else y=y.slice("resources/".length);var T=1===v[2];o.add(y,d,b,!T)}}else cc.error("Cannot get",m)}}}t.packedAssets&&l.initPacks(t.packedAssets);var S=t.mountPaths;S||(S={assets:f+"assets",internal:f+"internal"}),cc.url._init(S)}};v._uuidToAsset={},n.exports=cc.AssetLibrary=v}),{"../assets/CCAsset":25,"../load-pipeline/CCLoader":98,"../load-pipeline/auto-release-utils":101,"../load-pipeline/md5-pipe":107,"../load-pipeline/pack-downloader":108,"../utils/decode-uuid":160,"./utils":156}],136:[(function(i,n,o){function r(t,e){t.indexOf(e)<0&&t.push(e)}function s(t,e){r(t.__props__,e)}function c(t,e,i,n,o){var r=n.default;x.setClassAttr(t,i,"default",r),s(t,i);var c=C(t,n,e,i,!1);if(c){for(var a=L,h=0;h<c.length;h++){var l=c[h];x.attr(t,i,l),l._onAfterProp&&a.push(l._onAfterProp)}for(var u=0;u<a.length;u++)a[u](t,i);L.length=0,c.length=0}}function a(t,e,i,n,o){var r=n.get,s=n.set,c=t.prototype,a=Object.getOwnPropertyDescriptor(c,i),h=!a;if(r){for(var l=C(t,n,e,i,!0),u=0;u<l.length;u++)x.attr(t,i,l[u]);l.length=0;x.setClassAttr(t,i,"serializable",!1),o||T.get(c,i,r,h,h)}s&&(o||T.set(c,i,s,h,h))}function h(i){return"function"===("object"==(e=typeof i)?t(i):e)?i():i}function l(t,e,i){for(var n in e)t.hasOwnProperty(n)||i&&!i(n)||Object.defineProperty(t,n,T.getPropertyDescriptor(e,n))}function u(t,e,i,n){var o,r,s=n.__ctor__,c=n.ctor,a=n.__ES6__;a?(o=[c],r=c):(r=g(o=s?[s]:v(e,i,n),e,t,n),T.value(r,"extend",(function(t){return t.extends=this,b(t)}),!0)),T.value(r,"__ctors__",o.length>0?o:null,!0);var h=r.prototype;if(e&&(a||(T.extend(r,e),h=r.prototype),T.value(r,"$super",e)),i){for(var u=i.length-1;u>=0;u--){var d=i[u];l(h,d.prototype),l(r,d,(function(t){return d.hasOwnProperty(t)&&!0})),b._isCCClass(d)&&l(x.getClassAttrs(r).constructor.prototype,x.getClassAttrs(d).constructor.prototype)}h.constructor=r}return a||(h.__initProps__=f),T.setClassName(t,r),r}function d(t,e,i,n){var o=cc.Component,r=cc._RF.peek();if(r&&cc.isChildClassOf(e,o)){if(cc.isChildClassOf(r.cls,o))return cc.errorID(3615),null;t=t||r.script}var s=u(t,e,i,n);if(r)if(cc.isChildClassOf(e,o)){var c=r.uuid;c&&T._setClassId(c,s),r.cls=s}else cc.isChildClassOf(r.cls,o)||(r.cls=s);return s}function p(i){var n,o=T.getClassName(i),r=i.constructor,s="new "+o+"(";if(r===cc.Mat3||r===cc.Mat4){var c=i.data;for(n=0;n<c.length;n++)s+=c[n],n<c.length-1&&(s+=",")}else for(n=0;n<r.__props__.length;n++){var a=i[r.__props__[n]];if("object"===("object"==(e=typeof a)?t(a):e))return cc.errorID(3641,o),"new "+o+"()";s+=a,n<r.__props__.length-1&&(s+=",")}return s+")"}function _(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function f(i){var n=x.getClassAttrs(i),o=i.__props__;null===o&&(N.init(),o=i.__props__);for(var r=[],s="",c=0;c<o.length;c++){var a=o[c],h=a+A+"default";if(h in n){var l;l=R.test(a)?"this."+a+"=":"this["+_(a)+"]=";var u,d=n[h];if("object"===("object"==(e=typeof d)?t(d):e)&&d)u=d instanceof cc.ValueType?p(d):Array.isArray(d)?"[]":"{}";else if("function"===("object"==(e=typeof d)?t(d):e)){var f=r.length;r.push(d),u="F["+f+"]()"}else u="string"===("object"==(e=typeof d)?t(d):e)?_(d):d;s+=l=l+u+";\n"}}var g;g=0===r.length?Function(s):Function("F","return (function(){\n"+s+"})")(r),i.prototype.__initProps__=g,g.call(this)}function g(t,e,i,n){var o="return function CCClass(){\n";e&&y(e,n,i)&&(o+="this._super=null;\n"),o+="this.__initProps__(CCClass);\n";var r=t.length;if(r>0){var s=!(i&&i.startsWith("cc."));s&&(o+="try{\n");var c="].apply(this,arguments);\n";if(1===r)o+="CCClass.__ctors__[0"+c;else{o+="var cs=CCClass.__ctors__;\n";for(var a=0;a<r;a++)o+="cs["+a+c}s&&(o+="}catch(e){\ncc._throw(e);\n}\n")}return o+="}",Function(o)()}function v(t,e,i){for(var n=[],o=[t].concat(e),s=0;s<o.length;s++){var c=o[s];if(c)for(var a=(function(t){return b._isCCClass(t)?t.__ctors__||[]:[t]})(c),h=0;h<a.length;h++)r(n,a[h])}var l=i.ctor;return l&&n.push(l),n}function y(i,n,o){var r=!1;for(var s in n)if(!(I.indexOf(s)>=0)){var c=n[s];if("function"===("object"==(e=typeof c)?t(c):e)){var a=T.getPropertyDescriptor(i.prototype,s);if(a){var h=a.value;if("function"===("object"==(e=typeof h)?t(h):e)){P.test(c)&&(r=!0,n[s]=(function(t,e){return function(){var i=this._super;this._super=t;var n=e.apply(this,arguments);return this._super=i,n}})(h,c));continue}}}}return r}function m(t,e,i,n,o,r){if(t.__props__=[],n&&n.__props__&&(t.__props__=n.__props__.slice()),o)for(var s=0;s<o.length;++s){var h=o[s];h.__props__&&(t.__props__=t.__props__.concat(h.__props__.filter((function(e){return t.__props__.indexOf(e)<0}))))}if(i){O.preprocessAttrs(i,e,t,r);for(var l in i){var u=i[l];"default"in u?c(t,e,l,u,r):a(t,e,l,u,r)}}}function b(i){var n=(i=i||{}).name,o=i.extends,r=i.mixins,s=d(n,o,r,i);n||(n=cc.js.getClassName(s));var c=i.properties;"function"===("object"==(e=typeof c)?t(c):e)||o&&null===o.__props__||r&&r.some((function(t){return null===t.__props__}))?(N.push({cls:s,props:c,mixins:r}),s.__props__=null):m(s,n,c,o,i.mixins,i.__ES6__);var a=i.statics;if(a){var h;for(h in a)s[h]=a[h]}for(var l in i)if(!(I.indexOf(l)>=0)){var u=i[l];O.validateMethodWithProps(u,l,n,s,o)&&T.value(s.prototype,l,u,!0,!0)}var p=i.editor;return p&&cc.isChildClassOf(o,cc.Component)&&cc.Component._registerEditorProps(s,p),s}function C(i,n,o,r,s){function c(){return l=r+A,h=x.getClassAttrsProto(i)}function a(i,o){if(i in n){var r=n[i];("object"==(e=typeof r)?t(r):e)===o&&((h||c())[l+i]=r)}}var h=null,l="";D.length=0;var u=D,d=n.type;if(d){var p=B[d];if(p)u.push({type:d,_onAfterProp:w(p,"cc."+d)});else if("Object"===d);else if(d===x.ScriptUuid){var _=x.ObjectType(cc.ScriptAsset);_.type="Script",u.push(_)}else"object"===("object"==(e=typeof d)?t(d):e)?S.isEnum(d)&&u.push({type:"Enum",enumList:S.getList(d)}):"function"===("object"==(e=typeof d)?t(d):e)&&(n.url?u.push({type:"Object",ctor:d,_onAfterProp:w("String","cc.String")}):u.push(n._short?{type:"Object",ctor:d}:x.ObjectType(d)))}n.editorOnly&&((h||c())[l+"editorOnly"]=!0),n.url&&((h||c())[l+"saveUrlAsAsset"]=!0),!1===n.serializable&&((h||c())[l+"serializable"]=!1);var f=n.range;return f&&Array.isArray(f)&&f.length>=2&&((h||c())[l+"min"]=f[0],h[l+"max"]=f[1],f.length>2&&(h[l+"step"]=f[2])),a("min","number"),a("max","number"),a("step","number"),u}var T=i("./js"),S=i("./CCEnum"),E=i("./utils"),x=(E.isPlainEmptyObj_DEV,E.cloneable_DEV,i("./attribute")),A=x.DELIMETER,w=x.getTypeChecker,O=i("./preprocess-class");i("./requiring-frame");var I=["name","extends","mixins","ctor","__ctor__","properties","statics","editor","__ES6__"],N={datas:null,push:function(t){if(this.datas)this.datas.push(t);else{this.datas=[t];var e=this;setTimeout((function(){e.init()}),0)}},init:function(){var i=this.datas;if(i){for(var n=0;n<i.length;++n){var o=i[n],r=o.cls,s=o.props;"function"===("object"==(e=typeof s)?t(s):e)&&(s=s());var c=T.getClassName(r);s?m(r,c,s,r.$super,o.mixins):cc.errorID(3633,c)}this.datas=null}}},L=[],R=/^[$A-Za-z_][0-9A-Za-z_$]*$/,P=/xyz/.test((function(){xyz}))?/\b\._super\b/:/.*/;/xyz/.test((function(){xyz}));b._isCCClass=function(t){return t&&t.hasOwnProperty("__ctors__")},b._fastDefine=function(t,e,i){T.setClassName(t,e);for(var n=e.__props__=Object.keys(i),o=x.getClassAttrsProto(e),r=0;r<n.length;r++){var s=n[r];o[s+A+"visible"]=!1,o[s+A+"default"]=i[s]}},b.Attr=x,b.attr=x.attr,cc.isChildClassOf=function(i,n){if(i&&n){if("function"!==("object"==(e=typeof i)?t(i):e))return!1;if("function"!==("object"==(e=typeof n)?t(n):e))return!1;if(i===n)return!0;for(;;){if(!(i=T.getSuper(i)))return!1;if(i===n)return!0}}return!1},b.getInheritanceChain=function(t){for(var e=[];t=T.getSuper(t);)t!==Object&&e.push(t);return e};var B={Integer:"Number",Float:"Number",Boolean:"Boolean",String:"String"},D=[];cc.Class=b,n.exports={isArray:function(t){return t=h(t),Array.isArray(t)},fastDefine:b._fastDefine,getNewValueTypeCode:p,IDENTIFIER_RE:R,escapeForJS:_,getDefault:h}}),{"./CCEnum":138,"./attribute":144,"./js":151,"./preprocess-class":153,"./requiring-frame":154,"./utils":156}],137:[(function(i,n,o){function r(t){return t}function s(t,e){return t[e]||(t[e]={})}function c(i){return function(n){return"function"===("object"==(e=typeof n)?t(n):e)?i(n):function(t){return i(t,n)}}}function a(t,e,i){return function(t){return function(i){return e(i,t)}}}function h(t){return a.bind(null,!1)}function l(t,e){return s(t,y)}function u(i){var n;try{n=i()}catch(t){return i}return"object"!==("object"==(e=typeof n)?t(n):e)||null===n?n:i}function d(t){var e;try{e=new t}catch(t){return{}}return e}function p(t,e,i,n,o,r){var s=n&&(g.getFullFormOfProperty(n)||n),c=e[i],a=v.mixin(c||{},s||{});if(o&&(o.get||o.set)){o.get&&(a.get=o.get),o.set&&(a.set=o.set)}else{var h=void 0;if(o)o.initializer&&(h=u(o.initializer),!0);else{var l=r.default||(r.default=d(t));l.hasOwnProperty(i)&&(h=l[i],!0)}a.default=h}e[i]=a}function _(t,e,i){return t((function(t,n){var o=l(t,e);if(o){var r=void 0!==i?i:n;s(s(o,"proto"),"editor")[e]=r}}),e)}function f(t){return t(r)}i("./CCClass");var g=i("./preprocess-class"),v=i("./js"),y="__ccclassCache__",m=a.bind(null,!1),b=h(),C=h(),T=c((function(t,e){var i=v.getSuper(t);i===Object&&(i=null);var n={name:e,extends:i,ctor:t,__ES6__:!0},o=t[y];if(o){var r=o.proto;r&&v.mixin(n,r),t[y]=void 0}return cc.Class(n)})),S=f(c),E=_(m,"requireComponent"),x=f(b),A=_(C,"executionOrder"),w=f(c),O=f(c),I=f(b),N=f(b),L=f(b);cc._decorator=n.exports={ccclass:T,property:function(i,n,o){function r(t,e,i){var n=l(t.constructor);if(n){var o=s(s(n,"proto"),"properties");p(t.constructor,o,e,c,i,n)}}var c=null;if("undefined"===("object"==(e=typeof n)?t(n):e))return c=i,r;r(i,n,o)},executeInEditMode:S,requireComponent:E,menu:x,executionOrder:A,disallowMultiple:w,playOnFocus:O,inspector:I,icon:N,help:L,mixins:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var i=l(e,"mixins");i&&(s(i,"proto").mixins=t)}}}}),{"./CCClass":136,"./js":151,"./preprocess-class":153,"./utils":156}],138:[(function(i,n,o){function r(i){if("__enums__"in i)return i;s.value(i,"__enums__",null,!0);for(var n=-1,o=Object.keys(i),r=0;r<o.length;r++){var c=o[r],a=i[c];if(-1===a)a=++n,i[c]=a;else if("number"===("object"==(e=typeof a)?t(a):e))n=a;else if("string"===("object"==(e=typeof a)?t(a):e)&&Number.isInteger(parseFloat(c)))continue;var h=""+a;c!==h&&s.value(i,h,c)}return i}var s=i("./js");r.isEnum=function(t){return t&&t.hasOwnProperty("__enums__")},r.getList=function(t){if(t.__enums__)return t.__enums__;var e=t.__enums__=[];for(var i in t){var n=t[i];Number.isInteger(n)&&e.push({name:i,value:n})}return e.sort((function(t,e){return t.value-e.value})),e};n.exports=cc.Enum=r}),{"./js":151}],139:[(function(t,e,i){t("./_CCClass"),cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.ImageFormat=cc.Enum({JPG:0,PNG:1,TIFF:2,WEBP:3,PVR:4,ETC:5,S3TC:6,ATITC:7,TGA:8,RAWDATA:9,UNKNOWN:10}),cc.getImageFormatByData=function(t){return t.length>8&&137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]?cc.ImageFormat.PNG:t.length>2&&(73===t[0]&&73===t[1]||77===t[0]&&77===t[1]||255===t[0]&&216===t[1])?cc.ImageFormat.TIFF:cc.ImageFormat.UNKNOWN},cc.macro={INVALID_INDEX:-1,NODE_TAG_INVALID:-1,PI:Math.PI,PI2:2*Math.PI,FLT_MAX:parseFloat("3.402823466e+38F"),FLT_MIN:parseFloat("1.175494351e-38F"),RAD:Math.PI/180,DEG:180/Math.PI,UINT_MAX:4294967295,REPEAT_FOREVER:4294967295,FLT_EPSILON:1.192092896e-7,ONE:1,ZERO:0,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,LINEAR:9729,BLEND_DST:771,WEB_ORIENTATION_PORTRAIT:0,WEB_ORIENTATION_LANDSCAPE_LEFT:-90,WEB_ORIENTATION_PORTRAIT_UPSIDE_DOWN:180,WEB_ORIENTATION_LANDSCAPE_RIGHT:90,ORIENTATION_PORTRAIT:1,ORIENTATION_LANDSCAPE:2,ORIENTATION_AUTO:3,DENSITYDPI_DEVICE:"device-dpi",DENSITYDPI_HIGH:"high-dpi",DENSITYDPI_MEDIUM:"medium-dpi",DENSITYDPI_LOW:"low-dpi",VERTEX_ATTRIB_FLAG_NONE:0,VERTEX_ATTRIB_FLAG_POSITION:1,VERTEX_ATTRIB_FLAG_COLOR:2,VERTEX_ATTRIB_FLAG_TEX_COORDS:4,VERTEX_ATTRIB_FLAG_POS_COLOR_TEX:7,GL_ALL:0,VERTEX_ATTRIB_POSITION:0,VERTEX_ATTRIB_COLOR:1,VERTEX_ATTRIB_TEX_COORDS:2,VERTEX_ATTRIB_MAX:3,UNIFORM_PMATRIX:0,UNIFORM_MVMATRIX:1,UNIFORM_MVPMATRIX:2,UNIFORM_TIME:3,UNIFORM_SINTIME:4,UNIFORM_COSTIME:5,UNIFORM_RANDOM01:6,UNIFORM_SAMPLER:7,UNIFORM_MAX:8,SHADER_POSITION_TEXTURECOLOR:"ShaderPositionTextureColor",SHADER_SPRITE_POSITION_TEXTURECOLOR:"ShaderSpritePositionTextureColor",SHADER_POSITION_TEXTURECOLORALPHATEST:"ShaderPositionTextureColorAlphaTest",SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST:"ShaderSpritePositionTextureColorAlphaTest",SHADER_POSITION_COLOR:"ShaderPositionColor",SHADER_SPRITE_POSITION_COLOR:"ShaderSpritePositionColor",SHADER_POSITION_TEXTURE:"ShaderPositionTexture",SHADER_POSITION_TEXTURE_UCOLOR:"ShaderPositionTexture_uColor",SHADER_POSITION_TEXTUREA8COLOR:"ShaderPositionTextureA8Color",SHADER_POSITION_UCOLOR:"ShaderPosition_uColor",SHADER_POSITION_LENGTHTEXTURECOLOR:"ShaderPositionLengthTextureColor",UNIFORM_PMATRIX_S:"CC_PMatrix",UNIFORM_MVMATRIX_S:"CC_MVMatrix",UNIFORM_MVPMATRIX_S:"CC_MVPMatrix",UNIFORM_TIME_S:"CC_Time",UNIFORM_SINTIME_S:"CC_SinTime",UNIFORM_COSTIME_S:"CC_CosTime",UNIFORM_RANDOM01_S:"CC_Random01",UNIFORM_SAMPLER_S:"CC_Texture0",UNIFORM_ALPHA_TEST_VALUE_S:"CC_alpha_value",ATTRIBUTE_NAME_COLOR:"a_color",ATTRIBUTE_NAME_POSITION:"a_position",ATTRIBUTE_NAME_TEX_COORD:"a_texCoord",ITEM_SIZE:32,CURRENT_ITEM:3233828865,ZOOM_ACTION_TAG:3233828866,NORMAL_TAG:8801,SELECTED_TAG:8802,DISABLE_TAG:8803,FIX_ARTIFACTS_BY_STRECHING_TEXEL:0,DIRECTOR_STATS_POSITION:cc.p(0,0),DIRECTOR_FPS_INTERVAL:.5,COCOSNODE_RENDER_SUBPIXEL:1,SPRITEBATCHNODE_RENDER_SUBPIXEL:1,AUTO_PREMULTIPLIED_ALPHA_FOR_PNG:0,OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA:0,TEXTURE_ATLAS_USE_TRIANGLE_STRIP:0,TEXTURE_ATLAS_USE_VAO:0,TEXTURE_NPOT_SUPPORT:0,USE_LA88_LABELS:1,SPRITE_DEBUG_DRAW:0,LABELBMFONT_DEBUG_DRAW:0,LABELATLAS_DEBUG_DRAW:0,ENABLE_STACKABLE_ACTIONS:1,ENABLE_GL_STATE_CACHE:1,TOUCH_TIMEOUT:5e3,BATCH_VERTEX_COUNT:2e4,ENABLE_GC_FOR_NATIVE_OBJECTS:!0,ENABLE_TILEDMAP_CULLING:!0,DOWNLOAD_MAX_CONCURRENT:64,ENABLE_TRANSPARENT_CANVAS:!1},cc.defineGetterSetter(cc.macro,"BLEND_SRC",(function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.macro.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?cc.macro.ONE:cc.macro.SRC_ALPHA})),cc.lerp=function(t,e,i){return t+(e-t)*i},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(t){return t*cc.macro.RAD},cc.radiansToDegrees=function(t){return t*cc.macro.DEG},cc.nodeDrawSetup=function(t){t._shaderProgram&&(t._shaderProgram.use(),t._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},cc.incrementGLDraws=function(t){cc.g_NumberOfDraws+=t},cc.checkGLErrorDebug=function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){var t=cc._renderContext.getError();t&&cc.logID(2400,t)}},e.exports=cc.macro}),{"./_CCClass":143}],140:[(function(i,n,o){function r(){this._name="",this._objFlags=0}function s(){for(var t=u.length,e=0;e<t;++e){var i=u[e];i._objFlags&l||i._destroyImmediate()}t===u.length?u.length=0:u.splice(0,t)}function c(i,n){var o,r={};for(o in i)if(i.hasOwnProperty(o))switch("object"==(e=typeof i[o])?t(i[o]):e){case"string":r[o]="";break;case"object":case"function":r[o]=null}if(cc.Class._isCCClass(n))for(var s=cc.Class.Attr.getClassAttrs(n),c=n.__props__,a=0;a<c.length;a++){var l=(o=c[a])+cc.Class.Attr.DELIMETER+"default";if(l in s)switch("object"==(e=typeof s[l])?t(s[l]):e){case"string":r[o]="";break;case"object":case"function":r[o]=null;break;case"undefined":r[o]=void 0}}var u=i instanceof cc._BaseNode||i instanceof cc.Component,d="";for(o in r)if(!u||"_id"!==o){var p;p=h.IDENTIFIER_RE.test(o)?"o."+o+"=":"o["+h.escapeForJS(o)+"]=";var _=r[o];""===_&&(_='""'),d+=p+_+";\n"}return Function("o",d)}var a=i("./js"),h=i("./CCClass"),l=1;h.fastDefine("cc.Object",r,{_name:"",_objFlags:0}),a.value(r,"Flags",{Destroyed:l,DontSave:8,EditorOnly:16,Dirty:32,DontDestroy:64,PersistentMask:-4192741,Destroying:128,Deactivating:256,IsPreloadStarted:8192,IsOnLoadStarted:32768,IsOnLoadCalled:16384,IsOnEnableCalled:2048,IsStartCalled:65536,IsEditorOnEnableCalled:4096,IsPositionLocked:1<<21,IsRotationLocked:1<<17,IsScaleLocked:1<<18,IsAnchorLocked:1<<19,IsSizeLocked:1<<20});var u=[];a.value(r,"_deferredDestroy",s);var d=r.prototype;a.getset(d,"name",(function(){return this._name}),(function(t){this._name=t})),a.get(d,"isValid",(function(){return!(this._objFlags&l)}));d.destroy=function(){return this._objFlags&l?(cc.warnID(5e3),!1):!(4&this._objFlags)&&(this._objFlags|=4,u.push(this),!0)},d._destruct=function(){var t=this.constructor,e=t.__destruct__;e||(e=c(this,t),a.value(t,"__destruct__",e,!0)),e(this)},d._onPreDestroy=null,d._destroyImmediate=function(){this._objFlags&l?cc.errorID(5e3):(this._onPreDestroy&&this._onPreDestroy(),this._destruct(),this._objFlags|=l)},d._deserialize=null,cc.isValid=function(i){return"object"===("object"==(e=typeof i)?t(i):e)?!(!i||i._objFlags&l):"undefined"!==("object"==(e=typeof i)?t(i):e)},cc.Object=n.exports=r}),{"./CCClass":136,"./js":151}],141:[(function(i,n,o){if(!cc.sys){cc.sys={};var r=cc.sys;r.LANGUAGE_ENGLISH="en",r.LANGUAGE_CHINESE="zh",r.LANGUAGE_FRENCH="fr",r.LANGUAGE_ITALIAN="it",r.LANGUAGE_GERMAN="de",r.LANGUAGE_SPANISH="es",r.LANGUAGE_DUTCH="du",r.LANGUAGE_RUSSIAN="ru",r.LANGUAGE_KOREAN="ko",r.LANGUAGE_JAPANESE="ja",r.LANGUAGE_HUNGARIAN="hu",r.LANGUAGE_PORTUGUESE="pt",r.LANGUAGE_ARABIC="ar",r.LANGUAGE_NORWEGIAN="no",r.LANGUAGE_POLISH="pl",r.LANGUAGE_TURKISH="tr",r.LANGUAGE_UKRAINIAN="uk",r.LANGUAGE_ROMANIAN="ro",r.LANGUAGE_BULGARIAN="bg",r.LANGUAGE_UNKNOWN="unknown",r.OS_IOS="iOS",r.OS_ANDROID="Android",r.OS_WINDOWS="Windows",r.OS_MARMALADE="Marmalade",r.OS_LINUX="Linux",r.OS_BADA="Bada",r.OS_BLACKBERRY="Blackberry",r.OS_OSX="OS X",r.OS_WP8="WP8",r.OS_WINRT="WINRT",r.OS_UNKNOWN="Unknown",r.UNKNOWN=-1,r.WIN32=0,r.LINUX=1,r.MACOS=2,r.ANDROID=3,r.IPHONE=4,r.IPAD=5,r.BLACKBERRY=6,r.NACL=7,r.EMSCRIPTEN=8,r.TIZEN=9,r.WINRT=10,r.WP8=11,r.MOBILE_BROWSER=100,r.DESKTOP_BROWSER=101,r.EDITOR_PAGE=102,r.EDITOR_CORE=103,r.BROWSER_TYPE_WECHAT="wechat",r.BROWSER_TYPE_ANDROID="androidbrowser",r.BROWSER_TYPE_IE="ie",r.BROWSER_TYPE_QQ="qqbrowser",r.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",r.BROWSER_TYPE_UC="ucbrowser",r.BROWSER_TYPE_360="360browser",r.BROWSER_TYPE_BAIDU_APP="baiduboxapp",r.BROWSER_TYPE_BAIDU="baidubrowser",r.BROWSER_TYPE_MAXTHON="maxthon",r.BROWSER_TYPE_OPERA="opera",r.BROWSER_TYPE_OUPENG="oupeng",r.BROWSER_TYPE_MIUI="miuibrowser",r.BROWSER_TYPE_FIREFOX="firefox",r.BROWSER_TYPE_SAFARI="safari",r.BROWSER_TYPE_CHROME="chrome",r.BROWSER_TYPE_LIEBAO="liebao",r.BROWSER_TYPE_QZONE="qzone",r.BROWSER_TYPE_SOUGOU="sogou",r.BROWSER_TYPE_UNKNOWN="unknown",r.isNative=!1,r.isBrowser="object"===("object"==(e=typeof window)?t(window):e)&&"object"===("object"==(e=typeof document)?t(document):e);var s=window,c=s.navigator,a=document,h=a.documentElement,l=c.userAgent.toLowerCase();r.isMobile=/mobile|android|iphone|ipad/.test(l),r.platform=r.isMobile?r.MOBILE_BROWSER:r.DESKTOP_BROWSER;var u=c.language;u=(u=u||c.browserLanguage)?u.split("-")[0]:r.LANGUAGE_ENGLISH,r.language=u;var d=!1,p=!1,_="",f=0,g=/android (\d+(?:\.\d+)+)/i.exec(l)||/android (\d+(?:\.\d+)+)/i.exec(c.platform);g&&(d=!0,_=g[1]||"",f=parseInt(_)||0),(g=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(l))?(p=!0,_=g[2]||"",f=parseInt(_)||0):/(iPhone|iPad|iPod)/.exec(c.platform)&&(p=!0,_="",f=0);var v=r.OS_UNKNOWN;-1!==c.appVersion.indexOf("Win")?v=r.OS_WINDOWS:p?v=r.OS_IOS:-1!==c.appVersion.indexOf("Mac")?v=r.OS_OSX:-1!==c.appVersion.indexOf("X11")&&-1===c.appVersion.indexOf("Linux")?v=r.OS_UNIX:d?v=r.OS_ANDROID:-1===c.appVersion.indexOf("Linux")&&-1===l.indexOf("ubuntu")||(v=r.OS_LINUX),r.os=v,r.osVersion=_,r.osMainVersion=f,r.browserType=r.BROWSER_TYPE_UNKNOWN,(function(){var t=/qqbrowser|chrome|safari|firefox|trident|opera|opr|oupeng/i,e=/mqqbrowser|micromessenger|qq|sogou|qzone|liebao|maxthon|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser/i.exec(l);e||(e=t.exec(l));var i=e?e[0].toLowerCase():r.BROWSER_TYPE_UNKNOWN;"micromessenger"===i?i=r.BROWSER_TYPE_WECHAT:"safari"===i&&d?i=r.BROWSER_TYPE_ANDROID:"qq"===i&&l.match(/android.*applewebkit/i)?brwoserType=r.BROWSER_TYPE_ANDROID:"trident"===i?i=r.BROWSER_TYPE_IE:"360 aphone"===i?i=r.BROWSER_TYPE_360:"mxbrowser"===i?i=r.BROWSER_TYPE_MAXTHON:"opr"===i&&(i=r.BROWSER_TYPE_OPERA),r.browserType=i})(),r.browserVersion="",(function(){var t=/(mqqbrowser|micromessenger|qq|sogou|qzone|liebao|maxthon|uc|360 aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui)(mobile)?(browser)?\/?([\d.]+)/i,e=/(qqbrowser|chrome|safari|firefox|trident|opera|opr|oupeng)(mobile)?(browser)?\/?([\d.]+)/i,i=l.match(t);i||(i=l.match(e)),r.browserVersion=i?i[4]:""})();var y=window.innerWidth||document.documentElement.clientWidth,m=window.innerHeight||document.documentElement.clientHeight,b=window.devicePixelRatio||1;r.windowPixelResolution={width:b*y,height:b*m},r._checkWebGLRenderMode=function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL)throw new Error("This feature supports WebGL render mode only.")};var C=document.createElement("canvas"),T=document.createElement("canvas");if(cc.create3DContext=function(t,e,i){if(!i)return cc.create3DContext(t,e,"webgl")||cc.create3DContext(t,e,"experimental-webgl")||cc.create3DContext(t,e,"webkit-3d")||cc.create3DContext(t,e,"moz-webgl")||null;try{return t.getContext(i,e)}catch(t){return null}},r._supportCanvasNewBlendModes=(function(){var t=C;t.width=1,t.height=1;var e=t.getContext("2d");e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply";var i=T;i.width=1,i.height=1;var n=i.getContext("2d");return n.fillStyle="#fff",n.fillRect(0,0,1,1),e.drawImage(i,0,0,1,1),0===e.getImageData(0,0,1,1).data[0]})(),cc.sys.isMobile){var S=document.createElement("style");S.type="text/css",document.body.appendChild(S),S.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}try{var E=r.localStorage=s.localStorage;E.setItem("storage",""),E.removeItem("storage"),E=null}catch(t){var x=function(){cc.warnID(5200)};r.localStorage={getItem:x,setItem:x,removeItem:x,clear:x}}var A=C.toDataURL("image/webp").startsWith("data:image/webp"),w=!!C.getContext("2d"),O=!1;if(s.WebGLRenderingContext&&(cc.create3DContext(document.createElement("CANVAS"))&&(O=!0),O&&r.os===r.OS_IOS&&9===r.osMainVersion&&(s.indexedDB||(O=!1)),O&&r.os===r.OS_ANDROID)){var I=parseFloat(r.browserVersion);switch(r.browserType){case r.BROWSER_TYPE_MOBILE_QQ:case r.BROWSER_TYPE_BAIDU:case r.BROWSER_TYPE_BAIDU_APP:O=I>=6.2;break;case r.BROWSER_TYPE_ANDROID:r.osMainVersion&&r.osMainVersion>=5&&(O=!0);break;case r.BROWSER_TYPE_CHROME:O=I>=30;break;case r.BROWSER_TYPE_UC:O=I>11;case r.BROWSER_TYPE_360:O=!1}}var N=r.capabilities={canvas:w,opengl:O,webp:A};(void 0!==h.ontouchstart||void 0!==a.ontouchstart||c.msPointerEnabled)&&(N.touches=!0),void 0!==h.onmouseup&&(N.mouse=!0),void 0!==h.onkeyup&&(N.keyboard=!0),(s.DeviceMotionEvent||s.DeviceOrientationEvent)&&(N.accelerometer=!0);var L;!(function(){r.browserVersion;var t=!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);L={ONLY_ONE:!1,WEB_AUDIO:t,DELAY_CREATE_CTX:!1},r.os===r.OS_IOS&&(L.USE_LOADER_EVENT="loadedmetadata"),r.browserType===r.BROWSER_TYPE_FIREFOX&&(L.DELAY_CREATE_CTX=!0,L.USE_LOADER_EVENT="canplay"),r.os===r.OS_ANDROID&&r.browserType===r.BROWSER_TYPE_UC&&(L.ONE_SOURCE=!0)})();try{L.WEB_AUDIO&&(L.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),L.DELAY_CREATE_CTX&&setTimeout((function(){L.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}),0))}catch(t){L.WEB_AUDIO=!1,cc.logID(5201)}var R=[];!(function(){var t=document.createElement("audio");t.canPlayType&&(t.canPlayType('audio/ogg; codecs="vorbis"')&&R.push(".ogg"),t.canPlayType("audio/mpeg")&&R.push(".mp3"),t.canPlayType('audio/wav; codecs="1"')&&R.push(".wav"),t.canPlayType("audio/mp4")&&R.push(".mp4"),t.canPlayType("audio/x-m4a")&&R.push(".m4a"))})(),L.format=R,r.__audioSupport=L,r.garbageCollect=function(){},r.dumpRoot=function(){},r.restartVM=function(){},r.cleanScript=function(t){},r.isObjectValid=function(t){return!!t},r.dump=function(){var t=this,e="";e+="isMobile : "+t.isMobile+"\r\n",e+="language : "+t.language+"\r\n",e+="browserType : "+t.browserType+"\r\n",e+="browserVersion : "+t.browserVersion+"\r\n",e+="capabilities : "+JSON.stringify(t.capabilities)+"\r\n",e+="os : "+t.os+"\r\n",e+="osVersion : "+t.osVersion+"\r\n",e+="platform : "+t.platform+"\r\n",e+="Using "+(cc._renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(e)},r.openURL=function(t){window.open(t)},r.now=function(){return Date.now?Date.now():+new Date},n.exports=r}}),{}],142:[(function(t,e,i){cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(t){var e=this.width=t.width,i=this.height=t.height,n=t.x,o=t.y,r=o+i,s=n+e;this.topLeft.x=n,this.topLeft.y=r,this.topRight.x=s,this.topRight.y=r,this.top.x=n+e/2,this.top.y=r,this.bottomLeft.x=n,this.bottomLeft.y=o,this.bottomRight.x=s,this.bottomRight.y=o,this.bottom.x=n+e/2,this.bottom.y=o,this.center.x=n+e/2,this.center.y=o+i/2,this.left.x=n,this.left.y=o+i/2,this.right.x=s,this.right.y=o+i/2}}}),{}],143:[(function(i,n,o){var r=cc.ClassManager={instanceId:0|998*Math.random(),getNewInstanceId:function(){return this.instanceId++}},s=/\b_super\b/,c=function(){};c.extend=function(i){var n,o=this.prototype,a=Object.create(o),h={writable:!0,enumerable:!1,configurable:!0};if(cc.game&&cc.game.config&&cc.game.config[cc.game.CONFIG_KEY.exposeClassName]){var l="return (function "+(i._className||"Class")+"(arg0,arg1,arg2,arg3,arg4) {\nthis.__instanceId = cc.ClassManager.getNewInstanceId();\nif (this.ctor) {\nswitch (arguments.length) {\ncase 0: this.ctor(); break;\ncase 1: this.ctor(arg0); break;\ncase 2: this.ctor(arg0,arg1); break;\ncase 3: this.ctor(arg0,arg1,arg2); break;\ncase 4: this.ctor(arg0,arg1,arg2,arg3); break;\ncase 5: this.ctor(arg0,arg1,arg2,arg3,arg4); break;\ndefault: this.ctor.apply(this, arguments);\n}\n}\n});";n=Function(l)()}else n=function(t,e,i,n,o){if(this.__instanceId=r.getNewInstanceId(),this.ctor)switch(arguments.length){case 0:this.ctor();break;case 1:this.ctor(t);break;case 2:this.ctor(t,e);break;case 3:this.ctor(t,e,i);break;case 4:this.ctor(t,e,i,n);break;case 5:this.ctor(t,e,i,n,o);break;default:this.ctor.apply(this,arguments)}};n.prototype=a,h.value=n,Object.defineProperty(a,"constructor",h);for(var u in i){var d="function"===("object"==(e=typeof i[u])?t(i[u]):e);d&&"function"===("object"==(e=typeof o[u])?t(o[u]):e)&&s.test(i[u])?(h.value=(function(t,e){return function(){var i=this._super;this._super=o[t];var n=e.apply(this,arguments);return this._super=i,n}})(u,i[u]),Object.defineProperty(a,u,h)):d?(h.value=i[u],Object.defineProperty(a,u,h)):a[u]=i[u]}return n.extend=c.extend,n.implement=function(t){for(var e in t)a[e]=t[e]},n},cc.defineGetterSetter=function(t,e,i,n,o,r){if(t.__defineGetter__)i&&t.__defineGetter__(e,i),n&&t.__defineSetter__(e,n);else{if(!Object.defineProperty)throw new Error("browser does not support getters");var s={configurable:!0};i&&(s.get=i),n&&(s.set=n),Object.defineProperty(t,e,s)}},cc.clone=function(i){var n=i.constructor?new i.constructor:{};for(var o in i){var r=i[o];"object"!==("object"==(e=typeof r)?t(r):e)||!r||r instanceof _ccsg.Node?n[o]=r:n[o]=cc.clone(r)}return n},cc._Class=n.exports=c}),{}],144:[(function(i,n,o){function r(t,e,i){var n;n=function(){},i&&u.extend(n,i.constructor);var o=new n;return u.value(t,"__attrs__",o),o}function s(t){for(var e,i=cc.Class.getInheritanceChain(t),n=i.length-1;n>=0;n--){var o=i[n];o.hasOwnProperty("__attrs__")&&o.__attrs__||r(o,o,(e=i[n+1])&&e.__attrs__)}return e=i[0],r(t,t,e&&e.__attrs__),t.__attrs__}function c(i,n,o){var s,c,h;if("function"===("object"==(e=typeof i)?t(i):e))c=(s=a(i)).constructor.prototype;else{var l=i;(s=l.__attrs__)||(s=r(l,i=l.constructor,a(i))),c=s}if("undefined"===("object"==(e=typeof o)?t(o):e)){var u=n+d,p={};for(h in s)h.startsWith(u)&&(p[h.slice(u.length)]=s[h]);return p}if("object"===("object"==(e=typeof o)?t(o):e))for(h in o)95!==h.charCodeAt(0)&&(c[n+d+h]=o[h])}function a(t){return t.hasOwnProperty("__attrs__")&&t.__attrs__||s(t)}function h(t){return a(t).constructor.prototype}function l(t,e){}var u=i("./js"),d=(i("./utils").isPlainEmptyObj_DEV,"$_$");cc.Integer="Integer",cc.Float="Float",cc.Boolean="Boolean",cc.String="String",n.exports={attr:c,getClassAttrs:a,getClassAttrsProto:h,setClassAttr:function(t,e,i,n){h(t)[e+d+i]=n},DELIMETER:d,getTypeChecker:l,ObjectType:function(t){return{type:"Object",ctor:t,_onAfterProp:!1}},ScriptUuid:{}}}),{"./CCClass":136,"./js":151,"./utils":156}],145:[(function(i,n,o){var r=i("./js"),s=function(){this._callbackTable={},this._invoking={},this._toRemove={},this._toRemoveAll=null},c={};s.REMOVE_PLACEHOLDER=c,s.prototype._clearToRemove=function(t){var e=this._callbackTable[t];if(this._toRemove[t]&&e){for(var i=e.indexOf(c),n=i,o=i+1;o<e.length;++o){var r=e[o];r!==c&&(e[n]=r,++n)}e.length=n,this._toRemove[t]=!1}this._toRemoveAll&&(this.removeAll(this._toRemoveAll),this._toRemoveAll=null)},s.prototype.add=function(i,n,o){var r=this._callbackTable[i];return"undefined"!==("object"==(e=typeof r)?t(r):e)?("object"===("object"==(e=typeof o)?t(o):e)?r.push(n,o):r.push(n),!1):(r="object"===("object"==(e=typeof o)?t(o):e)?[n,o]:[n],this._callbackTable[i]=r,!0)},s.prototype.has=function(i,n,o){if(this._toRemoveAll===i)return!1;var r,s,a=this._callbackTable[i];if(!a)return!1;if(!n){if(this._toRemove[i]){for(s=0;s<a.length;s++)if(a[s]!==c)return!0;return!1}return a.length>0}if("function"!==("object"==(e=typeof n)?t(n):e))return!1;for(s=a.indexOf(n);-1!==s;){if(r=a[s+1],"object"!==("object"==(e=typeof r)?t(r):e)&&(r=void 0),r===o)return!0;s=cc.js.array.indexOf.call(a,n,s+1)}return!1},s.prototype.removeAll=function(i){if(this._invoking[i])this._toRemoveAll=i;else if("object"===("object"==(e=typeof i)?t(i):e)){var n,o,r,s=i;for(i in this._callbackTable)for(o=(n=this._callbackTable[i]).lastIndexOf(s);-1!==o;)r=n[o-1],"function"===("object"==(e=typeof r)?t(r):e)?n.splice(o-1,2):n.splice(o,1),o=n.lastIndexOf(s)}else delete this._callbackTable[i],delete this._toRemove[i]},s.prototype.remove=function(i,n,o){var r,s,a=this._callbackTable[i];if(a){for(r=a.indexOf(n);-1!==r;){if(s=a[r+1],"object"!==("object"==(e=typeof s)?t(s):e)&&(s=void 0),s===o){a[r]=c,s&&(a[r+1]=c),this._toRemove[i]=!0;break}r=cc.js.array.indexOf.call(a,n,r+1)}return!0}return!1};var a=function(){s.call(this)};r.extend(a,s),a.prototype.invoke=function(i,n,o,r,s,a){this._invoking[i]=!0;var h=this._callbackTable[i];if(h){var l,u=h.length-1;for(l=0;l<=u;){var d=h[l],p=1;if(d!==c){var _=h[l+1];_&&"object"===("object"==(e=typeof _)?t(_):e)?(d.call(_,n,o,r,s,a),p=2):d(n,o,r,s,a)}l+=p}}this._invoking[i]=!1,this._clearToRemove(i)},a.prototype.invokeAndRemove=function(i,n,o,r,s,a){this._invoking[i]=!0;var h,l,u,d,p,_=this._callbackTable[i];if(_)for(h=0,l=_.length;h<l;)u=1,(d=_[h])!==c&&((p=_[h+1])&&"object"===("object"==(e=typeof p)?t(p):e)?(d.call(p,n,o,r,s,a),u=2):d(n,o,r,s,a)),h+=u;this._invoking[i]=!1,this._toRemove[i]=!1,this.removeAll(i)},a.prototype.bindKey=function(i,n){var o=this;return function(r,s,c,a,h){var l,u,d,p=o._callbackTable[i];if(p)for(l=0,u=p.length;l<u;)(d=p[l+1])&&"object"===("object"==(e=typeof d)?t(d):e)?(p[l].call(d,r,s,c,a,h),l+=2):(p[l](r,s,c,a,h),++l);n&&o.removeAll(i)}},a.CallbacksHandler=s,n.exports=a}),{"./js":151}],146:[(function(i,n,o){var r=i("./js"),s=(i("./CCObject"),i("./attribute")),c=i("./CCClass"),a=function(){this.uuidList=[],this.uuidObjList=[],this.uuidPropList=[],this.rawProp=""};a.prototype.reset=function(){this.uuidList.length=0,this.uuidObjList.length=0,this.uuidPropList.length=0,this.rawProp=""},a.prototype.getUuidOf=function(t,e){for(var i=0;i<this.uuidObjList.length;i++)if(this.uuidObjList[i]===t&&this.uuidPropList[i]===e)return this.uuidList[i];return""},a.prototype.push=function(t,e,i){this.uuidList.push(i),this.uuidObjList.push(t),this.uuidPropList.push(e)},(a.pool=new r.Pool(function(t){t.reset()},10)).get=function(){return this._get()||new a};var h=(function(){function i(t,e,i,n,o){this.result=t,this.customEnv=n,this.deserializedList=[],this.deserializedData=null,this._classFinder=i,this._idList=[],this._idObjList=[],this._idPropList=[]}function n(t){var e,i,n,o=t.deserializedList,r=t._idPropList,s=t._idList,c=t._idObjList;t._classFinder&&t._classFinder.onDereferenced;for(e=0;e<s.length;e++)i=r[e],n=s[e],c[e][i]=o[n]}function o(t,e){for(var i=s.DELIMETER+"rawType",n=(s.DELIMETER,s.DELIMETER+"serializable"),o=s.DELIMETER+"default",a=s.getClassAttrs(e),h=e.__props__,l=["var prop;"],u=0;u<h.length;u++){var d,p=h[u];if(a[p+i])d=c.IDENTIFIER_RE.test(p)?'"'+p+'"':c.escapeForJS(p),l.push('if(s.result.rawProp)\ncc.error("not support multi raw object in a file");'),l.push("s.result.rawProp="+d+";");else{if(!1===a[p+n])continue;var _;c.IDENTIFIER_RE.test(p)?(d='"'+p+'"',_="."+p):_="["+(d=c.escapeForJS(p))+"]",l.push("prop=d"+_+";"),l.push('if(typeof (prop)!=="undefined"){'),l.push('if(typeof (prop)!=="object"){o'+_+"=prop;"),l.push("}else{if(prop){");var f=c.getDefault(a[p+o]);if(f instanceof cc.ValueType){var g=r.getClassName(f);l.push("s._deserializeTypedObject(o"+_+",prop,"+g+");")}else l.push("s._deserializeObjField(o,prop,"+d+");");l.push("}else o"+_+"=null;}}")}}return"_$erialized"===h[h.length-1]&&(l.push("o._$erialized=JSON.parse(JSON.stringify(d));"),l.push("s._deserializePrimitiveObject(o._$erialized,d);")),Function("s","o","d","k","t",l.join(""))}function a(t,e,i,n,s){var c;n.hasOwnProperty("__deserialize__")?c=n.__deserialize__:(c=o(t,n),r.value(n,"__deserialize__",c,!0)),c(t,e,i,n,s)}var h=i.prototype;return h.deserialize=function(t){if(Array.isArray(t)){var e=t,i=e.length;this.deserializedList.length=i;for(var o=0;o<i;o++)if(e[o]){this.deserializedList[o]=this._deserializeObject(e[o])}this.deserializedData=i>0?this.deserializedList[0]:[]}else this.deserializedList.length=1,this.deserializedData=t?this._deserializeObject(t):null,this.deserializedList[0]=this.deserializedData;return n(this),this.deserializedData},h._deserializeObject=function(i,n,o,s){var c,h=null,l=null;if(i.__type__){var u=i.__type__;if(!(l=this._classFinder(u,i,o,s)))return this._classFinder===r._getClassById&&cc.deserialize.reportMissingClass(u),null;if(h=new l,l===cc.SpriteFrame&&h.retain(),h._deserialize)return h._deserialize(i.content,this),h;cc.Class._isCCClass(l)?a(this,h,i,l,n):this._deserializeTypedObject(h,i,l)}else if(Array.isArray(i)){h=new Array(i.length);for(var d=0;d<i.length;d++)c=i[d],"object"===("object"==(e=typeof c)?t(c):e)&&c?this._deserializeObjField(h,c,""+d):h[d]=c}else h={},this._deserializePrimitiveObject(h,i);return h},h._deserializeObjField=function(i,n,o,r){var s=n.__id__;if("undefined"===("object"==(e=typeof s)?t(s):e)){var c=n.__uuid__;c?(this.result.uuidList.push(c),this.result.uuidObjList.push(i),this.result.uuidPropList.push(o)):i[o]=this._deserializeObject(n)}else{var a=this.deserializedList[s];a?i[o]=a:(this._idList.push(s),this._idObjList.push(i),this._idPropList.push(o))}},h._deserializePrimitiveObject=function(i,n){var o=this;for(var r in n)if(n.hasOwnProperty(r)){var s=n[r];"object"!==("object"==(e=typeof s)?t(s):e)?"__type__"!==r&&(i[r]=s):s?o._deserializeObjField(i,s,r):i[r]=null}},h._deserializeTypedObject=function(i,n,o){if(o===cc.Vec2)return i.x=n.x||0,void(i.y=n.y||0);if(o!==cc.Color){var r=o.__props__;r||(r=Object.keys(i));for(var s=0;s<r.length;s++){var c=r[s],a=n[c];"undefined"!==("object"==(e=typeof a)?t(a):e)&&n.hasOwnProperty(c)&&("object"!==("object"==(e=typeof a)?t(a):e)?i[c]=a:a?this._deserializeObjField(i,a,c):i[c]=null)}}else{i.r=n.r||0,i.g=n.g||0,i.b=n.b||0;var h=n.a;i.a=void 0===h?255:h}},i.pool=new r.Pool(function(t){t.result=null,t.customEnv=null,t.deserializedList.length=0,t.deserializedData=null,t._classFinder=null,t._idList.length=0,t._idObjList.length=0,t._idPropList.length=0},1),i.pool.get=function(t,e,n,o,r){var s=this._get();return s?(s.result=t,s.customEnv=o,s._classFinder=n,s):new i(t,e,n,o,r)},i})();cc.deserialize=function(i,n,o){var s=(o=o||{}).classFinder||r._getClassById,c=o.createAssetRefs||cc.sys.platform===cc.sys.EDITOR_CORE,l=o.customEnv,u=o.ignoreEditorOnly;"string"===("object"==(e=typeof i)?t(i):e)&&(i=JSON.parse(i));var d=!n;n=n||a.pool.get();var p=h.pool.get(n,!1,s,l,u);cc.game._isCloning=!0;var _=p.deserialize(i);return cc.game._isCloning=!1,h.pool.put(p),c&&n.assignAssetsBy(Editor.serialize.asAsset),d&&a.pool.put(n),_},cc.deserialize.Details=a,cc.deserialize.reportMissingClass=function(t){cc.warnID(5302,t)}}),{"./CCClass":136,"./CCObject":140,"./attribute":144,"./js":151}],147:[(function(t,e,i){function n(t){this.id=0|998*Math.random(),this.prefix=t?t+o:""}var o=".";n.prototype.getNewId=function(){return this.prefix+ ++this.id},n.global=new n("global"),e.exports=n}),{}],148:[(function(t,e,i){t("./js"),t("./CCClass"),t("./CCClassDecorator"),t("./CCEnum"),t("./CCObject"),t("./callbacks-invoker"),t("./url"),t("./deserialize"),t("./instantiate"),t("./instantiate-jit"),t("./requiring-frame"),t("./CCSys"),t("./CCMacro"),t("./CCAssetLibrary")}),{"./CCAssetLibrary":135,"./CCClass":136,"./CCClassDecorator":137,"./CCEnum":138,"./CCMacro":139,"./CCObject":140,"./CCSys":141,"./CCVisibleRect":142,"./callbacks-invoker":145,"./deserialize":146,"./instantiate":150,"./instantiate-jit":149,"./js":151,"./miniFramework":152,"./requiring-frame":154,"./url":155}],149:[(function(i,n,o){function r(t,e){this.varName=t,this.expression=e}function s(t,e){return e instanceof r?new r(e.varName,t+e.expression):t+e}function c(t,e,i){Array.isArray(i)?(i[0]=s(e,i[0]),t.push(i)):t.push(s(e,i)+";")}function a(t){this._exps=[],this._targetExp=t}function h(i,n){if("function"===("object"==(e=typeof i)?t(i):e))try{i=i()}catch(t){return!1}if(i===n)return!0;if(i&&n){if(i instanceof cc.ValueType&&i.equals(n))return!0;if(Array.isArray(i)&&Array.isArray(n)||i.constructor===Object&&n.constructor===Object)try{return JSON.stringify(i)===JSON.stringify(n)}catch(t){}}return!1}function l(t,e){var i=[];return (function t(e){for(var n=0;n<e.length;n++){var o=e[n];Array.isArray(o)?t(o):i.push(o)}})(t),i.join(e)}function u(t){return C.test(t)?"."+t:"["+T(t)+"]"}function d(t,e){this.parent=e,this.objsToClear_iN$t=[],this.codeArray=[],this.objs=[],this.funcs=[],this.funcModuleCache=v.createMap(),v.mixin(this.funcModuleCache,A),this.globalVariables=[],this.globalVariableId=0,this.localVariableId=0,this.codeArray.push(S+E+","+x+";","if(R){",E+"=R;","}else{",E+"=R=new "+this.getFuncModule(t.constructor,!0)+"();","}"),t._iN$t={globalVar:"R"},this.objsToClear_iN$t.push(t),this.enumerateObject(this.codeArray,t);var i;this.globalVariables.length>0&&(i=S+this.globalVariables.join(",")+";");var n=l(["return (function(R){",i||[],this.codeArray,"return o;","})"],"");this.result=Function("O","F",n)(this.objs,this.funcs);for(var o=0,r=this.objsToClear_iN$t.length;o<r;++o)this.objsToClear_iN$t[o]._iN$t=null;this.objsToClear_iN$t.length=0}var p=i("./CCObject"),_=p.Flags.Destroyed,f=p.Flags.PersistentMask,g=i("./attribute"),v=i("./js"),y=i("./CCClass"),m=g.DELIMETER+"serializable",b=g.DELIMETER+"default",C=y.IDENTIFIER_RE,T=y.escapeForJS,S="var ",E="o",x="t",A={"cc.Node":"cc.Node","cc.Sprite":"cc.Sprite","cc.Label":"cc.Label","cc.Button":"cc.Button","cc.Widget":"cc.Widget","cc.Animation":"cc.Animation","cc.ClickEvent":!1,"cc.PrefabInfo":!1};r.prototype.toString=function(){return S+this.varName+"="+this.expression+";"},a.prototype.append=function(t,e){this._exps.push([t,e])},a.prototype.writeCode=function(t){var e;if(this._exps.length>1)t.push(x+"="+this._targetExp+";"),e=x;else{if(1!==this._exps.length)return;e=this._targetExp}for(var i=0;i<this._exps.length;i++){var n=this._exps[i];c(t,e+u(n[0])+"=",n[1])}},(a.pool=new v.Pool(function(t){t._exps.length=0,t._targetExp=null},1)).get=function(t){var e=this._get()||new a;return e._targetExp=t,e};var w=d.prototype;w.getFuncModule=function(t,e){var i=v.getClassName(t);if(i){var n=this.funcModuleCache[i];if(n)return n;if(void 0===n){var o=-1!==i.indexOf(".");if(o)try{if(o=t===Function("return "+i)())return this.funcModuleCache[i]=i,i}catch(t){}}}var r=this.funcs.indexOf(t);r<0&&(r=this.funcs.length,this.funcs.push(t));var s="F["+r+"]";return e&&(s="("+s+")"),this.funcModuleCache[i]=s,s},w.getObjRef=function(t){var e=this.objs.indexOf(t);return e<0&&(e=this.objs.length,this.objs.push(t)),"O["+e+"]"},w.setValueType=function(t,e,i,n){var o=a.pool.get(n),r=e.constructor.__props__;r||(r=Object.keys(e));for(var s=0;s<r.length;s++){var c=r[s],h=i[c];if(e[c]!==h){var l=this.enumerateField(i,c,h);o.append(c,l)}}o.writeCode(t),a.pool.put(o)},w.enumerateCCClass=function(i,n,o){for(var r=o.__props__,s=g.getClassAttrs(o),c=0;c<r.length;c++){var a=r[c];if(!1!==s[a+m]){var l=n[a],d=s[a+b];if(h(d,l))continue;if("object"===("object"==(e=typeof l)?t(l):e)&&l instanceof cc.ValueType&&((d=y.getDefault(d))&&d.constructor)===l.constructor){var p=E+u(a);this.setValueType(i,d,l,p);continue}this.setObjProp(i,n,a,l)}}},w.instantiateArray=function(t){if(0===t.length)return"[]";var e="a"+ ++this.localVariableId,i=[new r(e,"new Array("+t.length+")")];t._iN$t={globalVar:"",source:i},this.objsToClear_iN$t.push(t);for(var n=0;n<t.length;++n)c(i,e+"["+n+"]=",this.enumerateField(t,n,t[n]));return i},w.enumerateField=function(i,n,o){if("object"===("object"==(e=typeof o)?t(o):e)&&o){var r=o._iN$t;if(r){var c=r.globalVar;if(!c){c=r.globalVar="v"+ ++this.globalVariableId,this.globalVariables.push(c);var a=r.source[0];r.source[0]=s(c+"=",a)}return c}return Array.isArray(o)?this.instantiateArray(o):this.instantiateObj(o)}return"function"===("object"==(e=typeof o)?t(o):e)?this.getFuncModule(o):"string"===("object"==(e=typeof o)?t(o):e)?T(o):("_objFlags"===n&&i instanceof p&&(o&=f),o)},w.setObjProp=function(t,e,i,n){c(t,E+u(i)+"=",this.enumerateField(e,i,n))},w.enumerateObject=function(i,n){var o=n.constructor;if(cc.Class._isCCClass(o))this.enumerateCCClass(i,n,o);else for(var r in n)if(n.hasOwnProperty(r)&&(95!==r.charCodeAt(0)||95!==r.charCodeAt(1)||"__type__"===r)){var s=n[r];"object"===("object"==(e=typeof s)?t(s):e)&&s&&s===n._iN$t||this.setObjProp(i,n,r,s)}},w.instantiateObj=function(t){if(t instanceof cc.ValueType)return y.getNewValueTypeCode(t);if(t instanceof cc.Asset)return this.getObjRef(t);if(t._objFlags&_)return null;var e,i=t.constructor;if(cc.Class._isCCClass(i)){if(this.parent)if(this.parent instanceof cc.Component){if(t instanceof cc._BaseNode||t instanceof cc.Component)return this.getObjRef(t)}else if(this.parent instanceof cc._BaseNode)if(t instanceof cc._BaseNode){if(!t.isChildOf(this.parent))return this.getObjRef(t)}else if(t instanceof cc.Component&&!t.node.isChildOf(this.parent))return this.getObjRef(t);e=new r(E,"new "+this.getFuncModule(i,!0)+"()")}else{if(i!==Object)return this.getObjRef(t);e=new r(E,"{}")}var n=[e];return t._iN$t={globalVar:"",source:n},this.objsToClear_iN$t.push(t),this.enumerateObject(n,t),["(function(){",n,"return o;})();"]},n.exports={compile:function(t){return new d(t,t instanceof cc._BaseNode&&t).result},equalsToDefault:h}}),{"./CCClass":136,"./CCObject":140,"./attribute":144,"./js":151}],150:[(function(i,n,o){function r(i,n){if(!n){if("object"!==("object"==(e=typeof i)?t(i):e)||Array.isArray(i))return null;if(!i)return null;if(!cc.isValid(i))return null}var o;if(i instanceof l){if(i._instantiate)return cc.game._isCloning=!0,o=i._instantiate(),cc.game._isCloning=!1,o;if(i instanceof cc.Asset)return null}return cc.game._isCloning=!0,o=s(i),cc.game._isCloning=!1,o}function s(t,e){if(Array.isArray(t))return null;var i;a(t,i=t._iN$t?t._iN$t:new(0,t.constructor),e);for(var n=0,o=_.length;n<o;++n)_[n]._iN$t=null;return _.length=0,i}function c(i,n,o,r){for(var s=i.__props__,c=p.getClassAttrs(i),a=0;a<s.length;a++){var l=s[a];if(!1!==c[l+f]){var u=n[l];"object"===("object"==(e=typeof u)?t(u):e)&&u?o[l]=u._iN$t||h(u,r):o[l]=u}}}function a(i,n,o){i._iN$t=n,_.push(i);var r=i.constructor;if(cc.Class._isCCClass(r))c(r,i,n,o);else for(var s in i)if(i.hasOwnProperty(s)&&(95!==s.charCodeAt(0)||95!==s.charCodeAt(1)||"__type__"===s)){var a=i[s];if("object"===("object"==(e=typeof a)?t(a):e)&&a){if(a===n)continue;n[s]=a._iN$t||h(a,o)}else n[s]=a}i instanceof l&&(n._objFlags&=d)}function h(i,n){if(i instanceof cc.ValueType)return i.clone();if(i instanceof cc.Asset)return i;var o;if(Array.isArray(i)){var r=i.length;o=new Array(r),i._iN$t=o;for(var s=0;s<r;++s){var c=i[s];"object"===("object"==(e=typeof c)?t(c):e)&&c?o[s]=c._iN$t||h(c,n):o[s]=c}return _.push(i),o}if(i._objFlags&u)return null;var l=i.constructor;if(cc.Class._isCCClass(l)){if(n)if(n instanceof cc.Component){if(i instanceof cc._BaseNode||i instanceof cc.Component)return i}else if(n instanceof cc._BaseNode)if(i instanceof cc._BaseNode){if(!i.isChildOf(n))return i}else if(i instanceof cc.Component&&!i.node.isChildOf(n))return i}else if(l!==Object)return i;return o=new l,a(i,o,n),o}var l=i("./CCObject"),u=l.Flags.Destroyed,d=l.Flags.PersistentMask,p=i("./attribute"),_=(i("./utils").isDomNode,[]),f=p.DELIMETER+"serializable";r._clone=s,cc.instantiate=r,n.exports=r}),{"./CCObject":140,"./attribute":144,"./utils":156}],151:[(function(i,n,o){function r(t,e){for(;t;){var i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Object.getPrototypeOf(t)}return null}function s(t,e,i){var n=r(e,t);Object.defineProperty(i,t,n)}function c(t,e){t.splice(e,1)}function a(t,e){var i=t.indexOf(e);return i>=0&&(c(t,i),!0)}function h(i,n){"number"===("object"==(e=typeof i)?t(i):e)&&(n=i,i=null),this.get=null,this.count=0,this._pool=new Array(n),this._cleanup=i}var l=new(i("./id-generater"))("TmpCId."),u={isNumber:function(i){return"number"===("object"==(e=typeof i)?t(i):e)||i instanceof Number},isString:function(i){return"string"===("object"==(e=typeof i)?t(i):e)||i instanceof String},addon:function(i){"use strict";i=i||{};for(var n=1,o=arguments.length;n<o;n++){var r=arguments[n];if(r){if("object"!==("object"==(e=typeof r)?t(r):e)){cc.errorID(5402,r);continue}for(var c in r)c in i||s(c,r,i)}}return i},mixin:function(i){"use strict";i=i||{};for(var n=1,o=arguments.length;n<o;n++){var r=arguments[n];if(r){if("object"!==("object"==(e=typeof r)?t(r):e)){cc.errorID(5403,r);continue}for(var c in r)s(c,r,i)}}return i},extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),t},getSuper:function(t){if(t.hasOwnProperty("$super"))return t.$super;var e=t.prototype,i=e&&Object.getPrototypeOf(e);return i&&i.constructor},clear:function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)delete t[e[i]]},getPropertyDescriptor:r},d={value:void 0,enumerable:!1,writable:!1,configurable:!0};u.value=function(t,e,i,n,o){d.value=i,d.writable=n,d.enumerable=o,Object.defineProperty(t,e,d),d.value=void 0};var p={get:null,set:null,enumerable:!1};u.getset=function(i,n,o,r,s){"function"!==("object"==(e=typeof r)?t(r):e)&&(s=r,r=void 0),p.get=o,p.set=r,p.enumerable=s,Object.defineProperty(i,n,p),p.get=null,p.set=null};var _={get:null,enumerable:!1,configurable:!1};u.get=function(t,e,i,n,o){_.get=i,_.enumerable=n,_.configurable=o,Object.defineProperty(t,e,_),_.get=null};var f={set:null,enumerable:!1,configurable:!1};u.set=function(t,e,i,n,o){f.set=i,f.enumerable=n,f.configurable=o,Object.defineProperty(t,e,f),f.set=null},u.getClassName=function(i){if("function"===("object"==(e=typeof i)?t(i):e)){var n=i.prototype;if(n&&n.hasOwnProperty("__classname__")&&n.__classname__)return n.__classname__;var o="";if(i.name&&(o=i.name),i.toString){var r,s=i.toString();(r="["===s.charAt(0)?s.match(/\[\w+\s*(\w+)\]/):s.match(/function\s*(\w+)/))&&2===r.length&&(o=r[1])}return"Object"!==o?o:""}return i&&i.constructor?u.getClassName(i.constructor):""},(function(){function i(t,e){return function(i,n){if(n.prototype.hasOwnProperty(t)&&delete e[n.prototype[t]],u.value(n.prototype,t,i),i){var o=e[i];if(o&&o!==n){var r="A Class already exists with the same "+t+' : "'+i+'".';cc.error(r)}else e[i]=n}}}var n={},o={};u._setClassId=i("__cid__",n);var r=i("__classname__",o);u.setClassName=function(t,e){if(r(t,e),!e.prototype.hasOwnProperty("__cid__")){var i=t||l.getNewId();i&&u._setClassId(i,e)}},u.unregisterClass=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t].prototype,i=e.__cid__;i&&delete n[i];var r=e.__classname__;r&&delete o[r]}},u._getClassById=function(t){return n[t]},u.getClassByName=function(t){return o[t]},u._getClassId=function(i,n){n="undefined"===("object"==(e=typeof n)?t(n):e)||n;if("function"===("object"==(e=typeof i)?t(i):e)&&i.prototype.hasOwnProperty("__cid__"))return i.prototype.__cid__;if(i&&i.constructor){var o=i.constructor.prototype;if(o&&o.hasOwnProperty("__cid__"))return i.__cid__}return""}})(),u.obsolete=function(t,e,i,n){function o(){return this[i]}var r=/([^.]+)$/.exec(e)[0];n?u.getset(t,r,o,(function(t){this[i]=t})):u.get(t,r,o)},u.obsoletes=function(t,e,i,n){for(var o in i){var r=i[o];u.obsolete(t,e+"."+o,r,n)}};var g=/(%d)|(%s)/,v=/%s/;u.formatStr=function(){var i=arguments.length;if(0===i)return"";var n=arguments[0];if(1===i)return""+n;if("string"===("object"==(e=typeof n)?t(n):e)&&g.test(n))for(var o=1;o<i;++o){var r=arguments[o],s="number"===("object"==(e=typeof r)?t(r):e)?g:v;s.test(n)?n=n.replace(s,r):n+=" "+r}else for(var c=1;c<i;++c)n+=" "+arguments[c];return n},u.shiftArguments=function(){for(var t=arguments.length-1,e=new Array(t),i=0;i<t;++i)e[i]=arguments[i+1];return e},u.createMap=function(t){var e=Object.create(null);return t&&(e.__=void 0,delete e.__),e};var y=Array.prototype.indexOf;u.array={remove:a,fastRemove:function(t,e){var i=t.indexOf(e);i>=0&&(t[i]=t[t.length-1],--t.length)},removeAt:c,fastRemoveAt:function(t,e){var i=t.length;e<0||e>=i||(t[e]=t[i-1],t.length=i-1)},contains:function(t,e){return y.call(t,e)>=0},verifyType:function(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return cc.logID(1300),!1;return!0},removeArray:function(t,e){for(var i=0,n=e.length;i<n;i++)a(t,e[i])},appendObjectsAt:function(t,e,i){return t.splice.apply(t,[i,0].concat(e)),t},copy:function(t){var e,i=t.length,n=new Array(i);for(e=0;e<i;e+=1)n[e]=t[e];return n},indexOf:y,MutableForwardIterator:i("../utils/mutable-forward-iterator")},h.prototype._get=function(){if(this.count>0){--this.count;var t=this._pool[this.count];return this._pool[this.count]=null,t}return null},h.prototype.put=function(t){var e=this._pool;if(this.count<e.length){if(this._cleanup&&!1===this._cleanup(t))return;e[this.count]=t,++this.count}},h.prototype.resize=function(t){t>=0&&(this._pool.length=t,this.count>t&&(this.count=t))},u.Pool=h,cc.js=u,n.exports=u}),{"../utils/mutable-forward-iterator":163,"./id-generater":147}],152:[(function(t,e,i){switch(cc.$=function(t){var e=this===cc?document:this,i=t instanceof HTMLElement?t:e.querySelector(t);return i&&(i.find=i.find||cc.$,i.hasClass=i.hasClass||function(t){return this.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},i.addClass=i.addClass||function(t){return this.hasClass(t)||(this.className&&(this.className+=" "),this.className+=t),this},i.removeClass=i.removeClass||function(t){return this.hasClass(t)&&(this.className=this.className.replace(t,"")),this},i.remove=i.remove||function(){return this.parentNode&&this.parentNode.removeChild(this),this},i.appendTo=i.appendTo||function(t){return t.appendChild(this),this},i.prependTo=i.prependTo||function(t){return t.childNodes[0]?t.insertBefore(this,t.childNodes[0]):t.appendChild(this),this},i.transforms=i.transforms||function(){return this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},i.position=i.position||{x:0,y:0},i.rotation=i.rotation||0,i.scale=i.scale||{x:1,y:1},i.skew=i.skew||{x:0,y:0},i.translates=function(t,e){return this.position.x=t,this.position.y=e,this.transforms(),this},i.rotate=function(t){return this.rotation=t,this.transforms(),this},i.resize=function(t,e){return this.scale.x=t,this.scale.y=e,this.transforms(),this},i.setSkew=function(t,e){return this.skew.x=t,this.skew.y=e,this.transforms(),this}),i},cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O",cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms",cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}cc.$.trans=cc.$.pfx+"Transform",cc.$.translate=cc.$.hd?function(t){return"translate3d("+t.x+"px, "+t.y+"px, 0) "}:function(t){return"translate("+t.x+"px, "+t.y+"px) "},cc.$.rotate=cc.$.hd?function(t){return"rotateZ("+t+"deg) "}:function(t){return"rotate("+t+"deg) "},cc.$.scale=function(t){return"scale("+t.x+", "+t.y+") "},cc.$.skew=function(t){return"skewX("+-t.x+"deg) skewY("+t.y+"deg)"},cc.$new=function(t){return cc.$(document.createElement(t))},cc.$.findpos=function(t){var e=0,i=0;do{e+=t.offsetLeft,i+=t.offsetTop}while(t=t.offsetParent);return{x:e,y:i}}}),{}],153:[(function(i,n,o){function r(t,e,i,n){if(!t.get&&!t.set&&t.hasOwnProperty("default")){var o="_N$"+e;t.get=function(){return this[o]},t.set=function(t){var e=this[o];this[o]=t,i.call(this,e)};var r={};n[o]=r;for(var s in h){var c=h[s];t.hasOwnProperty(s)&&(r[s]=t[s],c.canUsedInGet||delete t[s])}}}function s(t,e,i,n){Array.isArray(n)&&n.length>0&&(n=n[0]),t.type=n}function c(t,e,i,n){if(Array.isArray(e)){if(!(e.length>0))return cc.errorID(5508,i,n);if(cc.RawAsset.isRawAssetType(e[0]))return t.url=e[0],void delete t.type;t.type=e=e[0]}}function a(t,e,i,n){}var h={url:{canUsedInGet:!0},default:{},serializable:{},editorOnly:{},rawType:{}};o.getFullFormOfProperty=function(i){if(!(i&&i.constructor===Object)){if(Array.isArray(i)&&i.length>0)return{default:[],type:i,_short:!0};if("function"===("object"==(e=typeof i)?t(i):e)){var n=i;return cc.RawAsset.isRawAssetType(n)?{default:"",url:n,_short:!0}:{default:cc.isChildClassOf(n,cc.ValueType)?new n:null,type:n,_short:!0}}return{default:i,_short:!0}}return null},o.preprocessAttrs=function(t,e,i,n){for(var h in t){var l=t[h],u=o.getFullFormOfProperty(l);if(u&&(l=t[h]=u),l){var d=l.notify;d&&r(l,h,d,t),"type"in l&&c(l,l.type,e,h),"url"in l&&s(l,0,0,l.url),"type"in l&&a(0,l.type)}}},o.validateMethodWithProps=function(i,n,o,r,s){if("function"!==("object"==(e=typeof i)?t(i):e)&&null!==i){return!1}return!0}}),{"./CCClass":136}],154:[(function(t,e,i){var n=[];cc._RF={push:function(t,e,i){void 0===i&&(i=e,e=""),n.push({uuid:e,script:i,module:t,exports:t.exports,beh:null})},pop:function(){var t=n.pop(),e=t.module,i=e.exports;if(i===t.exports){for(var o in i)return;e.exports=i=t.cls}},peek:function(){return n[n.length-1]}},cc._RFpush=cc._RF.push,cc._RFpop=cc._RF.pop,cc._RFpeek=cc._RF.peek}),{}],155:[(function(t,e,i){var n={};cc.url={_rawAssets:"",_builtinRawAssets:"",normalize:function(t){return 46===t.charCodeAt(0)&&47===t.charCodeAt(1)?t=t.slice(2):47===t.charCodeAt(0)&&(t=t.slice(1)),t},raw:function(t){return(t=this.normalize(t)).startsWith("resources/")||cc.errorID(7002,t),this._rawAssets+t},builtinRaw:!1,_init:function(t){for(var e in t){var i=t[e];i=cc.path.stripSep(i)+"/",n[e]=i}this._rawAssets=n.assets,this._builtinRawAssets=n.internal}},e.exports=cc.url}),{}],156:[(function(i,n,o){n.exports={contains:function(i,n){if("function"==("object"==(e=typeof i.contains)?t(i.contains):e))return i.contains(n);if("function"==("object"==(e=typeof i.compareDocumentPosition)?t(i.compareDocumentPosition):e))return!!(16&i.compareDocumentPosition(n));var o=n.parentNode;do{if(o===i)return!0;o=o.parentNode}while(null!==o);return!1},isDomNode:"object"===("object"==(e=typeof window)?t(window):e)&&("function"===("object"==(e=typeof Node)?t(Node):e)?function(t){return t instanceof Node}:function(i){return i&&"object"===("object"==(e=typeof i)?t(i):e)&&"number"===("object"==(e=typeof i.nodeType)?t(i.nodeType):e)&&"string"===("object"==(e=typeof i.nodeName)?t(i.nodeName):e)}),callInNextTick:function(t,e,i){t&&cc.director.once(cc.Director._EVENT_NEXT_TICK,(function(){t(e,i)}))}}}),{}],157:[(function(t,e,i){t("../platform/CCSys");var n=/(\.[^\.\/\?\\]*)(\?.*)?$/,o=/[^\.\/]+\/\.\.\//;cc.path={join:function(){for(var t=arguments.length,e="",i=0;i<t;i++)e=(e+(""===e?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return e},extname:function(t){var e=n.exec(t);return e?e[1]:""},mainFileName:function(t){if(t){var e=t.lastIndexOf(".");if(-1!==e)return t.substring(0,e)}return t},basename:function(t,e){var i=t.indexOf("?");i>0&&(t=t.substring(0,i));var n=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(t.replace(/(\/|\\\\)$/,""));if(!n)return null;var o=n[2];return e&&t.substring(t.length-e.length).toLowerCase()===e.toLowerCase()?o.substring(0,o.length-e.length):o},dirname:function(t){return t.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(t,e){e=e||"";var i=t.indexOf("?"),n="";return i>0&&(n=t.substring(i),t=t.substring(0,i)),(i=t.lastIndexOf("."))<0?t+e+n:t.substring(0,i)+e+n},changeBasename:function(t,e,i){if(0===e.indexOf("."))return this.changeExtname(t,e);var n=t.indexOf("?"),o="",r=i?this.extname(t):"";return n>0&&(o=t.substring(n),t=t.substring(0,n)),n=t.lastIndexOf("/"),n=n<=0?0:n+1,t.substring(0,n)+e+r+o},_normalize:function(t){var e=t=String(t);do{e=t,t=t.replace(o,"")}while(e.length!==t.length);return t},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",stripSep:function(t){return t.replace(/[\/\\]$/,"")}},e.exports=cc.path}),{"../platform/CCSys":141}],158:[(function(i,n,o){function r(i){return i?"string"===("object"==(e=typeof i)?t(i):e)?p.getClassByName(i):i:(cc.errorID(3804),null)}function s(t,e){for(var i=0;i<t._components.length;++i){var n=t._components[i];if(n instanceof e)return n}return null}function c(t,e,i){for(var n=0;n<t._components.length;++n){var o=t._components[n];o instanceof e&&i.push(o)}}function a(t,e){for(var i=0;i<t.length;++i){var n=t[i],o=s(n,e);if(o)return o;if(n._children.length>0&&(o=a(n._children,e)))return o}return null}function h(t,e,i){for(var n=0;n<t.length;++n){var o=t[n];c(o,e,i),o._children.length>0&&h(o._children,e,i)}}var l=i("../platform/CCObject").Flags,u=i("./misc"),d=i("../platform/id-generater"),p=cc.js,_=l.Destroying,f=l.DontDestroy,g=new d("Node"),v=cc.Class({name:"cc._BaseNode",extends:cc.Object,mixins:[cc.EventTarget],properties:{_parent:null,_children:[],_tag:cc.macro.NODE_TAG_INVALID,_active:!0,_components:[],_prefab:null,_persistNode:{get:function(){return(this._objFlags&f)>0},set:function(t){t?this._objFlags|=f:this._objFlags&=~f}},name:{get:function(){return this._name},set:function(t){this._name=t}},_id:{default:"",editorOnly:!0},uuid:{get:function(){var t=this._id;return t||(t=this._id=g.getNewId()),t}},children:{get:function(){return this._children}},childrenCount:{get:function(){return this._children.length}},active:{get:function(){return this._active},set:function(t){if(t=!!t,this._active!==t){this._active=t;var e=this._parent;e&&e._activeInHierarchy&&cc.director._nodeActivator.activateNode(this,t)}}},activeInHierarchy:{get:function(){return this._activeInHierarchy}}},ctor:function(i){this._name="undefined"!==("object"==(e=typeof i)?t(i):e)?i:"New Node",this._activeInHierarchy=!1,this.__instanceId=this._id||cc.ClassManager.getNewInstanceId(),this.__eventTargets=[]},getTag:function(){return this._tag},setTag:function(t){this._tag=t},getParent:function(){return this._parent},setParent:function(t){if(this._parent!==t){var e=this._parent;if(this._parent=t||null,this._onSetParent(t),t&&(t._children.push(this),t.emit("child-added",this)),e){if(!(e._objFlags&_)){var i=e._children.indexOf(this);e._children.splice(i,1),e.emit("child-removed",this),this._onHierarchyChanged(e)}}else t&&this._onHierarchyChanged(null)}},init:function(){return!0},attr:function(t){p.mixin(this,t)},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];if(n&&n._tag===t)return n}return null},getChildByUuid:function(t){if(!t)return cc.log("Invalid uuid"),null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._id===t)return e[i];return null},getChildByName:function(t){if(!t)return cc.log("Invalid name"),null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._name===t)return e[i];return null},addChild:function(t){cc.assertID(t,1606),cc.assertID(null===t._parent,1605),t.setParent(this)},insertChild:function(t,e){t.parent=this,t.setSiblingIndex(e)},getSiblingIndex:function(){return this._parent?this._parent._children.indexOf(this):0},setSiblingIndex:function(t){if(this._parent){var e=this._parent._children;t=-1!==t?t:e.length-1;var i=e.indexOf(this);t!==i&&(e.splice(i,1),t<e.length?e.splice(t,0,this):e.push(this),this._onSiblingIndexChanged&&this._onSiblingIndexChanged(t))}},cleanup:function(){},removeFromParent:function(t){this._parent&&(void 0===t&&(t=!0),this._parent.removeChild(this,t))},removeChild:function(t,e){this._children.indexOf(t)>-1&&((e||void 0===e)&&t.cleanup(),t.parent=null)},removeChildByTag:function(t,e){t===cc.macro.NODE_TAG_INVALID&&cc.logID(1609);var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.logID(1610,t)},removeAllChildren:function(t){var e=this._children;void 0===t&&(t=!0);for(var i=e.length-1;i>=0;i--){var n=e[i];n&&(t&&n.cleanup(),n.parent=null)}this._children.length=0},isChildOf:function(t){var e=this;do{if(e===t)return!0;e=e._parent}while(e);return!1},getComponent:function(t){var e=r(t);return e?s(this,e):null},getComponents:function(t){var e=r(t),i=[];return e&&c(this,e,i),i},getComponentInChildren:function(t){var e=r(t);return e?a(this._children,e):null},getComponentsInChildren:function(t){var e=r(t),i=[];return e&&(c(this,e,i),h(this._children,e,i)),i},_checkMultipleComp:!1,addComponent:function(i){var n;if("string"===("object"==(e=typeof i)?t(i):e)){if(!(n=p.getClassByName(i)))return cc.errorID(3807,i),cc._RFpeek()&&cc.errorID(3808,i),null}else{if(!i)return cc.errorID(3804),null;n=i}if("function"!==("object"==(e=typeof n)?t(n):e))return cc.errorID(3809),null;if(!cc.isChildClassOf(n,cc.Component))return cc.errorID(3810),null;var o=n._requireComponent;if(o&&!this.getComponent(o)&&!this.addComponent(o))return null;var r=new n;return r.node=this,this._components.push(r),this._activeInHierarchy&&cc.director._nodeActivator.activateComp(r),r},_addComponentAt:!1,removeComponent:function(t){t?(t instanceof cc.Component||(t=this.getComponent(t)),t&&t.destroy()):cc.errorID(3813)},_getDependComponent:!1,_removeComponent:function(t){if(t){if(!(this._objFlags&_)){var e=this._components.indexOf(t);-1!==e?this._components.splice(e,1):t.node!==this&&cc.errorID(3815)}}else cc.errorID(3814)},_disableChildComps:function(){var t,e=this._components.length;for(t=0;t<e;++t){var i=this._components[t];i._enabled&&cc.director._compScheduler.disableComp(i)}for(t=0,e=this._children.length;t<e;++t){var n=this._children[t];n._active&&n._disableChildComps()}},destroy:function(){cc.Object.prototype.destroy.call(this)&&this._activeInHierarchy&&this._disableChildComps()},destroyAllChildren:function(){for(var t=this._children,e=0;e<t.length;++e)t[e].destroy()},_onSetParent:function(t){},_onPostActivated:function(){},_onHierarchyChanged:function(t){var e=this._parent;!this._persistNode||e instanceof cc.Scene||cc.game.removePersistRootNode(this);var i=this._active&&!(!e||!e._activeInHierarchy);this._activeInHierarchy!==i&&cc.director._nodeActivator.activateNode(this,i)},_onBatchCreated:function(){var t=this._prefab;t&&t.sync&&!t._synced&&t.root===this&&PrefabHelper.syncWithPrefab(this);for(var e=this._children,i=0,n=e.length;i<n;i++)e[i]._onBatchCreated()},_instantiate:function(t){t||(t=cc.instantiate._clone(this,this));var e=this._prefab;return e&&this===e.root&&e.sync&&(t._prefab._synced=e._synced),t._parent=null,t._onBatchCreated(),t},_registerIfAttached:!1,_onPreDestroy:function(){var t,e;this._objFlags|=_;var i=this._parent,n=i&&i._objFlags&_,o=this._children;for(t=0,e=o.length;t<e;++t)o[t]._destroyImmediate();for(t=0,e=this._components.length;t<e;++t)this._components[t]._destroyImmediate();var r=this.__eventTargets;for(t=0,e=r.length;t<e;++t){var s=r[t];s&&s.targetOff(this)}if(r.length=0,this._persistNode&&cc.game.removePersistRootNode(this),!n&&i){var c=i._children.indexOf(this);i._children.splice(c,1),i.emit("child-removed",this)}return n},onRestore:!1});v.prototype._onPreDestroyBase=v.prototype._onPreDestroy,v.prototype._onHierarchyChangedBase=v.prototype._onHierarchyChanged;var y=["name","children","childrenCount"];u.propertyDefine(v,y,{}),cc._BaseNode=n.exports=v}),{"../platform/CCObject":140,"../platform/id-generater":147,"./misc":162}],159:[(function(t,e,i){var n=1e-6;e.exports={binarySearchEpsilon:function(t,e){for(var i=0,o=t.length-1,r=o>>>1;i<=o;r=i+o>>>1){var s=t[r];if(s>e+n)o=r-1;else{if(!(s<e-n))return r;i=r+1}}return~i}}}),{}],160:[(function(t,e,i){var n=t("./misc").BASE64_VALUES,o="0123456789abcdef".split(""),r=["","","",""],s=r.concat(r,"-",r,"-",r,"-",r,"-",r,r,r),c=s.map((function(t,e){return"-"===t?NaN:e})).filter(isFinite);e.exports=function(t){if(22!==t.length)return t;s[0]=t[0],s[1]=t[1];for(var e=2,i=2;e<22;e+=2){var r=n[t.charCodeAt(e)],a=n[t.charCodeAt(e+1)];s[c[i++]]=o[r>>2],s[c[i++]]=o[(3&r)<<2|a>>4],s[c[i++]]=o[15&a]}return s.join("")}}),{"./misc":162}],161:[(function(t,e,i){cc.find=e.exports=function(t,e){if(null==t)return cc.errorID(5600),null;if(!e){var i=cc.director.getScene();if(!i)return null;e=i}for(var n=e,o="/"!==t[0]?0:1,r=t.split("/"),s=o;s<r.length;s++){var c=r[s],a=n._children;n=null;for(var h=0,l=a.length;h<l;++h){var u=a[h];if(u.name===c){n=u;break}}if(!n)return null}return n}}),{}],162:[(function(t,e,i){var n=t("../platform/js"),o=t("../platform/CCSys"),r=i;r.propertyDefine=function(t,e,i){function n(t,e,i,n){var o=Object.getOwnPropertyDescriptor(t,e);if(o)o.get&&(t[i]=o.get),o.set&&n&&(t[n]=o.set);else{var r=t[i];cc.js.getset(t,e,r,t[n])}}for(var o,r=t.prototype,s=0;s<e.length;s++){var c=(o=e[s])[0].toUpperCase()+o.slice(1);n(r,o,"get"+c,"set"+c)}for(o in i){var a=i[o];n(r,o,a[0],a[1])}},r.NextPOT=function(t){return t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},r.imagePool=new n.Pool(function(t){return t instanceof HTMLImageElement&&(t.src=this._smallImg,!0)},10),r.imagePool.get=function(){return this._get()||new Image},r.imagePool._smallImg="data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=",o.os!==o.OS_WINDOWS&&o.os!==o.OS_LINUX||o.browser===o.BROWSER_TYPE_CHROME||r.imagePool.resize(0),r.isBuiltinClassId=function(t){return t.startsWith("cc.")||t.startsWith("dragonBones.")||t.startsWith("sp.")||t.startsWith("ccsg.")};for(var s=new Array(123),c=0;c<123;++c)s[c]=64;for(var a=0;a<64;++a)s["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charCodeAt(a)]=a;r.BASE64_VALUES=s}),{"../platform/CCSys":141,"../platform/js":151}],163:[(function(t,e,i){function n(t){this.i=0,this.array=t}var o=n.prototype;o.remove=function(t){var e=this.array.indexOf(t);e>=0&&this.removeAt(e)},o.removeAt=function(t){this.array.splice(t,1),t<=this.i&&--this.i},o.fastRemove=function(t){var e=this.array.indexOf(t);e>=0&&this.fastRemoveAt(e)},o.fastRemoveAt=function(t){var e=this.array;e[t]=e[e.length-1],--e.length,t<=this.i&&--this.i},o.push=function(t){this.array.push(t)},e.exports=n}),{}],164:[(function(t,e,i){cc._PrefabInfo=cc.Class({name:"cc.PrefabInfo",properties:{root:null,asset:null,fileId:"",sync:!1,_synced:{default:!1,serializable:!1}}}),e.exports={syncWithPrefab:function(t){var e=t._prefab;if(e._synced=!0,!e.asset)return cc.errorID(3701,t.name),void(t._prefab=null);var i=t._objFlags,n=t._parent,o=t._id,r=t._name,s=t._active,c=t._position.x,a=t._position.y,h=t._rotationX,l=t._rotationY,u=t._localZOrder,d=t._globalZOrder;cc.game._isCloning=!0,e.asset._doInstantiate(t),cc.game._isCloning=!1,t._objFlags=i,t._parent=n,t._id=o,t._prefab=e,t._name=r,t._active=s,t._position.x=c,t._position.y=a,t._rotationX=h,t._rotationY=l,t._localZOrder=u,t._globalZOrder=d}}}),{}],165:[(function(t,e,i){var n={removeSgNode:function(){var t=this._sgNode;if(t){var e=t._parent;e&&e.removeChild(t),t.release(),this._sgNode._entity&&(this._sgNode._entity=null)}}};e.exports=n}),{}],166:[(function(t,e,i){cc.AffineTransform=function(t,e,i,n,o,r){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=o,this.ty=r},cc.affineTransformMake=function(t,e,i,n,o,r){return{a:t,b:e,c:i,d:n,tx:o,ty:r}},cc.affineTransformClone=function(t){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx,ty:t.ty}},cc.pointApplyAffineTransform=function(t,e,i){var n,o;return void 0===i?(i=e,n=t.x,o=t.y):(n=t,o=e),{x:i.a*n+i.c*o+i.tx,y:i.b*n+i.d*o+i.ty}},cc._pointApplyAffineTransformIn=function(t,e,i,n){var o,r,s;void 0===n?(s=e,o=t.x,r=t.y,n=i):(o=t,r=e,s=i),n.x=s.a*o+s.c*r+s.tx,n.y=s.b*o+s.d*r+s.ty},cc._pointApplyAffineTransform=function(t,e,i){return cc.pointApplyAffineTransform(t,e,i)},cc.sizeApplyAffineTransform=function(t,e){return{width:e.a*t.width+e.c*t.height,height:e.b*t.width+e.d*t.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(t,e){var i=t.x,n=t.y,o=i+t.width,r=n+t.height,s=e.a*i+e.c*n+e.tx,c=e.b*i+e.d*n+e.ty,a=e.a*o+e.c*n+e.tx,h=e.b*o+e.d*n+e.ty,l=e.a*i+e.c*r+e.tx,u=e.b*i+e.d*r+e.ty,d=e.a*o+e.c*r+e.tx,p=e.b*o+e.d*r+e.ty,_=Math.min(s,a,l,d),f=Math.max(s,a,l,d),g=Math.min(c,h,u,p),v=Math.max(c,h,u,p);return cc.rect(_,g,f-_,v-g)},cc._rectApplyAffineTransformIn=function(t,e){var i=t.x,n=t.y,o=i+t.width,r=n+t.height,s=e.a*i+e.c*n+e.tx,c=e.b*i+e.d*n+e.ty,a=e.a*o+e.c*n+e.tx,h=e.b*o+e.d*n+e.ty,l=e.a*i+e.c*r+e.tx,u=e.b*i+e.d*r+e.ty,d=e.a*o+e.c*r+e.tx,p=e.b*o+e.d*r+e.ty,_=Math.min(s,a,l,d),f=Math.max(s,a,l,d),g=Math.min(c,h,u,p),v=Math.max(c,h,u,p);return t.x=_,t.y=g,t.width=f-_,t.height=v-g,t},cc.obbApplyAffineTransform=function(t,e,i,n,o,r){var s=t.x,c=t.y,a=t.width,h=t.height,l=e.a*s+e.c*c+e.tx,u=e.b*s+e.d*c+e.ty,d=e.a*a,p=e.b*a,_=e.c*h,f=e.d*h;n.x=l,n.y=u,o.x=d+l,o.y=p+u,i.x=_+l,i.y=f+u,r.x=d+_+l,r.y=p+f+u},cc.affineTransformTranslate=function(t,e,i){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx+t.a*e+t.c*i,ty:t.ty+t.b*e+t.d*i}},cc.affineTransformScale=function(t,e,i){return{a:t.a*e,b:t.b*e,c:t.c*i,d:t.d*i,tx:t.tx,ty:t.ty}},cc.affineTransformRotate=function(t,e){var i=Math.sin(e),n=Math.cos(e);return{a:t.a*n+t.c*i,b:t.b*n+t.d*i,c:t.c*n-t.a*i,d:t.d*n-t.b*i,tx:t.tx,ty:t.ty}},cc.affineTransformConcat=function(t,e){return{a:t.a*e.a+t.b*e.c,b:t.a*e.b+t.b*e.d,c:t.c*e.a+t.d*e.c,d:t.c*e.b+t.d*e.d,tx:t.tx*e.a+t.ty*e.c+e.tx,ty:t.tx*e.b+t.ty*e.d+e.ty}},cc.affineTransformConcatIn=function(t,e){var i=t.a,n=t.b,o=t.c,r=t.d,s=t.tx,c=t.ty;return t.a=i*e.a+n*e.c,t.b=i*e.b+n*e.d,t.c=o*e.a+r*e.c,t.d=o*e.b+r*e.d,t.tx=s*e.a+c*e.c+e.tx,t.ty=s*e.b+c*e.d+e.ty,t},cc.affineTransformEqualToTransform=function(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty},cc.affineTransformInvert=function(t){var e=1/(t.a*t.d-t.b*t.c);return{a:e*t.d,b:-e*t.b,c:-e*t.c,d:e*t.a,tx:e*(t.c*t.ty-t.d*t.tx),ty:e*(t.b*t.tx-t.a*t.ty)}},cc.affineTransformInvertOut=function(t,e){var i=t.a,n=t.b,o=t.c,r=t.d,s=1/(i*r-n*o);e.a=s*r,e.b=-s*n,e.c=-s*o,e.d=s*i,e.tx=s*(o*t.ty-r*t.tx),e.ty=s*(n*t.tx-i*t.ty)}}),{}],167:[(function(i,n,o){var r=i("./CCValueType"),s=i("../platform/js"),c=(function(){function n(i,n,o,r){"object"===("object"==(e=typeof i)?t(i):e)&&(n=i.g,o=i.b,r=i.a,i=i.r),i=i||0,n=n||0,o=o||0,r="number"===("object"==(e=typeof r)?t(r):e)?r:255,this._val=(~~i<<24>>>0)+(~~n<<16)+(~~o<<8)+~~r}s.extend(n,r),i("../platform/CCClass").fastDefine("cc.Color",n,{r:0,g:0,b:0,a:255});var o={WHITE:[255,255,255,255],BLACK:[0,0,0,255],TRANSPARENT:[0,0,0,0],GRAY:[127.5,127.5,127.5],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,235,4],ORANGE:[255,127,0],CYAN:[0,255,255],MAGENTA:[255,0,255]};for(var c in o)s.get(n,c,(function(t){return function(){return new n(t[0],t[1],t[2],t[3])}})(o[c]));var a=n.prototype;return a.clone=function(){var t=new n;return t._val=this._val,t},a.equals=function(t){return t&&this._val===t._val},a.lerp=function(t,e,i){i=i||new n;var o=this.r,r=this.g,s=this.b,c=this.a;return i.r=o+(t.r-o)*e,i.g=r+(t.g-r)*e,i.b=s+(t.b-s)*e,i.a=c+(t.a-c)*e,i},a.toString=function(){return"rgba("+this.r.toFixed()+", "+this.g.toFixed()+", "+this.b.toFixed()+", "+this.a.toFixed()+")"},a.getR=function(){return(4278190080&this._val)>>>24},a.setR=function(t){return this._val=(16777215&this._val|~~t<<24>>>0)>>>0,this},a.getG=function(){return(16711680&this._val)>>16},a.setG=function(t){return this._val=(4278255615&this._val|~~t<<16)>>>0,this},a.getB=function(){return(65280&this._val)>>8},a.setB=function(t){return this._val=(4294902015&this._val|~~t<<8)>>>0,this},a.getA=function(){return 255&this._val},a.setA=function(t){return this._val=(4294967040&this._val|~~t)>>>0,this},s.getset(a,"r",a.getR,a.setR,!0),s.getset(a,"g",a.getG,a.setG,!0),s.getset(a,"b",a.getB,a.setB,!0),s.getset(a,"a",a.getA,a.setA,!0),a.toCSS=function(t){return"rgba"===t?"rgba("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+","+(this.a/255).toFixed(2)+")":"rgb"===t?"rgb("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+")":"#"+this.toHEX(t)},a.clamp=function(){},a.fromHEX=function(t){t.length<8&&(t+="FF");var e=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return this._val=(0&this._val|e)>>>0,this},a.toHEX=function(t){var e=[(0|this.r).toString(16),(0|this.g).toString(16),(0|this.b).toString(16)],i=-1;if("#rgb"===t)for(i=0;i<e.length;++i)e[i].length>1&&(e[i]=e[i][0]);else if("#rrggbb"===t)for(i=0;i<e.length;++i)1===e[i].length&&(e[i]="0"+e[i]);return e.join("")},a.toRGBValue=function(){return 16777215&this._val},a.fromHSV=function(t,e,i){var o=n.hsv2rgb(t,e,i);return this._val=(o.r<<24>>>0)+(o.g<<16)+(o.b<<8)+this.a,this},a.toHSV=function(){return n.rgb2hsv(this.r,this.g,this.b)},a.fromColor=function(t){t._val?this._val=t._val:(this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a)},n})();c.rgb2hsv=function(t,e,i){t/=255,e/=255,i/=255;var n={h:0,s:0,v:0},o=Math.max(t,e,i),r=Math.min(t,e,i),s=0;return n.v=o,n.s=o?(o-r)/o:0,n.s?(s=o-r,n.h=t===o?(e-i)/s:e===o?2+(i-t)/s:4+(t-e)/s,n.h/=6,n.h<0&&(n.h+=1)):n.h=0,n},c.hsv2rgb=function(t,e,i){var n={r:0,g:0,b:0};if(0===e)n.r=n.g=n.b=i;else if(0===i)n.r=n.g=n.b=0;else{1===t&&(t=0),t*=6,e=e,i=i;var o=Math.floor(t),r=t-o,s=i*(1-e),c=i*(1-e*r),a=i*(1-e*(1-r));switch(o){case 0:n.r=i,n.g=a,n.b=s;break;case 1:n.r=c,n.g=i,n.b=s;break;case 2:n.r=s,n.g=i,n.b=a;break;case 3:n.r=s,n.g=c,n.b=i;break;case 4:n.r=a,n.g=s,n.b=i;break;case 5:n.r=i,n.g=s,n.b=c}}return n.r*=255,n.g*=255,n.b*=255,n},cc.Color=c,cc.color=function(i,n,o,r){return"string"===("object"==(e=typeof i)?t(i):e)?(new cc.Color).fromHEX(i):"object"===("object"==(e=typeof i)?t(i):e)?new cc.Color(i.r,i.g,i.b,i.a):new cc.Color(i,n,o,r)},cc.colorEqual=function(t,e){return void 0!==t._val&&void 0!==e._val?t._val===e._val:t.r===e.r&&t.g===e.g&&t.b===e.b},cc.hexToColor=function(t){t=t.replace(/^#?/,"0x");var e=parseInt(t),i=e>>16,n=(65280&e)>>8,o=255&e;return cc.color(i,n,o)},cc.colorToHex=function(t){var e=t.r.toString(16),i=t.g.toString(16),n=t.b.toString(16);return"#"+(t.r<16?"0"+e:e)+(t.g<16?"0"+i:i)+(t.b<16?"0"+n:n)},n.exports=cc.Color}),{"../platform/CCClass":136,"../platform/js":151,"./CCValueType":173}],168:[(function(t,e,i){var n=parseFloat("1.192092896e-07F");cc.pNeg=function(t){return cc.p(-t.x,-t.y)},cc.pAdd=function(t,e){return cc.p(t.x+e.x,t.y+e.y)},cc.pSub=function(t,e){return cc.p(t.x-e.x,t.y-e.y)},cc.pMult=function(t,e){return cc.p(t.x*e,t.y*e)},cc.pMidpoint=function(t,e){return cc.pMult(cc.pAdd(t,e),.5)},cc.pDot=function(t,e){return t.x*e.x+t.y*e.y},cc.pCross=function(t,e){return t.x*e.y-t.y*e.x},cc.pPerp=function(t){return cc.p(-t.y,t.x)},cc.pRPerp=function(t){return cc.p(t.y,-t.x)},cc.pProject=function(t,e){return cc.pMult(e,cc.pDot(t,e)/cc.pDot(e,e))},cc.pLengthSQ=function(t){return cc.pDot(t,t)},cc.pDistanceSQ=function(t,e){return cc.pLengthSQ(cc.pSub(t,e))},cc.pLength=function(t){return Math.sqrt(cc.pLengthSQ(t))},cc.pDistance=function(t,e){return cc.pLength(cc.pSub(t,e))},cc.pNormalize=function(t){var e=cc.pLength(t);return 0===e?cc.p(t):cc.pMult(t,1/e)},cc.pForAngle=function(t){return cc.p(Math.cos(t),Math.sin(t))},cc.pToAngle=function(t){return Math.atan2(t.y,t.x)},cc.clampf=function(t,e,i){if(e>i){var n=e;e=i,i=n}return t<e?e:t<i?t:i},cc.clamp01=function(t){return t<0?0:t<1?t:1},cc.pClamp=function(t,e,i){return cc.p(cc.clampf(t.x,e.x,i.x),cc.clampf(t.y,e.y,i.y))},cc.pFromSize=function(t){return cc.p(t.width,t.height)},cc.pCompOp=function(t,e){return cc.p(e(t.x),e(t.y))},cc.pLerp=function(t,e,i){return cc.pAdd(cc.pMult(t,1-i),cc.pMult(e,i))},cc.pFuzzyEqual=function(t,e,i){return t.x-i<=e.x&&e.x<=t.x+i&&t.y-i<=e.y&&e.y<=t.y+i},cc.pCompMult=function(t,e){return cc.p(t.x*e.x,t.y*e.y)},cc.pAngleSigned=function(t,e){var i=cc.pNormalize(t),o=cc.pNormalize(e),r=Math.atan2(i.x*o.y-i.y*o.x,cc.pDot(i,o));return Math.abs(r)<n?0:r},cc.pAngle=function(t,e){var i=Math.acos(cc.pDot(cc.pNormalize(t),cc.pNormalize(e)));return Math.abs(i)<n?0:i},cc.pRotateByAngle=function(t,e,i){var n=cc.pSub(t,e),o=Math.cos(i),r=Math.sin(i),s=n.x;return n.x=s*o-n.y*r+e.x,n.y=s*r+n.y*o+e.y,n},cc.pLineIntersect=function(t,e,i,n,o){if(t.x===e.x&&t.y===e.y||i.x===n.x&&i.y===n.y)return!1;var r=e.x-t.x,s=e.y-t.y,c=n.x-i.x,a=n.y-i.y,h=t.x-i.x,l=t.y-i.y,u=a*r-c*s;return o.x=c*l-a*h,o.y=r*l-s*h,0===u?0===o.x||0===o.y:(o.x=o.x/u,o.y=o.y/u,!0)},cc.pSegmentIntersect=function(t,e,i,n){var o=cc.p(0,0);return!!(cc.pLineIntersect(t,e,i,n,o)&&o.x>=0&&o.x<=1&&o.y>=0&&o.y<=1)},cc.pIntersectPoint=function(t,e,i,n){var o=cc.p(0,0);if(cc.pLineIntersect(t,e,i,n,o)){var r=cc.p(0,0);return r.x=t.x+o.x*(e.x-t.x),r.y=t.y+o.x*(e.y-t.y),r}return cc.p(0,0)},cc.pSameAs=function(t,e){return null!=t&&null!=e&&(t.x===e.x&&t.y===e.y)},cc.pZeroIn=function(t){t.x=0,t.y=0},cc.pIn=function(t,e){t.x=e.x,t.y=e.y},cc.pMultIn=function(t,e){t.x*=e,t.y*=e},cc.pSubIn=function(t,e){t.x-=e.x,t.y-=e.y},cc.pAddIn=function(t,e){t.x+=e.x,t.y+=e.y},cc.pNormalizeIn=function(t){cc.pMultIn(t,1/Math.sqrt(t.x*t.x+t.y*t.y))}}),{}],169:[(function(i,n,o){function r(i,n,o,r){i&&"object"===("object"==(e=typeof i)?t(i):e)&&(n=i.y,o=i.width,r=i.height,i=i.x),this.x=i||0,this.y=n||0,this.width=o||0,this.height=r||0}var s=i("./CCValueType"),c=i("../platform/js");c.extend(r,s),i("../platform/CCClass").fastDefine("cc.Rect",r,{x:0,y:0,width:0,height:0}),r.fromMinMax=function(t,e){var i=Math.min(t.x,e.x),n=Math.min(t.y,e.y);return new r(i,n,Math.max(t.x,e.x)-i,Math.max(t.y,e.y)-n)},r.contain=function(t,e){return t.x<e.x&&t.x+t.width>e.x+e.width&&t.y<e.y&&t.y+t.height>e.y+e.height?1:e.x<t.x&&e.x+e.width>t.x+t.width&&e.y<t.y&&e.y+e.height>t.y+t.height?-1:0};var a=r.prototype;a.clone=function(){return new r(this.x,this.y,this.width,this.height)},a.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},a.lerp=function(t,e,i){i=i||new r;var n=this.x,o=this.y,s=this.width,c=this.height;return i.x=n+(t.x-n)*e,i.y=o+(t.y-o)*e,i.width=s+(t.width-s)*e,i.height=c+(t.height-c)*e,i},a.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},c.getset(a,"xMin",(function(){return this.x}),(function(t){this.width+=this.x-t,this.x=t})),c.getset(a,"yMin",(function(){return this.y}),(function(t){this.height+=this.y-t,this.y=t})),c.getset(a,"xMax",(function(){return this.x+this.width}),(function(t){this.width=t-this.x})),c.getset(a,"yMax",(function(){return this.y+this.height}),(function(t){this.height=t-this.y})),c.getset(a,"center",(function(){return new cc.Vec2(this.x+.5*this.width,this.y+.5*this.height)}),(function(t){this.x=t.x-.5*this.width,this.y=t.y-.5*this.height})),c.getset(a,"origin",(function(){return new cc.Vec2(this.x,this.y)}),(function(t){this.x=t.x,this.y=t.y})),c.getset(a,"size",(function(){return new cc.Size(this.width,this.height)}),(function(t){this.width=t.width,this.height=t.height})),a.intersects=function(t){return cc.rectIntersectsRect(this,t)},a.contains=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y},a.containsRect=function(t){return this.x<=t.x&&this.x+this.width>=t.x+t.width&&this.y<=t.y&&this.y+this.height>=t.y+t.height},cc.Rect=r,cc.rect=function(t,e,i,n){return new r(t,e,i,n)},cc.rectEqualToRect=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},cc._rectEqualToZero=function(t){return t&&0===t.x&&0===t.y&&0===t.width&&0===t.height},cc.rectContainsRect=function(t,e){return!(!t||!e)&&!(t.x>=e.x||t.y>=e.y||t.x+t.width<=e.x+e.width||t.y+t.height<=e.y+e.height)},cc.rectGetMaxX=function(t){return t.x+t.width},cc.rectGetMidX=function(t){return t.x+t.width/2},cc.rectGetMinX=function(t){return t.x},cc.rectGetMaxY=function(t){return t.y+t.height},cc.rectGetMidY=function(t){return t.y+t.height/2},cc.rectGetMinY=function(t){return t.y},cc.rectContainsPoint=function(t,e){return e.x>=cc.rectGetMinX(t)&&e.x<=cc.rectGetMaxX(t)&&e.y>=cc.rectGetMinY(t)&&e.y<=cc.rectGetMaxY(t)},cc.rectIntersectsRect=function(t,e){var i=t.x+t.width,n=t.y+t.height,o=e.x+e.width,r=e.y+e.height;return!(i<e.x||o<t.x||n<e.y||r<t.y)},cc.rectOverlapsRect=function(t,e){return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)},cc.rectUnion=function(t,e){var i=cc.rect(0,0,0,0);return i.x=Math.min(t.x,e.x),i.y=Math.min(t.y,e.y),i.width=Math.max(t.x+t.width,e.x+e.width)-i.x,i.height=Math.max(t.y+t.height,e.y+e.height)-i.y,i},cc.rectIntersection=function(t,e){var i=cc.rect(Math.max(cc.rectGetMinX(t),cc.rectGetMinX(e)),Math.max(cc.rectGetMinY(t),cc.rectGetMinY(e)),0,0);return i.width=Math.min(cc.rectGetMaxX(t),cc.rectGetMaxX(e))-cc.rectGetMinX(i),i.height=Math.min(cc.rectGetMaxY(t),cc.rectGetMaxY(e))-cc.rectGetMinY(i),i},n.exports=cc.Rect}),{"../platform/CCClass":136,"../platform/js":151,"./CCValueType":173}],170:[(function(i,n,o){function r(i,n){i&&"object"===("object"==(e=typeof i)?t(i):e)&&(n=i.height,i=i.width),this.width=i||0,this.height=n||0}var s=i("./CCValueType"),c=i("../platform/js");c.extend(r,s),i("../platform/CCClass").fastDefine("cc.Size",r,{width:0,height:0}),c.get(r,"ZERO",(function(){return new r(0,0)}));var a=r.prototype;a.clone=function(){return new r(this.width,this.height)},a.equals=function(t){return t&&this.width===t.width&&this.height===t.height},a.lerp=function(t,e,i){i=i||new r;var n=this.width,o=this.height;return i.width=n+(t.width-n)*e,i.height=o+(t.height-o)*e,i},a.toString=function(){return"("+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},cc.size=function(t,e){return new r(t,e)},cc.sizeEqualToSize=function(t,e){return t&&e&&t.width===e.width&&t.height===e.height},cc.Size=n.exports=r}),{"../platform/CCClass":136,"../platform/js":151,"./CCValueType":173}],171:[(function(t,e,i){cc.Acceleration=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.timestamp=n||0},cc.BlendFunc=function(t,e){this.src=t,this.dst=e};var n=cc.Enum({ONE:1,ZERO:0,SRC_ALPHA:770,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775});cc.BlendFunc._disable=function(){return new cc.BlendFunc(n.ONE,n.ZERO)},cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._additive=function(){return new cc.BlendFunc(n.SRC_ALPHA,n.ONE)},cc.BlendFunc.BlendFactor=n,cc.BlendFunc.DISABLE,cc.js.get(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable),cc.BlendFunc.ALPHA_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied),cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied),cc.BlendFunc.ADDITIVE,cc.js.get(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive),cc.blendFuncDisable=cc.BlendFunc._disable,cc.FontDefinition=function(t){var e=this;if(e.fontName="Arial",e.fontSize=12,e.textAlign=cc.TextAlignment.CENTER,e.verticalAlign=cc.VerticalTextAlignment.TOP,e.fillStyle=cc.color(255,255,255,255),e.boundingWidth=0,e.boundingHeight=0,e.strokeEnabled=!1,e.strokeStyle=cc.color(255,255,255,255),e.lineWidth=1,e.lineHeight="normal",e.fontStyle="normal",e.fontWeight="normal",e.shadowEnabled=!1,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.shadowOpacity=1,t&&t instanceof Object)for(var i in t)e[i]=t[i]},cc.FontDefinition.prototype._getCanvasFontStr=function(){var t=this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px";return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+t+" '"+this.fontName+"'"},cc.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),cc._Dictionary=cc.Class({ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return"key_"+ ++this.__currId},setObject:function(t,e){if(null!=e){var i=this.__getKey();this._keyMapTb[i]=e,this._valueMapTb[i]=t}},objectForKey:function(t){if(null==t)return null;var e=this._keyMapTb;for(var i in e)if(e[i]===t)return this._valueMapTb[i];return null},valueForKey:function(t){return this.objectForKey(t)},removeObjectForKey:function(t){if(null!=t){var e=this._keyMapTb;for(var i in e)if(e[i]===t)return delete this._valueMapTb[i],void delete e[i]}},removeObjectsForKeys:function(t){if(null!=t)for(var e=0;e<t.length;e++)this.removeObjectForKey(t[e])},allKeys:function(){var t=[],e=this._keyMapTb;for(var i in e)t.push(e[i]);return t},removeAllObjects:function(){this._keyMapTb={},this._valueMapTb={}},count:function(){return this.allKeys().length}})}),{}],172:[(function(i,n,o){cc.WebGLColor=function(i,n,o,r,s,c){this._arrayBuffer=s||new ArrayBuffer(cc.WebGLColor.BYTES_PER_ELEMENT),this._offset=c||0;var a=this._arrayBuffer,h=this._offset;this._view=new Uint8Array(a,h,4),this._view[0]=i||0,this._view[1]=n||0,this._view[2]=o||0,"number"===("object"==(e=typeof r)?t(r):e)?this._view[3]=r:(this._view[3]=255,this.a_undefined=!0)},cc.WebGLColor.BYTES_PER_ELEMENT=4;var r=cc.WebGLColor.prototype;r._getR=function(){return this._view[0]},r._setR=function(t){this._view[0]=t<0?0:t},r._getG=function(){return this._view[1]},r._setG=function(t){this._view[1]=t<0?0:t},r._getB=function(){return this._view[2]},r._setB=function(t){this._view[2]=t<0?0:t},r._getA=function(){return this._view[3]},r._setA=function(t){this._view[3]=t<0?0:t},r.r,cc.js.getset(r,"r",r._getR,r._setR),r.g,cc.js.getset(r,"g",r._getG,r._setG),r.b,cc.js.getset(r,"b",r._getB,r._setB),r.a,cc.js.getset(r,"a",r._getA,r._setA),cc.Vertex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Vertex2F.BYTES_PER_ELEMENT=8,(r=cc.Vertex2F.prototype)._getX=function(){return this._view[0]},r._setX=function(t){this._view[0]=t},r._getY=function(){return this._view[1]},r._setY=function(t){this._view[1]=t},cc.js.getset(r,"x",r._getX,r._setX),cc.js.getset(r,"y",r._getY,r._setY),cc.Vertex3F=function(t,e,i,n,o){this._arrayBuffer=n||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT),this._offset=o||0;var r=this._arrayBuffer,s=this._offset;this._view=new Float32Array(r,s,3),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0},cc.Vertex3F.BYTES_PER_ELEMENT=12,(r=cc.Vertex3F.prototype)._getX=function(){return this._view[0]},r._setX=function(t){this._view[0]=t},r._getY=function(){return this._view[1]},r._setY=function(t){this._view[1]=t},r._getZ=function(){return this._view[2]},r._setZ=function(t){this._view[2]=t},cc.js.getset(r,"x",r._getX,r._setX),cc.js.getset(r,"y",r._getY,r._setY),cc.js.getset(r,"z",r._getZ,r._setZ),cc.Tex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Tex2F.BYTES_PER_ELEMENT=8,(r=cc.Tex2F.prototype)._getU=function(){return this._view[0]},r._setU=function(t){this._view[0]=t},r._getV=function(){return this._view[1]},r._setV=function(t){this._view[1]=t},cc.js.getset(r,"u",r._getU,r._setU),cc.js.getset(r,"v",r._getV,r._setV),cc.Quad2=function(t,e,i,n,o,r){this._arrayBuffer=o||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT),this._offset=r||0;var s=this._arrayBuffer,c=this._offset,a=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=t?new cc.Vertex2F(t.x,t.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._tr=e?new cc.Vertex2F(e.x,e.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._bl=i?new cc.Vertex2F(i.x,i.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._br=n?new cc.Vertex2F(n.x,n.y,s,c):new cc.Vertex2F(0,0,s,c)},cc.Quad2.BYTES_PER_ELEMENT=32,(r=cc.Quad2.prototype)._getTL=function(){return this._tl},r._setTL=function(t){this._tl._view[0]=t.x,this._tl._view[1]=t.y},r._getTR=function(){return this._tr},r._setTR=function(t){this._tr._view[0]=t.x,this._tr._view[1]=t.y},r._getBL=function(){return this._bl},r._setBL=function(t){this._bl._view[0]=t.x,this._bl._view[1]=t.y},r._getBR=function(){return this._br},r._setBR=function(t){this._br._view[0]=t.x,this._br._view[1]=t.y},cc.js.getset(r,"tl",r._getTL,r._setTL),cc.js.getset(r,"tr",r._getTR,r._setTR),cc.js.getset(r,"bl",r._getBL,r._setBL),cc.js.getset(r,"br",r._getBR,r._setBR),cc.Quad3=function(t,e,i,n,o,r){this._arrayBuffer=o||new ArrayBuffer(cc.Quad3.BYTES_PER_ELEMENT),this._offset=r||0;var s=this._arrayBuffer,c=this._offset,a=cc.Vertex3F.BYTES_PER_ELEMENT;this.bl=bl?new cc.Vertex3F(bl.x,bl.y,bl.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.br=br?new cc.Vertex3F(br.x,br.y,br.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.tl=tl?new cc.Vertex3F(tl.x,tl.y,tl.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.tr=tr?new cc.Vertex3F(tr.x,tr.y,tr.z,s,c):new cc.Vertex3F(0,0,0,s,c)},cc.Quad3.BYTES_PER_ELEMENT=48,cc.V3F_C4B_T2F=function(t,e,i,n,o){this._arrayBuffer=n||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=o||0;var r=this._arrayBuffer,s=this._offset;this._vertices=t?new cc.Vertex3F(t.x,t.y,t.z,r,s):new cc.Vertex3F(0,0,0,r,s),s+=cc.Vertex3F.BYTES_PER_ELEMENT,this._colors=e?new cc.WebGLColor(e.r,e.g,e.b,e.a,r,s):new cc.WebGLColor(0,0,0,0,r,s),s+=cc.WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,r,s):new cc.Tex2F(0,0,r,s)},cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24,(r=cc.V3F_C4B_T2F.prototype)._getVertices=function(){return this._vertices},r._setVertices=function(t){var e=this._vertices;e._view[0]=t.x,e._view[1]=t.y,e._view[2]=t.z},r._getColor=function(){return this._colors},r._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},r._getTexCoords=function(){return this._texCoords},r._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.js.getset(r,"vertices",r._getVertices,r._setVertices),cc.js.getset(r,"colors",r._getColor,r._setColor),cc.js.getset(r,"texCoords",r._getTexCoords,r._setTexCoords),cc.V3F_C4B_T2F_Quad=function(t,e,i,n,o,r){this._arrayBuffer=o||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._offset=r||0;var s=this._arrayBuffer,c=this._offset,a=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=t?new cc.V3F_C4B_T2F(t.vertices,t.colors,t.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._bl=e?new cc.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._tr=i?new cc.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._br=n?new cc.V3F_C4B_T2F(n.vertices,n.colors,n.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c)},cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96,(r=cc.V3F_C4B_T2F_Quad.prototype)._getTL=function(){return this._tl},r._setTL=function(t){var e=this._tl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},r._getBL=function(){return this._bl},r._setBL=function(t){var e=this._bl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},r._getTR=function(){return this._tr},r._setTR=function(t){var e=this._tr;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},r._getBR=function(){return this._br},r._setBR=function(t){var e=this._br;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},r._getArrayBuffer=function(){return this._arrayBuffer},cc.js.getset(r,"tl",r._getTL,r._setTL),cc.js.getset(r,"tr",r._getTR,r._setTR),cc.js.getset(r,"bl",r._getBL,r._setBL),cc.js.getset(r,"br",r._getBR,r._setBR),cc.js.get(r,"arrayBuffer",r._getArrayBuffer),cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad},cc.V3F_C4B_T2F_QuadCopy=function(t){if(!t)return cc.V3F_C4B_T2F_QuadZero();var e=t.tl,i=t.bl,n=t.tr,o=t.br;return{tl:{vertices:{x:e.vertices.x,y:e.vertices.y,z:e.vertices.z},colors:{r:e.colors.r,g:e.colors.g,b:e.colors.b,a:e.colors.a},texCoords:{u:e.texCoords.u,v:e.texCoords.v}},bl:{vertices:{x:i.vertices.x,y:i.vertices.y,z:i.vertices.z},colors:{r:i.colors.r,g:i.colors.g,b:i.colors.b,a:i.colors.a},texCoords:{u:i.texCoords.u,v:i.texCoords.v}},tr:{vertices:{x:n.vertices.x,y:n.vertices.y,z:n.vertices.z},colors:{r:n.colors.r,g:n.colors.g,b:n.colors.b,a:n.colors.a},texCoords:{u:n.texCoords.u,v:n.texCoords.v}},br:{vertices:{x:o.vertices.x,y:o.vertices.y,z:o.vertices.z},colors:{r:o.colors.r,g:o.colors.g,b:o.colors.b,a:o.colors.a},texCoords:{u:o.texCoords.u,v:o.texCoords.v}}}},cc.V3F_C4B_T2F_QuadsCopy=function(t){if(!t)return[];for(var e=[],i=0;i<t.length;i++)e.push(cc.V3F_C4B_T2F_QuadCopy(t[i]));return e},cc.V2F_C4B_T2F=function(t,e,i,n,o){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=o||0;var r=this._arrayBuffer,s=this._offset;this._vertices=t?new cc.Vertex2F(t.x,t.y,r,s):new cc.Vertex2F(0,0,r,s),s+=cc.Vertex2F.BYTES_PER_ELEMENT,this._colors=e?new cc.WebGLColor(e.r,e.g,e.b,e.a,r,s):new cc.WebGLColor(0,0,0,0,r,s),s+=cc.WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,r,s):new cc.Tex2F(0,0,r,s)},cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20,(r=cc.V2F_C4B_T2F.prototype)._getVertices=function(){return this._vertices},r._setVertices=function(t){this._vertices._view[0]=t.x,this._vertices._view[1]=t.y},r._getColor=function(){return this._colors},r._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},r._getTexCoords=function(){return this._texCoords},r._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.js.getset(r,"vertices",r._getVertices,r._setVertices),cc.js.getset(r,"colors",r._getColor,r._setColor),cc.js.getset(r,"texCoords",r._getTexCoords,r._setTexCoords),cc.V2F_C4B_T2F_Triangle=function(t,e,i,n,o){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT),this._offset=o||0;var r=this._arrayBuffer,s=this._offset,c=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=t?new cc.V2F_C4B_T2F(t.vertices,t.colors,t.texCoords,r,s):new cc.V2F_C4B_T2F(null,null,null,r,s),s+=c,this._b=e?new cc.V2F_C4B_T2F(e.vertices,e.colors,e.texCoords,r,s):new cc.V2F_C4B_T2F(null,null,null,r,s),s+=c,this._c=i?new cc.V2F_C4B_T2F(i.vertices,i.colors,i.texCoords,r,s):new cc.V2F_C4B_T2F(null,null,null,r,s)},cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60,(r=cc.V2F_C4B_T2F_Triangle.prototype)._getA=function(){return this._a},r._setA=function(t){var e=this._a;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},r._getB=function(){return this._b},r._setB=function(t){var e=this._b;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},r._getC=function(){return this._c},r._setC=function(t){var e=this._c;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},cc.js.getset(r,"a",r._getA,r._setA),cc.js.getset(r,"b",r._getB,r._setB),cc.js.getset(r,"c",r._getC,r._setC)}),{}],173:[(function(t,e,i){function n(){}var o=t("../platform/js");o.setClassName("cc.ValueType",n);var r=n.prototype;r.toString=function(){return""+{}},cc.ValueType=n,e.exports=n}),{"../platform/js":151}],174:[(function(i,n,o){function r(i,n){i&&"object"===("object"==(e=typeof i)?t(i):e)&&(n=i.y,i=i.x),this.x=i||0,this.y=n||0}var s=i("./CCValueType"),c=i("../platform/js"),a=i("../platform/CCClass");c.extend(r,s),a.fastDefine("cc.Vec2",r,{x:0,y:0});var h=r.prototype;h.clone=function(){return new r(this.x,this.y)},h.set=function(t){return this.x=t.x,this.y=t.y,this},h.equals=function(t){return t&&this.x===t.x&&this.y===t.y},h.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"},h.lerp=function(t,e,i){i=i||new r;var n=this.x,o=this.y;return i.x=n+(t.x-n)*e,i.y=o+(t.y-o)*e,i},h.addSelf=function(t){return this.x+=t.x,this.y+=t.y,this},h.add=function(t,e){return e=e||new r,e.x=this.x+t.x,e.y=this.y+t.y,e},h.subSelf=function(t){return this.x-=t.x,this.y-=t.y,this},h.sub=function(t,e){return e=e||new r,e.x=this.x-t.x,e.y=this.y-t.y,e},h.mulSelf=function(t){return this.x*=t,this.y*=t,this},h.mul=function(t,e){return e=e||new r,e.x=this.x*t,e.y=this.y*t,e},h.scaleSelf=function(t){return this.x*=t.x,this.y*=t.y,this},h.scale=function(t,e){return e=e||new r,e.x=this.x*t.x,e.y=this.y*t.y,e},h.divSelf=function(t){return this.x/=t,this.y/=t,this},h.div=function(t,e){return e=e||new r,e.x=this.x/t,e.y=this.y/t,e},h.negSelf=function(){return this.x=-this.x,this.y=-this.y,this},h.neg=function(t){return t=t||new r,t.x=-this.x,t.y=-this.y,t},h.dot=function(t){return this.x*t.x+this.y*t.y},h.cross=function(t){return this.y*t.x-this.x*t.y},h.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},h.magSqr=function(){return this.x*this.x+this.y*this.y},h.normalizeSelf=function(){var t=this.x*this.x+this.y*this.y;if(1===t)return this;if(0===t)return console.warn("Can't normalize zero vector"),this;var e=1/Math.sqrt(t);return this.x*=e,this.y*=e,this},h.normalize=function(t){return t=t||new r,t.x=this.x,t.y=this.y,t.normalizeSelf(),t},h.angle=function(t){var e=this.magSqr(),i=t.magSqr();if(0===e||0===i)return console.warn("Can't get angle between zero vector"),0;var n=this.dot(t)/Math.sqrt(e*i);return n=cc.clampf(n,-1,1),Math.acos(n)},h.signAngle=function(t){return Math.atan2(this.y,this.x)-Math.atan2(t.y,t.x)},h.rotate=function(t,e){return e=e||new r,e.x=this.x,e.y=this.y,e.rotateSelf(t)},h.rotateSelf=function(t){var e=Math.sin(t),i=Math.cos(t),n=this.x;return this.x=i*n-e*this.y,this.y=e*n+i*this.y,this},c.get(r,"ONE",(function(){return new r(1,1)})),c.get(r,"ZERO",(function(){return new r(0,0)})),c.get(r,"UP",(function(){return new r(0,1)})),c.get(r,"RIGHT",(function(){return new r(1,0)})),cc.Vec2=r,cc.v2=function(t,e){return new r(t,e)},cc.p=cc.v2,cc.pointEqualToPoint=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y},n.exports=cc.Vec2}),{"../platform/CCClass":136,"../platform/js":151,"./CCValueType":173}],175:[(function(t,e,i){t("./CCValueType"),t("./CCVec2"),t("./CCPointExtension"),t("./CCSize"),t("./CCRect"),t("./CCColor"),t("./CCTypes"),t("./CCAffineTransform"),t("./CCTypesWebGL")}),{"./CCAffineTransform":166,"./CCColor":167,"./CCPointExtension":168,"./CCRect":169,"./CCSize":170,"./CCTypes":171,"./CCTypesWebGL":172,"./CCValueType":173,"./CCVec2":174}],176:[(function(t,e,i){var n=cc.js;n.obsolete(cc.loader,"cc.loader.loadResAll","loadResDir")}),{}],177:[(function(t,e,i){t("./CCSGMotionStreak"),t("./CCSGMotionStreakWebGLRenderCmd");var n=cc.Class({name:"cc.MotionStreak",extends:cc.Component,editor:!1,ctor:function(){this._root=null,this._motionStreak=null},properties:{preview:{default:!1,editorOnly:!0,notify:!1,animatable:!1},_fadeTime:1,fadeTime:{get:function(){return this._fadeTime},set:function(t){this._fadeTime=t,this._motionStreak&&this._motionStreak.setFadeTime(t)},animatable:!1,tooltip:!1},_minSeg:1,minSeg:{get:function(){return this._minSeg},set:function(t){this._minSeg=t,this._motionStreak&&this._motionStreak.setMinSeg(t)},animatable:!1,tooltip:!1},_stroke:64,stroke:{get:function(){return this._stroke},set:function(t){this._stroke=t,this._motionStreak&&this._motionStreak.setStroke(t)},animatable:!1,tooltip:!1},_texture:{default:"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._motionStreak&&(t&&cc.js.isString(t)&&(t=cc.textureCache.addImage(t)),this._motionStreak.setTexture(t))},url:cc.Texture2D,animatable:!1,tooltip:!1},_color:cc.Color.WHITE,color:{get:function(){return this._color},set:function(t){this._color=t,this._motionStreak&&this._motionStreak.tintWithColor(t)},tooltip:!1},_fastMode:!1,fastMode:{get:function(){return this._fastMode},set:function(t){this._fastMode=t,this._motionStreak&&this._motionStreak.setFastMode(t)},animatable:!1,tooltip:!1}},onFocusInEditor:!1,onLostFocusInEditor:!1,reset:function(){this._motionStreak.reset()},__preload:function(){if(cc._renderType,cc.game.RENDER_TYPE_WEBGL,1){this._root=new _ccsg.Node;var t=new _ccsg.MotionStreak;t.initWithFade(this._fadeTime,this._minSeg,this._stroke,this.node.color,this._texture||null),t.setFastMode(this._fastMode),this._root.addChild(t);var e=this.node._sgNode;e&&e.addChild(this._root,-10),this._motionStreak=t}else cc.warnID(5900)},onEnable:function(){this.node.on("position-changed",this._onNodePositionChanged,this)},onDisable:function(){this.node.off("position-changed",this._onNodePositionChanged,this)},_onNodePositionChanged:function(){if(this._motionStreak){var t=this.node,e=t.getNodeToWorldTransform(),i=e.tx-(t.width/2+t.anchorX*t.width),n=e.ty-(t.height/2+t.anchorY*t.height);this._root.setPosition(-i,-n),this._motionStreak.setPosition(i,n)}}});cc.MotionStreak=e.exports=n}),{"./CCSGMotionStreak":218,"./CCSGMotionStreakWebGLRenderCmd":218}],178:[(function(t,e,i){var n=cc.Class({name:"cc.ParticleAsset",extends:cc.RawAsset});cc.ParticleAsset=e.exports=n}),{}],179:[(function(t,e,i){t("./CCParticleAsset"),t("./CCSGParticleSystem"),t("./CCSGParticleSystemCanvasRenderCmd"),t("./CCSGParticleSystemWebGLRenderCmd"),t("./CCParticleBatchNode"),t("./CCParticleBatchNodeCanvasRenderCmd"),t("./CCParticleBatchNodeWebGLRenderCmd");var n=cc.BlendFunc.BlendFactor,o=cc.Enum({GRAVITY:0,RADIUS:1}),r=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),s={preview:{default:!0,editorOnly:!0,notify:!1,animatable:!1,tooltip:!1},_custom:!1,custom:{get:function(){return this._custom},set:function(t){this._custom!==t&&(this._custom=t,t?this._applyCustoms():this._applyFile())},animatable:!1,tooltip:!1},_file:{default:"",url:cc.ParticleAsset},file:{get:function(){return this._file},set:function(t,e){this._file!==t&&(this._file=t,t?this._applyFile():this.custom=!0)},animatable:!1,url:cc.ParticleAsset,tooltip:!1},_texture:{default:"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._sgNode.texture=t?cc.textureCache.addImage(t):null,!t&&this._file&&this._applyFile()},url:cc.Texture2D,tooltip:!1},particleCount:{get:function(){return this._sgNode.particleCount},set:function(t){this._sgNode.particleCount=t},visible:!1,tooltip:!1},_srcBlendFactor:n.SRC_ALPHA,srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n,tooltip:!1},_dstBlendFactor:n.ONE_MINUS_SRC_ALPHA,dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n,tooltip:!1},playOnLoad:!0,_autoRemoveOnFinish:!1,autoRemoveOnFinish:{get:function(){return this._autoRemoveOnFinish},set:function(t){this._autoRemoveOnFinish!==t&&(this._autoRemoveOnFinish=t,this._applyAutoRemove())},animatable:!1,tooltip:!1},active:{get:function(){return!!this._sgNode&&this._sgNode.isActive()},visible:!1}},c=(function(){for(var t={totalParticles:150,duration:-1,emissionRate:10,life:1,lifeVar:0,startColor:cc.Color.WHITE,startColorVar:cc.Color.BLACK,endColor:cc.color(255,255,255,0),endColorVar:cc.color(0,0,0,0),angle:90,angleVar:20,startSize:50,startSizeVar:0,endSize:0,endSizeVar:0,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,sourcePos:cc.p(0,0),posVar:cc.p(0,0),positionType:r.FREE,emitterMode:o.GRAVITY,gravity:cc.p(0,0),speed:180,speedVar:50,tangentialAccel:80,tangentialAccelVar:0,radialAccel:0,radialAccelVar:0,rotationIsDir:!1,startRadius:0,startRadiusVar:0,endRadius:0,endRadiusVar:0,rotatePerS:0,rotatePerSVar:0},e=Object.keys(t),i=0;i<e.length;++i){var n=e[i];!(function(t,e){var i="_"+t;s[i]=e;var n=e.constructor,o=s[t]={};cc.isChildClassOf(n,cc.ValueType)?(o.get=function(){return new n(this[i])},o.type=n):o.get=function(){return this[i]},cc.isChildClassOf(n,cc.ValueType)?o.set=function(e){this[i]=new n(e),this._sgNode[t]=e}:o.set=function(e){this[i]=e,this._sgNode[t]=e}})(n,t[n])}return e})();s.positionType.type=r,s.emitterMode.type=o;var a=cc.Class({name:"cc.ParticleSystem",extends:cc._RendererUnderSG,editor:!1,ctor:function(){this._previewTimer=null,this._focused=!1,this._willStart=!1,this._blendFunc=new cc.BlendFunc(0,0),this._originOnExit=null},properties:s,statics:{DURATION_INFINITY:-1,START_SIZE_EQUAL_TO_END_SIZE:-1,START_RADIUS_EQUAL_TO_END_RADIUS:-1,EmitterMode:o,PositionType:r},__preload:function(){this._super(),this.playOnLoad&&this.resetSystem(),this._applyAutoRemove()},onDestroy:function(){this._autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1),this._super()},onFocusInEditor:!1,onLostFocusInEditor:!1,_createSgNode:function(){return new _ccsg.ParticleSystem},_initSgNode:function(){var t=this._sgNode;this._file?this._custom?!this._texture?this._applyFile():this._applyCustoms():this._applyFile():this._custom&&this._applyCustoms(),t.stopSystem()},addParticle:function(){return this._sgNode.addParticle()},stopSystem:function(){this._sgNode.stopSystem()},resetSystem:function(){this._sgNode.resetSystem()},isFull:function(){return this.particleCount>=this._totalParticles},setDisplayFrame:function(t){if(t){var e=t.getTexture();e&&(this._texture=e.url),this._sgNode.setDisplayFrame(t)}},setTextureWithRect:function(t,e){t instanceof cc.Texture2D&&(this._texture=t.url),this._sgNode.setTextureWithRect(t,e)},_applyFile:function(){var t=this._file;if(t){var e=this;cc.loader.load(t,(function(i,n){if(i||!n)throw i||new Error("Unkown error");if(e.isValid){var o=e._sgNode;o.particleCount=0;var r=o.isActive();o.initWithFile(t),n.textureUuid&&cc.AssetLibrary.queryAssetInfo(n.textureUuid,(function(t,i,n){t?cc.error(t):e.texture=i})),n.emissionRate&&(e.emissionRate=n.emissionRate),o.setPosition(0,0),r||o.stopSystem(),e._applyAutoRemove(),e._custom&&e._applyCustoms()}}))}},_applyCustoms:function(){for(var t=this._sgNode,e=t.isActive(),i=0;i<c.length;i++){var n=c[i];t[n]=this["_"+n]}this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc),this._texture&&(t.texture=cc.textureCache.addImage(this._texture)),e||t.stopSystem(),this._applyAutoRemove()},_applyAutoRemove:function(){var t=this._sgNode,e=this._autoRemoveOnFinish;if(t.autoRemoveOnFinish=e,e){if(this._originOnExit)return;this._originOnExit=t.onExit;var i=this;t.onExit=function(){i._originOnExit.call(this),i.node.destroy()}}else this._originOnExit&&(t.onExit=this._originOnExit,this._originOnExit=null)}});cc.ParticleSystem=e.exports=a}),{"./CCParticleAsset":178,"./CCParticleBatchNode":218,"./CCParticleBatchNodeCanvasRenderCmd":218,"./CCParticleBatchNodeWebGLRenderCmd":218,"./CCSGParticleSystem":218,"./CCSGParticleSystemCanvasRenderCmd":218,"./CCSGParticleSystemWebGLRenderCmd":218}],180:[(function(t,e,i){t("./CCSGTMXLayer"),t("./CCTMXLayerCanvasRenderCmd"),t("./CCTMXLayerWebGLRenderCmd");var n=cc.Class({name:"cc.TiledLayer",extends:cc._SGComponent,onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null)},_initSgNode:function(){var t=this._sgNode;if(t){this.enabledInHierarchy||t.setVisible(!1),this._registSizeProvider();var e=this.node;t.setAnchorPoint(e.getAnchorPoint())}},_replaceSgNode:function(t){t!==this._sgNode&&(this._removeSgNode(),this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),t&&t instanceof _ccsg.TMXLayer?(this._sgNode=t,t.retain(),this._initSgNode()):this._sgNode=null)},getLayerName:function(){return this._sgNode?this._sgNode.getLayerName():""},setLayerName:function(t){this._sgNode&&this._sgNode.setLayerName(t)},getProperty:function(t){return this._sgNode?this._sgNode.getProperty(t):null},getPositionAt:function(t,e){return this._sgNode?(void 0!==e&&(t=cc.p(t,e)),this._sgNode.getPositionAt(t)):null},removeTileAt:function(t,e){this._sgNode&&(void 0!==e&&(t=cc.p(t,e)),this._sgNode.removeTileAt(t))},setTileGID:function(t,e,i,n){if(this._sgNode){if(void 0===e)throw new Error("_ccsg.TMXLayer.setTileGID(): pos should be non-null");var o;void 0===n&&e instanceof cc.Vec2?(o=e,n=i):o=cc.p(e,i),this._sgNode.setTileGID(t,o,n)}},getTileGIDAt:function(t,e){return this._sgNode?(void 0!==e&&(t=cc.p(t,e)),this._sgNode.getTileGIDAt(t)):0},getTileAt:function(t,e){return this._sgNode?(void 0!==e&&(t=cc.p(t,e)),this._sgNode.getTileAt(t)):null},releaseMap:function(){this._sgNode&&this._sgNode.releaseMap()},setContentSize:function(t,e){this._sgNode&&(void 0!==e&&(t=cc.size(t,e)),this._sgNode.setContentSize(t))},getTexture:function(){return this._sgNode?this._sgNode.getTexture():null},setTexture:function(t){this._sgNode&&this._sgNode.setTexture(t)},setTileOpacity:function(t){this._sgNode&&this._sgNode.setTileOpacity(t)},getLayerSize:function(){return this._sgNode?this._sgNode.getLayerSize():cc.size(0,0)},setLayerSize:function(t){this._sgNode&&this._sgNode.setLayerSize(t)},getMapTileSize:function(){return this._sgNode?this._sgNode.getMapTileSize():cc.size(0,0)},setMapTileSize:function(t){this._sgNode&&this._sgNode.setMapTileSize(t)},getTiles:function(){return this._sgNode?this._sgNode.getTiles():null},setTiles:function(t){this._sgNode&&this._sgNode.setTiles(t)},getTileSet:function(){return this._sgNode?this._sgNode.getTileSet():null},setTileSet:function(t){this._sgNode&&this._sgNode.setTileSet(t)},getLayerOrientation:function(){return this._sgNode?this._sgNode.getLayerOrientation():0},setLayerOrientation:function(t){this._sgNode&&this._sgNode.setLayerOrientation(t)},getProperties:function(){return this._sgNode?this._sgNode.getProperties():null},setProperties:function(t){this._sgNode&&this._sgNode.setProperties(t)},_tryRemoveNode:function(){this.node.removeComponent(cc.TiledLayer),1===this.node._components.length&&0===this.node.getChildren().length&&this.node.removeFromParent()}});cc.TiledLayer=e.exports=n}),{"./CCSGTMXLayer":218,"./CCTMXLayerCanvasRenderCmd":218,"./CCTMXLayerWebGLRenderCmd":218}],181:[(function(t,e,i){t("./CCTiledMapAsset"),t("./CCTiledLayer"),t("./CCTiledObjectGroup"),t("./CCSGTMXTiledMap");var n=cc.Enum({ORTHO:0,HEX:1,ISO:2}),o=cc.Enum({NONE:0,MAP:1,LAYER:2,OBJECTGROUP:3,OBJECT:4,TILE:5}),r=cc.Enum({HORIZONTAL:2147483648,VERTICAL:1073741824,DIAGONAL:536870912,FLIPPED_ALL:3758096384,FLIPPED_MASK:536870911}),s=cc.Enum({STAGGERAXIS_X:0,STAGGERAXIS_Y:1}),c=cc.Enum({STAGGERINDEX_ODD:0,STAGGERINDEX_EVEN:1}),a=cc.Enum({RECT:0,ELLIPSE:1,POLYGON:2,POLYLINE:3,IMAGE:4}),h=cc.Class({name:"cc.TiledMap",extends:cc._RendererInSG,editor:!1,statics:{Orientation:n,Property:o,TileFlag:r,StaggerAxis:s,StaggerIndex:c,TMXObjectType:a},properties:{_detachedChildren:{default:[],serializable:!1},_tmxFile:{default:null,type:cc.TiledMapAsset},tmxAsset:{get:function(){return this._tmxFile},set:function(t,e){this._tmxFile!==t&&(this._tmxFile=t,this._applyFile())},type:cc.TiledMapAsset}},getMapSize:function(){return this._sgNode.getMapSize()},setMapSize:function(t){this._sgNode.setMapSize(t)},getTileSize:function(){return this._sgNode.getTileSize()},setTileSize:function(t){this._sgNode.setTileSize(t)},getMapOrientation:function(){return this._sgNode.getMapOrientation()},setMapOrientation:function(t){this._sgNode.setMapOrientation(t)},getObjectGroups:function(){for(var t=this.node.children,e=[],i=0,n=t.length;i<n;i++){var o=t[i].getComponent(cc.TiledObjectGroup);o&&e.push(o)}return e},getProperties:function(){return this._sgNode.getProperties()},setProperties:function(t){this._sgNode.setProperties(t)},initWithTMXFile:function(t){cc.errorID(7200)},initWithXML:function(t,e){cc.errorID(7201)},allLayers:function(){for(var t=this.node.children,e=[],i=0,n=t.length;i<n;i++){var o=t[i].getComponent(cc.TiledLayer);o&&e.push(o)}return e},getLayer:function(t){for(var e=this.node.children,i=0,n=e.length;i<n;i++){var o=e[i].getComponent(cc.TiledLayer);if(o&&o.getLayerName()===t)return o}return null},getObjectGroup:function(t){for(var e=this.node.children,i=0,n=e.length;i<n;i++){var o=e[i].getComponent(cc.TiledObjectGroup);if(o&&o.getGroupName()===t)return o}return null},getProperty:function(t){return this._sgNode.getProperty(t)},getPropertiesForGID:function(t){return this._sgNode.getPropertiesForGID(t)},onEnable:function(){0===this._detachedChildren.length&&this._moveLayersInSgNode(this._sgNode),this._super(),this._tmxFile&&this._refreshLayerEntities(),this.node.on("anchor-changed",this._anchorChanged,this),this.node.on("child-added",this._childAdded,this),this.node.on("child-reorder",this._syncChildrenOrder,this)},onDisable:function(){this._super(),this._setLayersEnabled(!1);var t=this._plainNode;this._moveLayersInSgNode(t),this.node.off("anchor-changed",this._anchorChanged,this),this.node.off("child-added",this._childAdded,this),this.node.off("child-reorder",this._syncChildrenOrder,this)},onDestroy:function(){this._super(),this._removeLayerEntities()},_createSgNode:function(){return new _ccsg.TMXTiledMap},_initSgNode:function(){this._applyFile()},_resetSgSize:function(){this.node.setContentSize(this._sgNode.getContentSize()),this._sgNode.setContentSize(0,0)},_onMapLoaded:function(){this._refreshLayerEntities(),this._enabled?this._anchorChanged():this._moveLayersInSgNode(this._sgNode),this._setLayersEnabled(this._enabled),this._resetSgSize()},_setLayersEnabled:function(t){for(var e=this.node.getChildren(),i=e.length-1;i>=0;i--){var n=e[i].getComponent(cc.TiledLayer);n&&(n.enabled=t)}},_moveLayersInSgNode:function(t){this._detachedChildren.length=0;for(var e=t.getChildren(),i=e.length-1;i>=0;i--){var n=e[i];if(n instanceof _ccsg.TMXLayer||n instanceof _ccsg.TMXObjectGroup){t.removeChild(n);var o=n.getLocalZOrder();this._detachedChildren.push({sgNode:n,zorder:o})}}},_removeLayerEntities:function(){for(var t=this.node.getChildren(),e=t.length-1;e>=0;e--){var i=t[e];if(i.isValid){var n=i.getComponent(cc.TiledLayer);n&&n._tryRemoveNode();var o=i.getComponent(cc.TiledObjectGroup);o&&o._tryRemoveNode()}}},_refreshLayerEntities:function(){var t,e,i=this.node.getChildren(),n=[],o=[],r=[];for(t=0;t<this._detachedChildren.length;t++){var s=this._detachedChildren[t];this._sgNode.addChild(s.sgNode,s.zorder,s.zorder)}this._detachedChildren.length=0;var c=this._sgNode.allLayers().map((function(t){return t.getLayerName()})),a=this._sgNode.getObjectGroups().map((function(t){return t.getGroupName()}));for(t=i.length-1;t>=0;t--){var h=i[t],l=h.getComponent(cc.TiledLayer),u=h.getComponent(cc.TiledObjectGroup);if(l){var d=l.getLayerName();if(d||(d=h._name),c.indexOf(d)<0)l._tryRemoveNode();else{n.push(h);var p=this._sgNode.getLayer(d);l._replaceSgNode(p),l.enabled=!0}}else if(u){var _=u.getGroupName();if(_||(_=h._name),a.indexOf(_)<0)u._tryRemoveNode();else{o.push(h);var f=this._sgNode.getObjectGroup(_);u._replaceSgNode(f),u.enabled=f.isVisible()}}else r.push({child:h,index:h.getSiblingIndex()})}var g=n.map((function(t){return t.getComponent(cc.TiledLayer).getLayerName()}));for(t=0,e=c.length;t<e;t++){var v=c[t],y=this._sgNode.getLayer(v),m=g.indexOf(v);if(m<0){var b=this.node.getChildByName(v),C=null;b&&!b.getComponent(cc._SGComponent)?C=b.addComponent(cc.TiledLayer):(b=new cc.Node(v),this.node.addChild(b),C=b.addComponent(cc.TiledLayer)),b&&C||cc.errorID(7202),C._replaceSgNode(y),b.setSiblingIndex(y.getLocalZOrder()),b.setAnchorPoint(this.node.getAnchorPoint())}}var T=o.map((function(t){return t.getComponent(cc.TiledObjectGroup).getGroupName()}));for(t=0,e=a.length;t<e;t++){v=a[t];var S=this._sgNode.getObjectGroup(v);if((m=T.indexOf(v))<0){var E=null;(b=this.node.getChildByName(v))&&!b.getComponent(cc._SGComponent)?E=b.addComponent(cc.TiledObjectGroup):(b=new cc.Node(v),this.node.addChild(b),E=b.addComponent(cc.TiledObjectGroup)),b&&E||cc.errorID(7202),E._replaceSgNode(S),b.setSiblingIndex(S.getLocalZOrder()),b.setAnchorPoint(this.node.getAnchorPoint()),E.enabled=S.isVisible()}}var x=this.node.getChildren(),A=[];for(t=0,e=x.length;t<e;t++)l=(h=x[t]).getComponent(cc.TiledLayer),u=h.getComponent(cc.TiledObjectGroup),(l||u)&&A.push(h._name);var w=[],O=[],I=this._sgNode.getChildren();for(t=0,e=I.length;t<e;t++)(h=I[t])instanceof _ccsg.TMXLayer?(w.push(h.getLayerName()),O.push(h)):h instanceof _ccsg.TMXObjectGroup&&(w.push(h.getGroupName()),O.push(h));for(t=w.length-1;t>=0;t--){var N=w[t];t!==A.indexOf(N)&&this.node.getChildByName(N).setSiblingIndex(O[t].getLocalZOrder())}for(t=0,e=r.length;t<e;t++)(s=r[t]).child.setSiblingIndex(s.index);this._syncChildrenOrder()},_anchorChanged:function(){for(var t=this.node.children,e=this.node.getAnchorPoint(),i=0,n=t.length;i<n;i++){var o=t[i];o.getComponent(cc.TiledLayer)&&o.setAnchorPoint(e)}},_childAdded:function(t){var e=t.detail;if(e){var i=e.getComponent(cc.TiledLayer),n=e.getComponent(cc.TiledObjectGroup);if(!i&&!n){var o=this.node.getChildrenCount();e.setSiblingIndex(o),e._sgNode&&e._sgNode.setLocalZOrder(o)}}},_syncChildrenOrder:function(){for(var t=this.node.children,e=0,i=t.length;e<i;e++){var n=t[e],o=n.getComponent(cc.TiledLayer),r=n.getComponent(cc.TiledObjectGroup),s=n.getSiblingIndex();o&&o._sgNode&&o._sgNode.setLocalZOrder(s),r&&r._sgNode&&r._sgNode.setLocalZOrder(s),n._sgNode&&n._sgNode.setLocalZOrder(s)}},_applyFile:function(){var t=this._sgNode,e=this._tmxFile,i=this;if(e){var n=cc.url._rawAssets+e.tmxFolderPath;n=cc.path.stripSep(n),t.initWithXML(e.tmxXmlStr,n)&&(i._detachedChildren.length=0,i._onMapLoaded())}else{for(var o=t.allLayers(),r=0,s=o.length;r<s;r++)t.removeChild(o[r]);var c=t.getObjectGroups();for(r=0,s=c.length;r<s;r++)t.removeChild(c[r]);this._detachedChildren.length=0,i._removeLayerEntities()}}});cc.TiledMap=e.exports=h,cc.js.obsolete(cc.TiledMap.prototype,"cc.TiledMap.tmxFile","tmxAsset",!0),cc.js.get(cc.TiledMap.prototype,"mapLoaded",(function(){return cc.errorID(7203),[]}),!1)}),{"./CCSGTMXTiledMap":218,"./CCTiledLayer":180,"./CCTiledMapAsset":182,"./CCTiledObjectGroup":183}],182:[(function(t,e,i){var n=cc.Class({name:"cc.TiledMapAsset",extends:cc.Asset,properties:{tmxXmlStr:{default:""},tmxFolderPath:{default:""},textures:{default:[],url:[cc.Texture2D]},tsxFiles:{default:[],url:[cc.RawAsset]}},statics:{preventDeferredLoadDependents:!0},createNode:!1});cc.TiledMapAsset=n,e.exports=n}),{}],183:[(function(t,e,i){t("./CCSGTMXObjectGroup");var n=cc.Class({name:"cc.TiledObjectGroup",extends:cc._SGComponent,onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null)},_initSgNode:function(){var t=this._sgNode;t&&(this._registSizeProvider(),t.setAnchorPoint(this.node.getAnchorPoint()))},_replaceSgNode:function(t){t!==this._sgNode&&(this._removeSgNode(),this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),t&&t instanceof _ccsg.TMXObjectGroup?(this._sgNode=t,t.retain(),this._initSgNode()):this._sgNode=null)},getPositionOffset:function(){return this._sgNode?this._sgNode.getPositionOffset():cc.p(0,0)},setPositionOffset:function(t){this._sgNode&&this._sgNode.setPositionOffset(t)},getProperties:function(){return this._sgNode?this._sgNode.getProperties():null},setProperties:function(t){this._sgNode&&this._sgNode.setProperties(t)},getGroupName:function(){return this._sgNode?this._sgNode.getGroupName():""},setGroupName:function(t){this._sgNode&&this._sgNode.setGroupName(t)},getProperty:function(t){return this._sgNode?this._sgNode.propertyNamed(t):null},getObject:function(t){return this._sgNode?this._sgNode.getObject(t):null},getObjects:function(){return this._sgNode?this._sgNode.getObjects():[]},_tryRemoveNode:function(){this.node.removeComponent(cc.TiledObjectGroup),1===this.node._components.length&&0===this.node.getChildren().length&&this.node.removeFromParent()}});cc.TiledObjectGroup=e.exports=n}),{"./CCSGTMXObjectGroup":218}],184:[(function(t,e,i){t("./cocos2d/core"),t("./cocos2d/animation"),t("./cocos2d/particle/CCParticleSystem"),t("./cocos2d/tilemap/CCTiledMap"),t("./cocos2d/motion-streak/CCMotionStreak"),t("./cocos2d/core/components/CCStudioComponent"),t("./extensions/ccpool/CCNodePool"),t("./extensions/ccpool/CCPool"),t("./extensions/spine"),t("./extensions/dragonbones"),t("./cocos2d/deprecated")}),{"./cocos2d/actions":9,"./cocos2d/animation":18,"./cocos2d/core":95,"./cocos2d/core/components/CCStudioComponent":72,"./cocos2d/deprecated":176,"./cocos2d/motion-streak/CCMotionStreak":177,"./cocos2d/particle/CCParticleAsset":178,"./cocos2d/particle/CCParticleSystem":179,"./cocos2d/tilemap/CCTiledMap":181,"./cocos2d/tilemap/CCTiledMapAsset":182,"./extensions/ccpool/CCNodePool":185,"./extensions/ccpool/CCPool":186,"./extensions/dragonbones":190,"./extensions/spine":194,"./external/chipmunk/chipmunk":195}],185:[(function(t,e,i){cc.NodePool=function(t){this.poolHandlerComp=t,this._pool=[]},cc.NodePool.prototype={constructor:cc.NodePool,size:function(){return this._pool.length},clear:function(){for(var t=this._pool.length,e=0;e<t;++e)this._pool[e].destroy();this._pool.length=0},put:function(t){if(t&&-1===this._pool.indexOf(t)){t.removeFromParent(!1);var e=this.poolHandlerComp?t.getComponent(this.poolHandlerComp):null;e&&e.unuse&&e.unuse(),this._pool.push(t)}},get:function(){var t=this._pool.length-1;if(t<0)return null;var e=this._pool[t];this._pool.length=t;var i=this.poolHandlerComp?e.getComponent(this.poolHandlerComp):null;return i&&i.reuse&&i.reuse.apply(i,arguments),e}},e.exports=cc.NodePool}),{}],186:[(function(t,e,i){var n=[];cc.pool={_pool:{},_releaseCB:function(){this.release()},_autoRelease:function(t){var e=void 0!==t._running&&!t._running;cc.director.getScheduler().schedule(this._releaseCB,t,0,0,0,e)},putInPool:function(t){var e=cc.js._getClassId(t.constructor);e&&(this._pool[e]||(this._pool[e]=[]),t.retain&&t.retain(),t.unuse&&t.unuse(),this._pool[e].push(t))},hasObject:function(t){var e=cc.js._getClassId(t),i=this._pool[e];return!(!i||0===i.length)},removeObject:function(t){var e=cc.js._getClassId(t.constructor);if(e){var i=this._pool[e];if(i)for(var n=0;n<i.length;n++)t===i[n]&&(t.release&&t.release(),i.splice(n,1))}},getFromPool:function(t){if(this.hasObject(t)){var e=cc.js._getClassId(t),i=this._pool[e];n.length=arguments.length-1;for(var o=0;o<n.length;o++)n[o]=arguments[o+1];var r=i.pop();return r.reuse&&r.reuse.apply(r,n),r.release&&this._autoRelease(r),n.length=0,r}},drainAllPools:function(){for(var t in this._pool)for(var e=0;e<this._pool[t].length;e++){var i=this._pool[t][e];i.release&&i.release()}this._pool={}}}}),{}],187:[(function(t,e,i){var n=cc.Enum({default:-1}),o=cc.Enum({"<None>":0});dragonBones.ArmatureDisplay=cc.Class({name:"dragonBones.ArmatureDisplay",extends:cc._RendererUnderSG,editor:!1,properties:{_factory:{default:null,type:dragonBones.CCFactory,serializable:!1},_dragonBonesData:{default:null,type:dragonBones.DragonBonesData,serializable:!1},dragonAsset:{default:null,type:dragonBones.DragonBonesAsset,notify:function(){this._parseDragonAsset(),this._refresh()},tooltip:!1},dragonAtlasAsset:{default:null,type:dragonBones.DragonBonesAtlasAsset,notify:function(){this._parseDragonAtlasAsset(),this._refreshSgNode()},tooltip:!1},_armatureName:"",armatureName:{get:function(){return this._armatureName},set:function(t){this._armatureName=t;var e=this.getAnimationNames(this._armatureName);(!this.animationName||e.indexOf(this.animationName)<0)&&(this.animationName=""),this._refresh()},visible:!1},_animationName:"",animationName:{get:function(){return this._animationName},set:function(t){this._animationName=t},visible:!1},_defaultArmatureIndex:{default:0,notify:function(){var t="";if(this.dragonAsset){var e;if(this.dragonAsset&&(e=this.dragonAsset.getArmatureEnum()),!e)return cc.errorID(7400,this.name);t=e[this._defaultArmatureIndex]}void 0!==t?this.armatureName=t:cc.errorID(7401,this.name)},type:n,visible:!0,editorOnly:!0,displayName:"Armature",tooltip:!1},_animationIndex:{default:0,notify:function(){if(0!==this._animationIndex){var t;if(this.dragonAsset&&(t=this.dragonAsset.getAnimsEnum(this.armatureName)),t){var e=t[this._animationIndex];void 0!==e?this.animationName=e:cc.errorID(7402,this.name)}}else this.animationName=""},type:o,visible:!0,editorOnly:!0,displayName:"Animation",tooltip:!1},timeScale:{default:1,notify:function(){this._sgNode&&(this._sgNode.animation().timeScale=this.timeScale)},tooltip:!1},playTimes:{default:-1,tooltip:!1},debugBones:{default:!1,notify:function(){this._sgNode&&this._sgNode.setDebugBones(this.debugBones)},editorOnly:!0,tooltip:!1}},ctor:function(){this._factory=new dragonBones.CCFactory},__preload:function(){this._parseDragonAsset(),this._parseDragonAtlasAsset(),this._refresh()},_createSgNode:function(){return this.dragonAsset&&this.dragonAtlasAsset&&this.armatureName?this._factory.buildArmatureDisplay(this.armatureName,this._dragonBonesData.name):null},_initSgNode:function(){var t=this._sgNode;t.animation().timeScale=this.timeScale,this.animationName&&this.playAnimation(this.animationName,this.playTimes)},_parseDragonAsset:function(){if(this.dragonAsset){var t=JSON.parse(this.dragonAsset.dragonBonesJson),e=this._factory.getDragonBonesData(t.name);if(e)return void(this._dragonBonesData=e);this._dragonBonesData=this._factory.parseDragonBonesData(this.dragonAsset.dragonBonesJson)}},_parseDragonAtlasAsset:function(){if(this.dragonAtlasAsset){this._factory.parseTextureAtlasData(this.dragonAtlasAsset.atlasJson,this.dragonAtlasAsset.texture)}},_refreshSgNode:function(){var t=this,e=null;t._sgNode&&(e=t._sgNode._bubblingListeners,t.node._sizeProvider===t._sgNode&&(t.node._sizeProvider=null),t._removeSgNode(),t._sgNode=null);var i=t._sgNode=t._createSgNode();i&&(i.retain(),t.enabledInHierarchy||i.setVisible(!1),e&&(i._bubblingListeners=e,i.hasEventCallback()||i.setEventCallback((function(t){i.emit(t.type,t)}))),t._initSgNode(),t._appendSgNode(i),t._registSizeProvider())},_refresh:function(){this._refreshSgNode()},_updateAnimEnum:!1,_updateArmatureEnum:!1,playAnimation:function(t,e){return this._sgNode?(this.playTimes=void 0===e?-1:e,this.animationName=t,this._sgNode.animation().play(t,this.playTimes)):null},getArmatureNames:function(){return this._dragonBonesData?this._dragonBonesData.armatureNames:[]},getAnimationNames:function(t){var e=[];if(this._dragonBonesData){var i=this._dragonBonesData.getArmature(t);if(i)for(var n in i.animations)i.animations.hasOwnProperty(n)&&e.push(n)}return e},addEventListener:function(t,e,i){this._sgNode&&this._sgNode.addEvent(t,e,i)},removeEventListener:function(t,e,i){this._sgNode&&this._sgNode.removeEvent(t,e,i)},buildArmature:function(t){return this._factory?this._factory.buildArmature(t):null},armature:function(){return this._sgNode?this._sgNode.armature():null}})}),{}],188:[(function(t,e,i){var n=cc.Class({name:"dragonBones.DragonBonesAsset",extends:cc.Asset,properties:{_dragonBonesJson:"",dragonBonesJson:{get:function(){return this._dragonBonesJson},set:function(t){this._dragonBonesJson=t,this.reset()}}},statics:{preventDeferredLoadDependents:!0},createNode:!1,reset:function(){},getRuntimeData:!1,getArmatureEnum:!1,getAnimsEnum:!1});dragonBones.DragonBonesAsset=e.exports=n}),{}],189:[(function(t,e,i){var n=cc.Class({name:"dragonBones.DragonBonesAtlasAsset",extends:cc.Asset,properties:{_atlasJson:"",atlasJson:{get:function(){return this._atlasJson},set:function(t){this._atlasJson=t}},texture:{default:"",url:cc.Texture2D}},statics:{preventDeferredLoadDependents:!0},createNode:!1});dragonBones.DragonBonesAtlasAsset=e.exports=n}),{}],190:[(function(t,e,i){dragonBones=dragonBones,dragonBones.DisplayType={Image:0,Armature:1,Mesh:2},dragonBones.ArmatureType={Armature:0,MovieClip:1,Stage:2},dragonBones.ExtensionType={FFD:0,AdjustColor:10,BevelFilter:11,BlurFilter:12,DropShadowFilter:13,GlowFilter:14,GradientBevelFilter:15,GradientGlowFilter:16},dragonBones.EventType={Frame:0,Sound:1},dragonBones.ActionType={Play:0,Stop:1,GotoAndPlay:2,GotoAndStop:3,FadeIn:4,FadeOut:5},dragonBones.AnimationFadeOutMode={None:0,SameLayer:1,SameGroup:2,SameLayerAndGroup:3,All:4},t("./DragonBonesAsset"),t("./DragonBonesAtlasAsset"),t("./ArmatureDisplay")}),{"./ArmatureDisplay":187,"./CCArmatureDisplay":218,"./CCFactory":218,"./CCSlot":218,"./CCTextureData":218,"./DragonBonesAsset":188,"./DragonBonesAtlasAsset":189,"./lib/dragonBones":218}],191:[(function(t,e,i){sp.SkeletonTexture=cc.Class({name:"sp.SkeletonTexture",extends:sp.spine.Texture,_texture:null,setRealTexture:function(t){this._texture=t},getRealTexture:function(){return this._texture},setFilters:function(t,e){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){var i=cc._renderContext;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e)}},setWraps:function(t,e){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){var i=cc._renderContext;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e)}},dispose:function(){},bind:function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.gl.bindTexture2D(this._texture)}})}),{}],192:[(function(i,n,o){var r=cc.Enum({default:-1}),s=cc.Enum({"<None>":0});sp.Skeleton=cc.Class({name:"sp.Skeleton",extends:cc._RendererUnderSG,editor:!1,properties:{_startListener:{default:null,serializable:!1},_endListener:{default:null,serializable:!1},_completeListener:{default:null,serializable:!1},_eventListener:{default:null,serializable:!1},_disposeListener:{default:null,serializable:!1},_interruptListener:{default:null,serializable:!1},_paused:!1,paused:{get:function(){return this._paused},set:function(t){this._paused=t,this._sgNode&&(t?this._sgNode.pause():this._sgNode.resume())},visible:!1},skeletonData:{default:null,type:sp.SkeletonData,notify:function(){this.defaultSkin="",this.defaultAnimation="",this._refresh()},tooltip:!1},defaultSkin:{default:"",visible:!1},defaultAnimation:{default:"",visible:!1},animation:{get:function(){var t=this.getCurrent(0);return t&&t.animation.name||""},set:function(t){this.defaultAnimation=t,t?this.setAnimation(0,t,this.loop):(this.clearTrack(0),this.setToSetupPose())},visible:!1},_defaultSkinIndex:{get:function(){if(this.skeletonData&&this.defaultSkin){var t=this.skeletonData.getSkinsEnum();if(t){var e=t[this.defaultSkin];if(void 0!==e)return e}}return 0},set:function(t){var e;if(this.skeletonData&&(e=this.skeletonData.getSkinsEnum()),!e)return cc.errorID("",this.name);var i=e[t];void 0!==i?this.defaultSkin=i:cc.errorID(7501,this.name)},type:r,visible:!0,displayName:"Default Skin",tooltip:!1},_animationIndex:{get:function(){var t=this.animation;if(this.skeletonData&&t){var e=this.skeletonData.getAnimsEnum();if(e){var i=e[t];if(void 0!==i)return i}}return 0},set:function(t){if(0!==t){var e;if(this.skeletonData&&(e=this.skeletonData.getAnimsEnum()),!e)return cc.errorID(7502,this.name);var i=e[t];void 0!==i?this.animation=i:cc.errorID(7503,this.name)}else this.animation=""},type:s,visible:!0,displayName:"Animation",tooltip:!1},loop:{default:!0,tooltip:!1},_premultipliedAlpha:!0,premultipliedAlpha:{get:function(){return this._premultipliedAlpha},set:function(t){this._premultipliedAlpha=t,this._sgNode&&this._sgNode.setPremultipliedAlpha(t)},tooltip:!1},timeScale:{default:1,notify:function(){this._sgNode&&this._sgNode.setTimeScale(this.timeScale)},tooltip:!1},debugSlots:{default:!1,notify:function(){this._sgNode&&this._sgNode.setDebugSlotsEnabled(this.debugSlots)},editorOnly:!0,tooltip:!1},debugBones:{default:!1,notify:function(){this._sgNode&&this._sgNode.setDebugBonesEnabled(this.debugBones)},editorOnly:!0,tooltip:!1}},__preload:function(){this.node.setContentSize(0,0),this._refresh()},_createSgNode:function(){if(this.skeletonData){if(!this.skeletonData._uuid)return cc.errorID(7504),null;var i=this.skeletonData.rawUrl,n=this.skeletonData.atlasUrl;if(n){if("string"!==("object"==(e=typeof n)?t(n):e))return cc.errorID(7505),null;try{return new sp._SGSkeletonAnimation(i,n,this.skeletonData.scale)}catch(t){cc._throw(t)}}}return null},_initSgNode:function(){var t=this._sgNode;t.setTimeScale(this.timeScale);var e=this;if(t.onEnter=function(){_ccsg.Node.prototype.onEnter.call(this),e._paused&&this.pause()},this._startListener&&this.setStartListener(this._startListener),this._endListener&&this.setEndListener(this._endListener),this._completeListener&&this.setCompleteListener(this._completeListener),this._eventListener&&this.setEventListener(this._eventListener),this._interruptListener&&this.setInterruptListener(this._interruptListener),this._disposeListener&&this.setDisposeListener(this._disposeListener),this.defaultSkin)try{t.setSkin(this.defaultSkin)}catch(t){cc._throw(t)}t.setPremultipliedAlpha(this._premultipliedAlpha),this.animation=this.defaultAnimation},_getLocalBounds:!1,updateWorldTransform:function(){this._sgNode&&this._sgNode.updateWorldTransform()},setToSetupPose:function(){this._sgNode&&this._sgNode.setToSetupPose()},setBonesToSetupPose:function(){this._sgNode&&this._sgNode.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._sgNode&&this._sgNode.setSlotsToSetupPose()},findBone:function(t){return this._sgNode?this._sgNode.findBone(t):null},findSlot:function(t){return this._sgNode?this._sgNode.findSlot(t):null},setSkin:function(t){return this._sgNode?this._sgNode.setSkin(t):null},getAttachment:function(t,e){return this._sgNode?this._sgNode.getAttachment(t,e):null},setAttachment:function(t,e){this._sgNode&&this._sgNode.setAttachment(t,e)},setSkeletonData:function(t,e){this._sgNode&&this._sgNode.setSkeletonData(t,e)},setAnimationStateData:function(t){if(this._sgNode)return this._sgNode.setAnimationStateData(t)},setMix:function(t,e,i){this._sgNode&&this._sgNode.setMix(t,e,i)},setAnimationListener:function(t,e){this._sgNode&&this._sgNode.setAnimationListener(t,e)},setAnimation:function(t,e,i){return this._sgNode?this._sgNode.setAnimation(t,e,i):null},_sample:function(){this._sgNode&&this._sgNode.update(0)},addAnimation:function(t,e,i,n){return this._sgNode?this._sgNode.addAnimation(t,e,i,n||0):null},findAnimation:function(t){return this._sgNode?this._sgNode.findAnimation(t):null},getCurrent:function(t){return this._sgNode?this._sgNode.getCurrent(t):null},clearTracks:function(){this._sgNode&&this._sgNode.clearTracks()},clearTrack:function(t){this._sgNode&&this._sgNode.clearTrack(t)},_updateAnimEnum:!1,_updateSkinEnum:!1,setStartListener:function(t){this._startListener=t,this._sgNode&&this._sgNode.setStartListener(t)},setInterruptListener:function(t){this._interruptListener=t,this._sgNode&&this._sgNode.setInterruptListener(t)},setEndListener:function(t){this._endListener=t,this._sgNode&&this._sgNode.setEndListener(t)},setDisposeListener:function(t){this._disposeListener=t,this._sgNode&&this._sgNode.setDisposeListener(t)},setCompleteListener:function(t){this._completeListener=t,this._sgNode&&this._sgNode.setCompleteListener(t)},setEventListener:function(t){this._eventListener=t,this._sgNode&&this._sgNode.setEventListener(t)},setTrackStartListener:function(t,e){this._sgNode&&this._sgNode.setTrackStartListener(t,e)},setTrackInterruptListener:function(t,e){this._sgNode&&this._sgNode.setTrackInterruptListener(t,e)},setTrackEndListener:function(t,e){this._sgNode&&this._sgNode.setTrackEndListener(t,e)},setTrackDisposeListener:function(t,e){this._sgNode&&this._sgNode.setTrackDisposeListener(t,e)},setTrackCompleteListener:function(t,e){this._sgNode&&this._sgNode.setTrackCompleteListener(t,e)},setTrackEventListener:function(t,e){this._sgNode&&this._sgNode.setTrackEventListener(t,e)},getState:function(){if(this._sgNode)return this._sgNode.getState()},_refresh:function(){var t=this;t._sgNode&&(t.node._sizeProvider===t._sgNode&&(t.node._sizeProvider=null),t._removeSgNode(),t._sgNode=null);var e=t._sgNode=t._createSgNode();e&&(e.retain(),t.enabledInHierarchy||e.setVisible(!1),e.setContentSize(0,0),t._initSgNode(),t._appendSgNode(e),t._registSizeProvider())}})}),{}],193:[(function(t,e,i){var n=cc.Class({name:"sp.SkeletonData",extends:cc.Asset,ctor:function(){this.reset()},properties:{_skeletonJson:null,skeletonJson:{get:function(){return this._skeletonJson},set:function(t){this._skeletonJson=t,this.reset()}},_atlasText:"",atlasText:{get:function(){return this._atlasText},set:function(t){this._atlasText=t,this.reset()}},atlasUrl:{default:"",url:cc.RawAsset},textures:{default:[],url:[cc.Texture2D]},scale:1},statics:{preventDeferredLoadDependents:!0},createNode:!1,reset:function(){this._skeletonCache=null,this._atlasCache=null},getRuntimeData:!1,getSkinsEnum:!1,getAnimsEnum:!1,_getAtlas:!1});sp.SkeletonData=e.exports=n}),{}],194:[(function(t,e,i){sp=sp,sp.VERTEX_INDEX={X1:0,Y1:1,X2:2,Y2:3,X3:4,Y3:5,X4:6,Y4:7},sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3},sp.AnimationEventType=cc.Enum({START:0,INTERRUPT:1,END:2,DISPOSE:3,COMPLETE:4,EVENT:5}),t("./SkeletonData"),t("./Skeleton")}),{"./SGSkeleton":218,"./SGSkeletonAnimation":218,"./SGSkeletonCanvasRenderCmd":218,"./SGSkeletonTexture":191,"./SGSkeletonWebGLRenderCmd":218,"./Skeleton":192,"./SkeletonData":193,"./lib/spine":218}],195:[(function(i,n,o){Object.create=Object.create||function(t){function e(){}return e.prototype=t,new e};var r,s,c=function(t,e){if(!t)throw new Error("Assertion failed: "+e)},a=function(t,e){!t&&console&&console.warn&&(console.warn("ASSERTION FAILED: "+e),console.trace&&console.trace())};"object"===("object"==(e=typeof window)?t(window):e)&&window.navigator.userAgent.indexOf("Firefox")>-1?(r=Math.min,s=Math.max):(r=function(t,e){return t<e?t:e},s=function(t,e){return t>e?t:e});var h=function(t,e){return t<e?t+" "+e:e+" "+t},l=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return t[i]=t[t.length-1],void t.length--},u=function(t,e,i){var n=A(e,i),o=y(C(n,A(t,i))/D(n));return x(i,O(n,o))},d=function(t,e,i,n,o,r){var s=i-o,c=n-r,a=y(T(s,c,t-o,e-r)/M(s,c));return new m(o+s*a,r+c*a)};cp.momentForCircle=function(t,e,i,n){return t*(.5*(e*e+i*i)+D(n))},cp.areaForCircle=function(t,e){return Math.PI*Math.abs(t*t-e*e)},cp.momentForSegment=function(t,e,i){var n=O(x(e,i),.5);return t*(V(i,e)/12+D(n))},cp.areaForSegment=function(t,e,i){return i*(Math.PI*i+2*W(t,e))},cp.momentForPoly=function(t,e,i){for(var n=0,o=0,r=e.length,s=0;s<r;s+=2){var c=e[s]+i.x,a=e[s+1]+i.y,h=e[(s+2)%r]+i.x,l=e[(s+3)%r]+i.y,u=N(h,l,c,a);n+=u*(T(c,a,c,a)+T(c,a,h,l)+T(h,l,h,l)),o+=u}return t*n/(6*o)},cp.areaForPoly=function(t){for(var e=0,i=0,n=t.length;i<n;i+=2)e+=I(new m(t[i],t[i+1]),new m(t[(i+2)%n],t[(i+3)%n]));return-e/2},cp.centroidForPoly=function(t){for(var e=0,i=new m(0,0),n=0,o=t.length;n<o;n+=2){var r=new m(t[n],t[n+1]),s=new m(t[(n+2)%o],t[(n+3)%o]),c=I(r,s);e+=c,i=x(i,O(x(r,s),c))}return O(i,1/(3*e))},cp.recenterPoly=function(t){for(var e=cp.centroidForPoly(t),i=0;i<t.length;i+=2)t[i]-=e.x,t[i+1]-=e.y},cp.momentForBox=function(t,e,i){return t*(e*e+i*i)/12},cp.momentForBox2=function(t,e){var i=e.r-e.l,n=e.t-e.b,o=O([e.l+e.r,e.b+e.t],.5);return cp.momentForBox(t,i,n)+t*D(o)};var p=cp.loopIndexes=function(t){var e,i,n,o,r=0,s=0;e=n=t[0],i=o=t[1];for(var c=t.length>>1,a=1;a<c;a++){var h=t[2*a],l=t[2*a+1];h<e||h==e&&l<i?(e=h,i=l,r=a):(h>n||h==n&&l>o)&&(n=h,o=l,s=a)}return[r,s]},_=function(t,e,i){var n=t[2*e];t[2*e]=t[2*i],t[2*i]=n,n=t[2*e+1],t[2*e+1]=t[2*i+1],t[2*i+1]=n},f=function(t,e,i,n,o,r){if(0===i)return 0;for(var s=0,c=e,a=A(o,n),h=r*S(a),l=e,u=e+i-1;l<=u;){var d=new m(t[2*l],t[2*l+1]),p=I(a,A(d,n));p>h?(p>s&&(s=p,c=l),l++):(_(t,l,u),u--)}return c!=e&&_(t,e,c),l-e},g=function(t,e,i,n,o,r,s,c){if(n<0)return 0;if(0==n)return e[2*c]=r.x,e[2*c+1]=r.y,1;var a=f(e,i,n,o,r,t),h=new m(e[2*i],e[2*i+1]),l=g(t,e,i+1,a-1,o,h,r,c),u=c+l++;e[2*u]=r.x,e[2*u+1]=r.y;var d=f(e,i+a,n-a,r,s,t),p=new m(e[2*(i+a)],e[2*(i+a)+1]);return l+g(t,e,i+a+1,d-1,r,p,s,c+l)};cp.convexHull=function(t,e,i){if(e)for(var n=0;n<t.length;n++)e[n]=t[n];else e=t;var o=p(t),r=o[0],s=o[1];if(r==s)return e.length=2,e;_(e,0,r),_(e,1,0==s?r:s);var c=new m(e[0],e[1]),h=new m(e[2],e[3]),l=t.length>>1,u=g(i,e,2,l-2,c,h,c,1)+1;return e.length=2*u,a(it(e),"Internal error: cpConvexHull() and cpPolyValidate() did not agree.Please report this error with as much info as you can."),e};var v=function(t,e,i){return r(s(t,e),i)},y=function(t){return s(0,r(t,1))},m=cp.Vect=function(t,e){this.x=t,this.y=e};cp.v=function(t,e){return new m(t,e)};var b=cp.vzero=new m(0,0),C=cp.v.dot=function(t,e){return t.x*e.x+t.y*e.y},T=function(t,e,i,n){return t*i+e*n},S=cp.v.len=function(t){return Math.sqrt(C(t,t))},E=cp.v.len2=function(t,e){return Math.sqrt(t*t+e*e)},x=(cp.v.eql=function(t,e){return t.x===e.x&&t.y===e.y},cp.v.add=function(t,e){return new m(t.x+e.x,t.y+e.y)});m.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this};var A=cp.v.sub=function(t,e){return new m(t.x-e.x,t.y-e.y)};m.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this};var w=cp.v.neg=function(t){return new m(-t.x,-t.y)};m.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this};var O=cp.v.mult=function(t,e){return new m(t.x*e,t.y*e)};m.prototype.mult=function(t){return this.x*=t,this.y*=t,this};var I=cp.v.cross=function(t,e){return t.x*e.y-t.y*e.x},N=function(t,e,i,n){return t*n-e*i},L=cp.v.perp=function(t){return new m(-t.y,t.x)},R=(cp.v.pvrperp=function(t){return new m(t.y,-t.x)},cp.v.project=function(t,e){return O(e,C(t,e)/D(e))});m.prototype.project=function(t){return this.mult(C(this,t)/D(t)),this};var P=cp.v.rotate=function(t,e){return new m(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)};m.prototype.rotate=function(t){return this.x=this.x*t.x-this.y*t.y,this.y=this.x*t.y+this.y*t.x,this};var B=cp.v.unrotate=function(t,e){return new m(t.x*e.x+t.y*e.y,t.y*e.x-t.x*e.y)},D=cp.v.lengthsq=function(t){return C(t,t)},M=cp.v.lengthsq2=function(t,e){return t*t+e*e},F=cp.v.lerp=function(t,e,i){return x(O(t,1-i),O(e,i))},j=cp.v.normalize=function(t){return O(t,1/S(t))},k=cp.v.normalize_safe=function(t){return 0===t.x&&0===t.y?b:j(t)},z=cp.v.clamp=function(t,e){return C(t,t)>e*e?O(j(t),e):t},W=(cp.v.lerpconst=function(t,e,i){return x(t,z(A(e,t),i))},cp.v.dist=function(t,e){return S(A(t,e))}),V=cp.v.distsq=function(t,e){return D(A(t,e))},G=(cp.v.near=function(t,e,i){return V(t,e)<i*i},cp.v.slerp=function(t,e,i){var n=Math.acos(C(t,e));if(n){var o=1/Math.sin(n);return x(O(t,Math.sin((1-i)*n)*o),O(e,Math.sin(i*n)*o))}return t}),H=(cp.v.slerpconst=function(t,e,i){var n=Math.acos(C(t,e));return G(t,e,r(i,n)/n)},cp.v.forangle=function(t){return new m(Math.cos(t),Math.sin(t))},cp.v.toangle=function(t){return Math.atan2(t.y,t.x)},cp.v.str=function(t){return"("+t.x.toFixed(3)+", "+t.y.toFixed(3)+")"},0),U=cp.BB=function(t,e,i,n){this.l=t,this.b=e,this.r=i,this.t=n,H++};cp.bb=function(t,e,i,n){return new U(t,e,i,n)};var Y=function(t,e){return new U(t.x-e,t.y-e,t.x+e,t.y+e)},X=function(t,e,i,n,o){return t.l<=n&&e<=t.r&&t.b<=o&&i<=t.t},J=0,q=(cp.NO_GROUP=0,cp.ALL_LAYERS=-1);cp.resetShapeIdCounter=function(){J=0};var Q=cp.Shape=function(t){this.body=t,this.bb_l=this.bb_b=this.bb_r=this.bb_t=0,this.hashid=J++,this.sensor=!1,this.e=0,this.u=0,this.surface_v=b,this.collision_type=0,this.group=0,this.layers=q,this.space=null,this.collisionCode=this.collisionCode};Q.prototype.setElasticity=function(t){this.e=t},Q.prototype.setFriction=function(t){this.body.activate(),this.u=t},Q.prototype.setLayers=function(t){this.body.activate(),this.layers=t},Q.prototype.setSensor=function(t){this.body.activate(),this.sensor=t},Q.prototype.setCollisionType=function(t){this.body.activate(),this.collision_type=t},Q.prototype.getBody=function(){return this.body},Q.prototype.active=function(){return this.body&&-1!==this.body.shapeList.indexOf(this)},Q.prototype.setBody=function(t){c(!this.active(),"You cannot change the body on an active shape. You must remove the shape from the space before changing the body."),this.body=t},Q.prototype.cacheBB=function(){return this.update(this.body.p,this.body.rot)},Q.prototype.update=function(t,e){c(!isNaN(e.x),"Rotation is NaN"),c(!isNaN(t.x),"Position is NaN"),this.cacheData(t,e)},Q.prototype.pointQuery=function(t){var e=this.nearestPointQuery(t);if(e.d<0)return e},Q.prototype.getBB=function(){return new U(this.bb_l,this.bb_b,this.bb_r,this.bb_t)};var Z=function(t,e,i){this.shape=t,this.p=e,this.d=i},K=function(t,e,i){this.shape=t,this.t=e,this.n=i};K.prototype.hitPoint=function(t,e){return F(t,e,this.t)},K.prototype.hitDist=function(t,e){return W(t,e)*this.t};var $=cp.CircleShape=function(t,e,i){this.c=this.tc=i,this.r=e,this.type="circle",Q.call(this,t)};$.prototype=Object.create(Q.prototype),$.prototype.cacheData=function(t,e){var i=this.tc=P(this.c,e).add(t),n=this.r;this.bb_l=i.x-n,this.bb_b=i.y-n,this.bb_r=i.x+n,this.bb_t=i.y+n},$.prototype.nearestPointQuery=function(t){var e=t.x-this.tc.x,i=t.y-this.tc.y,n=E(e,i),o=this.r,r=new m(this.tc.x+e*o/n,this.tc.y+i*o/n);return new Z(this,r,n-o)};var tt=function(t,e,i,n,o,r){n=A(n,e),o=A(o,e);var s=C(n,n)-2*C(n,o)+C(o,o),c=-2*C(n,n)+2*C(n,o),a=c*c-4*s*(C(n,n)-i*i);if(a>=0){var h=(-c-Math.sqrt(a))/(2*s);if(0<=h&&h<=1)return new K(t,h,j(F(n,o,h)))}};$.prototype.segmentQuery=function(t,e){return tt(this,this.tc,this.r,t,e)};var et=cp.SegmentShape=function(t,e,i,n){this.a=e,this.b=i,this.n=L(j(A(i,e))),this.ta=this.tb=this.tn=null,this.r=n,this.a_tangent=b,this.b_tangent=b,this.type="segment",Q.call(this,t)};et.prototype=Object.create(Q.prototype),et.prototype.cacheData=function(t,e){this.ta=x(t,P(this.a,e)),this.tb=x(t,P(this.b,e)),this.tn=P(this.n,e);var i,n,o,r;this.ta.x<this.tb.x?(i=this.ta.x,n=this.tb.x):(i=this.tb.x,n=this.ta.x),this.ta.y<this.tb.y?(o=this.ta.y,r=this.tb.y):(o=this.tb.y,r=this.ta.y);var s=this.r;this.bb_l=i-s,this.bb_b=o-s,this.bb_r=n+s,this.bb_t=r+s},et.prototype.nearestPointQuery=function(t){var e=u(t,this.ta,this.tb),i=t.x-e.x,n=t.y-e.y,o=E(i,n),r=this.r,s=o?x(e,O(new m(i,n),r/o)):e;return new Z(this,s,o-r)},et.prototype.segmentQuery=function(t,e){var i=this.tn,n=C(A(this.ta,t),i),o=this.r,r=n>0?w(i):i,s=A(O(r,o),t),c=x(this.ta,s),a=x(this.tb,s),h=A(e,t);if(I(h,c)*I(h,a)<=0){var l=n+(n>0?-o:o),u=-l,d=C(h,i)-l;if(u*d<0)return new K(this,u/(u-d),r)}else if(0!==o){var p=tt(this,this.ta,this.r,t,e),_=tt(this,this.tb,this.r,t,e);return p?_&&_.t<p.t?_:p:_}},et.prototype.setNeighbors=function(t,e){this.a_tangent=A(t,this.a),this.b_tangent=A(e,this.b)},et.prototype.setEndpoints=function(t,e){this.a=t,this.b=e,this.n=L(j(A(e,t)))};var it=function(t){for(var e=t.length,i=0;i<e;i+=2){var n=t[i],o=t[i+1],r=t[(i+2)%e],s=t[(i+3)%e],c=t[(i+4)%e],a=t[(i+5)%e];if(N(r-n,s-o,c-r,a-s)>0)return!1}return!0},nt=cp.PolyShape=function(t,e,i){this.setVerts(e,i),this.type="poly",Q.call(this,t)};nt.prototype=Object.create(Q.prototype);var ot=function(t,e){this.n=t,this.d=e};ot.prototype.compare=function(t){return C(this.n,t)-this.d},nt.prototype.setVerts=function(i,n){c(i.length>=4,"Polygons require some verts"),c("number"===("object"==(e=typeof i[0])?t(i[0]):e),"Polygon verticies should be specified in a flattened list (eg [x1,y1,x2,y2,x3,y3,...])"),c(it(i),"Polygon is concave or has a reversed winding. Consider using cpConvexHull()");var o=i.length,r=o>>1;this.verts=new Array(o),this.tVerts=new Array(o),this.planes=new Array(r),this.tPlanes=new Array(r);for(var s=0;s<o;s+=2){var a=i[s]+n.x,h=i[s+1]+n.y,l=i[(s+2)%o]+n.x,u=i[(s+3)%o]+n.y,d=j(L(new m(l-a,u-h)));this.verts[s]=a,this.verts[s+1]=h,this.planes[s>>1]=new ot(d,T(d.x,d.y,a,h)),this.tPlanes[s>>1]=new ot(new m(0,0),0)}};cp.BoxShape=function(t,e,i){var n=e/2,o=i/2;return rt(t,new U(-n,-o,n,o))};var rt=cp.BoxShape2=function(t,e){var i=[e.l,e.b,e.l,e.t,e.r,e.t,e.r,e.b];return new nt(t,i,b)};nt.prototype.transformVerts=function(t,e){for(var i=this.verts,n=this.tVerts,o=1/0,c=-1/0,a=1/0,h=-1/0,l=0;l<i.length;l+=2){var u=i[l],d=i[l+1],p=t.x+u*e.x-d*e.y,_=t.y+u*e.y+d*e.x;n[l]=p,n[l+1]=_,o=r(o,p),c=s(c,p),a=r(a,_),h=s(h,_)}this.bb_l=o,this.bb_b=a,this.bb_r=c,this.bb_t=h},nt.prototype.transformAxes=function(t,e){for(var i=this.planes,n=this.tPlanes,o=0;o<i.length;o++){var r=P(i[o].n,e);n[o].n=r,n[o].d=C(t,r)+i[o].d}},nt.prototype.cacheData=function(t,e){this.transformAxes(t,e),this.transformVerts(t,e)},nt.prototype.nearestPointQuery=function(t){for(var e=this.tPlanes,i=this.tVerts,n=i[i.length-2],o=i[i.length-1],r=1/0,s=b,c=!1,a=0;a<e.length;a++){e[a].compare(t)>0&&(c=!0);var h=i[2*a],l=i[2*a+1],u=d(t.x,t.y,n,o,h,l),p=W(t,u);p<r&&(r=p,s=u),n=h,o=l}return new Z(this,s,c?r:-r)},nt.prototype.segmentQuery=function(t,e){for(var i=this.tPlanes,n=this.tVerts,o=i.length,r=2*o,s=0;s<o;s++){var c=i[s].n,a=C(t,c);if(!(i[s].d>a)){var h=C(e,c),l=(i[s].d-a)/(h-a);if(!(l<0||1<l)){var u=F(t,e,l),d=-I(c,u),p=-N(c.x,c.y,n[2*s],n[2*s+1]),_=-N(c.x,c.y,n[(2*s+2)%r],n[(2*s+3)%r]);if(p<=d&&d<=_)return new K(this,l,c)}}}},nt.prototype.valueOnAxis=function(t,e){for(var i=this.tVerts,n=T(t.x,t.y,i[0],i[1]),o=2;o<i.length;o+=2)n=r(n,T(t.x,t.y,i[o],i[o+1]));return n-e},nt.prototype.containsVert=function(t,e){for(var i=this.tPlanes,n=0;n<i.length;n++){var o=i[n].n;if(T(o.x,o.y,t,e)-i[n].d>0)return!1}return!0},nt.prototype.containsVertPartial=function(t,e,i){for(var n=this.tPlanes,o=0;o<n.length;o++){var r=n[o].n;if(!(C(r,i)<0)&&T(r.x,r.y,t,e)-n[o].d>0)return!1}return!0},nt.prototype.getNumVerts=function(){return this.verts.length/2},nt.prototype.getVert=function(t){return new m(this.verts[2*t],this.verts[2*t+1])};var st=cp.Body=function(t,e){this.p=new m(0,0),this.vx=this.vy=0,this.f=new m(0,0),this.w=0,this.t=0,this.v_limit=1/0,this.w_limit=1/0,this.v_biasx=this.v_biasy=0,this.w_bias=0,this.space=null,this.shapeList=[],this.arbiterList=null,this.constraintList=null,this.nodeRoot=null,this.nodeNext=null,this.nodeIdleTime=0,this.setMass(t),this.setMoment(e),this.rot=new m(0,0),this.setAngle(0)};if(cp.StaticBody=function(){var t=new st(1/0,1/0);return t.nodeIdleTime=1/0,t},"undefined"!==("object"==(e=typeof DEBUG)?t(DEBUG):e)&&DEBUG){var ct=function(t,e){c(t.x==t.x&&t.y==t.y,e)},at=function(t,e){c(Math.abs(t.x)!==1/0&&Math.abs(t.y)!==1/0,e)},ht=function(t,e){ct(t,e),at(t,e)};st.prototype.sanityCheck=function(){c(this.m===this.m&&this.m_inv===this.m_inv,"Body's mass is invalid."),c(this.i===this.i&&this.i_inv===this.i_inv,"Body's moment is invalid."),ht(this.p,"Body's position is invalid."),ht(this.f,"Body's force is invalid."),c(this.vx===this.vx&&Math.abs(this.vx)!==1/0,"Body's velocity is invalid."),c(this.vy===this.vy&&Math.abs(this.vy)!==1/0,"Body's velocity is invalid."),c(this.a===this.a&&Math.abs(this.a)!==1/0,"Body's angle is invalid."),c(this.w===this.w&&Math.abs(this.w)!==1/0,"Body's angular velocity is invalid."),c(this.t===this.t&&Math.abs(this.t)!==1/0,"Body's torque is invalid."),ht(this.rot,"Body's rotation vector is invalid."),c(this.v_limit===this.v_limit,"Body's velocity limit is invalid."),c(this.w_limit===this.w_limit,"Body's angular velocity limit is invalid.")}}else st.prototype.sanityCheck=function(){};st.prototype.getPos=function(){return this.p},st.prototype.getVel=function(){return new m(this.vx,this.vy)},st.prototype.getAngVel=function(){return this.w},st.prototype.isSleeping=function(){return null!==this.nodeRoot},st.prototype.isStatic=function(){return this.nodeIdleTime===1/0},st.prototype.isRogue=function(){return null===this.space},st.prototype.setMass=function(t){c(t>0,"Mass must be positive and non-zero."),this.activate(),this.m=t,this.m_inv=1/t},st.prototype.setMoment=function(t){c(t>0,"Moment of Inertia must be positive and non-zero."),this.activate(),this.i=t,this.i_inv=1/t},st.prototype.addShape=function(t){this.shapeList.push(t)},st.prototype.removeShape=function(t){l(this.shapeList,t)};var lt=function(t,e,i){return t===i?t.next(e):(t.a===e?t.next_a=lt(t.next_a,e,i):t.next_b=lt(t.next_b,e,i),t)};st.prototype.removeConstraint=function(t){this.constraintList=lt(this.constraintList,this,t)},st.prototype.setPos=function(t){this.activate(),this.sanityCheck(),t===b&&(t=cp.v(0,0)),this.p=t},st.prototype.setVel=function(t){this.activate(),this.vx=t.x,this.vy=t.y},st.prototype.setAngVel=function(t){this.activate(),this.w=t},st.prototype.setAngleInternal=function(t){c(!isNaN(t),"Internal Error: Attempting to set body's angle to NaN"),this.a=t,this.rot.x=Math.cos(t),this.rot.y=Math.sin(t)},st.prototype.setAngle=function(t){this.activate(),this.sanityCheck(),this.setAngleInternal(t)},st.prototype.velocity_func=function(t,e,i){var n=this.vx*e+(t.x+this.f.x*this.m_inv)*i,o=this.vy*e+(t.y+this.f.y*this.m_inv)*i,r=this.v_limit,s=n*n+o*o,c=s>r*r?r/Math.sqrt(s):1;this.vx=n*c,this.vy=o*c;var a=this.w_limit;this.w=v(this.w*e+this.t*this.i_inv*i,-a,a),this.sanityCheck()},st.prototype.position_func=function(t){this.p.x+=(this.vx+this.v_biasx)*t,this.p.y+=(this.vy+this.v_biasy)*t,this.setAngleInternal(this.a+(this.w+this.w_bias)*t),this.v_biasx=this.v_biasy=0,this.w_bias=0,this.sanityCheck()},st.prototype.resetForces=function(){this.activate(),this.f=new m(0,0),this.t=0},st.prototype.applyForce=function(t,e){this.activate(),this.f=x(this.f,t),this.t+=I(e,t)},st.prototype.applyImpulse=function(t,e){this.activate(),ce(this,t.x,t.y,e)},st.prototype.getVelAtPoint=function(t){return x(new m(this.vx,this.vy),O(L(t),this.w))},st.prototype.getVelAtWorldPoint=function(t){return this.getVelAtPoint(A(t,this.p))},st.prototype.getVelAtLocalPoint=function(t){return this.getVelAtPoint(P(t,this.rot))},st.prototype.eachShape=function(t){for(var e=0,i=this.shapeList.length;e<i;e++)t(this.shapeList[e])},st.prototype.eachConstraint=function(t){for(var e=this.constraintList;e;){var i=e.next(this);t(e),e=i}},st.prototype.eachArbiter=function(t){for(var e=this.arbiterList;e;){var i=e.next(this);e.swappedColl=this===e.body_b,t(e),e=i}},st.prototype.local2World=function(t){return x(this.p,P(t,this.rot))},st.prototype.world2Local=function(t){return B(A(t,this.p),this.rot)},st.prototype.kineticEnergy=function(){var t=this.vx*this.vx+this.vy*this.vy,e=this.w*this.w;return(t?t*this.m:0)+(e?e*this.i:0)};var ut=cp.SpatialIndex=function(t){if(this.staticIndex=t,t){if(t.dynamicIndex)throw new Error("This static index is already associated with a dynamic index.");t.dynamicIndex=this}};ut.prototype.collideStatic=function(t,e){if(t.count>0){var i=t.query;this.each((function(t){i(t,new U(t.bb_l,t.bb_b,t.bb_r,t.bb_t),e)}))}};var dt=cp.BBTree=function(t){ut.call(this,t),this.velocityFunc=null,this.leaves={},this.count=0,this.root=null,this.pooledNodes=null,this.pooledPairs=null,this.stamp=0};dt.prototype=Object.create(ut.prototype);var pt=0,_t=function(t,e,i){this.obj=null,this.bb_l=r(e.bb_l,i.bb_l),this.bb_b=r(e.bb_b,i.bb_b),this.bb_r=s(e.bb_r,i.bb_r),this.bb_t=s(e.bb_t,i.bb_t),this.parent=null,this.setA(e),this.setB(i)};dt.prototype.makeNode=function(t,e){var i=this.pooledNodes;return i?(this.pooledNodes=i.parent,i.constructor(this,t,e),i):(pt++,new _t(this,t,e))};var ft=0,gt=function(t,e){this.obj=e,t.getBB(e,this),this.parent=null,this.stamp=1,this.pairs=null,ft++};dt.prototype.getBB=function(t,e){var i=this.velocityFunc;if(i){var n=.1*(t.bb_r-t.bb_l),o=.1*(t.bb_t-t.bb_b),c=O(i(t),.1);e.bb_l=t.bb_l+r(-n,c.x),e.bb_b=t.bb_b+r(-o,c.y),e.bb_r=t.bb_r+s(n,c.x),e.bb_t=t.bb_t+s(o,c.y)}else e.bb_l=t.bb_l,e.bb_b=t.bb_b,e.bb_r=t.bb_r,e.bb_t=t.bb_t},dt.prototype.getStamp=function(){var t=this.dynamicIndex;return t&&t.stamp?t.stamp:this.stamp},dt.prototype.incrementStamp=function(){this.dynamicIndex&&this.dynamicIndex.stamp?this.dynamicIndex.stamp++:this.stamp++};var vt=0,yt=function(t,e,i,n){this.prevA=null,this.leafA=t,this.nextA=e,this.prevB=null,this.leafB=i,this.nextB=n};dt.prototype.makePair=function(t,e,i,n){var o=this.pooledPairs;return o?(this.pooledPairs=o.prevA,o.prevA=null,o.leafA=t,o.nextA=e,o.prevB=null,o.leafB=i,o.nextB=n,o):(vt++,new yt(t,e,i,n))},yt.prototype.recycle=function(t){this.prevA=t.pooledPairs,t.pooledPairs=this};var mt=function(t,e,i){i&&(i.leafA===e?i.prevA=t:i.prevB=t),t?t.leafA===e?t.nextA=i:t.nextB=i:e.pairs=i};gt.prototype.clearPairs=function(t){var e,i=this.pairs;for(this.pairs=null;i;)i.leafA===this?(e=i.nextA,mt(i.prevB,i.leafB,i.nextB)):(e=i.nextB,mt(i.prevA,i.leafA,i.nextA)),i.recycle(t),i=e};var bt=function(t,e,i){var n=t.pairs,o=e.pairs,r=i.makePair(t,n,e,o);t.pairs=e.pairs=r,n&&(n.leafA===t?n.prevA=r:n.prevB=r),o&&(o.leafA===e?o.prevA=r:o.prevB=r)};_t.prototype.recycle=function(t){this.parent=t.pooledNodes,t.pooledNodes=this},gt.prototype.recycle=function(t){},_t.prototype.setA=function(t){this.A=t,t.parent=this},_t.prototype.setB=function(t){this.B=t,t.parent=this},gt.prototype.isLeaf=!0,_t.prototype.isLeaf=!1,_t.prototype.otherChild=function(t){return this.A==t?this.B:this.A},_t.prototype.replaceChild=function(t,e,i){a(t==this.A||t==this.B,"Node is not a child of parent."),this.A==t?(this.A.recycle(i),this.setA(e)):(this.B.recycle(i),this.setB(e));for(var n=this;n;n=n.parent){var o=n.A,c=n.B;n.bb_l=r(o.bb_l,c.bb_l),n.bb_b=r(o.bb_b,c.bb_b),n.bb_r=s(o.bb_r,c.bb_r),n.bb_t=s(o.bb_t,c.bb_t)}},_t.prototype.bbArea=gt.prototype.bbArea=function(){return(this.bb_r-this.bb_l)*(this.bb_t-this.bb_b)};var Ct=function(t,e){return(s(t.bb_r,e.bb_r)-r(t.bb_l,e.bb_l))*(s(t.bb_t,e.bb_t)-r(t.bb_b,e.bb_b))},Tt=function(t,e){return Math.abs(t.bb_l+t.bb_r-e.bb_l-e.bb_r)+Math.abs(t.bb_b+t.bb_t-e.bb_b-e.bb_t)},St=function(t,e,i){if(null==t)return e;if(t.isLeaf)return i.makeNode(e,t);var n=t.B.bbArea()+Ct(t.A,e),o=t.A.bbArea()+Ct(t.B,e);return n===o&&(n=Tt(t.A,e),o=Tt(t.B,e)),o<n?t.setB(St(t.B,e,i)):t.setA(St(t.A,e,i)),t.bb_l=r(t.bb_l,e.bb_l),t.bb_b=r(t.bb_b,e.bb_b),t.bb_r=s(t.bb_r,e.bb_r),t.bb_t=s(t.bb_t,e.bb_t),t};_t.prototype.intersectsBB=gt.prototype.intersectsBB=function(t){return this.bb_l<=t.r&&t.l<=this.bb_r&&this.bb_b<=t.t&&t.b<=this.bb_t};var Et=function(t,e,i){t.intersectsBB(e)&&(t.isLeaf?i(t.obj):(Et(t.A,e,i),Et(t.B,e,i)))},xt=function(t,e,i){var n=1/(i.x-e.x),o=t.bb_l==e.x?-1/0:(t.bb_l-e.x)*n,c=t.bb_r==e.x?1/0:(t.bb_r-e.x)*n,a=r(o,c),h=s(o,c),l=1/(i.y-e.y),u=t.bb_b==e.y?-1/0:(t.bb_b-e.y)*l,d=t.bb_t==e.y?1/0:(t.bb_t-e.y)*l,p=r(u,d),_=s(u,d);if(p<=h&&a<=_){var f=s(a,p);if(0<=r(h,_)&&f<=1)return s(f,0)}return 1/0},At=function(t,e,i,n,o){if(t.isLeaf)return o(t.obj);var s=xt(t.A,e,i),c=xt(t.B,e,i);return s<c?(s<n&&(n=r(n,At(t.A,e,i,n,o))),c<n&&(n=r(n,At(t.B,e,i,n,o)))):(c<n&&(n=r(n,At(t.B,e,i,n,o))),s<n&&(n=r(n,At(t.A,e,i,n,o)))),n};dt.prototype.subtreeRecycle=function(t){t.isLeaf&&(this.subtreeRecycle(t.A),this.subtreeRecycle(t.B),t.recycle(this))};var wt=function(t,e,i){if(e==t)return null;var n=e.parent;if(n==t){var o=t.otherChild(e);return o.parent=t.parent,t.recycle(i),o}return n.parent.replaceChild(n,n.otherChild(e),i),t},Ot=function(t,e){return t.bb_l<=e.bb_r&&e.bb_l<=t.bb_r&&t.bb_b<=e.bb_t&&e.bb_b<=t.bb_t};gt.prototype.markLeafQuery=function(t,e,i,n){Ot(t,this)&&(e?bt(t,this,i):(this.stamp<t.stamp&&bt(this,t,i),n&&n(t.obj,this.obj)))},_t.prototype.markLeafQuery=function(t,e,i,n){Ot(t,this)&&(this.A.markLeafQuery(t,e,i,n),this.B.markLeafQuery(t,e,i,n))},gt.prototype.markSubtree=function(t,e,i){if(this.stamp==t.getStamp()){e&&e.markLeafQuery(this,!1,t,i);for(var n=this;n.parent;n=n.parent)n==n.parent.A?n.parent.B.markLeafQuery(this,!0,t,i):n.parent.A.markLeafQuery(this,!1,t,i)}else for(var o=this.pairs;o;)this===o.leafB?(i&&i(o.leafA.obj,this.obj),o=o.nextB):o=o.nextA},_t.prototype.markSubtree=function(t,e,i){this.A.markSubtree(t,e,i),this.B.markSubtree(t,e,i)},gt.prototype.containsObj=function(t){return this.bb_l<=t.bb_l&&this.bb_r>=t.bb_r&&this.bb_b<=t.bb_b&&this.bb_t>=t.bb_t},gt.prototype.update=function(t){var e=t.root,i=this.obj;return!this.containsObj(i)&&(t.getBB(this.obj,this),e=wt(e,this,t),t.root=St(e,this,t),this.clearPairs(t),this.stamp=t.getStamp(),!0)},gt.prototype.addPairs=function(t){var e=t.dynamicIndex;if(e){var i=e.root;i&&i.markLeafQuery(this,!0,e,null)}else{var n=t.staticIndex.root;this.markSubtree(t,n,null)}},dt.prototype.insert=function(t,e){var i=new gt(this,t);this.leaves[e]=i,this.root=St(this.root,i,this),this.count++,i.stamp=this.getStamp(),i.addPairs(this),this.incrementStamp()},dt.prototype.remove=function(t,e){var i=this.leaves[e];delete this.leaves[e],this.root=wt(this.root,i,this),this.count--,i.clearPairs(this),i.recycle(this)},dt.prototype.contains=function(t,e){return null!=this.leaves[e]};var It=function(t,e){};dt.prototype.reindexQuery=function(t){if(this.root){var e,i=this.leaves;for(e in i)i[e].update(this);var n=this.staticIndex,o=n&&n.root;this.root.markSubtree(this,o,t),n&&!o&&this.collideStatic(this,n,t),this.incrementStamp()}},dt.prototype.reindex=function(){this.reindexQuery(It)},dt.prototype.reindexObject=function(t,e){var i=this.leaves[e];i&&(i.update(this)&&i.addPairs(this),this.incrementStamp())},dt.prototype.pointQuery=function(t,e){this.query(new U(t.x,t.y,t.x,t.y),e)},dt.prototype.segmentQuery=function(t,e,i,n){this.root&&At(this.root,t,e,i,n)},dt.prototype.query=function(t,e){this.root&&Et(this.root,t,e)},dt.prototype.count=function(){return this.count},dt.prototype.each=function(t){var e;for(e in this.leaves)t(this.leaves[e].obj)};var Nt=function(t,e,i,n,o){return(s(t.bb_r,n)-r(t.bb_l,e))*(s(t.bb_t,o)-r(t.bb_b,i))},Lt=function(t,e,i,n){if(1==n)return e[i];if(2==n)return t.makeNode(e[i],e[i+1]);for(var o=(x=e[i]).bb_l,c=x.bb_b,a=x.bb_r,h=x.bb_t,l=i+n,u=i+1;u<l;u++)x=e[u],o=r(o,x.bb_l),c=r(c,x.bb_b),a=s(a,x.bb_r),h=s(h,x.bb_t);var d=a-o>h-c,p=new Array(2*n);if(d)for(u=i;u<l;u++)p[2*u+0]=e[u].bb_l,p[2*u+1]=e[u].bb_r;else for(u=i;u<l;u++)p[2*u+0]=e[u].bb_b,p[2*u+1]=e[u].bb_t;p.sort((function(t,e){return t-e}));var _=.5*(p[n-1]+p[n]),f=o,g=c,v=a,y=h,m=o,b=c,C=a,T=h;d?v=m=_:y=b=_;for(var S=l,E=i;E<S;){x=e[E];Nt(x,m,b,C,T)<Nt(x,f,g,v,y)?(S--,e[E]=e[S],e[S]=x):E++}if(S==n){for(var x=null,u=i;u<l;u++)x=St(x,e[u],t);return x}return NodeNew(t,Lt(t,e,i,S-i),Lt(t,e,S,l-S))};dt.prototype.optimize=function(){var t=new Array(this.count),e=0;for(var i in this.leaves)t[e++]=this.nodes[i];tree.subtreeRecycle(root),this.root=Lt(tree,t,t.length)};var Rt=function(t,e){!t.isLeaf&&e<=10&&(Rt(t.A,e+1),Rt(t.B,e+1));for(var i="",n=0;n<e;n++)i+=" ";console.log(i+t.bb_b+" "+t.bb_t)};dt.prototype.log=function(){this.root&&Rt(this.root,0)};var Pt=cp.CollisionHandler=function(){this.a=this.b=0};Pt.prototype.begin=function(t,e){return!0},Pt.prototype.preSolve=function(t,e){return!0},Pt.prototype.postSolve=function(t,e){},Pt.prototype.separate=function(t,e){};var Bt=function(t,e){this.e=0,this.u=0,this.surface_vr=b,this.a=t,this.body_a=t.body,this.b=e,this.body_b=e.body,this.thread_a_next=this.thread_a_prev=null,this.thread_b_next=this.thread_b_prev=null,this.contacts=null,this.stamp=0,this.handler=null,this.swappedColl=!1,this.state="first coll"};Bt.prototype.getShapes=function(){return this.swappedColl?[this.b,this.a]:[this.a,this.b]},Bt.prototype.totalImpulse=function(){for(var t=this.contacts,e=new m(0,0),i=0,n=t.length;i<n;i++){var o=t[i];e.add(O(o.n,o.jnAcc))}return this.swappedColl?e:e.neg()},Bt.prototype.totalImpulseWithFriction=function(){for(var t=this.contacts,e=new m(0,0),i=0,n=t.length;i<n;i++){var o=t[i];e.add(new m(o.jnAcc,o.jtAcc).rotate(o.n))}return this.swappedColl?e:e.neg()},Bt.prototype.totalKE=function(){for(var t=(1-this.e)/(1+this.e),e=0,i=this.contacts,n=0,o=i.length;n<o;n++){var r=i[n],s=r.jnAcc,c=r.jtAcc;e+=t*s*s/r.nMass+c*c/r.tMass}return e},Bt.prototype.ignore=function(){this.state="ignore"},Bt.prototype.getA=function(){return this.swappedColl?this.b:this.a},Bt.prototype.getB=function(){return this.swappedColl?this.a:this.b},Bt.prototype.isFirstContact=function(){return"first coll"===this.state};var Dt=function(t,e,i){this.point=t,this.normal=e,this.dist=i};Bt.prototype.getContactPointSet=function(){var t,e=new Array(this.contacts.length);for(t=0;t<e.length;t++)e[t]=new Dt(this.contacts[t].p,this.contacts[t].n,this.contacts[t].dist);return e},Bt.prototype.getNormal=function(t){var e=this.contacts[t].n;return this.swappedColl?w(e):e},Bt.prototype.getPoint=function(t){return this.contacts[t].p},Bt.prototype.getDepth=function(t){return this.contacts[t].dist};var Mt=function(t,e,i,n){i?i.body_a===e?i.thread_a_next=n:i.thread_b_next=n:e.arbiterList=n,n&&(n.body_a===e?n.thread_a_prev=i:n.thread_b_prev=i)};Bt.prototype.unthread=function(){Mt(0,this.body_a,this.thread_a_prev,this.thread_a_next),Mt(0,this.body_b,this.thread_b_prev,this.thread_b_next),this.thread_a_prev=this.thread_a_next=null,this.thread_b_prev=this.thread_b_next=null},Bt.prototype.update=function(t,e,i,n){if(this.contacts)for(var o=0;o<this.contacts.length;o++)for(var r=this.contacts[o],s=0;s<t.length;s++){var c=t[s];c.hash===r.hash&&(c.jnAcc=r.jnAcc,c.jtAcc=r.jtAcc)}this.contacts=t,this.handler=e,this.swappedColl=i.collision_type!==e.a,this.e=i.e*n.e,this.u=i.u*n.u,this.surface_vr=A(i.surface_v,n.surface_v),this.a=i,this.body_a=i.body,this.b=n,this.body_b=n.body,"cached"==this.state&&(this.state="first coll")},Bt.prototype.preStep=function(t,e,i){for(var n=this.body_a,o=this.body_b,s=0;s<this.contacts.length;s++){var c=this.contacts[s];c.r1=A(c.p,n.p),c.r2=A(c.p,o.p),c.nMass=1/ue(n,o,c.r1,c.r2,c.n),c.tMass=1/ue(n,o,c.r1,c.r2,L(c.n)),c.bias=-i*r(0,c.dist+e)/t,c.jBias=0,c.bounce=se(n,o,c.r1,c.r2,c.n)*this.e}},Bt.prototype.applyCachedImpulse=function(t){if(!this.isFirstContact())for(var e=this.body_a,i=this.body_b,n=0;n<this.contacts.length;n++){var o=this.contacts[n],r=o.n.x,s=o.n.y,c=r*o.jnAcc-s*o.jtAcc,a=r*o.jtAcc+s*o.jnAcc;ae(e,i,o.r1,o.r2,c*t,a*t)}};var Ft=0,jt=0;Bt.prototype.applyImpulse=function(){Ft++;for(var t=this.body_a,e=this.body_b,i=this.surface_vr,n=this.u,o=0;o<this.contacts.length;o++){jt++;var r=this.contacts[o],c=r.nMass,a=r.n,h=r.r1,l=r.r2,u=e.vx-l.y*e.w-(t.vx-h.y*t.w),d=e.vy+l.x*e.w-(t.vy+h.x*t.w),p=a.x*(e.v_biasx-l.y*e.w_bias-t.v_biasx+h.y*t.w_bias)+a.y*(l.x*e.w_bias+e.v_biasy-h.x*t.w_bias-t.v_biasy),_=T(u,d,a.x,a.y),f=T(u+i.x,d+i.y,-a.y,a.x),g=(r.bias-p)*c,y=r.jBias;r.jBias=s(y+g,0);var m=-(r.bounce+_)*c,b=r.jnAcc;r.jnAcc=s(b+m,0);var C=n*r.jnAcc,S=-f*r.tMass,E=r.jtAcc;r.jtAcc=v(E+S,-C,C);var x=a.x*(r.jBias-y),A=a.y*(r.jBias-y);he(t,-x,-A,h),he(e,x,A,l);var w=r.jnAcc-b,O=r.jtAcc-E;ae(t,e,h,l,a.x*w-a.y*O,a.x*O+a.y*w)}},Bt.prototype.callSeparate=function(t){t.lookupHandler(this.a.collision_type,this.b.collision_type).separate(this,t)},Bt.prototype.next=function(t){return this.body_a==t?this.thread_a_next:this.thread_b_next};var kt=0,zt=function(t,e,i,n){this.p=t,this.n=e,this.dist=i,this.r1=this.r2=b,this.nMass=this.tMass=this.bounce=this.bias=0,this.jnAcc=this.jtAcc=this.jBias=0,this.hash=n,kt++},Wt=[],Vt=function(t,e,i,n){var o=i+n,r=A(e,t),s=D(r);if(!(s>=o*o)){var c=Math.sqrt(s);return new zt(x(t,O(r,.5+(i-.5*o)/(c||1/0))),c?O(r,1/c):new m(1,0),c-o,0)}},Gt=0,Ht=function(t,e){var i=0,n=t.valueOnAxis(e[0].n,e[0].d);if(n>0)return-1;for(var o=1;o<e.length;o++){var r=t.valueOnAxis(e[o].n,e[o].d);if(r>0)return-1;r>n&&(n=r,i=o)}return Gt=n,i},Ut=function(t,e,i,n){for(var o=[],r=t.tVerts,s=0;s<r.length;s+=2){var c=r[s],a=r[s+1];e.containsVertPartial(c,a,w(i))&&o.push(new zt(new m(c,a),i,n,h(t.hashid,s)))}for(var l=e.tVerts,s=0;s<l.length;s+=2){var c=l[s],a=l[s+1];t.containsVertPartial(c,a,i)&&o.push(new zt(new m(c,a),i,n,h(e.hashid,s)))}return o},Yt=function(t,e,i,n){for(var o=[],r=t.tVerts,s=0;s<r.length;s+=2){var c=r[s],a=r[s+1];e.containsVert(c,a)&&o.push(new zt(new m(c,a),i,n,h(t.hashid,s>>1)))}for(var l=e.tVerts,s=0;s<l.length;s+=2){var c=l[s],a=l[s+1];t.containsVert(c,a)&&o.push(new zt(new m(c,a),i,n,h(e.hashid,s>>1)))}return o.length?o:Ut(t,e,i,n)},Xt=function(t,e,i){var n=C(e,t.ta)-t.r,o=C(e,t.tb)-t.r;return r(n,o)-i},Jt=function(t,e,i,n,o){for(var r=I(e.tn,e.ta),s=I(e.tn,e.tb),c=O(e.tn,o),a=i.tVerts,l=0;l<a.length;l+=2){var u=a[l],d=a[l+1];if(T(u,d,c.x,c.y)<C(e.tn,e.ta)*o+e.r){var p=N(e.tn.x,e.tn.y,u,d);r>=p&&p>=s&&t.push(new zt(new m(u,d),c,n,h(i.hashid,l)))}}};$.prototype.collisionCode=0,et.prototype.collisionCode=1,nt.prototype.collisionCode=2,$.prototype.collisionTable=[function(t,e){var i=Vt(t.tc,e.tc,t.r,e.r);return i?[i]:Wt},function(t,e){var i=e.ta,n=e.tb,o=t.tc,r=A(n,i),s=y(C(r,A(o,i))/D(r)),c=x(i,O(r,s)),a=Vt(o,c,t.r,e.r);if(a){var h=a.n;return 0===s&&C(h,e.a_tangent)<0||1===s&&C(h,e.b_tangent)<0?Wt:[a]}return Wt},function(t,e){for(var i=e.tPlanes,n=0,o=C(i[0].n,t.tc)-i[0].d-t.r,r=0;r<i.length;r++){var s=C(i[r].n,t.tc)-i[r].d-t.r;if(s>0)return Wt;s>o&&(o=s,n=r)}var c=i[n].n,a=e.tVerts,h=a.length,l=n<<1,u=a[l],d=a[l+1],p=a[(l+2)%h],_=a[(l+3)%h],f=N(c.x,c.y,u,d),g=N(c.x,c.y,p,_),v=I(c,t.tc);if(v<g)return(y=Vt(t.tc,new m(p,_),t.r,0))?[y]:Wt;if(v<f)return[new zt(A(t.tc,O(c,t.r+o/2)),w(c),o,0)];var y=Vt(t.tc,new m(u,d),t.r,0);return y?[y]:Wt}],et.prototype.collisionTable=[null,function(t,e){return Wt},function(t,e){var i=[],n=e.tPlanes,o=n.length,r=C(t.tn,t.ta),s=e.valueOnAxis(t.tn,r)-t.r,c=e.valueOnAxis(w(t.tn),-r)-t.r;if(c>0||s>0)return Wt;var a=0,l=Xt(t,n[0].n,n[0].d);if(l>0)return Wt;for(var u=0;u<o;u++){var d=Xt(t,n[u].n,n[u].d);if(d>0)return Wt;d>l&&(l=d,a=u)}var p=w(n[a].n),_=x(t.ta,O(p,t.r)),f=x(t.tb,O(p,t.r));if(e.containsVert(_.x,_.y)&&i.push(new zt(_,p,l,h(t.hashid,0))),e.containsVert(f.x,f.y)&&i.push(new zt(f,p,l,h(t.hashid,1))),(s>=l||c>=l)&&(s>c?Jt(i,t,e,s,1):Jt(i,t,e,c,-1)),0===i.length){var g,v=2*a,y=e.tVerts,b=new m(y[v],y[v+1]);if(g=Vt(t.ta,b,t.r,0))return[g];if(g=Vt(t.tb,b,t.r,0))return[g];var T=2*o,S=new m(y[(v+2)%T],y[(v+3)%T]);if(g=Vt(t.ta,S,t.r,0))return[g];if(g=Vt(t.tb,S,t.r,0))return[g]}return i}],nt.prototype.collisionTable=[null,null,function(t,e){var i=Ht(e,t.tPlanes);if(-1==i)return Wt;var n=Gt,o=Ht(t,e.tPlanes);if(-1==o)return Wt;var r=Gt;return n>r?Yt(t,e,t.tPlanes[i].n,n):Yt(t,e,w(e.tPlanes[o].n),r)}];var qt=cp.collideShapes=function(t,e){return c(t.collisionCode<=e.collisionCode,"Collided shapes must be sorted by type"),t.collisionTable[e.collisionCode](t,e)},Qt=new Pt,Zt=cp.Space=function(){this.stamp=0,this.curr_dt=0,this.bodies=[],this.rousedBodies=[],this.sleepingComponents=[],this.staticShapes=new dt(null),this.activeShapes=new dt(this.staticShapes),this.arbiters=[],this.contactBuffersHead=null,this.cachedArbiters={},this.constraints=[],this.locked=0,this.collisionHandlers={},this.defaultHandler=Qt,this.postStepCallbacks=[],this.iterations=10,this.gravity=b,this.damping=1,this.idleSpeedThreshold=0,this.sleepTimeThreshold=1/0,this.collisionSlop=.1,this.collisionBias=Math.pow(.9,60),this.collisionPersistence=3,this.enableContactGraph=!1,this.staticBody=new st(1/0,1/0),this.staticBody.nodeIdleTime=1/0,this.collideShapes=this.makeCollideShapes()};Zt.prototype.getCurrentTimeStep=function(){return this.curr_dt},Zt.prototype.setIterations=function(t){this.iterations=t},Zt.prototype.isLocked=function(){return this.locked};var Kt=function(t){c(!t.locked,"This addition/removal cannot be done safely during a call to cpSpaceStep()  or during a query. Put these calls into a post-step callback.")};Zt.prototype.addCollisionHandler=function(t,e,i,n,o,r){Kt(this),this.removeCollisionHandler(t,e);var s=new Pt;s.a=t,s.b=e,i&&(s.begin=i),n&&(s.preSolve=n),o&&(s.postSolve=o),r&&(s.separate=r),this.collisionHandlers[h(t,e)]=s},Zt.prototype.removeCollisionHandler=function(t,e){Kt(this),delete this.collisionHandlers[h(t,e)]},Zt.prototype.setDefaultCollisionHandler=function(t,e,i,n){Kt(this);var o=new Pt;t&&(o.begin=t),e&&(o.preSolve=e),i&&(o.postSolve=i),n&&(o.separate=n),this.defaultHandler=o},Zt.prototype.lookupHandler=function(t,e){return this.collisionHandlers[h(t,e)]||this.defaultHandler},Zt.prototype.addShape=function(t){var e=t.body;return e.isStatic()?this.addStaticShape(t):(c(!t.space,"This shape is already added to a space and cannot be added to another."),Kt(this),e.activate(),e.addShape(t),t.update(e.p,e.rot),this.activeShapes.insert(t,t.hashid),t.space=this,t)},Zt.prototype.addStaticShape=function(t){c(!t.space,"This shape is already added to a space and cannot be added to another."),Kt(this);var e=t.body;return e.addShape(t),t.update(e.p,e.rot),this.staticShapes.insert(t,t.hashid),t.space=this,t},Zt.prototype.addBody=function(t){return c(!t.isStatic(),"Static bodies cannot be added to a space as they are not meant to be simulated."),c(!t.space,"This body is already added to a space and cannot be added to another."),Kt(this),this.bodies.push(t),t.space=this,t},Zt.prototype.addConstraint=function(t){c(!t.space,"This shape is already added to a space and cannot be added to another."),Kt(this);var e=t.a,i=t.b;return e.activate(),i.activate(),this.constraints.push(t),t.next_a=e.constraintList,e.constraintList=t,t.next_b=i.constraintList,i.constraintList=t,t.space=this,t},Zt.prototype.filterArbiters=function(t,e){for(var i in this.cachedArbiters){var n=this.cachedArbiters[i];(t!==n.body_a||e!==n.a&&null!==e)&&(t!==n.body_b||e!==n.b&&null!==e)||(e&&"cached"!==n.state&&n.callSeparate(this),n.unthread(),l(this.arbiters,n),delete this.cachedArbiters[i])}},Zt.prototype.removeShape=function(t){var e=t.body;e.isStatic()?this.removeStaticShape(t):(c(this.containsShape(t),"Cannot remove a shape that was not added to the space. (Removed twice maybe?)"),Kt(this),e.activate(),e.removeShape(t),this.filterArbiters(e,t),this.activeShapes.remove(t,t.hashid),t.space=null)},Zt.prototype.removeStaticShape=function(t){c(this.containsShape(t),"Cannot remove a static or sleeping shape that was not added to the space. (Removed twice maybe?)"),Kt(this);var e=t.body;e.isStatic()&&e.activateStatic(t),e.removeShape(t),this.filterArbiters(e,t),this.staticShapes.remove(t,t.hashid),t.space=null},Zt.prototype.removeBody=function(t){c(this.containsBody(t),"Cannot remove a body that was not added to the space. (Removed twice maybe?)"),Kt(this),t.activate(),l(this.bodies,t),t.space=null},Zt.prototype.removeConstraint=function(t){c(this.containsConstraint(t),"Cannot remove a constraint that was not added to the space. (Removed twice maybe?)"),Kt(this),t.a.activate(),t.b.activate(),l(this.constraints,t),t.a.removeConstraint(t),t.b.removeConstraint(t),t.space=null},Zt.prototype.containsShape=function(t){return t.space===this},Zt.prototype.containsBody=function(t){return t.space==this},Zt.prototype.containsConstraint=function(t){return t.space==this},Zt.prototype.uncacheArbiter=function(t){delete this.cachedArbiters[h(t.a.hashid,t.b.hashid)],l(this.arbiters,t)},Zt.prototype.eachBody=function(t){this.lock();for(var e=this.bodies,i=0;i<e.length;i++)t(e[i]);for(var n=this.sleepingComponents,i=0;i<n.length;i++)for(var o=n[i];o;){var r=o.nodeNext;t(o),o=r}this.unlock(!0)},Zt.prototype.eachShape=function(t){this.lock(),this.activeShapes.each(t),this.staticShapes.each(t),this.unlock(!0)},Zt.prototype.eachConstraint=function(t){this.lock();for(var e=this.constraints,i=0;i<e.length;i++)t(e[i]);this.unlock(!0)},Zt.prototype.reindexStatic=function(){c(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete."),this.staticShapes.each((function(t){var e=t.body;t.update(e.p,e.rot)})),this.staticShapes.reindex()},Zt.prototype.reindexShape=function(t){c(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete.");var e=t.body;t.update(e.p,e.rot),this.activeShapes.reindexObject(t,t.hashid),this.staticShapes.reindexObject(t,t.hashid)},Zt.prototype.reindexShapesForBody=function(t){for(var e=t.shapeList;e;e=e.next)this.reindexShape(e)},Zt.prototype.useSpatialHash=function(t,e){throw new Error("Spatial Hash not implemented.")},Zt.prototype.activateBody=function(t){if(c(!t.isRogue(),"Internal error: Attempting to activate a rogue body."),this.locked)-1===this.rousedBodies.indexOf(t)&&this.rousedBodies.push(t);else{this.bodies.push(t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.staticShapes.remove(i,i.hashid),this.activeShapes.insert(i,i.hashid)}for(var n=t.arbiterList;n;n=n.next(t))if(t===(a=n.body_a)||a.isStatic()){var o=n.a,r=n.b;this.cachedArbiters[h(o.hashid,r.hashid)]=n,n.stamp=this.stamp,n.handler=this.lookupHandler(o.collision_type,r.collision_type),this.arbiters.push(n)}for(var s=t.constraintList;s;s=s.nodeNext){var a=s.a;(t===a||a.isStatic())&&this.constraints.push(s)}}},Zt.prototype.deactivateBody=function(t){c(!t.isRogue(),"Internal error: Attempting to deactivate a rogue body."),l(this.bodies,t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.activeShapes.remove(i,i.hashid),this.staticShapes.insert(i,i.hashid)}for(var n=t.arbiterList;n;n=n.next(t))(t===(r=n.body_a)||r.isStatic())&&this.uncacheArbiter(n);for(var o=t.constraintList;o;o=o.nodeNext){var r=o.a;(t===r||r.isStatic())&&l(this.constraints,o)}};var $t=function(t){return t?t.nodeRoot:null},te=function(t){if(t&&t.isSleeping(t)){c(!t.isRogue(),"Internal Error: componentActivate() called on a rogue body.");for(var e=t.space,i=t;i;){var n=i.nodeNext;i.nodeIdleTime=0,i.nodeRoot=null,i.nodeNext=null,e.activateBody(i),i=n}l(e.sleepingComponents,t)}};st.prototype.activate=function(){this.isRogue()||(this.nodeIdleTime=0,te($t(this)))},st.prototype.activateStatic=function(t){c(this.isStatic(),"Body.activateStatic() called on a non-static body.");for(var e=this.arbiterList;e;e=e.next(this))t&&t!=e.a&&t!=e.b||(e.body_a==this?e.body_b:e.body_a).activate()},st.prototype.pushArbiter=function(t){a(null===(t.body_a===this?t.thread_a_next:t.thread_b_next),"Internal Error: Dangling contact graph pointers detected. (A)"),a(null===(t.body_a===this?t.thread_a_prev:t.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (B)");var e=this.arbiterList;a(null===e||null===(e.body_a===this?e.thread_a_prev:e.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (C)"),t.body_a===this?t.thread_a_next=e:t.thread_b_next=e,e&&(e.body_a===this?e.thread_a_prev=t:e.thread_b_prev=t),this.arbiterList=t};var ee=function(t,e){e.nodeRoot=t,e!==t&&(e.nodeNext=t.nodeNext,t.nodeNext=e)},ie=function(t,e){if(!e.isRogue()){var i=$t(e);if(null==i){ee(t,e);for(var n=e.arbiterList;n;n=n.next(e))ie(t,e==n.body_a?n.body_b:n.body_a);for(var o=e.constraintList;o;o=o.next(e))ie(t,e==o.a?o.b:o.a)}else a(i===t,"Internal Error: Inconsistency detected in the contact graph.")}},ne=function(t,e){for(var i=t;i;i=i.nodeNext)if(i.nodeIdleTime<e)return!0;return!1};Zt.prototype.processComponents=function(t){for(var e=this.sleepTimeThreshold!==1/0,i=this.bodies,n=0;n<i.length;n++){s=i[n];a(null===s.nodeNext,"Internal Error: Dangling next pointer detected in contact graph."),a(null===s.nodeRoot,"Internal Error: Dangling root pointer detected in contact graph.")}if(e)for(var o=this.idleSpeedThreshold,r=o?o*o:D(this.gravity)*t*t,n=0;n<i.length;n++){var s=i[n],c=r?s.m*r:0;s.nodeIdleTime=s.kineticEnergy()>c?0:s.nodeIdleTime+t}for(var h=this.arbiters,n=0,l=h.length;n<l;n++){var u=h[n],d=u.body_a,p=u.body_b;e&&((p.isRogue()&&!p.isStatic()||d.isSleeping())&&d.activate(),(d.isRogue()&&!d.isStatic()||p.isSleeping())&&p.activate()),d.pushArbiter(u),p.pushArbiter(u)}if(e){for(var _=this.constraints,n=0;n<_.length;n++){var f=_[n],d=f.a;(p=f.b).isRogue()&&!p.isStatic()&&d.activate(),d.isRogue()&&!d.isStatic()&&p.activate()}for(n=0;n<i.length;){s=i[n];if(null!==$t(s)||(ie(s,s),ne(s,this.sleepTimeThreshold)))n++,s.nodeRoot=null,s.nodeNext=null;else{this.sleepingComponents.push(s);for(var g=s;g;g=g.nodeNext)this.deactivateBody(g)}}}},st.prototype.sleep=function(){this.sleepWithGroup(null)},st.prototype.sleepWithGroup=function(t){c(!this.isStatic()&&!this.isRogue(),"Rogue and static bodies cannot be put to sleep.");var e=this.space;if(c(e,"Cannot put a rogue body to sleep."),c(!e.locked,"Bodies cannot be put to sleep during a query or a call to cpSpaceStep(). Put these calls into a post-step callback."),c(null===t||t.isSleeping(),"Cannot use a non-sleeping body as a group identifier."),this.isSleeping())c($t(this)===$t(t),"The body is already sleeping and it's group cannot be reassigned.");else{for(var i=0;i<this.shapeList.length;i++)this.shapeList[i].update(this.p,this.rot);if(e.deactivateBody(this),t){var n=$t(t);this.nodeRoot=n,this.nodeNext=n.nodeNext,this.nodeIdleTime=0,n.nodeNext=this}else this.nodeRoot=this,this.nodeNext=null,this.nodeIdleTime=0,e.sleepingComponents.push(this);l(e.bodies,this)}},Zt.prototype.activateShapesTouchingShape=function(t){this.sleepTimeThreshold!==1/0&&this.shapeQuery(t,(function(t,e){t.body.activate()}))},Zt.prototype.pointQuery=function(t,e,i,n){var o=function(o){(!o.group||i!==o.group)&&e&o.layers&&o.pointQuery(t)&&n(o)},r=new U(t.x,t.y,t.x,t.y);this.lock(),this.activeShapes.query(r,o),this.staticShapes.query(r,o),this.unlock(!0)},Zt.prototype.pointQueryFirst=function(t,e,i){var n=null;return this.pointQuery(t,e,i,(function(t){t.sensor||(n=t)})),n},Zt.prototype.nearestPointQuery=function(t,e,i,n,o){var r=function(r){if((!r.group||n!==r.group)&&i&r.layers){var s=r.nearestPointQuery(t);s.d<e&&o(r,s.d,s.p)}},s=Y(t,e);this.lock(),this.activeShapes.query(s,r),this.staticShapes.query(s,r),this.unlock(!0)},Zt.prototype.nearestPointQueryNearest=function(t,e,i,n){var o,r=function(r){if((!r.group||n!==r.group)&&i&r.layers&&!r.sensor){var s=r.nearestPointQuery(t);s.d<e&&(!o||s.d<o.d)&&(o=s)}},s=Y(t,e);return this.activeShapes.query(s,r),this.staticShapes.query(s,r),o},Zt.prototype.segmentQuery=function(t,e,i,n,o){var r=function(r){var s;return(!r.group||n!==r.group)&&i&r.layers&&(s=r.segmentQuery(t,e))&&o(r,s.t,s.n),1};this.lock(),this.staticShapes.segmentQuery(t,e,1,r),this.activeShapes.segmentQuery(t,e,1,r),this.unlock(!0)},Zt.prototype.segmentQueryFirst=function(t,e,i,n){var o=null,r=function(r){var s;return(!r.group||n!==r.group)&&i&r.layers&&!r.sensor&&(s=r.segmentQuery(t,e))&&(null===o||s.t<o.t)&&(o=s),o?o.t:1};return this.staticShapes.segmentQuery(t,e,1,r),this.activeShapes.segmentQuery(t,e,o?o.t:1,r),o},Zt.prototype.bbQuery=function(t,e,i,n){var o=function(o){(!o.group||i!==o.group)&&e&o.layers&&X(t,o.bb_l,o.bb_b,o.bb_r,o.bb_t)&&n(o)};this.lock(),this.activeShapes.query(t,o),this.staticShapes.query(t,o),this.unlock(!0)},Zt.prototype.shapeQuery=function(t,e){var i=t.body;i&&t.update(i.p,i.rot);var n=new U(t.bb_l,t.bb_b,t.bb_r,t.bb_t),o=!1,r=function(i){var n=t;if((!n.group||n.group!==i.group)&&n.layers&i.layers&&n!==i){var r;if(n.collisionCode<=i.collisionCode)r=qt(n,i);else{r=qt(i,n);for(c=0;c<r.length;c++)r[c].n=w(r[c].n)}if(r.length&&(o=!(n.sensor||i.sensor),e)){for(var s=new Array(r.length),c=0;c<r.length;c++)s[c]=new Dt(r[c].p,r[c].n,r[c].dist);e(i,s)}}};return this.lock(),this.activeShapes.query(n,r),this.staticShapes.query(n,r),this.unlock(!0),o},Zt.prototype.addPostStepCallback=function(t){a(this.locked,"Adding a post-step callback when the space is not locked is unnecessary. Post-step callbacks will not called until the end of the next call to cpSpaceStep() or the next query."),this.postStepCallbacks.push(t)},Zt.prototype.runPostStepCallbacks=function(){for(var t=0;t<this.postStepCallbacks.length;t++)this.postStepCallbacks[t]();this.postStepCallbacks=[]},Zt.prototype.lock=function(){this.locked++},Zt.prototype.unlock=function(t){if(this.locked--,c(this.locked>=0,"Internal Error: Space lock underflow."),0===this.locked&&t){for(var e=this.rousedBodies,i=0;i<e.length;i++)this.activateBody(e[i]);e.length=0,this.runPostStepCallbacks()}},Zt.prototype.makeCollideShapes=function(){var t=this;return function(e,i){var n=t;if(e.bb_l<=i.bb_r&&i.bb_l<=e.bb_r&&e.bb_b<=i.bb_t&&i.bb_b<=e.bb_t&&e.body!==i.body&&(!e.group||e.group!==i.group)&&e.layers&i.layers){var o=n.lookupHandler(e.collision_type,i.collision_type),r=e.sensor||i.sensor;if(!r||o!==Qt){if(e.collisionCode>i.collisionCode){var s=e;e=i,i=s}var c=qt(e,i);if(0!==c.length){var a=h(e.hashid,i.hashid),l=n.cachedArbiters[a];l||(l=n.cachedArbiters[a]=new Bt(e,i)),l.update(c,o,e,i),"first coll"!=l.state||o.begin(l,n)||l.ignore(),"ignore"!==l.state&&o.preSolve(l,n)&&!r?n.arbiters.push(l):(l.contacts=null,"ignore"!==l.state&&(l.state="normal")),l.stamp=n.stamp}}}}},Zt.prototype.arbiterSetFilter=function(t){var e=this.stamp-t.stamp,i=t.body_a,n=t.body_b;return!(!i.isStatic()&&!i.isSleeping()||!n.isStatic()&&!n.isSleeping())||(e>=1&&"cached"!=t.state&&(t.callSeparate(this),t.state="cached"),!(e>=this.collisionPersistence)||(t.contacts=null,!1))};var oe=function(t){var e=t.body;t.update(e.p,e.rot)};Zt.prototype.step=function(t){if(0!==t){c(0===b.x&&0===b.y,"vzero is invalid"),this.stamp++;var e=this.curr_dt;this.curr_dt=t;var i,n,o,r=this.bodies,s=this.constraints,a=this.arbiters;for(i=0;i<a.length;i++){var h=a[i];h.state="normal",h.body_a.isSleeping()||h.body_b.isSleeping()||h.unthread()}for(a.length=0,this.lock(),i=0;i<r.length;i++)r[i].position_func(t);this.activeShapes.each(oe),this.activeShapes.reindexQuery(this.collideShapes),this.unlock(!1),this.processComponents(t),this.lock();for(o in this.cachedArbiters)this.arbiterSetFilter(this.cachedArbiters[o])||delete this.cachedArbiters[o];var l=this.collisionSlop,u=1-Math.pow(this.collisionBias,t);for(i=0;i<a.length;i++)a[i].preStep(t,l,u);for(i=0;i<s.length;i++){var d=s[i];d.preSolve(this),d.preStep(t)}var p=Math.pow(this.damping,t),_=this.gravity;for(i=0;i<r.length;i++)r[i].velocity_func(_,p,t);var f=0===e?0:t/e;for(i=0;i<a.length;i++)a[i].applyCachedImpulse(f);for(i=0;i<s.length;i++)s[i].applyCachedImpulse(f);for(i=0;i<this.iterations;i++){for(n=0;n<a.length;n++)a[n].applyImpulse();for(n=0;n<s.length;n++)s[n].applyImpulse()}for(i=0;i<s.length;i++)s[i].postSolve(this);for(i=0;i<a.length;i++)a[i].handler.postSolve(a[i],this);this.unlock(!0)}};var re=function(t,e,i,n){var o=t.vx+-i.y*t.w,r=t.vy+i.x*t.w,s=e.vx+-n.y*e.w,c=e.vy+n.x*e.w;return new m(s-o,c-r)},se=function(t,e,i,n,o){var r=t.vx+-i.y*t.w,s=t.vy+i.x*t.w,c=e.vx+-n.y*e.w,a=e.vy+n.x*e.w;return T(c-r,a-s,o.x,o.y)},ce=function(t,e,i,n){t.vx+=e*t.m_inv,t.vy+=i*t.m_inv,t.w+=t.i_inv*(n.x*i-n.y*e)},ae=function(t,e,i,n,o,r){ce(t,-o,-r,i),ce(e,o,r,n)},he=function(t,e,i,n){t.v_biasx+=e*t.m_inv,t.v_biasy+=i*t.m_inv,t.w_bias+=t.i_inv*N(n.x,n.y,e,i)},le=function(t,e,i){var n=I(e,i);return t.m_inv+t.i_inv*n*n},ue=function(t,e,i,n,o){var r=le(t,i,o)+le(e,n,o);return a(0!==r,"Unsolvable collision or constraint."),r},de=function(t,e,i,n,o,r){var s,c,h,l,u=t.m_inv+e.m_inv;s=u,c=0,h=0,l=u;var d=t.i_inv,p=i.x*i.x*d,_=i.y*i.y*d,f=-i.x*i.y*d;s+=_,c+=f,h+=f,l+=p;var g=e.i_inv,v=n.x*n.x*g,y=n.y*n.y*g,m=-n.x*n.y*g,b=(s+=y)*(l+=v)-(c+=m)*(h+=m);a(0!==b,"Unsolvable constraint.");var C=1/b;o.x=l*C,o.y=-c*C,r.x=-h*C,r.y=s*C},pe=function(t,e,i){return new m(C(t,e),C(t,i))},_e=function(t,e){return 1-Math.pow(t,e)},fe=cp.Constraint=function(t,e){this.a=t,this.b=e,this.space=null,this.next_a=null,this.next_b=null,this.maxForce=1/0,this.errorBias=Math.pow(.9,60),this.maxBias=1/0};fe.prototype.activateBodies=function(){this.a&&this.a.activate(),this.b&&this.b.activate()},fe.prototype.preStep=function(t){},fe.prototype.applyCachedImpulse=function(t){},fe.prototype.applyImpulse=function(){},fe.prototype.getImpulse=function(){return 0},fe.prototype.preSolve=function(t){},fe.prototype.postSolve=function(t){},fe.prototype.next=function(t){return this.a===t?this.next_a:this.next_b};var ge=cp.PinJoint=function(t,e,i,n){fe.call(this,t,e),this.anchr1=i,this.anchr2=n;var o=t?x(t.p,P(i,t.rot)):i,r=e?x(e.p,P(n,e.rot)):n;this.dist=S(A(r,o)),a(this.dist>0,"You created a 0 length pin joint. A pivot joint will be much more stable."),this.r1=this.r2=null,this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};ge.prototype=Object.create(fe.prototype),ge.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=P(this.anchr1,e.rot),this.r2=P(this.anchr2,i.rot);var n=A(x(i.p,this.r2),x(e.p,this.r1)),o=S(n);this.n=O(n,1/(o||1/0)),this.nMass=1/ue(e,i,this.r1,this.r2,this.n);var r=this.maxBias;this.bias=v(-_e(this.errorBias,t)*(o-this.dist)/t,-r,r),this.jnMax=this.maxForce*t},ge.prototype.applyCachedImpulse=function(t){var e=O(this.n,this.jnAcc*t);ae(this.a,this.b,this.r1,this.r2,e.x,e.y)},ge.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=se(t,e,this.r1,this.r2,i),o=(this.bias-n)*this.nMass,r=this.jnAcc;this.jnAcc=v(r+o,-this.jnMax,this.jnMax),o=this.jnAcc-r,ae(t,e,this.r1,this.r2,i.x*o,i.y*o)},ge.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var ve=cp.SlideJoint=function(t,e,i,n,o,r){fe.call(this,t,e),this.anchr1=i,this.anchr2=n,this.min=o,this.max=r,this.r1=this.r2=this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};ve.prototype=Object.create(fe.prototype),ve.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=P(this.anchr1,e.rot),this.r2=P(this.anchr2,i.rot);var n=A(x(i.p,this.r2),x(e.p,this.r1)),o=S(n),r=0;o>this.max?(r=o-this.max,this.n=k(n)):o<this.min?(r=this.min-o,this.n=w(k(n))):(this.n=b,this.jnAcc=0),this.nMass=1/ue(e,i,this.r1,this.r2,this.n);var s=this.maxBias;this.bias=v(-_e(this.errorBias,t)*r/t,-s,s),this.jnMax=this.maxForce*t},ve.prototype.applyCachedImpulse=function(t){var e=this.jnAcc*t;ae(this.a,this.b,this.r1,this.r2,this.n.x*e,this.n.y*e)},ve.prototype.applyImpulse=function(){if(0!==this.n.x||0!==this.n.y){var t=this.a,e=this.b,i=this.n,n=this.r1,o=this.r2,r=re(t,e,n,o),s=C(r,i),c=(this.bias-s)*this.nMass,a=this.jnAcc;this.jnAcc=v(a+c,-this.jnMax,0),c=this.jnAcc-a,ae(t,e,this.r1,this.r2,i.x*c,i.y*c)}},ve.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var ye=cp.PivotJoint=function(i,n,o,r){if(fe.call(this,i,n),"undefined"===("object"==(e=typeof r)?t(r):e)){var s=o;o=i?i.world2Local(s):s,r=n?n.world2Local(s):s}this.anchr1=o,this.anchr2=r,this.r1=this.r2=b,this.k1=new m(0,0),this.k2=new m(0,0),this.jAcc=b,this.jMaxLen=0,this.bias=b};ye.prototype=Object.create(fe.prototype),ye.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=P(this.anchr1,e.rot),this.r2=P(this.anchr2,i.rot),de(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var n=A(x(i.p,this.r2),x(e.p,this.r1));this.bias=z(O(n,-_e(this.errorBias,t)/t),this.maxBias)},ye.prototype.applyCachedImpulse=function(t){ae(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},ye.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,o=re(t,e,i,n),r=pe(A(this.bias,o),this.k1,this.k2),s=this.jAcc;this.jAcc=z(x(this.jAcc,r),this.jMaxLen),ae(t,e,this.r1,this.r2,this.jAcc.x-s.x,this.jAcc.y-s.y)},ye.prototype.getImpulse=function(){return S(this.jAcc)};var me=cp.GrooveJoint=function(t,e,i,n,o){fe.call(this,t,e),this.grv_a=i,this.grv_b=n,this.grv_n=L(j(A(n,i))),this.anchr2=o,this.grv_tn=null,this.clamp=0,this.r1=this.r2=null,this.k1=new m(0,0),this.k2=new m(0,0),this.jAcc=b,this.jMaxLen=0,this.bias=null};me.prototype=Object.create(fe.prototype),me.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.local2World(this.grv_a),o=e.local2World(this.grv_b),r=P(this.grv_n,e.rot),s=C(n,r);this.grv_tn=r,this.r2=P(this.anchr2,i.rot);var c=I(x(i.p,this.r2),r);c<=I(n,r)?(this.clamp=1,this.r1=A(n,e.p)):c>=I(o,r)?(this.clamp=-1,this.r1=A(o,e.p)):(this.clamp=0,this.r1=A(x(O(L(r),-c),O(r,s)),e.p)),de(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var a=A(x(i.p,this.r2),x(e.p,this.r1));this.bias=z(O(a,-_e(this.errorBias,t)/t),this.maxBias)},me.prototype.applyCachedImpulse=function(t){ae(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},me.prototype.grooveConstrain=function(t){var e=this.grv_tn,i=this.clamp*I(t,e)>0?t:R(t,e);return z(i,this.jMaxLen)},me.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,o=re(t,e,i,n),r=pe(A(this.bias,o),this.k1,this.k2),s=this.jAcc;this.jAcc=this.grooveConstrain(x(s,r)),ae(t,e,this.r1,this.r2,this.jAcc.x-s.x,this.jAcc.y-s.y)},me.prototype.getImpulse=function(){return S(this.jAcc)},me.prototype.setGrooveA=function(t){this.grv_a=t,this.grv_n=L(j(A(this.grv_b,t))),this.activateBodies()},me.prototype.setGrooveB=function(t){this.grv_b=t,this.grv_n=L(j(A(t,this.grv_a))),this.activateBodies()};var be=function(t,e){return(t.restLength-e)*t.stiffness},Ce=cp.DampedSpring=function(t,e,i,n,o,r,s){fe.call(this,t,e),this.anchr1=i,this.anchr2=n,this.restLength=o,this.stiffness=r,this.damping=s,this.springForceFunc=be,this.target_vrn=this.v_coef=0,this.r1=this.r2=null,this.nMass=0,this.n=null};Ce.prototype=Object.create(fe.prototype),Ce.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=P(this.anchr1,e.rot),this.r2=P(this.anchr2,i.rot);var n=A(x(i.p,this.r2),x(e.p,this.r1)),o=S(n);this.n=O(n,1/(o||1/0));var r=ue(e,i,this.r1,this.r2,this.n);a(0!==r,"Unsolvable this."),this.nMass=1/r,this.target_vrn=0,this.v_coef=1-Math.exp(-this.damping*t*r);var s=this.springForceFunc(this,o);ae(e,i,this.r1,this.r2,this.n.x*s*t,this.n.y*s*t)},Ce.prototype.applyCachedImpulse=function(t){},Ce.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=this.r1,o=this.r2,r=se(t,e,n,o,i),s=(this.target_vrn-r)*this.v_coef;this.target_vrn=r+s,s*=this.nMass,ae(t,e,this.r1,this.r2,this.n.x*s,this.n.y*s)},Ce.prototype.getImpulse=function(){return 0};var Te=function(t,e){return(e-t.restAngle)*t.stiffness},Se=cp.DampedRotarySpring=function(t,e,i,n,o){fe.call(this,t,e),this.restAngle=i,this.stiffness=n,this.damping=o,this.springTorqueFunc=Te,this.target_wrn=0,this.w_coef=0,this.iSum=0};Se.prototype=Object.create(fe.prototype),Se.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.i_inv+i.i_inv;a(0!==n,"Unsolvable spring."),this.iSum=1/n,this.w_coef=1-Math.exp(-this.damping*t*n),this.target_wrn=0;var o=this.springTorqueFunc(this,e.a-i.a)*t;e.w-=o*e.i_inv,i.w+=o*i.i_inv},Se.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=t.w-e.w,n=(this.target_wrn-i)*this.w_coef;this.target_wrn=i+n;var o=n*this.iSum;t.w+=o*t.i_inv,e.w-=o*e.i_inv};var Ee=cp.RotaryLimitJoint=function(t,e,i,n){fe.call(this,t,e),this.min=i,this.max=n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Ee.prototype=Object.create(fe.prototype),Ee.prototype.preStep=function(t){var e=this.a,i=this.b,n=i.a-e.a,o=0;n>this.max?o=this.max-n:n<this.min&&(o=this.min-n),this.iSum=1/(1/e.i+1/i.i);var r=this.maxBias;this.bias=v(-_e(this.errorBias,t)*o/t,-r,r),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},Ee.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Ee.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=-(this.bias+i)*this.iSum,o=this.jAcc;this.bias<0?this.jAcc=v(o+n,0,this.jMax):this.jAcc=v(o+n,-this.jMax,0),n=this.jAcc-o,t.w-=n*t.i_inv,e.w+=n*e.i_inv}},Ee.prototype.getImpulse=function(){return Math.abs(joint.jAcc)};var xe=cp.RatchetJoint=function(t,e,i,n){fe.call(this,t,e),this.angle=0,this.phase=i,this.ratchet=n,this.angle=(e?e.a:0)-(t?t.a:0),this.iSum=this.bias=this.jAcc=this.jMax=0};xe.prototype=Object.create(fe.prototype),xe.prototype.preStep=function(t){var e=this.a,i=this.b,n=this.angle,o=this.phase,r=this.ratchet,s=i.a-e.a,c=n-s,a=0;c*r>0?a=c:this.angle=Math.floor((s-o)/r)*r+o,this.iSum=1/(e.i_inv+i.i_inv);var h=this.maxBias;this.bias=v(-_e(this.errorBias,t)*a/t,-h,h),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},xe.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},xe.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=this.ratchet,o=-(this.bias+i)*this.iSum,r=this.jAcc;this.jAcc=v((r+o)*n,0,this.jMax*Math.abs(n))/n,o=this.jAcc-r,t.w-=o*t.i_inv,e.w+=o*e.i_inv}},xe.prototype.getImpulse=function(t){return Math.abs(t.jAcc)};var Ae=cp.GearJoint=function(t,e,i,n){fe.call(this,t,e),this.phase=i,this.ratio=n,this.ratio_inv=1/n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Ae.prototype=Object.create(fe.prototype),Ae.prototype.preStep=function(t){var e=this.a,i=this.b;this.iSum=1/(e.i_inv*this.ratio_inv+this.ratio*i.i_inv);var n=this.maxBias;this.bias=v(-_e(this.errorBias,t)*(i.a*this.ratio-e.a-this.phase)/t,-n,n),this.jMax=this.maxForce*t},Ae.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv*this.ratio_inv,i.w+=n*i.i_inv},Ae.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w*this.ratio-t.w,n=(this.bias-i)*this.iSum,o=this.jAcc;this.jAcc=v(o+n,-this.jMax,this.jMax),n=this.jAcc-o,t.w-=n*t.i_inv*this.ratio_inv,e.w+=n*e.i_inv},Ae.prototype.getImpulse=function(){return Math.abs(this.jAcc)},Ae.prototype.setRatio=function(t){this.ratio=t,this.ratio_inv=1/t,this.activateBodies()};var we=cp.SimpleMotor=function(t,e,i){fe.call(this,t,e),this.rate=i,this.jAcc=0,this.iSum=this.jMax=0};we.prototype=Object.create(fe.prototype),we.prototype.preStep=function(t){this.iSum=1/(this.a.i_inv+this.b.i_inv),this.jMax=this.maxForce*t},we.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},we.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=-(e.w-t.w+this.rate)*this.iSum,n=this.jAcc;this.jAcc=v(n+i,-this.jMax,this.jMax),i=this.jAcc-n,t.w-=i*t.i_inv,e.w+=i*e.i_inv},we.prototype.getImpulse=function(){return Math.abs(this.jAcc)}}),{}],196:[(function(t,e,i){"use strict";function n(t,e){return"if(typeof "+t+'=="undefined")'+t+"="+e+";"}function o(t){return"typeof "+t+'=="object"'}var r=console.log;try{console.log=function(...t){r(cc.js.formatStr.apply(null,t))}}catch(t){}Function(n("CC_TEST",o("tap")+"||"+o("QUnit"))+n("CC_EDITOR",o("Editor")+"&&"+o("process")+'&&"electron" in process.versions')+n("CC_PREVIEW","!CC_EDITOR")+n("CC_DEV",!0)+n("CC_DEBUG",!0)+n("CC_JSB",o("jsb"))+n("CC_BUILD",!1))(),cc.ClassManager||(cc.ClassManager=window.ClassManager),t("../polyfill/misc"),t("../polyfill/typescript"),t("../cocos2d/core/platform/js"),t("../cocos2d/core/value-types"),t("../cocos2d/core/utils/find"),t("../cocos2d/core/utils/mutable-forward-iterator"),t("../cocos2d/core/event"),t("../cocos2d/core/event-manager/CCEvent"),t("../cocos2d/core/event-manager/CCSystemEvent"),t("../CCDebugger");var s=t("../cocos2d/core/platform/CCMacro");void 0!==window.__ENABLE_GC_FOR_NATIVE_OBJECTS__&&(s.ENABLE_GC_FOR_NATIVE_OBJECTS=window.__ENABLE_GC_FOR_NATIVE_OBJECTS__),t("./jsb-game"),t("./jsb-loader"),t("./jsb-director"),t("./jsb-tex-sprite-frame"),t("./jsb-scale9sprite"),t("./jsb-label"),t("./jsb-editbox"),t("./jsb-videoplayer"),t("./jsb-webview"),t("./jsb-particle"),t("./jsb-spine"),t("./jsb-enums"),t("./jsb-event"),t("./jsb-action"),t("./jsb-etc"),t("./jsb-audio"),t("./jsb-tiledmap"),t("./jsb-box2d"),t("./jsb-dragonbones"),t("../extends")}),{"../CCDebugger":1,"../DebugInfos":2,"../cocos2d/core/event":86,"../cocos2d/core/event-manager/CCEvent":81,"../cocos2d/core/event-manager/CCSystemEvent":82,"../cocos2d/core/platform/CCMacro":139,"../cocos2d/core/platform/js":151,"../cocos2d/core/utils/find":161,"../cocos2d/core/utils/mutable-forward-iterator":163,"../cocos2d/core/value-types":175,"../extends":184,"../polyfill/misc":216,"../polyfill/typescript":217,"./jsb-action":197,"./jsb-audio":198,"./jsb-box2d":199,"./jsb-director":200,"./jsb-dragonbones":201,"./jsb-editbox":202,"./jsb-enums":203,"./jsb-etc":204,"./jsb-event":205,"./jsb-game":206,"./jsb-label":207,"./jsb-loader":208,"./jsb-particle":209,"./jsb-scale9sprite":210,"./jsb-spine":211,"./jsb-tex-sprite-frame":212,"./jsb-tiledmap":213,"./jsb-videoplayer":214,"./jsb-webview":215}],197:[(function(t,e,i){function n(t,e,i){if(t)for(var n=t._owner.getComponentsInChildren(cc._SGComponent),o=0;o<n.length;++o){var r=n[o];r.enabled=e?!r.enabled:i}}function o(t,e){var i=t[e];t[e]=function(...t){this._retained&&(this.release(),this._retained=!1);var e=i.apply(this,t);return e.retain(),e._retained=!0,e}}function r(t){return t instanceof cc.Component?t=t.node._sgNode:t instanceof cc.Node?t=t._sgNode:t instanceof _ccsg.Node||(t=null),t}function s(t){this._jsbUpdate(t);var e=this._getSgTarget();e._owner&&(e._owner.x=e.getPositionX(),e._owner.y=e.getPositionY())}function c(t){this._jsbUpdate(t);var e=this._getSgTarget();e._owner&&(e._owner.rotationX=e.getRotationX(),e._owner.rotationY=e.getRotationY())}function a(t){this._jsbUpdate(t);var e=this._getSgTarget();e._owner&&(e._owner.opacity=e.getOpacity())}function h(t){this._jsbUpdate(t);var e=this._getSgTarget();if(e._owner){var i=e.getColor();e._owner.color=i}}var l=cc.macro.ENABLE_GC_FOR_NATIVE_OBJECTS,u=["ActionEase","EaseExponentialIn","EaseExponentialOut","EaseExponentialInOut","EaseSineIn","EaseSineOut","EaseSineInOut","EaseBounce","EaseBounceIn","EaseBounceOut","EaseBounceInOut","EaseBackIn","EaseBackOut","EaseBackInOut","EaseRateAction","EaseIn","EaseElastic","EaseElasticIn","EaseElasticOut","EaseElasticInOut","RemoveSelf","FlipX","FlipY","Place","CallFunc","DelayTime","Speed","Repeat","RepeatForever","TargetedAction","ActionInterval","RotateTo","RotateBy","MoveBy","MoveTo","SkewTo","SkewBy","JumpTo","JumpBy","ScaleTo","ScaleBy","Blink","FadeTo","FadeIn","FadeOut","TintTo","TintBy"];if(cc.Action.prototype._getSgTarget=cc.Action.prototype.getTarget,cc.Action.prototype.getTarget=function(){var t=this._getSgTarget();return t._owner||t},!l)for(m=0;m<u.length;++m){var d=u[m],p=cc[d];p&&(!(function(t){var e=t._ctor;t._ctor=function(...t){e.apply(this,t),this.retain(),this._retained=!0}})(p.prototype),-1===d.indexOf("Ease")&&(function(t,e){var i=t[0].toLowerCase()+t.substr(1);cc[i]=function(...t){var i=e.create.apply(this,t);return i.retain(),i._retained=!0,i}})(d,p))}cc.Sequence.prototype._ctor=function(...t){var e=t[0]instanceof Array?t[0]:t;if(1!==e.length){var i=e.length-1;i>=0&&null==e[i]&&cc.logID(1015),i>=0&&this.init(e),l||(this.retain(),this._retained=!0)}else cc.errorID(1019)},cc.sequence=function(...t){var e=t[0]instanceof Array?t[0]:t;return new cc.Sequence(e)},cc.Spawn.prototype._ctor=function(...t){var e=t[0]instanceof Array?t[0]:t;1===e.length&&cc.errorID(1020);var i=e.length-1;i>=0&&null==e[i]&&cc.logID(1015),i>=0&&this.init(e),l||(this.retain(),this._retained=!0)},cc.spawn=function(...t){var e=t[0]instanceof Array?t[0]:t;return new cc.Spawn(e)},cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)},cc.TargetedAction.prototype._ctor=function(t,e){var i=t._sgNode||t;i._owner=t,e&&this.initWithTarget(i,e)},cc.follow=function(t,e){return new cc.Follow(t,e)},cc.Follow=cc.BaseJSAction.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(t,e){cc.BaseJSAction.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))},clone:function(){var t=new cc.Follow,e=this._worldRect,i=new cc.Rect(e.x,e.y,e.width,e.height);return t.initWithTarget(this._followedNode,i),t},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(t){this._boundarySet=t},initWithTarget:function(t,e){if(!t)throw new Error("cc.Follow.initWithAction(): followedNode must be non nil");var i=this;e=e||cc.rect(0,0,0,0),i._followedNode=t,i._worldRect=e,i._boundarySet=!cc._rectEqualToZero(e),i._boundaryFullyCovered=!1;var n=cc.director.getWinSize();return i._fullScreenSize=cc.p(n.width,n.height),i._halfScreenSize=cc.pMult(i._fullScreenSize,.5),i._boundarySet&&(i.leftBoundary=-(e.x+e.width-i._fullScreenSize.x),i.rightBoundary=-e.x,i.topBoundary=-e.y,i.bottomBoundary=-(e.y+e.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary&&(i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2),i.topBoundary<i.bottomBoundary&&(i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2),i.topBoundary===i.bottomBoundary&&i.leftBoundary===i.rightBoundary&&(i._boundaryFullyCovered=!0)),!0},step:function(t){var e=this.getTarget(),i=e.convertToWorldSpaceAR(cc.Vec2.ZERO),n=this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO),o=cc.pSub(i,n),r=e.parent.convertToNodeSpaceAR(cc.pAdd(o,this._halfScreenSize));if(this._boundarySet){if(this._boundaryFullyCovered)return;e.setPosition(cc.clampf(r.x,this.leftBoundary,this.rightBoundary),cc.clampf(r.y,this.bottomBoundary,this.topBoundary))}else e.setPosition(r.x,r.y)},isDone:function(){return!this._followedNode.isRunning()},stop:function(){this.setTarget(null),cc.Action.prototype.stop.call(this)}});var _=cc.FlipX;cc.FlipX=_.extend({_flippedX:!1,ctor:function(t){_.prototype.ctor.call(this),this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=!!t,!0},update:function(t){var e=this._getSgTarget();e.scaleX=Math.abs(e.scaleX)*(this._flippedX?-1:1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){return new cc.FlipX(this._flippedX)}}),cc.flipX=function(t){return new cc.FlipX(t)};var f=cc.FlipY;if(cc.FlipY=f.extend({_flippedY:!1,ctor:function(t){f.prototype.ctor.call(this),this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=!!t,!0},update:function(t){var e=this._getSgTarget();e.scaleY=Math.abs(e.scaleY)*(this._flippedY?-1:1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){return new cc.FlipY(this._flippedY)}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.Show.prototype.update=function(t){n(this._getSgTarget(),!1,!0)},cc.Hide.prototype.update=function(t){n(this._getSgTarget(),!1,!1)},cc.ToggleVisibility.prototype.update=function(t){n(this._getSgTarget(),!0)},cc.callFunc=function(t,e,i){var n=function(e){e&&(e=e._owner||e),t.call(this,e,i)},o=e?cc.CallFunc.create(n,e):cc.CallFunc.create(n);return l||(o.retain(),o._retained=!0),o},cc.CallFunc.prototype._ctor=function(t,e,i){if(void 0!==t){var n=function(e){e&&(e=e._owner||e),t.call(this,e,i)};void 0===e?this.initWithFunction(n):this.initWithFunction(n,e)}l||(this.retain(),this._retained=!0)},!l){o(cc.ActionInterval.prototype,"repeat"),o(cc.ActionInterval.prototype,"repeatForever"),o(cc.ActionInterval.prototype,"easing");var g=cc.Node.prototype.runAction;cc.Node.prototype.runAction=function(t){return g.call(this,t),t._retained&&(t.release(),t._retained=!1),t}}var v=cc.ActionManager.prototype.addAction;cc.ActionManager.prototype.addAction=function(t,e,i){(e=r(e))&&(v.call(this,t,e,i),!l&&t._retained&&(t.release(),t._retained=!1))};for(var y=[["removeAllActionsFromTarget",0],["removeActionByTag",1],["getActionByTag",1],["getNumberOfRunningActionsInTarget",0],["pauseTarget",0],["resumeTarget",0]],m=0;m<y.length;++m)(function(t,e){var i=cc.ActionManager.prototype,n=i[t];i[t]=function(...t){for(var i=0;i<t.length;i++)i===e&&(t[i]=r(t[i]));return t[e]?n.apply(this,t):void 0}}).apply(null,y[m]);cc.ActionManager.prototype.resumeTargets=function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.resumeTarget(t[e])},cc.ActionManager.prototype.pauseTargets=function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.pauseTarget(t[e])};var b={MoveBy:s,JumpBy:s,Place:s,CardinalSplineTo:s,RotateTo:c,RotateBy:c,ScaleTo:function(t){this._jsbUpdate(t);var e=this._getSgTarget();e._owner&&(e._owner.scaleX=e.getScaleX(),e._owner.scaleY=e.getScaleY())},RemoveSelf:function(t){this._jsbUpdate(t);var e=this._getSgTarget();e._owner&&e._owner.removeFromParent()},SkewTo:function(t){this._jsbUpdate(t);var e=this._getSgTarget();e._owner&&(e._owner.skewX=e.getSkewX(),e._owner.skewY=e.getSkewY())},Blink:a,FadeIn:a,FadeOut:a,FadeTo:a,TintTo:h,TintBy:h,BezierBy:s};for(var C in b){var T=cc[C];T.prototype._jsbUpdate=T.prototype.update,T.prototype.update=b[C]}}),{}],198:[(function(t,e,i){cc.Audio=function(t){this.src=t,this.volume=1,this.loop=!1,this.id=-1,this._eventList={},this.type=cc.Audio.Type.NATIVE},cc.Audio.Type={DOM:"AUDIO",WEBAUDIO:"WEBAUDIO",NATIVE:"NATIVE",UNKNOWN:"UNKNOWN"},(function(e,i){cc.audioEngine=i,i.play=i.play2d,i.setMaxWebAudioSize=function(){};var n=t("../cocos2d/audio/deprecated");n.removed(i),n.deprecated(i),e.State=i.AudioState,e.play=function(){i.stop(this.id),this.id=i.play2d(this.src,this.loop,this.volume)},e.pause=function(){i.pause(this.id)},e.resume=function(){i.resume(this.id)},e.stop=function(){i.stop(this.id)},e.setLoop=function(t){this.loop=t,i.setLoop(this.id,t)},e.getLoop=function(){return i.getLoop(this.id)},e.setVolume=function(t){return this.volume=t,i.setVolume(this.id,t)},e.getVolume=function(){return i.getVolume(this.id)},e.setCurrentTime=function(t){i.setCurrentTime(this.id,t)},e.getCurrentTime=function(){return i.getCurrentTime(this.id)},e.getDuration=function(){return i.getDuration(this.id)},e.getState=function(){return i.getState(this.id)},e.preload=function(){this._loaded=!0,this.emit("load")},e.on=function(t,e){var i=this._eventList[t];i||(i=this._eventList[t]=[]),i.push(e)},e.once=function(t,e){var i=function(n){e.call(this,n),this.off(t,i)};this.on(t,i)},e.emit=function(t){var e=this._eventList[t];if(e)for(var i=0;i<e.length;i++)e[i].call(this,this)},e.off=function(t,e){var i=this._eventList[t];if(!i)return!1;if(!e)return this._eventList[t]=[],!0;for(var n=0;n<i.length;n++)if(i[n]===e){i.splice(n,1);break}return!0}})(cc.Audio.prototype,jsb.AudioEngine)}),{"../cocos2d/audio/deprecated":22}],199:[(function(t,e,i){!(function(){window.b2||(window.b2={});var t=b2.Vec2=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e};t.Make=function(e,i){return void 0===e&&(e=0),void 0===i&&(i=0),new t(e,i)},t.prototype.SetZero=function(){this.x=0,this.y=0},t.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},t.prototype.SetV=function(t){this.x=t.x,this.y=t.y},t.prototype.GetNegative=function(){return new t(-this.x,-this.y)},t.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},t.prototype.Copy=function(){return new t(this.x,this.y)},t.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},t.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},t.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},t.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y,this.y=-t*e},t.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y,this.y=t*e},t.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},t.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},t.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},t.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},t.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},t.prototype.IsValid=function(){return t.IsValid(this.x)&&t.IsValid(this.y)};var e=b2.AABB=function(){this.lowerBound=new t,this.upperBound=new t};e.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=t>=0&&e>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},e.prototype.GetCenter=function(){return new t((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},e.prototype.GetExtents=function(){return new t((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},e.prototype.Contains=function(t){var e=!0;return e=e&&this.lowerBound.x<=t.lowerBound.x,e=e&&this.lowerBound.y<=t.lowerBound.y,e=e&&t.upperBound.x<=this.upperBound.x,e=e&&t.upperBound.y<=this.upperBound.y},e.prototype.RayCast=function(t,e){var i=-Number.MAX_VALUE,n=Number.MAX_VALUE,o=e.p1.x,r=e.p1.y,s=e.p2.x-e.p1.x,c=e.p2.y-e.p1.y,a=Math.abs(s),h=Math.abs(c),l=t.normal,u=0,d=0,p=0,_=0,f=0;if(a<Number.MIN_VALUE){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else if(u=1/s,d=(this.lowerBound.x-o)*u,p=(this.upperBound.x-o)*u,f=-1,d>p&&(_=d,d=p,p=_,f=1),d>i&&(l.x=f,l.y=0,i=d),n=Math.min(n,p),i>n)return!1;if(h<Number.MIN_VALUE){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else if(u=1/c,d=(this.lowerBound.y-r)*u,p=(this.upperBound.y-r)*u,f=-1,d>p&&(_=d,d=p,p=_,f=1),d>i&&(l.y=f,l.x=0,i=d),n=Math.min(n,p),i>n)return!1;return t.fraction=i,!0},e.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,o=this.lowerBound.y-t.upperBound.y;return!(e>0||i>0)&&!(n>0||o>0)},e.Combine=function(t,i){var n=new e;return n.Combine(t,i),n},e.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)};var i=b2.FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0};i.prototype.Copy=function(){var t=new i;return t.categoryBits=this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},b2.FixtureDef=function(){this.filter=new i,this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1},b2.BodyDef=function(){this.position=new t(0,0),this.linearVelocity=new t(0,0),this.userData=null,this.angle=0,this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=b2.Body.b2_staticBody,this.active=!0,this.inertiaScale=1,this.gravityScale=1},b2.JointDef=function(){this.type=b2.Joint.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},b2.DistanceJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_distanceJoint,this.localAnchorA=new t,this.localAnchorB=new t,this.length=1,this.frequencyHz=0,this.dampingRatio=0},b2.FrictionJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_frictionJoint,this.localAnchorA=new t,this.localAnchorB=new t,this.maxForce=0,this.maxTorque=0},b2.GearJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},b2.MotorJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_motorJoint,this.linearOffset=new t,this.angularOffset=0,this.maxForce=1,this.maxTorque=1,this.correctionFactor=.3},b2.MouseJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_mouseJoint,this.target=new t,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},b2.PrismaticJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_prismaticJoint,this.localAnchorA=new t,this.localAnchorB=new t,this.localAxisA=new t(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},b2.PulleyJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_pulleyJoint,this.groundAnchorA=new t(-1,1),this.groundAnchorB=new t(1,1),this.localAnchorA=new t(-1,0),this.localAnchorB=new t(1,0),this.lengthA=0,this.lengthB=0,this.ratio=1,this.collideConnected=!0},b2.RevoluteJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_revoluteJoint,this.localAnchorA=new t(0,0),this.localAnchorB=new t(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},b2.RopeJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_ropeJoint,this.localAnchorA=new t(-1,0),this.localAnchorB=new t(1,0),this.maxLength=0},b2.WeldJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_weldJoint,this.localAnchorA=new t(0,0),this.localAnchorB=new t(0,0),this.referenceAngle=0,this.frequencyHz=0,this.dampingRatio=0},b2.WheelJointDef=function(){b2.JointDef.apply(this,arguments),this.type=b2.Joint.e_wheelJoint,this.localAnchorA=new t,this.localAnchorB=new t,this.localAxisA=new t(1,0),this.enableMotor=!1,this.maxMotorTorque=0,this.motorSpeed=0,this.frequencyHz=2,this.dampingRatio=.7},b2.WorldManifold=function(){this.normal=new b2.Vec2,this.points=[],this.separations=[]};var n=b2.Shape.prototype;cc.defineGetterSetter(n,"m_radius",n.GetRadius,n.SetRadius),n=b2.CircleShape.prototype,cc.defineGetterSetter(n,"m_p",n.GetPosition,n.SetPosition),b2.Body.b2_staticBody=0,b2.Body.b2_kinematicBody=1,b2.Body.b2_dynamicBody=2,b2.Draw.e_shapeBit=1,b2.Draw.e_jointBit=2,b2.Draw.e_aabbBit=4,b2.Draw.e_pairBit=8,b2.Draw.e_centerOfMassBit=16,b2.Joint.e_unknownJoint=0,b2.Joint.e_revoluteJoint=1,b2.Joint.e_prismaticJoint=2,b2.Joint.e_distanceJoint=3,b2.Joint.e_pulleyJoint=4,b2.Joint.e_mouseJoint=5,b2.Joint.e_gearJoint=6,b2.Joint.e_wheelJoint=7,b2.Joint.e_weldJoint=8,b2.Joint.e_frictionJoint=9,b2.Joint.e_ropeJoint=10,b2.Joint.e_motorJoint=11,b2.Joint.e_inactiveLimit=0,b2.Joint.e_atLowerLimit=1,b2.Joint.e_atUpperLimit=2,b2.Joint.e_equalLimits=3,b2.maxPolygonVertices=8,b2.maxManifoldPoints=2})()}),{}],200:[(function(i,n,o){"use strict";var r=i("../cocos2d/core/load-pipeline/auto-release-utils"),s=i("../cocos2d/core/component-scheduler"),c=i("../cocos2d/core/node-activator"),a=i("../cocos2d/core/event/event-listeners");cc.director._purgeDirector=cc.director.purgeDirector,cc.js.mixin(cc.director,{sharedInit:function(){this._compScheduler=new s,this._nodeActivator=new c;var t=this.getScheduler();cc.AnimationManager?(this._animationManager=new cc.AnimationManager,t.scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._animationManager=null,cc.CollisionManager?(this._collisionManager=new cc.CollisionManager,t.scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._collisionManager=null,cc.PhysicsManager?(this._physicsManager=new cc.PhysicsManager,this.getScheduler().scheduleUpdate(this._physicsManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._physicsManager=null,cc._widgetManager.init(this)},purgeDirector:function(){this._compScheduler.unscheduleAll(),this._nodeActivator.reset(),this._purgeDirector()},reset:function(){this.purgeDirector(),cc.eventManager&&cc.eventManager.setEnabled(!0),this._animationManager&&this.getScheduler().scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._collisionManager&&this.getScheduler().scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._physicsManager&&this.getScheduler().scheduleUpdate(this._physicsManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this.startAnimation()},getActionManager:function(){return this._actionManager},setActionManager:function(t){this._actionManager!==t&&(this._actionManager&&this._scheduler.unscheduleUpdate(this._actionManager),this._actionManager=t,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1))},getAnimationManager:function(){return this._animationManager},getCollisionManager:function(){return this._collisionManager},getPhysicsManager:function(){return this._physicsManager},getScene:function(){return this._scene},runSceneImmediate:function(t,e,i){var n=window.console;t instanceof cc.Scene&&(n.time("I"),t._load(),n.timeEnd("I"));for(var o=cc.game,s=Object.keys(o._persistRootNodes).map((function(t){return o._persistRootNodes[t]})),c=0;c<s.length;c++){var a=s[c];o._ignoreRemovePersistNode=a,a.parent=null,o._ignoreRemovePersistNode=null}var h=this._scene;n.time("AR");var l=h&&h.autoReleaseAssets&&h.dependAssets;r.autoRelease(l,t.dependAssets,s),n.timeEnd("AR"),n.time("D"),cc.isValid(h)&&h.destroy(),this._scene=null,cc.Object._deferredDestroy(),n.timeEnd("D"),e&&e(),this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,t);var u=t;if(t instanceof cc.Scene){this._scene=t,u=t._sgNode,n.time("AP");for(var d=0;d<s.length;d++){var p=s[d],_=t.getChildByUuid(p.uuid);if(_){var f=_.getSiblingIndex();_._destroyImmediate(),t.insertChild(p,f)}else p.parent=t}n.timeEnd("AP"),n.time("A"),t._activate(),n.timeEnd("A")}this.getRunningScene()?this.replaceScene(u):this.runWithScene(u),i&&i(null,t),this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH,t)},runScene:function(t,e,i){cc.assertID(t,1205),t instanceof cc.Scene&&t._load(),this.once(cc.Director.EVENT_AFTER_UPDATE,(function(){this.runSceneImmediate(t,e,i)}))},_getSceneUuid:function(i){var n=cc.game._sceneInfos;if("string"===("object"==(e=typeof i)?t(i):e)){i.endsWith(".fire")||(i+=".fire"),"/"===i[0]||i.startsWith("db://assets/")||(i="/"+i);for(var o=0;o<n.length;o++){var r=n[o];if(r.url.endsWith(i))return r}}else if("number"===("object"==(e=typeof i)?t(i):e)){if(0<=i&&i<n.length)return n[i];cc.errorID(1211,i)}else cc.errorID(1212,i);return null},setRuntimeLaunchScene:function(t){var e=this._getSceneUuid(t);this._launchSceneUuid=e.uuid},loadScene:function(t,e,i){if(this._loadingScene)return cc.errorID(1213,t,this._loadingScene),!1;var n=this._getSceneUuid(t);if(n){var o=n.uuid;if(this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),this._loadingScene=t,cc.runtime&&o!==this._launchSceneUuid){var r=this,s=cc.path.basename(n.url)+"_"+n.uuid;console.log("==> start preload: "+s);var c=!1;cc.LoaderLayer.preload([s],(function(){console.log("==> end preload: "+s),c?r._loadSceneByUuid(o,e,i):setTimeout((function(){r._loadSceneByUuid(o,e,i)}),0)})),c=!0}else this._loadSceneByUuid(o,e,i);return!0}return cc.errorID(1214,t),!1},preloadScene:function(t,e){var i=this._getSceneUuid(t);if(i)this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),cc.loader.load({uuid:i.uuid,type:"uuid"},(function(i,n){i&&cc.errorID(1215,t,i.message),e&&e(i,n)}));else{var n='Can not preload the scene "'+t+'" because it is not in the build settings.';e(new Error(n)),cc.error("preloadScene: "+n)}},_loadSceneByUuid:function(t,e,i,n){console.time("LoadScene "+t),cc.AssetLibrary.loadAsset(t,(function(n,o){console.timeEnd("LoadScene "+t);var r=cc.director;if(r._loadingScene="",n)n="Failed to load scene: "+n,cc.error(n);else{if(o instanceof cc.SceneAsset){var s=o.scene;return s._id=o._uuid,s._name=o._name,void r.runSceneImmediate(s,i,e)}n="The asset "+t+" is not a scene",cc.error(n)}e&&e(n)}))},__fastOn:function(t,e,i){var n=this._bubblingListeners;n||(n=this._bubblingListeners=new a),n.add(t,e,i)},__fastOff:function(t,e,i){var n=this._bubblingListeners;n&&n.remove(t,e,i)}}),cc.defineGetterSetter(cc.director,"actionManager",cc.director.getActionManager,cc.director.setActionManager),cc.EventTarget.call(cc.director),cc.js.addon(cc.director,cc.EventTarget.prototype),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.Director.EVENT_BEFORE_VISIT="director_before_visit",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_BEFORE_UPDATE="director_before_update",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_BEFORE_SCENE_LOADING="director_before_scene_loading",cc.Director.EVENT_BEFORE_SCENE_LAUNCH="director_before_scene_launch",cc.Director.EVENT_AFTER_SCENE_LAUNCH="director_after_scene_launch",cc.Director._EVENT_NEXT_TICK="_director_next_tick",cc.Director._beforeUpdateListener={event:cc.EventListener.CUSTOM,eventName:cc.Director.EVENT_BEFORE_UPDATE,callback:function(){cc.director.emit(cc.Director._EVENT_NEXT_TICK),cc.director.emit(cc.Director.EVENT_BEFORE_UPDATE),cc.director._compScheduler.startPhase();var t=cc.director.getDeltaTime();cc.director._compScheduler.updatePhase(t)}},cc.Director._afterUpdateListener={event:cc.EventListener.CUSTOM,eventName:cc.Director.EVENT_AFTER_UPDATE,callback:function(){var t=cc.director.getDeltaTime();cc.director._compScheduler.lateUpdatePhase(t),cc.director.emit(cc.Director.EVENT_AFTER_UPDATE),cc.Object._deferredDestroy(),cc.director.emit(cc.Director.EVENT_BEFORE_VISIT,this)}},cc.Director._afterVisitListener={event:cc.EventListener.CUSTOM,eventName:cc.Director.EVENT_AFTER_VISIT,callback:function(){cc.director.emit(cc.Director.EVENT_AFTER_VISIT,this)}},cc.Director._afterDrawListener={event:cc.EventListener.CUSTOM,eventName:cc.Director.EVENT_AFTER_DRAW,callback:function(){cc.director.emit(cc.Director.EVENT_AFTER_DRAW,this)}},cc.eventManager.addEventListenerWithFixedPriority(cc.EventListener.create(cc.Director._beforeUpdateListener),1),cc.eventManager.addEventListenerWithFixedPriority(cc.EventListener.create(cc.Director._afterUpdateListener),1),cc.eventManager.addEventListenerWithFixedPriority(cc.EventListener.create(cc.Director._afterVisitListener),1),cc.eventManager.addEventListenerWithFixedPriority(cc.EventListener.create(cc.Director._afterDrawListener),1)}),{"../cocos2d/core/component-scheduler":47,"../cocos2d/core/event/event-listeners":83,"../cocos2d/core/load-pipeline/auto-release-utils":101,"../cocos2d/core/node-activator":113}],201:[(function(t,e,i){var n=dragonBones.CCArmatureDisplay.prototype;cc.js.mixin(n,cc.EventTarget.prototype),n.addEvent=function(t,e,i){if(!this.hasEventCallback()){var n=this;this.setEventCallback((function(t){n.emit(t.type,t)}))}this.on(t,e,i)};var o=[dragonBones.EventObject.START,dragonBones.EventObject.LOOP_COMPLETE,dragonBones.EventObject.COMPLETE,dragonBones.EventObject.FADE_IN,dragonBones.EventObject.FADE_IN_COMPLETE,dragonBones.EventObject.FADE_OUT,dragonBones.EventObject.FADE_OUT_COMPLETE,dragonBones.EventObject.FRAME_EVENT,dragonBones.EventObject.SOUND_EVENT];n.removeEvent=function(t,e,i){this.off(t,e,i);for(var n=!0,r=0,s=o.length;r<s;r++){var c=o[r];if(this.hasEventListener(c)){n=!1;break}}n&&this.clearEventCallback()};var r=dragonBones.Armature.prototype;r.addEventListener=function(t,e,i){var n=this.display;jsb.registerNativeRef(this,n),n.addEvent(t,e,i)},r.removeEventListener=function(t,e,i){var n=this.display;jsb.unregisterNativeRef(this,n),n.removeEvent(t,e,i)}}),{}],202:[(function(t,e,i){"use strict";var n=cc.EditBox.prototype;n._setMaxLength=n.setMaxLength,n.setMaxLength=function(t){t<0&&(t=65535),this._setMaxLength(t)},cc.defineGetterSetter(n,"font",null,n.setFont),cc.defineGetterSetter(n,"fontName",null,n.setFontName),cc.defineGetterSetter(n,"fontSize",null,n.setFontSize),cc.defineGetterSetter(n,"fontColor",null,n.setFontColor),cc.defineGetterSetter(n,"string",n.getString,n.setString),cc.defineGetterSetter(n,"maxLength",n.getMaxLength,n.setMaxLength),cc.defineGetterSetter(n,"placeholder",n.getPlaceHolder,n.setPlaceHolder),cc.defineGetterSetter(n,"placeholderFont",null,n.setPlaceholderFont),cc.defineGetterSetter(n,"placeholderFontName",null,n.setPlaceholderFontName),cc.defineGetterSetter(n,"placeholderFontSize",null,n.setPlaceholderFontSize),cc.defineGetterSetter(n,"placeholderFontColor",null,n.setPlaceholderFontColor),cc.defineGetterSetter(n,"inputFlag",null,n.setInputFlag),cc.defineGetterSetter(n,"delegate",null,n.setDelegate),cc.defineGetterSetter(n,"inputMode",null,n.setInputMode),cc.defineGetterSetter(n,"returnType",null,n.setReturnType),n.setLineHeight=function(){},n.setTabIndex=function(){},n.getTabIndex=function(){return-1},n.setFocus=function(){},n.isFocused=function(){return!1},n.stayOnTop=function(){}}),{}],203:[(function(t,e,i){"use strict";cc.sys.os!==cc.sys.OS_OSX&&cc.sys.os!==cc.sys.OS_WINDOWS||(cc.VideoPlayer={}),cc.sys.os!==cc.sys.OS_OSX&&cc.sys.os!==cc.sys.OS_WINDOWS||(cc.WebView={}),cc.VideoPlayer.EventType={PLAYING:0,PAUSED:1,STOPPED:2,COMPLETED:3,META_LOADED:4,CLICKED:5,READY_TO_PLAY:6},cc.WebView.EventType={LOADING:0,LOADED:1,ERROR:2,JS_EVALUATED:3},cc.EditBox.InputMode=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6}),cc.EditBox.InputFlag=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4,DEFAULT:5}),cc.EditBox.KeyboardReturnType=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4}),cc.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),ccui.RelativeLayoutParameter.Type=cc.Enum({NONE:0,PARENT_TOP_LEFT:1,PARENT_TOP_CENTER_HORIZONTAL:2,PARENT_TOP_RIGHT:3,PARENT_LEFT_CENTER_VERTICAL:4,CENTER_IN_PARENT:5,PARENT_RIGHT_CENTER_VERTICAL:6,PARENT_LEFT_BOTTOM:7,PARENT_BOTTOM_CENTER_HORIZONTAL:8,PARENT_RIGHT_BOTTOM:9,LOCATION_ABOVE_LEFTALIGN:10,LOCATION_ABOVE_CENTER:11,LOCATION_ABOVE_RIGHTALIGN:12,LOCATION_LEFT_OF_TOPALIGN:13,LOCATION_LEFT_OF_CENTER:14,LOCATION_LEFT_OF_BOTTOMALIGN:15,LOCATION_RIGHT_OF_TOPALIGN:16,LOCATION_RIGHT_OF_CENTER:17,LOCATION_RIGHT_OF_BOTTOMALIGN:18,LOCATION_BELOW_LEFTALIGN:19,LOCATION_BELOW_CENTER:20,LOCATION_BELOW_RIGHTALIGN:21}),ccui.Layout.Type=cc.Enum({ABSOLUTE:0,LINEAR_VERTICAL:1,LINEAR_HORIZONTAL:2,RELATIVE:3}),ccui.LoadingBar.Type=cc.Enum({LEFT:0,RIGHT:1}),ccui.ScrollView.Dir=cc.Enum({NONE:0,VERTICAL:1,HORIZONTAL:2,BOTH:3})}),{}],204:[(function(i,n,o){"use strict";cc.sys.now=function(){return Date.now()};var r=/[^\.\/]+\/\.\.\//;cc.js.mixin(cc.path,{_normalize:function(t){var e=t=String(t);do{e=t,t=t.replace(r,"")}while(e.length!==t.length);return t},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",stripSep:function(t){return t.replace(/[\/\\]$/,"")}}),cc.Scheduler.prototype.schedule=function(t,e,i,n,o,r){void 0===o||void 0===r?(r=!!n,n=cc.macro.REPEAT_FOREVER):(r=!!r,n=isFinite(n)?n:cc.macro.REPEAT_FOREVER),o=o||0,this.scheduleCallbackForTarget(e,t,i,n,o,r)},cc.Scheduler.prototype.scheduleUpdate=cc.Scheduler.prototype.scheduleUpdateForTarget,cc.Scheduler.prototype._unschedule=cc.Scheduler.prototype.unschedule,cc.Scheduler.prototype.unschedule=function(i,n){if("function"===("object"==(e=typeof n)?t(n):e)){var o=n;n=i,i=o}this._unschedule(n,i)};var s=cc.Node.prototype;cc.defineGetterSetter(s,"_parent",s.getParent,s.setParent),cc.view.isViewReady=cc.view.isOpenGLReady,cc.view.setOrientation=function(){};var c=0,a={},h=function(t){this._intervalId=c++,this._code=t};h.prototype.fun=function(){if(this._code){var i=this._code;"string"===("object"==(e=typeof i)?t(i):e)?Function(i)():"function"===("object"==(e=typeof i)?t(i):e)&&i.apply(null,this._args)}},window.setTimeout=function(t,e,...i){var n=new h(t);i.length>0&&(n._args=i);var o=n.fun;return n.fun=function(){o.call(this),clearTimeout(n._intervalId)},cc.director.getScheduler().schedule(n.fun,n,e/1e3,0,0,!1),a[n._intervalId]=n,n._intervalId},window.setInterval=function(t,e,...i){var n=new h(t);return i.length>0&&(n._args=i),cc.director.getScheduler().schedule(n.fun,n,e/1e3,cc.macro.REPEAT_FOREVER,0,!1),a[n._intervalId]=n,n._intervalId},window.clearInterval=function(t){var e=a[t];e&&(cc.director.getScheduler().unschedule(e.fun,e),delete a[t])},window.clearTimeout=clearInterval,window.SocketIO&&(window.io=window.SocketIO,SocketIO.prototype._jsbEmit=SocketIO.prototype.emit,SocketIO.prototype.emit=function(i,n){"object"===("object"==(e=typeof n)?t(n):e)&&(n=JSON.stringify(n)),this._jsbEmit(i,n)}),cc.Node.prototype.setIgnoreAnchorPointForPosition=cc.Node.prototype.ignoreAnchorPointForPosition,window._ccsg={Node:cc.Node,Scene:cc.Scene,Sprite:cc.Sprite,ParticleSystem:cc.ParticleSystem,Label:cc.Label,EditBox:cc.EditBox,VideoPlayer:cc.VideoPlayer,WebView:cc.WebView,TMXTiledMap:cc.TMXTiledMap,TMXObjectGroup:cc.TMXObjectGroup,TMXObject:cc.TMXObject,TMXObjectImage:cc.TMXObjetImage,TMXObjectShape:cc.TMXObjectShape,TMXLayer:cc.TMXLayer,MotionStreak:cc.MotionStreak,CameraNode:cc.CameraNode},cc.formatStr=cc.js.formatStr,cc.Image&&cc.Image.setPNGPremultipliedAlphaEnabled&&cc.Image.setPNGPremultipliedAlphaEnabled(!1),window.__errorHandler=function(t,e,i){},window.__cleanup=function(){cc.director.getScene().destroy(),cc.Object._deferredDestroy(),cc.js._registeredClassIds={},cc.js._registeredClassNames={},cc.loader.releaseAll(),cc.textureCache.removeAllTextures()}}),{}],205:[(function(i,n,o){"use strict";var r=i("../cocos2d/core/platform/js").Pool,s=i("../cocos2d/core/event/event");i("../cocos2d/core/event-manager/CCEvent"),s.EventMouse.pool=new r(5),s.EventMouse.pool.get=function(t,e){var i=this._get()||new s.EventMouse(e,!0);i._button=t.getButton();var n=t.getLocation();i._x=n.x,i._y=n.y;var o=t._listener;return o&&(i._prevX=o._previousX,i._prevY=o._previousY),i._scrollX=t.getScrollX(),i._scrollY=t.getScrollY(),i._target=null,i._currentTarget=null,i.eventPhase=cc.Event.NONE,i._propagationStopped=!1,i._propagationImmediateStopped=!1,i},s.EventTouch.pool=new r(5),s.EventTouch.pool.get=function(t){var e=t.getTouches(),i=this._get()||new s.EventTouch(e,!0);return i._eventCode=t.getEventCode(),i._target=null,i._currentTarget=null,i.eventPhase=cc.Event.NONE,i._propagationStopped=!1,i._propagationImmediateStopped=!1,i},cc.eventManager.addListener=function(i,n){if(i instanceof cc.EventListener||(i=cc.EventListener.create(i)),"number"===("object"==(e=typeof n)?t(n):e)){if(0===n)return void cc.logID(3500);cc.eventManager.addEventListenerWithFixedPriority(i,n)}else{var o=n;if(n instanceof cc._BaseNode)o=n._sgNode;else if(!(o instanceof _ccsg.Node))return void cc.warnID(3506);cc.eventManager.addEventListenerWithSceneGraphPriority(i,o)}return i},cc.eventManager._removeListeners=cc.eventManager.removeListeners,cc.eventManager.removeListeners=function(t,e){t instanceof cc._BaseNode&&(t=t._sgNode),t instanceof _ccsg.Node||cc.js.isNumber(t)?this._removeListeners(t,e||!1):cc.warnID(3506)},cc.eventManager._pauseTarget=cc.eventManager.pauseTarget,cc.eventManager.pauseTarget=function(t,e){var i=t;if(t._eventPaused=!0,t instanceof cc._BaseNode)i=t._sgNode;else if(!(i instanceof _ccsg.Node))return void cc.warnID(3506);if(i!==t&&!i.isRunning()){var n=i.onEnter;i.onEnter=function(){n.call(this),t._eventPaused&&cc.eventManager._pauseTarget(this,e||!1),this.onEnter=n}}this._pauseTarget(i,e||!1)},cc.eventManager._resumeTarget=cc.eventManager.resumeTarget,cc.eventManager.resumeTarget=function(t,e){if(t._eventPaused=!1,t instanceof cc._BaseNode)t=t._sgNode;else if(!(t instanceof _ccsg.Node))return void cc.warnID(3506);this._resumeTarget(t,e||!1)},cc._EventListenerKeyboard=cc.EventListenerKeyboard,cc._EventListenerKeyboard.LISTENER_ID="__cc_keyboard",cc._EventListenerAcceleration=cc.EventListenerAcceleration,cc._EventListenerAcceleration.LISTENER_ID="__cc_acceleration",cc._EventListenerTouchAllAtOnce=cc.EventListenerTouchAllAtOnce,cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once",cc._EventListenerTouchOneByOne=cc.EventListenerTouchOneByOne,cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one",cc._EventListenerMouse=cc.EventListenerMouse,cc._EventListenerMouse.LISTENER_ID="__cc_mouse"}),{"../cocos2d/core/event-manager/CCEvent":81,"../cocos2d/core/event/event":85,"../cocos2d/core/platform/js":151}],206:[(function(i,n,o){"use strict";cc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",EVENT_RESIZE:"game_on_resize",_onShowListener:null,_onHideListener:null,_paused:!1,_prepareCalled:!1,_prepared:!1,config:null,onStart:null,_sceneInfos:[],_persistRootNodes:{},_ignoreRemovePersistNode:null,RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,EVENT_GAME_INITED:"game_inited",CONFIG_KEY:{width:"width",height:"height",modules:"modules",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",registerSystemEvent:"registerSystemEvent",jsList:"jsList",scenes:"scenes"},setFrameRate:function(t){var e=this;e.config[e.CONFIG_KEY.frameRate]=t,cc.director.setAnimationInterval(1/t)},step:function(){cc.director.mainLoop()},pause:function(){this._paused=!0,cc.director.pause()},resume:function(){this._paused=!1,cc.director.resume()},isPaused:function(){return this._paused},restart:function(){__restartVM()},end:function(){close()},prepare:function(t){var e=this,i=e.config,n=e.CONFIG_KEY;if(this._loadConfig(),this._prepared)t&&t();else if(!this._prepareCalled){this._prepareCalled=!0,cc._renderType=cc.game.RENDER_TYPE_OPENGL,cc.director.sharedInit();var o=i[n.jsList];o?cc.loader.load(o,(function(i){if(i)throw new Error(JSON.stringify(i));e._prepared=!0,t&&t(),e.emit(e.EVENT_GAME_INITED)})):(t&&t(),e.emit(e.EVENT_GAME_INITED))}},run:function(i,n){"function"===("object"==(e=typeof i)?t(i):e)?cc.game.onStart=i:(i&&(cc.game.config=i),"function"===("object"==(e=typeof n)?t(n):e)&&(cc.game.onStart=n)),cc.director.startAnimation(),this.prepare(cc.game.onStart&&cc.game.onStart.bind(cc.game))},addPersistRootNode:function(t){if(cc.Node.isNode(t)&&t.uuid){var e=t.uuid;if(!this._persistRootNodes[e]){var i=cc.director._scene;if(cc.isValid(i)){if(t.parent){if(!(t.parent instanceof cc.Scene))return void cc.warnID(3801);if(t.parent!==i)return void cc.warnID(3802)}else t.parent=i;this._persistRootNodes[e]=t,t._persistNode=!0}}}else cc.warnID(3803)},removePersistRootNode:function(t){if(t!==this._ignoreRemovePersistNode){var e=t._id||"";t===this._persistRootNodes[e]&&(delete this._persistRootNodes[e],t._persistNode=!1)}},isPersistRootNode:function(t){return t._persistNode},_loadConfig:function(){if(this.config)this._initConfig(this.config);else try{var t=jsb.fileUtils.getStringFromFile("project.json"),e=JSON.parse(t);this._initConfig(e||{})}catch(t){console.log("Failed to read or parse project.json"),this._initConfig({})}},_initConfig:function(i){var n=this.CONFIG_KEY;"number"!==("object"==(e=typeof i[n.debugMode])?t(i[n.debugMode]):e)&&(i[n.debugMode]=0),"number"!==("object"==(e=typeof i[n.frameRate])?t(i[n.frameRate]):e)&&(i[n.frameRate]=60),"number"!==("object"==(e=typeof i[n.renderMode])?t(i[n.renderMode]):e)&&(i[n.renderMode]=0),i[n.showFPS]=!(n.showFPS in i)||!!i[n.showFPS],this.groupList=i.groupList||[],this.collisionMatrix=i.collisionMatrix||[],this._sceneInfos=i[n.scenes]||[],cc.director.setDisplayStats(i[n.showFPS]),cc.director.setAnimationInterval(1/i[n.frameRate]),cc._initDebugSetting(i[n.debugMode]),this.config=i}},cc.EventTarget.call(cc.game),cc.js.addon(cc.game,cc.EventTarget.prototype),cc.game._onHideListener=cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,(function(){cc.game.emit(cc.game.EVENT_HIDE,cc.game)})),cc.game._onShowListener=cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,(function(){cc.game.emit(cc.game.EVENT_SHOW,cc.game)})),cc._initDebugSetting(cc.game.DEBUG_MODE_INFO)}),{}],207:[(function(i,n,o){"use strict";var r=cc.Label;!r.createWithTTF&&r.prototype.createWithTTF&&(r.createWithTTF=r.prototype.createWithTTF),r.prototype.setHorizontalAlign=r.prototype.setHorizontalAlignment,r.prototype.setVerticalAlign=r.prototype.setVerticalAlignment,r.prototype.setBMFontSize||(r.prototype.setBMFontSize=function(){}),r.prototype.getBMFontSize||(r.prototype.getBMFontSize=function(){}),r.prototype.setOverflow||(r.prototype.setOverflow=function(){}),r.prototype.getOverflow||(r.prototype.getOverflow=function(){}),r.prototype._setOverflow=r.prototype.setOverflow,r.prototype.setOverflow=function(t){this._overFlow=t,this._setOverflow(this._overFlow)},r.prototype.getOverflow=function(){return this._overFlow},r.prototype._enableBold=r.prototype.enableBold,r.prototype.enableBold=function(t){t?this._enableBold():this.disableEffect(5)},r.prototype._enableItalics=r.prototype.enableItalics,r.prototype.enableItalics=function(t){t?this._enableItalics():this.disableEffect(4)},r.prototype._enableUnderline=r.prototype.enableUnderline,r.prototype.enableUnderline=function(t){t?this._enableUnderline():this.disableEffect(6)},r.prototype.setFontSize=function(t){if(this._fontSize=t,this._labelType===_ccsg.Label.Type.SystemFont)this.setSystemFontSize(t);else if(this._labelType===_ccsg.Label.Type.BMFont)this.setBMFontSize(t);else if(this._labelType===_ccsg.Label.Type.TTF){var e=this.getTTFConfig();e.fontSize=t,this.setTTFConfig(e)}},r.prototype.getFontSize=function(){return this._fontSize},r.prototype.enableWrapText=r.prototype.enableWrap||function(){},r.prototype.isWrapTextEnabled=r.prototype.isWrapEnabled||function(){},r.prototype._setLineHeight=r.prototype.setLineHeight,r.prototype.setLineHeight=function(t){this._labelType!==_ccsg.Label.Type.SystemFont&&this._setLineHeight(t)},r.prototype._setColor=r.prototype.setColor,r.prototype.setColor=function(t){this._labelType===_ccsg.Label.Type.BMFont?this._setColor(t):this.setTextColor(t)},r.prototype.setSpacingX=r.prototype.setAdditionalKerning,r.prototype._setTTFConfig=r.prototype.setTTFConfig,r.prototype.setTTFConfig=function(t){this._setTTFConfig(t),this._ttfConfig=t},r.prototype.getTTFConfig=function(){return this._ttfConfig},r.prototype._setContentSize=r.prototype.setContentSize,r.prototype.setContentSize=function(i,n){var o="number"===("object"==(e=typeof i.width)?t(i.width):e)?i.width:i,r="number"===("object"==(e=typeof i.height)?t(i.height):e)?i.height:n;this.getOverflow()===cc.Label.Overflow.NONE?(o=0,r=0):this._setContentSize(o,r),this.setDimensions(o,r)},r.prototype.setFontAsset=function(t){this._fontAsset=t;var e=t instanceof cc.Font;if(e){var i=e?t.rawUrl:"";if(".ttf"===cc.path.extname(i)){var n=this.isOutlined()?this.getOutlineWidth():0;this._ttfConfig?(this._ttfConfig.outlineSize=n,this._ttfConfig.fontFilePath=i):this._ttfConfig={fontFilePath:i,fontSize:this._fontSize,outlineSize:n,glyphs:0,customGlyphs:"",distanceFieldEnable:!1},this._labelType=_ccsg.Label.Type.TTF,this.setTTFConfig(this._ttfConfig)}else t.spriteFrame&&(this._labelType=_ccsg.Label.Type.BMFont,this.setBMFontFilePath(JSON.stringify(t._fntConfig),t.spriteFrame),this.setFontSize(this.getFontSize()));this.getContentSize()}else this.setFontFamily("Arial")},r.prototype.setFontFamily=function(t){t=t||"",this._labelType=_ccsg.Label.Type.SystemFont,this.setSystemFontName(t),this._isSystemFontUsed=!0,this.getContentSize()},r.prototype.setOutlined=function(t){this._outlined=!!t,this._outlined?this.enableOutline(this.getOutlineColor(),this.getOutlineWidth()):this.disableEffect(1)},r.prototype.setOutlineWidth=function(t){if(this._outlineWidth=t,this._outlined){var e=this.getOutlineWidth();if(this._labelType===_ccsg.Label.Type.TTF){var i=this.getTTFConfig();i.outlineSize!==e&&(i.outlineSize=e,this.setTTFConfig(i))}else this.enableOutline(this.getOutlineColor(),e)}},r.prototype.setOutlineColor=function(t){this._outlineColor=cc.color(t),this._outlined&&this.enableOutline(this.getOutlineColor(),this.getOutlineWidth())},r.prototype.setMargin=function(){},r.prototype.isOutlined=function(){return this._outlined},r.prototype.getOutlineWidth=function(){return this._outlineWidth||1},r.prototype.getOutlineColor=function(){return this._outlineColor||cc.color(255,255,255,255)},cc.Label=function(t,e,i,n){e=e||"Arial";var o=cc.path.extname(e),s=_ccsg.Label.Type.TTF;this._fontSize=n;var c;if(".ttf"===o){var a={fontFilePath:e,fontSize:this._fontSize,outlineSize:0,glyphs:0,customGlyphs:"",distanceFieldEnable:!1};(c=r.createWithTTF(a,t,this._fontSize))._ttfConfig=a}else i?(c=r.createWithBMFont(e,t,i),s=_ccsg.Label.Type.BMFont):(c=r.createWithSystemFont(t||"",e,this._fontSize),s=_ccsg.Label.Type.SystemFont,c._isSystemFontUsed=!0);return c._labelType=s,c},cc.Label.Type=cc.Enum({TTF:0,BMFont:1,SystemFont:2}),cc.Label.Overflow=cc.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3}),cc.Label.pool=new cc.js.Pool(0),cc.Label.pool.get=function(t,e,i,n){this._fontAsset=e,n=n||40;var o=e instanceof cc.Font;if(!o)return new _ccsg.Label(t,null,null,n);var r=o?e.rawUrl:"";return new _ccsg.Label(t,r,i,n)}}),{}],208:[(function(t,e,i){"use strict";function n(t,e){return null}function o(e,i){return t(e.url),null}function r(t,e){return t.url}function s(t,e){var i=t.url,n=cc.textureCache.getTextureForKey(i);if(n)return n;if(i.match(jsb.urlRegExp))jsb.loadRemoteImg(i,(function(t,n){t?e&&e(null,n):e&&e(new Error("Load image failed: "+i))}));else{var o=function(t){t instanceof cc.Texture2D?e&&e(null,t):e&&e(new Error("Load image failed: "+i)),jsb.unregisterNativeRef(cc.textureCache,o)};cc.textureCache._addImageAsync(i,o)}}t("../cocos2d/core/load-pipeline"),cc.loader.addDownloadHandlers({js:o,jsc:o,png:n,jpg:n,bmp:n,jpeg:n,gif:n,ico:n,tiff:n,webp:n,image:n,mp3:r,ogg:r,wav:r,mp4:r,m4a:r,font:n,eot:n,ttf:n,woff:n,svg:n,ttc:n}),cc.loader.addLoadHandlers({png:s,jpg:s,bmp:s,jpeg:s,gif:s,ico:s,tiff:s,webp:s,image:s,default:n})}),{"../cocos2d/core/load-pipeline":103}],209:[(function(t,e,i){"use strict";cc.ParticleSystem.Mode=cc.Enum({GRAVITY:0,RADIUS:1}),cc.ParticleSystem.Type=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2});for(var n=[{tangentialAccel:"setTangentialAccel",tangentialAccelVar:"setTangentialAccelVar",radialAccel:"setRadialAccel",radialAccelVar:"setRadialAccelVar",rotationIsDir:"setRotationIsDir",gravity:"setGravity",speed:"setSpeed",speedVar:"setSpeedVar"},{startRadius:"setStartRadius",startRadiusVar:"setStartRadiusVar",endRadius:"setEndRadius",endRadiusVar:"setEndRadiusVar",rotatePerS:"setRotatePerSecond",rotatePerSVar:"setRotatePerSecondVar"}],o=cc.ParticleSystem.prototype,r=0;r<n.length;r++){var s=n[r];for(var c in s){var a=s[c],h=o[a];o[a]=(function(t,e){return function(i){this.getEmitterMode()===e&&t.call(this,i)}})(h,r);var l=a.replace("set","get");cc.defineGetterSetter(o,c,o[l],o[a])}}}),{}],210:[(function(t,e,i){"use strict";var n=!1;cc.Scale9SpriteV2&&(n=!0,cc.Scale9Sprite=cc.Scale9SpriteV2),cc.Scale9Sprite.state={NORMAL:0,GRAY:1,DISTORTION:2},cc.Scale9Sprite.RenderingType=cc.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3}),cc.Scale9Sprite.FillType=cc.Enum({Horizontal:0,Vertical:1,RADIAL:2});var o=cc.Scale9Sprite.prototype;if(n){var r=o.setContentSize;o.setContentSize=function(t,e){void 0!==e&&(t=new cc.Size(t,e)),r.call(this,t)};var s=o.setAnchorPoint;o.setAnchorPoint=function(t,e){void 0!==e&&(t=new cc.Vec2(t,e)),s.call(this,t)}}else o.setFillType=function(){},o.setFillCenter=function(){},o.setFillStart=function(){},o.setFillRange=function(){},o.enableTrimmedContentSize=function(){},o._lazyInit=function(){this._onceInit||(this._onceInit=!0,this._insets={left:0,right:0,top:0,bottom:0},this._trim={left:0,right:0,top:0,bottom:0},this._contentSizeTrimmed=new cc.Size(0,0),this._anchorPointTrimmed=new cc.Vec2(0,0),this._sizeAfterTrimmed=new cc.Size(0,0))},o._applyInsetsContentAnchor=function(){var t=1,e=1;(this._renderingType||this.getRenderingType&&this.getRenderingType())===cc.Scale9Sprite.RenderingType.SIMPLE&&(t=this._contentSizeTrimmed.width/this._sizeAfterTrimmed.width,e=this._contentSizeTrimmed.height/this._sizeAfterTrimmed.height);var i=new cc.Size(0,0);i.width=this._contentSizeTrimmed.width+(this._trim.left+this._trim.right)*t,i.height=this._contentSizeTrimmed.height+(this._trim.top+this._trim.bottom)*e,this._setContentSize(i);var n=new cc.Vec2(0,0);n.x=this._contentSizeTrimmed.width*this._anchorPointTrimmed.x+this._trim.left*t,n.y=this._contentSizeTrimmed.height*this._anchorPointTrimmed.y+this._trim.bottom*e,n.x=n.x/i.width,n.y=n.y/i.height,this._setAnchorPoint(n);var o=new cc.Rect(0,0,0,0);o.x=this._trim.left+this._insets.left,o.y=this._trim.top+this._insets.top,o.width=this._sizeAfterTrimmed.width-this._insets.left-this._insets.right,o.height=this._sizeAfterTrimmed.height-this._insets.top-this._insets.bottom,this.setCapInsets(o)},o._setBlendFunc=o.setBlendFunc,o.setBlendFunc=function(t,e){void 0!==e&&(t={src:t,dst:e}),this._setBlendFunc&&this._setBlendFunc(t)},o._getContentSize=o.getContentSize,o.getContentSize=function(){return new cc.Size(this._contentSizeTrimmed)},o._setContentSize=o.setContentSize,o.setContentSize=function(t,e){this._lazyInit(),void 0!==e&&(t=new cc.Size(t,e)),this._contentSizeTrimmed=new cc.Size(t),this._applyInsetsContentAnchor()},o._getAnchorPoint=o.getAnchorPoint,o.getAnchorPoint=function(){return new cc.Vec2(this._anchorPointTrimmed)},o._setAnchorPoint=o.setAnchorPoint,o.setAnchorPoint=function(t,e){this._lazyInit(),void 0!==e&&(t=new cc.Vec2(t,e)),this._anchorPointTrimmed=new cc.Vec2(t),this._applyInsetsContentAnchor()},o._getInsetLeft=o.getInsetLeft,o._getInsetRight=o.getInsetRight,o._getInsetBottom=o.getInsetBottom,o._getInsetTop=o.getInsetTop,o.getInsetLeft=function(){return this._insets.left},o.getInsetRight=function(){return this._insets.right},o.getInsetBottom=function(){return this._insets.bottom},o.getInsetTop=function(){return this._insets.top},o._setInsetLeft=o.setInsetLeft,o.setInsetLeft=function(t){this._lazyInit(),this._insets.left=t,this._applyInsetsContentAnchor()},o._setInsetRight=o.setInsetRight,o.setInsetRight=function(t){this._lazyInit(),this._insets.right=t,this._applyInsetsContentAnchor()},o._setInsetTop=o.setInsetTop,o.setInsetTop=function(t){this._lazyInit(),this._insets.top=t,this._applyInsetsContentAnchor()},o._setInsetBottom=o.setInsetBottom,o.setInsetBottom=function(t){this._lazyInit(),this._insets.bottom=t,this._applyInsetsContentAnchor()},o._setSpriteFrame=o.setSpriteFrame,o.setSpriteFrame=function(t){this._lazyInit();var e=t.getOriginalSize(),i=t.getRect(),n=t.getOffset(),o=(e.width+2*n.x-i.width)/2,r=e.width-o-i.width,s=(e.height+2*n.y-i.height)/2,c=e.height-s-i.height;this._trim.left=o,this._trim.right=r,this._trim.top=c,this._trim.bottom=s,this._sizeAfterTrimmed=new cc.Size(i.width,i.height),this._setSpriteFrame(t),this._applyInsetsContentAnchor()}}),{}],211:[(function(t,e,i){sp._SGSkeleton=sp.Skeleton,sp._SGSkeletonAnimation=sp.SkeletonAnimation,sp._SGSkeleton.prototype.setPremultipliedAlpha=sp._SGSkeleton.prototype.setOpacityModifyRGB,sp._SGSkeleton.prototype.setOpacityModifyRGB=function(){}}),{}],212:[(function(i,n,o){"use strict";i("../cocos2d/core/platform/CCClass"),i("../cocos2d/core/assets/CCAsset"),cc.TextureCache.prototype._addImageAsync||(cc.TextureCache.prototype._addImageAsync=cc.TextureCache.prototype.addImageAsync),cc.TextureCache.prototype.addImageAsync=function(t,e,i){var n=null;return cc.loader.load(t,(function(t,o){t&&(o=null),e&&e.call(i,o),n=o})),n},cc.TextureCache.prototype._addImage||(cc.TextureCache.prototype._addImage=cc.TextureCache.prototype.addImage),cc.TextureCache.prototype.addImage=function(i,n,o){return"function"===("object"==(e=typeof n)?t(n):e)?this.addImageAsync(i,n,o):n?this._addImage(i,n):this._addImage(i)},cc.textureCache._textures={},cc.textureCache.cacheImage=function(t,e){e instanceof cc.Texture2D&&(this._textures[t]=e)},cc.textureCache._getTextureForKey=cc.textureCache.getTextureForKey,cc.textureCache.getTextureForKey=function(t){var e=this._getTextureForKey(t);return e||(e=this._textures[t]),e||null},cc.textureCache._removeTextureForKey=cc.textureCache.removeTextureForKey,cc.textureCache.removeTextureForKey=function(t){this._textures[t]&&delete this._textures[t],this._removeTextureForKey(t)},cc.Class._fastDefine("cc.Texture2D",cc.Texture2D,[]),cc.js.value(cc.Texture2D,"$super",cc.RawAsset),cc.Texture2D.WrapMode=cc.Enum({REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648});var r=cc.Texture2D.prototype;r.isLoaded=function(){return!0},r.getPixelWidth=r.getPixelsWide,r.getPixelHeight=r.getPixelsHigh,r.description=r.getDescription,cc.js.get(r,"pixelWidth",r.getPixelWidth),cc.js.get(r,"pixelHeight",r.getPixelHeight),cc.Class._fastDefine("cc.SpriteFrame",cc.SpriteFrame,[]),cc.js.value(cc.SpriteFrame,"$super",cc.Asset),(r=cc.SpriteFrame.prototype)._setTexture=r.setTexture,r._initWithTexture=r.initWithTexture,cc.js.mixin(r,cc.EventTarget.prototype),r._ctor=function(t,e,i,n,o){this._name="",this.insetTop=0,this.insetBottom=0,this.insetLeft=0,this.insetRight=0,void 0!==t&&this.initWithTexture(t,e,i,n,o)},r.textureLoaded=function(){return null!==this.getTexture()},r.setTexture=function(t,e,i,n,o){e&&this.setRect(e),n&&this.setOffset(n),o&&this.setOriginalSize(o),this.setRotated(i||!1);var r=t;return cc.js.isString(t)?(this._textureFilename=t,this._loadTexture()):r instanceof cc.Texture2D&&this._refreshTexture(r),!0},r.initWithTexture=r.setTexture,r._loadTexture=function(){if(this._textureFilename){var t=cc.textureCache.addImage(this._textureFilename);this._refreshTexture(t)}},r.ensureLoadTexture=function(){this._texture||this._loadTexture()},r.clearTexture=function(){this._setTexture(null)},r._refreshTexture=function(t){if(this.getTexture()!==t){var e=t.width,i=t.height,n=this.getRect();0===n.width||0===n.height?n=cc.rect(0,0,e,i):this._checkRect(t);var o=this.getOriginalSize();0!==o.width&&0!==o.height||(o=cc.size(e,i));var r=this.getOffset(),s=this.isRotated();this._initWithTexture(t,n,s,r,o),this.emit("load")}},r._deserialize=function(t,e){var i=t.rect;i&&this.setRect(new cc.Rect(i[0],i[1],i[2],i[3])),t.offset&&this.setOffset(new cc.Vec2(t.offset[0],t.offset[1])),t.originalSize&&this.setOriginalSize(new cc.Size(t.originalSize[0],t.originalSize[1])),this.setRotated(1===t.rotated),this._name=t.name;var n=t.capInsets;n&&(this.insetLeft=n[0],this.insetTop=n[1],this.insetRight=n[2],this.insetBottom=n[3]);var o=t.texture;if(o){var r=e.customEnv&&e.customEnv.deferredLoadRaw?"_textureFilename":"_textureFilenameSetter";e.result.push(this,r,o)}},r._checkRect=function(t){var e=this.getRect(),i=e.x,n=e.y;this.isRotated()?(i+=e.height,n+=e.width):(i+=e.width,n+=e.height),i>t.getPixelWidth()&&cc.errorID(3300,t.url),n>t.getPixelHeight()&&cc.errorID(3400,t.url)},r._getTexture=r.getTexture,r.getTexture=function(){var t=this._getTexture();return this._texture=t,t},r._clone=r.clone,r.clone=function(){var t=this._clone();return t._name=this._name,t.insetTop=this.insetTop,t.insetBottom=this.insetBottom,t.insetLeft=this.insetLeft,t.insetRight=this.insetRight,t},cc.js.set(r,"_textureFilenameSetter",(function(t){this._textureFilename=t,t&&this._loadTexture()})),cc.js.getset(r,"name",(function(){return this._name}),(function(t){this._name=t}))}),{"../cocos2d/core/assets/CCAsset":25,"../cocos2d/core/platform/CCClass":136}],213:[(function(t,e,i){"use strict";if(!cc.runtime){var n=cc.TMXObject.prototype;cc.defineGetterSetter(n,"type",n.getType,null),cc.defineGetterSetter(n,"name",n.getObjectName,n.setObjectName),cc.defineGetterSetter(n,"id",n.getId,null),cc.defineGetterSetter(n,"gid",n.getGid,null),cc.defineGetterSetter(n,"offset",n.getOffset,null),cc.defineGetterSetter(n,"objectSize",n.getObjectSize,null),cc.defineGetterSetter(n,"objectVisible",n.getObjectVisible,null),cc.defineGetterSetter(n,"objectRotation",n.getObjectRotation,null),cc.defineGetterSetter(n,"sgNode",n.getNode,null)}}),{}],214:[(function(t,e,i){cc.VideoPlayer=ccui.VideoPlayer}),{}],215:[(function(t,e,i){cc.WebView=ccui.WebView}),{}],216:[(function(i,n,o){if(Math.sign||(Math.sign=function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(i){return"number"===("object"==(e=typeof i)?t(i):e)&&(0|i)===i}),!console.time){var r=window.performance||Date,s=Object.create(null);console.time=function(t){s[t]=r.now()},console.timeEnd=function(t){var e=s[t],i=r.now()-e;console.log(t+": "+i+"ms")}}}),{}],217:[(function(i,n,o){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};window.__extends=function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},window.__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},window.__rest=function(i,n){var o={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&n.indexOf(r)<0&&(o[r]=i[r]);if(null!=i&&"function"===("object"==(e=typeof Object.getOwnPropertySymbols)?t(Object.getOwnPropertySymbols):e))for(var s=0,r=Object.getOwnPropertySymbols(i);s<r.length;s++)n.indexOf(r[s])<0&&(o[r[s]]=i[r[s]]);return o},window.__decorate=function(i,n,o,r){var s,c=arguments.length,a=c<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,o):r;if("object"===("object"==(e=typeof Reflect)?t(Reflect):e)&&"function"===("object"==(e=typeof Reflect.decorate)?t(Reflect.decorate):e))a=Reflect.decorate(i,n,o,r);else for(var h=i.length-1;h>=0;h--)(s=i[h])&&(a=(c<3?s(a):c>3?s(n,o,a):s(n,o))||a);return c>3&&a&&Object.defineProperty(n,o,a),a},window.__param=function(t,e){return function(i,n){e(i,n,t)}},window.__metadata=function(i,n){if("object"===("object"==(e=typeof Reflect)?t(Reflect):e)&&"function"===("object"==(e=typeof Reflect.metadata)?t(Reflect.metadata):e))return Reflect.metadata(i,n)},window.__awaiter=function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function s(t){try{a(n.next(t))}catch(t){r(t)}}function c(t){try{a(n.throw(t))}catch(t){r(t)}}function a(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(s,c)}a((n=n.apply(t,e||[])).next())})},window.__generator=function(i,n){function o(t){return function(e){return r([t,e])}}function r(t){if(s)throw new TypeError("Generator is already executing.");for(;l;)try{if(s=1,c&&(a=c[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(c,t[1])).done)return a;switch(c=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,c=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){l.label=t[1];break}if(6===t[0]&&l.label<a[1]){l.label=a[1],a=t;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(t);break}a[2]&&l.ops.pop(),l.trys.pop();continue}t=n.call(i,l)}catch(e){t=[6,e],c=0}finally{s=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var s,c,a,h,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return h={next:o(0),throw:o(1),return:o(2)},"function"===("object"==(e=typeof Symbol)?t(Symbol):e)&&(h[Symbol.iterator]=function(){return this}),h},window.__exportStar=function(t,e){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])},window.__values=function(i){var n="function"===("object"==(e=typeof Symbol)?t(Symbol):e)&&i[Symbol.iterator],o=0;return n?n.call(i):{next:function(){return i&&o>=i.length&&(i=void 0),{value:i&&i[o++],done:!i}}}},window.__read=function(i,n){var o="function"===("object"==(e=typeof Symbol)?t(Symbol):e)&&i[Symbol.iterator];if(!o)return i;var r,s,c=o.call(i),a=[];try{for(;(void 0===n||n-- >0)&&!(r=c.next()).done;)a.push(r.value)}catch(t){s={error:t}}finally{try{r&&!r.done&&(o=c.return)&&o.call(c)}finally{if(s)throw s.error}}return a},window.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},window.__await=function(t){return this instanceof __await?(this.v=t,this):new __await(t)},window.__asyncGenerator=function(t,e,i){function n(t){l[t]&&(h[t]=function(e){return new Promise(function(i,n){u.push([t,e,i,n])>1||o(t,e)})})}function o(t,e){try{r(l[t](e))}catch(t){a(u[0][3],t)}}function r(t){t.value instanceof __await?Promise.resolve(t.value.v).then(s,c):a(u[0][2],t)}function s(t){o("next",t)}function c(t){o("throw",t)}function a(t,e){t(e),u.shift(),u.length&&o(u[0][0],u[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h,l=i.apply(t,e||[]),u=[];return h={},n("next"),n("throw"),n("return"),h[Symbol.asyncIterator]=function(){return this},h},window.__asyncDelegator=function(t){function e(e,o){t[e]&&(i[e]=function(i){return(n=!n)?{value:__await(t[e](i)),done:"return"===e}:o?o(i):i})}var i,n;return i={},e("next"),e("throw",(function(t){throw t})),e("return"),i[Symbol.iterator]=function(){return this},i},window.__asyncValues=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=i[Symbol.asyncIterator];return n?n.call(i):"function"===("object"==(e=typeof __values)?t(__values):e)?__values(i):i[Symbol.iterator]()}}),{}],218:[(function(t,e,i){}),{}]},{},[196]);var e=""})();